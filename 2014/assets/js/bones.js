(function() {/**
 * @license
 * Lo-Dash 2.4.1 (Custom Build) lodash.com/license | Underscore.js 1.5.2 underscorejs.org/LICENSE
 * Build: `lodash underscore exports="amd,commonjs,global,node" -o ./dist/lodash.underscore.js`
 */
;(function(){function n(n,r,t){t=(t||0)-1;for(var e=n?n.length:0;++t<e;)if(n[t]===r)return t;return-1}function r(n,r){for(var t=n.m,e=r.m,u=-1,o=t.length;++u<o;){var i=t[u],f=e[u];if(i!==f){if(i>f||typeof i=="undefined")return 1;if(i<f||typeof f=="undefined")return-1}}return n.n-r.n}function t(n){return"\\"+yr[n]}function e(n,r,t){r||(r=0),typeof t=="undefined"&&(t=n?n.length:0);var e=-1;t=t-r||0;for(var u=Array(0>t?0:t);++e<t;)u[e]=n[r+e];return u}function u(n){return n instanceof u?n:new o(n)}function o(n,r){this.__chain__=!!r,this.__wrapped__=n
}function i(n){function r(){if(u){var n=e(u);Rr.apply(n,arguments)}if(this instanceof r){var i=f(t.prototype),n=t.apply(i,n||arguments);return O(n)?n:i}return t.apply(o,n||arguments)}var t=n[0],u=n[2],o=n[4];return r}function f(n){return O(n)?Br(n):{}}function a(n,r,t){if(typeof n!="function")return Y;if(typeof r=="undefined"||!("prototype"in n))return n;switch(t){case 1:return function(t){return n.call(r,t)};case 2:return function(t,e){return n.call(r,t,e)};case 3:return function(t,e,u){return n.call(r,t,e,u)
};case 4:return function(t,e,u,o){return n.call(r,t,e,u,o)}}return L(n,r)}function l(n){function r(){var n=p?a:this;if(o){var y=e(o);Rr.apply(y,arguments)}return(i||g)&&(y||(y=e(arguments)),i&&Rr.apply(y,i),g&&y.length<c)?(u|=16,l([t,h?u:-4&u,y,null,a,c])):(y||(y=arguments),s&&(t=n[v]),this instanceof r?(n=f(t.prototype),y=t.apply(n,y),O(y)?y:n):t.apply(n,y))}var t=n[0],u=n[1],o=n[2],i=n[3],a=n[4],c=n[5],p=1&u,s=2&u,g=4&u,h=8&u,v=t;return r}function c(n,r){for(var t=-1,e=m(),u=n?n.length:0,o=[];++t<u;){var i=n[t];
0>e(r,i)&&o.push(i)}return o}function p(n,r,t,e){e=(e||0)-1;for(var u=n?n.length:0,o=[];++e<u;){var i=n[e];if(i&&typeof i=="object"&&typeof i.length=="number"&&(Cr(i)||b(i))){r||(i=p(i,r,t));var f=-1,a=i.length,l=o.length;for(o.length+=a;++f<a;)o[l++]=i[f]}else t||o.push(i)}return o}function s(n,r,t,e){if(n===r)return 0!==n||1/n==1/r;if(n===n&&!(n&&vr[typeof n]||r&&vr[typeof r]))return false;if(null==n||null==r)return n===r;var o=Er.call(n),i=Er.call(r);if(o!=i)return false;switch(o){case lr:case cr:return+n==+r;
case pr:return n!=+n?r!=+r:0==n?1/n==1/r:n==+r;case gr:case hr:return n==r+""}if(i=o==ar,!i){var f=n instanceof u,a=r instanceof u;if(f||a)return s(f?n.__wrapped__:n,a?r.__wrapped__:r,t,e);if(o!=sr)return false;if(o=n.constructor,f=r.constructor,o!=f&&!(A(o)&&o instanceof o&&A(f)&&f instanceof f)&&"constructor"in n&&"constructor"in r)return false}for(t||(t=[]),e||(e=[]),o=t.length;o--;)if(t[o]==n)return e[o]==r;var l=true,c=0;if(t.push(n),e.push(r),i){if(c=r.length,l=c==n.length)for(;c--&&(l=s(n[c],r[c],t,e)););}else Kr(r,function(r,u,o){return Nr.call(o,u)?(c++,!(l=Nr.call(n,u)&&s(n[u],r,t,e))&&er):void 0
}),l&&Kr(n,function(n,r,t){return Nr.call(t,r)?!(l=-1<--c)&&er:void 0});return t.pop(),e.pop(),l}function g(n,r,t){for(var e=-1,u=m(),o=n?n.length:0,i=[],f=t?[]:i;++e<o;){var a=n[e],l=t?t(a,e,n):a;(r?!e||f[f.length-1]!==l:0>u(f,l))&&(t&&f.push(l),i.push(a))}return i}function h(n){return function(r,t,e){var u={};t=X(t,e,3),e=-1;var o=r?r.length:0;if(typeof o=="number")for(;++e<o;){var i=r[e];n(u,i,t(i,e,r),r)}else Lr(r,function(r,e,o){n(u,r,t(r,e,o),o)});return u}}function v(n,r,t,e,u,o){var f=16&r,a=32&r;
if(!(2&r||A(n)))throw new TypeError;return f&&!t.length&&(r&=-17,t=false),a&&!e.length&&(r&=-33,e=false),(1==r||17===r?i:l)([n,r,t,e,u,o])}function y(n){return Vr[n]}function m(){var r=(r=u.indexOf)===G?n:r;return r}function _(n){return typeof n=="function"&&Ar.test(n)}function d(n){return Gr[n]}function b(n){return n&&typeof n=="object"&&typeof n.length=="number"&&Er.call(n)==fr||false}function w(n){if(!n)return n;for(var r=1,t=arguments.length;r<t;r++){var e=arguments[r];if(e)for(var u in e)n[u]=e[u]}return n
}function j(n){if(!n)return n;for(var r=1,t=arguments.length;r<t;r++){var e=arguments[r];if(e)for(var u in e)"undefined"==typeof n[u]&&(n[u]=e[u])}return n}function x(n){var r=[];return Kr(n,function(n,t){A(n)&&r.push(t)}),r.sort()}function T(n){for(var r=-1,t=Ur(n),e=t.length,u={};++r<e;){var o=t[r];u[n[o]]=o}return u}function E(n){if(!n)return true;if(Cr(n)||N(n))return!n.length;for(var r in n)if(Nr.call(n,r))return false;return true}function A(n){return typeof n=="function"}function O(n){return!(!n||!vr[typeof n])
}function S(n){return typeof n=="number"||n&&typeof n=="object"&&Er.call(n)==pr||false}function N(n){return typeof n=="string"||n&&typeof n=="object"&&Er.call(n)==hr||false}function R(n){for(var r=-1,t=Ur(n),e=t.length,u=Array(e);++r<e;)u[r]=n[t[r]];return u}function k(n,r){var t=m(),e=n?n.length:0,u=false;return e&&typeof e=="number"?u=-1<t(n,r):Lr(n,function(n){return(u=n===r)&&er}),u}function B(n,r,t){var e=true;r=X(r,t,3),t=-1;var u=n?n.length:0;if(typeof u=="number")for(;++t<u&&(e=!!r(n[t],t,n)););else Lr(n,function(n,t,u){return!(e=!!r(n,t,u))&&er
});return e}function F(n,r,t){var e=[];r=X(r,t,3),t=-1;var u=n?n.length:0;if(typeof u=="number")for(;++t<u;){var o=n[t];r(o,t,n)&&e.push(o)}else Lr(n,function(n,t,u){r(n,t,u)&&e.push(n)});return e}function q(n,r,t){r=X(r,t,3),t=-1;var e=n?n.length:0;if(typeof e!="number"){var u;return Lr(n,function(n,t,e){return r(n,t,e)?(u=n,er):void 0}),u}for(;++t<e;){var o=n[t];if(r(o,t,n))return o}}function D(n,r,t){var e=-1,u=n?n.length:0;if(r=r&&typeof t=="undefined"?r:a(r,t,3),typeof u=="number")for(;++e<u&&r(n[e],e,n)!==er;);else Lr(n,r)
}function I(n,r){var t=n?n.length:0;if(typeof t=="number")for(;t--&&false!==r(n[t],t,n););else{var e=Ur(n),t=e.length;Lr(n,function(n,u,o){return u=e?e[--t]:--t,false===r(o[u],u,o)&&er})}}function M(n,r,t){var e=-1,u=n?n.length:0;if(r=X(r,t,3),typeof u=="number")for(var o=Array(u);++e<u;)o[e]=r(n[e],e,n);else o=[],Lr(n,function(n,t,u){o[++e]=r(n,t,u)});return o}function $(n,r,t){var e=-1/0,u=e;typeof r!="function"&&t&&t[r]===n&&(r=null);var o=-1,i=n?n.length:0;if(null==r&&typeof i=="number")for(;++o<i;)t=n[o],t>u&&(u=t);
else r=X(r,t,3),D(n,function(n,t,o){t=r(n,t,o),t>e&&(e=t,u=n)});return u}function W(n,r,t,e){if(!n)return t;var u=3>arguments.length;r=X(r,e,4);var o=-1,i=n.length;if(typeof i=="number")for(u&&(t=n[++o]);++o<i;)t=r(t,n[o],o,n);else Lr(n,function(n,e,o){t=u?(u=false,n):r(t,n,e,o)});return t}function z(n,r,t,e){var u=3>arguments.length;return r=X(r,e,4),I(n,function(n,e,o){t=u?(u=false,n):r(t,n,e,o)}),t}function C(n){var r=-1,t=n?n.length:0,e=Array(typeof t=="number"?t:0);return D(n,function(n){var t;t=++r,t=0+Sr(Wr()*(t-0+1)),e[r]=e[t],e[t]=n
}),e}function P(n,r,t){var e;r=X(r,t,3),t=-1;var u=n?n.length:0;if(typeof u=="number")for(;++t<u&&!(e=r(n[t],t,n)););else Lr(n,function(n,t,u){return(e=r(n,t,u))&&er});return!!e}function U(n,r,t){return t&&E(r)?rr:(t?q:F)(n,r)}function V(n,r,t){var u=0,o=n?n.length:0;if(typeof r!="number"&&null!=r){var i=-1;for(r=X(r,t,3);++i<o&&r(n[i],i,n);)u++}else if(u=r,null==u||t)return n?n[0]:rr;return e(n,0,$r(Mr(0,u),o))}function G(r,t,e){if(typeof e=="number"){var u=r?r.length:0;e=0>e?Mr(0,u+e):e||0}else if(e)return e=J(r,t),r[e]===t?e:-1;
return n(r,t,e)}function H(n,r,t){if(typeof r!="number"&&null!=r){var u=0,o=-1,i=n?n.length:0;for(r=X(r,t,3);++o<i&&r(n[o],o,n);)u++}else u=null==r||t?1:Mr(0,r);return e(n,u)}function J(n,r,t,e){var u=0,o=n?n.length:u;for(t=t?X(t,e,1):Y,r=t(r);u<o;)e=u+o>>>1,t(n[e])<r?u=e+1:o=e;return u}function K(n,r,t,e){return typeof r!="boolean"&&null!=r&&(e=t,t=typeof r!="function"&&e&&e[r]===n?null:r,r=false),null!=t&&(t=X(t,e,3)),g(n,r,t)}function L(n,r){return 2<arguments.length?v(n,17,e(arguments,2),null,r):v(n,1,null,null,r)
}function Q(n,r,t){var e,u,o,i,f,a,l,c=0,p=false,s=true;if(!A(n))throw new TypeError;if(r=Mr(0,r)||0,true===t)var g=true,s=false;else O(t)&&(g=t.leading,p="maxWait"in t&&(Mr(r,t.maxWait)||0),s="trailing"in t?t.trailing:s);var h=function(){var t=r-(nt()-i);0<t?a=setTimeout(h,t):(u&&clearTimeout(u),t=l,u=a=l=rr,t&&(c=nt(),o=n.apply(f,e),a||u||(e=f=null)))},v=function(){a&&clearTimeout(a),u=a=l=rr,(s||p!==r)&&(c=nt(),o=n.apply(f,e),a||u||(e=f=null))};return function(){if(e=arguments,i=nt(),f=this,l=s&&(a||!g),false===p)var t=g&&!a;
else{u||g||(c=i);var y=p-(i-c),m=0>=y;m?(u&&(u=clearTimeout(u)),c=i,o=n.apply(f,e)):u||(u=setTimeout(v,y))}return m&&a?a=clearTimeout(a):a||r===p||(a=setTimeout(h,r)),t&&(m=true,o=n.apply(f,e)),!m||a||u||(e=f=null),o}}function X(n,r,t){var e=typeof n;if(null==n||"function"==e)return a(n,r,t);if("object"!=e)return nr(n);var u=Ur(n);return function(r){for(var t=u.length,e=false;t--&&(e=r[u[t]]===n[u[t]]););return e}}function Y(n){return n}function Z(n){D(x(n),function(r){var t=u[r]=n[r];u.prototype[r]=function(){var n=[this.__wrapped__];
return Rr.apply(n,arguments),n=t.apply(u,n),this.__chain__?new o(n,true):n}})}function nr(n){return function(r){return r[n]}}var rr,tr=0,er={},ur=+new Date+"",or=/($^)/,ir=/['\n\r\t\u2028\u2029\\]/g,fr="[object Arguments]",ar="[object Array]",lr="[object Boolean]",cr="[object Date]",pr="[object Number]",sr="[object Object]",gr="[object RegExp]",hr="[object String]",vr={"boolean":false,"function":true,object:true,number:false,string:false,undefined:false},yr={"\\":"\\","'":"'","\n":"n","\r":"r","\t":"t","\u2028":"u2028","\u2029":"u2029"},mr=vr[typeof window]&&window||this,_r=vr[typeof exports]&&exports&&!exports.nodeType&&exports,dr=vr[typeof module]&&module&&!module.nodeType&&module,br=dr&&dr.exports===_r&&_r,wr=vr[typeof global]&&global;
!wr||wr.global!==wr&&wr.window!==wr||(mr=wr);var jr=[],xr=Object.prototype,Tr=mr._,Er=xr.toString,Ar=RegExp("^"+(Er+"").replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),Or=Math.ceil,Sr=Math.floor,Nr=xr.hasOwnProperty,Rr=jr.push,kr=xr.propertyIsEnumerable,Br=_(Br=Object.create)&&Br,Fr=_(Fr=Array.isArray)&&Fr,qr=mr.isFinite,Dr=mr.isNaN,Ir=_(Ir=Object.keys)&&Ir,Mr=Math.max,$r=Math.min,Wr=Math.random;o.prototype=u.prototype;var zr={};!function(){var n={0:1,length:1};zr.spliceObjects=(jr.splice.call(n,0,1),!n[0])
}(1),u.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,variable:""},Br||(f=function(){function n(){}return function(r){if(O(r)){n.prototype=r;var t=new n;n.prototype=null}return t||mr.Object()}}()),b(arguments)||(b=function(n){return n&&typeof n=="object"&&typeof n.length=="number"&&Nr.call(n,"callee")&&!kr.call(n,"callee")||false});var Cr=Fr||function(n){return n&&typeof n=="object"&&typeof n.length=="number"&&Er.call(n)==ar||false},Pr=function(n){var r,t=[];
if(!n||!vr[typeof n])return t;for(r in n)Nr.call(n,r)&&t.push(r);return t},Ur=Ir?function(n){return O(n)?Ir(n):[]}:Pr,Vr={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"},Gr=T(Vr),Hr=RegExp("("+Ur(Gr).join("|")+")","g"),Jr=RegExp("["+Ur(Vr).join("")+"]","g"),Kr=function(n,r){var t;if(!n||!vr[typeof n])return n;for(t in n)if(r(n[t],t,n)===er)break;return n},Lr=function(n,r){var t;if(!n||!vr[typeof n])return n;for(t in n)if(Nr.call(n,t)&&r(n[t],t,n)===er)break;return n};A(/x/)&&(A=function(n){return typeof n=="function"&&"[object Function]"==Er.call(n)
});var Qr=h(function(n,r,t){Nr.call(n,t)?n[t]++:n[t]=1}),Xr=h(function(n,r,t){(Nr.call(n,t)?n[t]:n[t]=[]).push(r)}),Yr=h(function(n,r,t){n[t]=r}),Zr=M,nt=_(nt=Date.now)&&nt||function(){return(new Date).getTime()};u.after=function(n,r){if(!A(r))throw new TypeError;return function(){return 1>--n?r.apply(this,arguments):void 0}},u.bind=L,u.bindAll=function(n){for(var r=1<arguments.length?p(arguments,true,false,1):x(n),t=-1,e=r.length;++t<e;){var u=r[t];n[u]=v(n[u],1,null,null,n)}return n},u.chain=function(n){return n=new o(n),n.__chain__=true,n
},u.compact=function(n){for(var r=-1,t=n?n.length:0,e=[];++r<t;){var u=n[r];u&&e.push(u)}return e},u.compose=function(){for(var n=arguments,r=n.length;r--;)if(!A(n[r]))throw new TypeError;return function(){for(var r=arguments,t=n.length;t--;)r=[n[t].apply(this,r)];return r[0]}},u.countBy=Qr,u.debounce=Q,u.defaults=j,u.defer=function(n){if(!A(n))throw new TypeError;var r=e(arguments,1);return setTimeout(function(){n.apply(rr,r)},1)},u.delay=function(n,r){if(!A(n))throw new TypeError;var t=e(arguments,2);
return setTimeout(function(){n.apply(rr,t)},r)},u.difference=function(n){return c(n,p(arguments,true,true,1))},u.filter=F,u.flatten=function(n,r){return p(n,r)},u.forEach=D,u.functions=x,u.groupBy=Xr,u.indexBy=Yr,u.initial=function(n,r,t){var u=0,o=n?n.length:0;if(typeof r!="number"&&null!=r){var i=o;for(r=X(r,t,3);i--&&r(n[i],i,n);)u++}else u=null==r||t?1:r||u;return e(n,0,$r(Mr(0,o-u),o))},u.intersection=function(){for(var n=[],r=-1,t=arguments.length;++r<t;){var e=arguments[r];(Cr(e)||b(e))&&n.push(e)
}var u=n[0],o=-1,i=m(),f=u?u.length:0,a=[];n:for(;++o<f;)if(e=u[o],0>i(a,e)){for(r=t;--r;)if(0>i(n[r],e))continue n;a.push(e)}return a},u.invert=T,u.invoke=function(n,r){var t=e(arguments,2),u=-1,o=typeof r=="function",i=n?n.length:0,f=Array(typeof i=="number"?i:0);return D(n,function(n){f[++u]=(o?r:n[r]).apply(n,t)}),f},u.keys=Ur,u.map=M,u.max=$,u.memoize=function(n,r){var t={};return function(){var e=r?r.apply(this,arguments):ur+arguments[0];return Nr.call(t,e)?t[e]:t[e]=n.apply(this,arguments)
}},u.min=function(n,r,t){var e=1/0,u=e;typeof r!="function"&&t&&t[r]===n&&(r=null);var o=-1,i=n?n.length:0;if(null==r&&typeof i=="number")for(;++o<i;)t=n[o],t<u&&(u=t);else r=X(r,t,3),D(n,function(n,t,o){t=r(n,t,o),t<e&&(e=t,u=n)});return u},u.omit=function(n){var r=[];Kr(n,function(n,t){r.push(t)});for(var r=c(r,p(arguments,true,false,1)),t=-1,e=r.length,u={};++t<e;){var o=r[t];u[o]=n[o]}return u},u.once=function(n){var r,t;if(!A(n))throw new TypeError;return function(){return r?t:(r=true,t=n.apply(this,arguments),n=null,t)
}},u.pairs=function(n){for(var r=-1,t=Ur(n),e=t.length,u=Array(e);++r<e;){var o=t[r];u[r]=[o,n[o]]}return u},u.partial=function(n){return v(n,16,e(arguments,1))},u.pick=function(n){for(var r=-1,t=p(arguments,true,false,1),e=t.length,u={};++r<e;){var o=t[r];o in n&&(u[o]=n[o])}return u},u.pluck=Zr,u.range=function(n,r,t){n=+n||0,t=+t||1,null==r&&(r=n,n=0);var e=-1;r=Mr(0,Or((r-n)/t));for(var u=Array(r);++e<r;)u[e]=n,n+=t;return u},u.reject=function(n,r,t){return r=X(r,t,3),F(n,function(n,t,e){return!r(n,t,e)
})},u.rest=H,u.shuffle=C,u.sortBy=function(n,t,e){var u=-1,o=n?n.length:0,i=Array(typeof o=="number"?o:0);for(t=X(t,e,3),D(n,function(n,r,e){i[++u]={m:[t(n,r,e)],n:u,o:n}}),o=i.length,i.sort(r);o--;)i[o]=i[o].o;return i},u.tap=function(n,r){return r(n),n},u.throttle=function(n,r,t){var e=true,u=true;if(!A(n))throw new TypeError;return false===t?e=false:O(t)&&(e="leading"in t?t.leading:e,u="trailing"in t?t.trailing:u),t={},t.leading=e,t.maxWait=r,t.trailing=u,Q(n,r,t)},u.times=function(n,r,t){n=-1<(n=+n)?n:0;
var e=-1,u=Array(n);for(r=a(r,t,1);++e<n;)u[e]=r(e);return u},u.toArray=function(n){return Cr(n)?e(n):n&&typeof n.length=="number"?M(n):R(n)},u.union=function(){return g(p(arguments,true,true))},u.uniq=K,u.values=R,u.where=U,u.without=function(n){return c(n,e(arguments,1))},u.wrap=function(n,r){return v(r,16,[n])},u.zip=function(){for(var n=-1,r=$(Zr(arguments,"length")),t=Array(0>r?0:r);++n<r;)t[n]=Zr(arguments,n);return t},u.collect=M,u.drop=H,u.each=D,u.extend=w,u.methods=x,u.object=function(n,r){var t=-1,e=n?n.length:0,u={};
for(r||!e||Cr(n[0])||(r=[]);++t<e;){var o=n[t];r?u[o]=r[t]:o&&(u[o[0]]=o[1])}return u},u.select=F,u.tail=H,u.unique=K,u.clone=function(n){return O(n)?Cr(n)?e(n):w({},n):n},u.contains=k,u.escape=function(n){return null==n?"":(n+"").replace(Jr,y)},u.every=B,u.find=q,u.has=function(n,r){return n?Nr.call(n,r):false},u.identity=Y,u.indexOf=G,u.isArguments=b,u.isArray=Cr,u.isBoolean=function(n){return true===n||false===n||n&&typeof n=="object"&&Er.call(n)==lr||false},u.isDate=function(n){return n&&typeof n=="object"&&Er.call(n)==cr||false
},u.isElement=function(n){return n&&1===n.nodeType||false},u.isEmpty=E,u.isEqual=function(n,r){return s(n,r)},u.isFinite=function(n){return qr(n)&&!Dr(parseFloat(n))},u.isFunction=A,u.isNaN=function(n){return S(n)&&n!=+n},u.isNull=function(n){return null===n},u.isNumber=S,u.isObject=O,u.isRegExp=function(n){return n&&vr[typeof n]&&Er.call(n)==gr||false},u.isString=N,u.isUndefined=function(n){return typeof n=="undefined"},u.lastIndexOf=function(n,r,t){var e=n?n.length:0;for(typeof t=="number"&&(e=(0>t?Mr(0,e+t):$r(t,e-1))+1);e--;)if(n[e]===r)return e;
return-1},u.mixin=Z,u.noConflict=function(){return mr._=Tr,this},u.random=function(n,r){return null==n&&null==r&&(r=1),n=+n||0,null==r?(r=n,n=0):r=+r||0,n+Sr(Wr()*(r-n+1))},u.reduce=W,u.reduceRight=z,u.result=function(n,r){if(n){var t=n[r];return A(t)?n[r]():t}},u.size=function(n){var r=n?n.length:0;return typeof r=="number"?r:Ur(n).length},u.some=P,u.sortedIndex=J,u.template=function(n,r,e){var o=u,i=o.templateSettings;n=(n||"")+"",e=j({},e,i);var f=0,a="__p+='",i=e.variable;n.replace(RegExp((e.escape||or).source+"|"+(e.interpolate||or).source+"|"+(e.evaluate||or).source+"|$","g"),function(r,e,u,o,i){return a+=n.slice(f,i).replace(ir,t),e&&(a+="'+_.escape("+e+")+'"),o&&(a+="';"+o+";\n__p+='"),u&&(a+="'+((__t=("+u+"))==null?'':__t)+'"),f=i+r.length,r
}),a+="';",i||(i="obj",a="with("+i+"||{}){"+a+"}"),a="function("+i+"){var __t,__p='',__j=Array.prototype.join;function print(){__p+=__j.call(arguments,'')}"+a+"return __p}";try{var l=Function("_","return "+a)(o)}catch(c){throw c.source=a,c}return r?l(r):(l.source=a,l)},u.unescape=function(n){return null==n?"":(n+"").replace(Hr,d)},u.uniqueId=function(n){var r=++tr+"";return n?n+r:r},u.all=B,u.any=P,u.detect=q,u.findWhere=function(n,r){return U(n,r,true)},u.foldl=W,u.foldr=z,u.include=k,u.inject=W,u.first=V,u.last=function(n,r,t){var u=0,o=n?n.length:0;
if(typeof r!="number"&&null!=r){var i=o;for(r=X(r,t,3);i--&&r(n[i],i,n);)u++}else if(u=r,null==u||t)return n?n[o-1]:rr;return e(n,Mr(0,o-u))},u.sample=function(n,r,t){return n&&typeof n.length!="number"&&(n=R(n)),null==r||t?n?n[0+Sr(Wr()*(n.length-1-0+1))]:rr:(n=C(n),n.length=$r(Mr(0,r),n.length),n)},u.take=V,u.head=V,Z(u),u.VERSION="2.4.1",u.prototype.chain=function(){return this.__chain__=true,this},u.prototype.value=function(){return this.__wrapped__},D("pop push reverse shift sort splice unshift".split(" "),function(n){var r=jr[n];
u.prototype[n]=function(){var n=this.__wrapped__;return r.apply(n,arguments),zr.spliceObjects||0!==n.length||delete n[0],this}}),D(["concat","join","slice"],function(n){var r=jr[n];u.prototype[n]=function(){var n=r.apply(this.__wrapped__,arguments);return this.__chain__&&(n=new o(n),n.__chain__=true),n}}),typeof define=="function"&&typeof define.amd=="object"&&define.amd?(mr._=u, define('underscore',[],function(){return u})):_r&&dr?br?(dr.exports=u)._=u:_r._=u:mr._=u}).call(this);
/*! jQuery v1.11.0 | (c) 2005, 2014 jQuery Foundation, Inc. | jquery.org/license */
!function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("jQuery requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(a,b){var c=[],d=c.slice,e=c.concat,f=c.push,g=c.indexOf,h={},i=h.toString,j=h.hasOwnProperty,k="".trim,l={},m="1.11.0",n=function(a,b){return new n.fn.init(a,b)},o=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,p=/^-ms-/,q=/-([\da-z])/gi,r=function(a,b){return b.toUpperCase()};n.fn=n.prototype={jquery:m,constructor:n,selector:"",length:0,toArray:function(){return d.call(this)},get:function(a){return null!=a?0>a?this[a+this.length]:this[a]:d.call(this)},pushStack:function(a){var b=n.merge(this.constructor(),a);return b.prevObject=this,b.context=this.context,b},each:function(a,b){return n.each(this,a,b)},map:function(a){return this.pushStack(n.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return this.pushStack(d.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length,c=+a+(0>a?b:0);return this.pushStack(c>=0&&b>c?[this[c]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:f,sort:c.sort,splice:c.splice},n.extend=n.fn.extend=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[h]||{},h++),"object"==typeof g||n.isFunction(g)||(g={}),h===i&&(g=this,h--);i>h;h++)if(null!=(e=arguments[h]))for(d in e)a=g[d],c=e[d],g!==c&&(j&&c&&(n.isPlainObject(c)||(b=n.isArray(c)))?(b?(b=!1,f=a&&n.isArray(a)?a:[]):f=a&&n.isPlainObject(a)?a:{},g[d]=n.extend(j,f,c)):void 0!==c&&(g[d]=c));return g},n.extend({expando:"jQuery"+(m+Math.random()).replace(/\D/g,""),isReady:!0,error:function(a){throw new Error(a)},noop:function(){},isFunction:function(a){return"function"===n.type(a)},isArray:Array.isArray||function(a){return"array"===n.type(a)},isWindow:function(a){return null!=a&&a==a.window},isNumeric:function(a){return a-parseFloat(a)>=0},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},isPlainObject:function(a){var b;if(!a||"object"!==n.type(a)||a.nodeType||n.isWindow(a))return!1;try{if(a.constructor&&!j.call(a,"constructor")&&!j.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(c){return!1}if(l.ownLast)for(b in a)return j.call(a,b);for(b in a);return void 0===b||j.call(a,b)},type:function(a){return null==a?a+"":"object"==typeof a||"function"==typeof a?h[i.call(a)]||"object":typeof a},globalEval:function(b){b&&n.trim(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return a.replace(p,"ms-").replace(q,r)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,b,c){var d,e=0,f=a.length,g=s(a);if(c){if(g){for(;f>e;e++)if(d=b.apply(a[e],c),d===!1)break}else for(e in a)if(d=b.apply(a[e],c),d===!1)break}else if(g){for(;f>e;e++)if(d=b.call(a[e],e,a[e]),d===!1)break}else for(e in a)if(d=b.call(a[e],e,a[e]),d===!1)break;return a},trim:k&&!k.call("\ufeff\xa0")?function(a){return null==a?"":k.call(a)}:function(a){return null==a?"":(a+"").replace(o,"")},makeArray:function(a,b){var c=b||[];return null!=a&&(s(Object(a))?n.merge(c,"string"==typeof a?[a]:a):f.call(c,a)),c},inArray:function(a,b,c){var d;if(b){if(g)return g.call(b,a,c);for(d=b.length,c=c?0>c?Math.max(0,d+c):c:0;d>c;c++)if(c in b&&b[c]===a)return c}return-1},merge:function(a,b){var c=+b.length,d=0,e=a.length;while(c>d)a[e++]=b[d++];if(c!==c)while(void 0!==b[d])a[e++]=b[d++];return a.length=e,a},grep:function(a,b,c){for(var d,e=[],f=0,g=a.length,h=!c;g>f;f++)d=!b(a[f],f),d!==h&&e.push(a[f]);return e},map:function(a,b,c){var d,f=0,g=a.length,h=s(a),i=[];if(h)for(;g>f;f++)d=b(a[f],f,c),null!=d&&i.push(d);else for(f in a)d=b(a[f],f,c),null!=d&&i.push(d);return e.apply([],i)},guid:1,proxy:function(a,b){var c,e,f;return"string"==typeof b&&(f=a[b],b=a,a=f),n.isFunction(a)?(c=d.call(arguments,2),e=function(){return a.apply(b||this,c.concat(d.call(arguments)))},e.guid=a.guid=a.guid||n.guid++,e):void 0},now:function(){return+new Date},support:l}),n.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(a,b){h["[object "+b+"]"]=b.toLowerCase()});function s(a){var b=a.length,c=n.type(a);return"function"===c||n.isWindow(a)?!1:1===a.nodeType&&b?!0:"array"===c||0===b||"number"==typeof b&&b>0&&b-1 in a}var t=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s="sizzle"+-new Date,t=a.document,u=0,v=0,w=eb(),x=eb(),y=eb(),z=function(a,b){return a===b&&(j=!0),0},A="undefined",B=1<<31,C={}.hasOwnProperty,D=[],E=D.pop,F=D.push,G=D.push,H=D.slice,I=D.indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(this[b]===a)return b;return-1},J="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",K="[\\x20\\t\\r\\n\\f]",L="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",M=L.replace("w","w#"),N="\\["+K+"*("+L+")"+K+"*(?:([*^$|!~]?=)"+K+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+M+")|)|)"+K+"*\\]",O=":("+L+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+N.replace(3,8)+")*)|.*)\\)|)",P=new RegExp("^"+K+"+|((?:^|[^\\\\])(?:\\\\.)*)"+K+"+$","g"),Q=new RegExp("^"+K+"*,"+K+"*"),R=new RegExp("^"+K+"*([>+~]|"+K+")"+K+"*"),S=new RegExp("="+K+"*([^\\]'\"]*?)"+K+"*\\]","g"),T=new RegExp(O),U=new RegExp("^"+M+"$"),V={ID:new RegExp("^#("+L+")"),CLASS:new RegExp("^\\.("+L+")"),TAG:new RegExp("^("+L.replace("w","w*")+")"),ATTR:new RegExp("^"+N),PSEUDO:new RegExp("^"+O),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+K+"*(even|odd|(([+-]|)(\\d*)n|)"+K+"*(?:([+-]|)"+K+"*(\\d+)|))"+K+"*\\)|)","i"),bool:new RegExp("^(?:"+J+")$","i"),needsContext:new RegExp("^"+K+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+K+"*((?:-\\d)?\\d*)"+K+"*\\)|)(?=[^-]|$)","i")},W=/^(?:input|select|textarea|button)$/i,X=/^h\d$/i,Y=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,$=/[+~]/,_=/'|\\/g,ab=new RegExp("\\\\([\\da-f]{1,6}"+K+"?|("+K+")|.)","ig"),bb=function(a,b,c){var d="0x"+b-65536;return d!==d||c?b:0>d?String.fromCharCode(d+65536):String.fromCharCode(d>>10|55296,1023&d|56320)};try{G.apply(D=H.call(t.childNodes),t.childNodes),D[t.childNodes.length].nodeType}catch(cb){G={apply:D.length?function(a,b){F.apply(a,H.call(b))}:function(a,b){var c=a.length,d=0;while(a[c++]=b[d++]);a.length=c-1}}}function db(a,b,d,e){var f,g,h,i,j,m,p,q,u,v;if((b?b.ownerDocument||b:t)!==l&&k(b),b=b||l,d=d||[],!a||"string"!=typeof a)return d;if(1!==(i=b.nodeType)&&9!==i)return[];if(n&&!e){if(f=Z.exec(a))if(h=f[1]){if(9===i){if(g=b.getElementById(h),!g||!g.parentNode)return d;if(g.id===h)return d.push(g),d}else if(b.ownerDocument&&(g=b.ownerDocument.getElementById(h))&&r(b,g)&&g.id===h)return d.push(g),d}else{if(f[2])return G.apply(d,b.getElementsByTagName(a)),d;if((h=f[3])&&c.getElementsByClassName&&b.getElementsByClassName)return G.apply(d,b.getElementsByClassName(h)),d}if(c.qsa&&(!o||!o.test(a))){if(q=p=s,u=b,v=9===i&&a,1===i&&"object"!==b.nodeName.toLowerCase()){m=ob(a),(p=b.getAttribute("id"))?q=p.replace(_,"\\$&"):b.setAttribute("id",q),q="[id='"+q+"'] ",j=m.length;while(j--)m[j]=q+pb(m[j]);u=$.test(a)&&mb(b.parentNode)||b,v=m.join(",")}if(v)try{return G.apply(d,u.querySelectorAll(v)),d}catch(w){}finally{p||b.removeAttribute("id")}}}return xb(a.replace(P,"$1"),b,d,e)}function eb(){var a=[];function b(c,e){return a.push(c+" ")>d.cacheLength&&delete b[a.shift()],b[c+" "]=e}return b}function fb(a){return a[s]=!0,a}function gb(a){var b=l.createElement("div");try{return!!a(b)}catch(c){return!1}finally{b.parentNode&&b.parentNode.removeChild(b),b=null}}function hb(a,b){var c=a.split("|"),e=a.length;while(e--)d.attrHandle[c[e]]=b}function ib(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||B)-(~a.sourceIndex||B);if(d)return d;if(c)while(c=c.nextSibling)if(c===b)return-1;return a?1:-1}function jb(a){return function(b){var c=b.nodeName.toLowerCase();return"input"===c&&b.type===a}}function kb(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}}function lb(a){return fb(function(b){return b=+b,fb(function(c,d){var e,f=a([],c.length,b),g=f.length;while(g--)c[e=f[g]]&&(c[e]=!(d[e]=c[e]))})})}function mb(a){return a&&typeof a.getElementsByTagName!==A&&a}c=db.support={},f=db.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return b?"HTML"!==b.nodeName:!1},k=db.setDocument=function(a){var b,e=a?a.ownerDocument||a:t,g=e.defaultView;return e!==l&&9===e.nodeType&&e.documentElement?(l=e,m=e.documentElement,n=!f(e),g&&g!==g.top&&(g.addEventListener?g.addEventListener("unload",function(){k()},!1):g.attachEvent&&g.attachEvent("onunload",function(){k()})),c.attributes=gb(function(a){return a.className="i",!a.getAttribute("className")}),c.getElementsByTagName=gb(function(a){return a.appendChild(e.createComment("")),!a.getElementsByTagName("*").length}),c.getElementsByClassName=Y.test(e.getElementsByClassName)&&gb(function(a){return a.innerHTML="<div class='a'></div><div class='a i'></div>",a.firstChild.className="i",2===a.getElementsByClassName("i").length}),c.getById=gb(function(a){return m.appendChild(a).id=s,!e.getElementsByName||!e.getElementsByName(s).length}),c.getById?(d.find.ID=function(a,b){if(typeof b.getElementById!==A&&n){var c=b.getElementById(a);return c&&c.parentNode?[c]:[]}},d.filter.ID=function(a){var b=a.replace(ab,bb);return function(a){return a.getAttribute("id")===b}}):(delete d.find.ID,d.filter.ID=function(a){var b=a.replace(ab,bb);return function(a){var c=typeof a.getAttributeNode!==A&&a.getAttributeNode("id");return c&&c.value===b}}),d.find.TAG=c.getElementsByTagName?function(a,b){return typeof b.getElementsByTagName!==A?b.getElementsByTagName(a):void 0}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"===a){while(c=f[e++])1===c.nodeType&&d.push(c);return d}return f},d.find.CLASS=c.getElementsByClassName&&function(a,b){return typeof b.getElementsByClassName!==A&&n?b.getElementsByClassName(a):void 0},p=[],o=[],(c.qsa=Y.test(e.querySelectorAll))&&(gb(function(a){a.innerHTML="<select t=''><option selected=''></option></select>",a.querySelectorAll("[t^='']").length&&o.push("[*^$]="+K+"*(?:''|\"\")"),a.querySelectorAll("[selected]").length||o.push("\\["+K+"*(?:value|"+J+")"),a.querySelectorAll(":checked").length||o.push(":checked")}),gb(function(a){var b=e.createElement("input");b.setAttribute("type","hidden"),a.appendChild(b).setAttribute("name","D"),a.querySelectorAll("[name=d]").length&&o.push("name"+K+"*[*^$|!~]?="),a.querySelectorAll(":enabled").length||o.push(":enabled",":disabled"),a.querySelectorAll("*,:x"),o.push(",.*:")})),(c.matchesSelector=Y.test(q=m.webkitMatchesSelector||m.mozMatchesSelector||m.oMatchesSelector||m.msMatchesSelector))&&gb(function(a){c.disconnectedMatch=q.call(a,"div"),q.call(a,"[s!='']:x"),p.push("!=",O)}),o=o.length&&new RegExp(o.join("|")),p=p.length&&new RegExp(p.join("|")),b=Y.test(m.compareDocumentPosition),r=b||Y.test(m.contains)?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))}:function(a,b){if(b)while(b=b.parentNode)if(b===a)return!0;return!1},z=b?function(a,b){if(a===b)return j=!0,0;var d=!a.compareDocumentPosition-!b.compareDocumentPosition;return d?d:(d=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&d||!c.sortDetached&&b.compareDocumentPosition(a)===d?a===e||a.ownerDocument===t&&r(t,a)?-1:b===e||b.ownerDocument===t&&r(t,b)?1:i?I.call(i,a)-I.call(i,b):0:4&d?-1:1)}:function(a,b){if(a===b)return j=!0,0;var c,d=0,f=a.parentNode,g=b.parentNode,h=[a],k=[b];if(!f||!g)return a===e?-1:b===e?1:f?-1:g?1:i?I.call(i,a)-I.call(i,b):0;if(f===g)return ib(a,b);c=a;while(c=c.parentNode)h.unshift(c);c=b;while(c=c.parentNode)k.unshift(c);while(h[d]===k[d])d++;return d?ib(h[d],k[d]):h[d]===t?-1:k[d]===t?1:0},e):l},db.matches=function(a,b){return db(a,null,null,b)},db.matchesSelector=function(a,b){if((a.ownerDocument||a)!==l&&k(a),b=b.replace(S,"='$1']"),!(!c.matchesSelector||!n||p&&p.test(b)||o&&o.test(b)))try{var d=q.call(a,b);if(d||c.disconnectedMatch||a.document&&11!==a.document.nodeType)return d}catch(e){}return db(b,l,null,[a]).length>0},db.contains=function(a,b){return(a.ownerDocument||a)!==l&&k(a),r(a,b)},db.attr=function(a,b){(a.ownerDocument||a)!==l&&k(a);var e=d.attrHandle[b.toLowerCase()],f=e&&C.call(d.attrHandle,b.toLowerCase())?e(a,b,!n):void 0;return void 0!==f?f:c.attributes||!n?a.getAttribute(b):(f=a.getAttributeNode(b))&&f.specified?f.value:null},db.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)},db.uniqueSort=function(a){var b,d=[],e=0,f=0;if(j=!c.detectDuplicates,i=!c.sortStable&&a.slice(0),a.sort(z),j){while(b=a[f++])b===a[f]&&(e=d.push(f));while(e--)a.splice(d[e],1)}return i=null,a},e=db.getText=function(a){var b,c="",d=0,f=a.nodeType;if(f){if(1===f||9===f||11===f){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=e(a)}else if(3===f||4===f)return a.nodeValue}else while(b=a[d++])c+=e(b);return c},d=db.selectors={cacheLength:50,createPseudo:fb,match:V,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(ab,bb),a[3]=(a[4]||a[5]||"").replace(ab,bb),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1].slice(0,3)?(a[3]||db.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&db.error(a[0]),a},PSEUDO:function(a){var b,c=!a[5]&&a[2];return V.CHILD.test(a[0])?null:(a[3]&&void 0!==a[4]?a[2]=a[4]:c&&T.test(c)&&(b=ob(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b)),a.slice(0,3))}},filter:{TAG:function(a){var b=a.replace(ab,bb).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=w[a+" "];return b||(b=new RegExp("(^|"+K+")"+a+"("+K+"|$)"))&&w(a,function(a){return b.test("string"==typeof a.className&&a.className||typeof a.getAttribute!==A&&a.getAttribute("class")||"")})},ATTR:function(a,b,c){return function(d){var e=db.attr(d,a);return null==e?"!="===b:b?(e+="","="===b?e===c:"!="===b?e!==c:"^="===b?c&&0===e.indexOf(c):"*="===b?c&&e.indexOf(c)>-1:"$="===b?c&&e.slice(-c.length)===c:"~="===b?(" "+e+" ").indexOf(c)>-1:"|="===b?e===c||e.slice(0,c.length+1)===c+"-":!1):!0}},CHILD:function(a,b,c,d,e){var f="nth"!==a.slice(0,3),g="last"!==a.slice(-4),h="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,i){var j,k,l,m,n,o,p=f!==g?"nextSibling":"previousSibling",q=b.parentNode,r=h&&b.nodeName.toLowerCase(),t=!i&&!h;if(q){if(f){while(p){l=b;while(l=l[p])if(h?l.nodeName.toLowerCase()===r:1===l.nodeType)return!1;o=p="only"===a&&!o&&"nextSibling"}return!0}if(o=[g?q.firstChild:q.lastChild],g&&t){k=q[s]||(q[s]={}),j=k[a]||[],n=j[0]===u&&j[1],m=j[0]===u&&j[2],l=n&&q.childNodes[n];while(l=++n&&l&&l[p]||(m=n=0)||o.pop())if(1===l.nodeType&&++m&&l===b){k[a]=[u,n,m];break}}else if(t&&(j=(b[s]||(b[s]={}))[a])&&j[0]===u)m=j[1];else while(l=++n&&l&&l[p]||(m=n=0)||o.pop())if((h?l.nodeName.toLowerCase()===r:1===l.nodeType)&&++m&&(t&&((l[s]||(l[s]={}))[a]=[u,m]),l===b))break;return m-=e,m===d||m%d===0&&m/d>=0}}},PSEUDO:function(a,b){var c,e=d.pseudos[a]||d.setFilters[a.toLowerCase()]||db.error("unsupported pseudo: "+a);return e[s]?e(b):e.length>1?(c=[a,a,"",b],d.setFilters.hasOwnProperty(a.toLowerCase())?fb(function(a,c){var d,f=e(a,b),g=f.length;while(g--)d=I.call(a,f[g]),a[d]=!(c[d]=f[g])}):function(a){return e(a,0,c)}):e}},pseudos:{not:fb(function(a){var b=[],c=[],d=g(a.replace(P,"$1"));return d[s]?fb(function(a,b,c,e){var f,g=d(a,null,e,[]),h=a.length;while(h--)(f=g[h])&&(a[h]=!(b[h]=f))}):function(a,e,f){return b[0]=a,d(b,null,f,c),!c.pop()}}),has:fb(function(a){return function(b){return db(a,b).length>0}}),contains:fb(function(a){return function(b){return(b.textContent||b.innerText||e(b)).indexOf(a)>-1}}),lang:fb(function(a){return U.test(a||"")||db.error("unsupported lang: "+a),a=a.replace(ab,bb).toLowerCase(),function(b){var c;do if(c=n?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return c=c.toLowerCase(),c===a||0===c.indexOf(a+"-");while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===m},focus:function(a){return a===l.activeElement&&(!l.hasFocus||l.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},enabled:function(a){return a.disabled===!1},disabled:function(a){return a.disabled===!0},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeType<6)return!1;return!0},parent:function(a){return!d.pseudos.empty(a)},header:function(a){return X.test(a.nodeName)},input:function(a){return W.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||"text"===b.toLowerCase())},first:lb(function(){return[0]}),last:lb(function(a,b){return[b-1]}),eq:lb(function(a,b,c){return[0>c?c+b:c]}),even:lb(function(a,b){for(var c=0;b>c;c+=2)a.push(c);return a}),odd:lb(function(a,b){for(var c=1;b>c;c+=2)a.push(c);return a}),lt:lb(function(a,b,c){for(var d=0>c?c+b:c;--d>=0;)a.push(d);return a}),gt:lb(function(a,b,c){for(var d=0>c?c+b:c;++d<b;)a.push(d);return a})}},d.pseudos.nth=d.pseudos.eq;for(b in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})d.pseudos[b]=jb(b);for(b in{submit:!0,reset:!0})d.pseudos[b]=kb(b);function nb(){}nb.prototype=d.filters=d.pseudos,d.setFilters=new nb;function ob(a,b){var c,e,f,g,h,i,j,k=x[a+" "];if(k)return b?0:k.slice(0);h=a,i=[],j=d.preFilter;while(h){(!c||(e=Q.exec(h)))&&(e&&(h=h.slice(e[0].length)||h),i.push(f=[])),c=!1,(e=R.exec(h))&&(c=e.shift(),f.push({value:c,type:e[0].replace(P," ")}),h=h.slice(c.length));for(g in d.filter)!(e=V[g].exec(h))||j[g]&&!(e=j[g](e))||(c=e.shift(),f.push({value:c,type:g,matches:e}),h=h.slice(c.length));if(!c)break}return b?h.length:h?db.error(a):x(a,i).slice(0)}function pb(a){for(var b=0,c=a.length,d="";c>b;b++)d+=a[b].value;return d}function qb(a,b,c){var d=b.dir,e=c&&"parentNode"===d,f=v++;return b.first?function(b,c,f){while(b=b[d])if(1===b.nodeType||e)return a(b,c,f)}:function(b,c,g){var h,i,j=[u,f];if(g){while(b=b[d])if((1===b.nodeType||e)&&a(b,c,g))return!0}else while(b=b[d])if(1===b.nodeType||e){if(i=b[s]||(b[s]={}),(h=i[d])&&h[0]===u&&h[1]===f)return j[2]=h[2];if(i[d]=j,j[2]=a(b,c,g))return!0}}}function rb(a){return a.length>1?function(b,c,d){var e=a.length;while(e--)if(!a[e](b,c,d))return!1;return!0}:a[0]}function sb(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;i>h;h++)(f=a[h])&&(!c||c(f,d,e))&&(g.push(f),j&&b.push(h));return g}function tb(a,b,c,d,e,f){return d&&!d[s]&&(d=tb(d)),e&&!e[s]&&(e=tb(e,f)),fb(function(f,g,h,i){var j,k,l,m=[],n=[],o=g.length,p=f||wb(b||"*",h.nodeType?[h]:h,[]),q=!a||!f&&b?p:sb(p,m,a,h,i),r=c?e||(f?a:o||d)?[]:g:q;if(c&&c(q,r,h,i),d){j=sb(r,n),d(j,[],h,i),k=j.length;while(k--)(l=j[k])&&(r[n[k]]=!(q[n[k]]=l))}if(f){if(e||a){if(e){j=[],k=r.length;while(k--)(l=r[k])&&j.push(q[k]=l);e(null,r=[],j,i)}k=r.length;while(k--)(l=r[k])&&(j=e?I.call(f,l):m[k])>-1&&(f[j]=!(g[j]=l))}}else r=sb(r===g?r.splice(o,r.length):r),e?e(null,g,r,i):G.apply(g,r)})}function ub(a){for(var b,c,e,f=a.length,g=d.relative[a[0].type],i=g||d.relative[" "],j=g?1:0,k=qb(function(a){return a===b},i,!0),l=qb(function(a){return I.call(b,a)>-1},i,!0),m=[function(a,c,d){return!g&&(d||c!==h)||((b=c).nodeType?k(a,c,d):l(a,c,d))}];f>j;j++)if(c=d.relative[a[j].type])m=[qb(rb(m),c)];else{if(c=d.filter[a[j].type].apply(null,a[j].matches),c[s]){for(e=++j;f>e;e++)if(d.relative[a[e].type])break;return tb(j>1&&rb(m),j>1&&pb(a.slice(0,j-1).concat({value:" "===a[j-2].type?"*":""})).replace(P,"$1"),c,e>j&&ub(a.slice(j,e)),f>e&&ub(a=a.slice(e)),f>e&&pb(a))}m.push(c)}return rb(m)}function vb(a,b){var c=b.length>0,e=a.length>0,f=function(f,g,i,j,k){var m,n,o,p=0,q="0",r=f&&[],s=[],t=h,v=f||e&&d.find.TAG("*",k),w=u+=null==t?1:Math.random()||.1,x=v.length;for(k&&(h=g!==l&&g);q!==x&&null!=(m=v[q]);q++){if(e&&m){n=0;while(o=a[n++])if(o(m,g,i)){j.push(m);break}k&&(u=w)}c&&((m=!o&&m)&&p--,f&&r.push(m))}if(p+=q,c&&q!==p){n=0;while(o=b[n++])o(r,s,g,i);if(f){if(p>0)while(q--)r[q]||s[q]||(s[q]=E.call(j));s=sb(s)}G.apply(j,s),k&&!f&&s.length>0&&p+b.length>1&&db.uniqueSort(j)}return k&&(u=w,h=t),r};return c?fb(f):f}g=db.compile=function(a,b){var c,d=[],e=[],f=y[a+" "];if(!f){b||(b=ob(a)),c=b.length;while(c--)f=ub(b[c]),f[s]?d.push(f):e.push(f);f=y(a,vb(e,d))}return f};function wb(a,b,c){for(var d=0,e=b.length;e>d;d++)db(a,b[d],c);return c}function xb(a,b,e,f){var h,i,j,k,l,m=ob(a);if(!f&&1===m.length){if(i=m[0]=m[0].slice(0),i.length>2&&"ID"===(j=i[0]).type&&c.getById&&9===b.nodeType&&n&&d.relative[i[1].type]){if(b=(d.find.ID(j.matches[0].replace(ab,bb),b)||[])[0],!b)return e;a=a.slice(i.shift().value.length)}h=V.needsContext.test(a)?0:i.length;while(h--){if(j=i[h],d.relative[k=j.type])break;if((l=d.find[k])&&(f=l(j.matches[0].replace(ab,bb),$.test(i[0].type)&&mb(b.parentNode)||b))){if(i.splice(h,1),a=f.length&&pb(i),!a)return G.apply(e,f),e;break}}}return g(a,m)(f,b,!n,e,$.test(a)&&mb(b.parentNode)||b),e}return c.sortStable=s.split("").sort(z).join("")===s,c.detectDuplicates=!!j,k(),c.sortDetached=gb(function(a){return 1&a.compareDocumentPosition(l.createElement("div"))}),gb(function(a){return a.innerHTML="<a href='#'></a>","#"===a.firstChild.getAttribute("href")})||hb("type|href|height|width",function(a,b,c){return c?void 0:a.getAttribute(b,"type"===b.toLowerCase()?1:2)}),c.attributes&&gb(function(a){return a.innerHTML="<input/>",a.firstChild.setAttribute("value",""),""===a.firstChild.getAttribute("value")})||hb("value",function(a,b,c){return c||"input"!==a.nodeName.toLowerCase()?void 0:a.defaultValue}),gb(function(a){return null==a.getAttribute("disabled")})||hb(J,function(a,b,c){var d;return c?void 0:a[b]===!0?b.toLowerCase():(d=a.getAttributeNode(b))&&d.specified?d.value:null}),db}(a);n.find=t,n.expr=t.selectors,n.expr[":"]=n.expr.pseudos,n.unique=t.uniqueSort,n.text=t.getText,n.isXMLDoc=t.isXML,n.contains=t.contains;var u=n.expr.match.needsContext,v=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,w=/^.[^:#\[\.,]*$/;function x(a,b,c){if(n.isFunction(b))return n.grep(a,function(a,d){return!!b.call(a,d,a)!==c});if(b.nodeType)return n.grep(a,function(a){return a===b!==c});if("string"==typeof b){if(w.test(b))return n.filter(b,a,c);b=n.filter(b,a)}return n.grep(a,function(a){return n.inArray(a,b)>=0!==c})}n.filter=function(a,b,c){var d=b[0];return c&&(a=":not("+a+")"),1===b.length&&1===d.nodeType?n.find.matchesSelector(d,a)?[d]:[]:n.find.matches(a,n.grep(b,function(a){return 1===a.nodeType}))},n.fn.extend({find:function(a){var b,c=[],d=this,e=d.length;if("string"!=typeof a)return this.pushStack(n(a).filter(function(){for(b=0;e>b;b++)if(n.contains(d[b],this))return!0}));for(b=0;e>b;b++)n.find(a,d[b],c);return c=this.pushStack(e>1?n.unique(c):c),c.selector=this.selector?this.selector+" "+a:a,c},filter:function(a){return this.pushStack(x(this,a||[],!1))},not:function(a){return this.pushStack(x(this,a||[],!0))},is:function(a){return!!x(this,"string"==typeof a&&u.test(a)?n(a):a||[],!1).length}});var y,z=a.document,A=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,B=n.fn.init=function(a,b){var c,d;if(!a)return this;if("string"==typeof a){if(c="<"===a.charAt(0)&&">"===a.charAt(a.length-1)&&a.length>=3?[null,a,null]:A.exec(a),!c||!c[1]&&b)return!b||b.jquery?(b||y).find(a):this.constructor(b).find(a);if(c[1]){if(b=b instanceof n?b[0]:b,n.merge(this,n.parseHTML(c[1],b&&b.nodeType?b.ownerDocument||b:z,!0)),v.test(c[1])&&n.isPlainObject(b))for(c in b)n.isFunction(this[c])?this[c](b[c]):this.attr(c,b[c]);return this}if(d=z.getElementById(c[2]),d&&d.parentNode){if(d.id!==c[2])return y.find(a);this.length=1,this[0]=d}return this.context=z,this.selector=a,this}return a.nodeType?(this.context=this[0]=a,this.length=1,this):n.isFunction(a)?"undefined"!=typeof y.ready?y.ready(a):a(n):(void 0!==a.selector&&(this.selector=a.selector,this.context=a.context),n.makeArray(a,this))};B.prototype=n.fn,y=n(z);var C=/^(?:parents|prev(?:Until|All))/,D={children:!0,contents:!0,next:!0,prev:!0};n.extend({dir:function(a,b,c){var d=[],e=a[b];while(e&&9!==e.nodeType&&(void 0===c||1!==e.nodeType||!n(e).is(c)))1===e.nodeType&&d.push(e),e=e[b];return d},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}}),n.fn.extend({has:function(a){var b,c=n(a,this),d=c.length;return this.filter(function(){for(b=0;d>b;b++)if(n.contains(this,c[b]))return!0})},closest:function(a,b){for(var c,d=0,e=this.length,f=[],g=u.test(a)||"string"!=typeof a?n(a,b||this.context):0;e>d;d++)for(c=this[d];c&&c!==b;c=c.parentNode)if(c.nodeType<11&&(g?g.index(c)>-1:1===c.nodeType&&n.find.matchesSelector(c,a))){f.push(c);break}return this.pushStack(f.length>1?n.unique(f):f)},index:function(a){return a?"string"==typeof a?n.inArray(this[0],n(a)):n.inArray(a.jquery?a[0]:a,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){return this.pushStack(n.unique(n.merge(this.get(),n(a,b))))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}});function E(a,b){do a=a[b];while(a&&1!==a.nodeType);return a}n.each({parent:function(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null},parents:function(a){return n.dir(a,"parentNode")},parentsUntil:function(a,b,c){return n.dir(a,"parentNode",c)},next:function(a){return E(a,"nextSibling")},prev:function(a){return E(a,"previousSibling")},nextAll:function(a){return n.dir(a,"nextSibling")},prevAll:function(a){return n.dir(a,"previousSibling")},nextUntil:function(a,b,c){return n.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return n.dir(a,"previousSibling",c)},siblings:function(a){return n.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return n.sibling(a.firstChild)},contents:function(a){return n.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:n.merge([],a.childNodes)}},function(a,b){n.fn[a]=function(c,d){var e=n.map(this,b,c);return"Until"!==a.slice(-5)&&(d=c),d&&"string"==typeof d&&(e=n.filter(d,e)),this.length>1&&(D[a]||(e=n.unique(e)),C.test(a)&&(e=e.reverse())),this.pushStack(e)}});var F=/\S+/g,G={};function H(a){var b=G[a]={};return n.each(a.match(F)||[],function(a,c){b[c]=!0}),b}n.Callbacks=function(a){a="string"==typeof a?G[a]||H(a):n.extend({},a);var b,c,d,e,f,g,h=[],i=!a.once&&[],j=function(l){for(c=a.memory&&l,d=!0,f=g||0,g=0,e=h.length,b=!0;h&&e>f;f++)if(h[f].apply(l[0],l[1])===!1&&a.stopOnFalse){c=!1;break}b=!1,h&&(i?i.length&&j(i.shift()):c?h=[]:k.disable())},k={add:function(){if(h){var d=h.length;!function f(b){n.each(b,function(b,c){var d=n.type(c);"function"===d?a.unique&&k.has(c)||h.push(c):c&&c.length&&"string"!==d&&f(c)})}(arguments),b?e=h.length:c&&(g=d,j(c))}return this},remove:function(){return h&&n.each(arguments,function(a,c){var d;while((d=n.inArray(c,h,d))>-1)h.splice(d,1),b&&(e>=d&&e--,f>=d&&f--)}),this},has:function(a){return a?n.inArray(a,h)>-1:!(!h||!h.length)},empty:function(){return h=[],e=0,this},disable:function(){return h=i=c=void 0,this},disabled:function(){return!h},lock:function(){return i=void 0,c||k.disable(),this},locked:function(){return!i},fireWith:function(a,c){return!h||d&&!i||(c=c||[],c=[a,c.slice?c.slice():c],b?i.push(c):j(c)),this},fire:function(){return k.fireWith(this,arguments),this},fired:function(){return!!d}};return k},n.extend({Deferred:function(a){var b=[["resolve","done",n.Callbacks("once memory"),"resolved"],["reject","fail",n.Callbacks("once memory"),"rejected"],["notify","progress",n.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return n.Deferred(function(c){n.each(b,function(b,f){var g=n.isFunction(a[b])&&a[b];e[f[1]](function(){var a=g&&g.apply(this,arguments);a&&n.isFunction(a.promise)?a.promise().done(c.resolve).fail(c.reject).progress(c.notify):c[f[0]+"With"](this===d?c.promise():this,g?[a]:arguments)})}),a=null}).promise()},promise:function(a){return null!=a?n.extend(a,d):d}},e={};return d.pipe=d.then,n.each(b,function(a,f){var g=f[2],h=f[3];d[f[1]]=g.add,h&&g.add(function(){c=h},b[1^a][2].disable,b[2][2].lock),e[f[0]]=function(){return e[f[0]+"With"](this===e?d:this,arguments),this},e[f[0]+"With"]=g.fireWith}),d.promise(e),a&&a.call(e,e),e},when:function(a){var b=0,c=d.call(arguments),e=c.length,f=1!==e||a&&n.isFunction(a.promise)?e:0,g=1===f?a:n.Deferred(),h=function(a,b,c){return function(e){b[a]=this,c[a]=arguments.length>1?d.call(arguments):e,c===i?g.notifyWith(b,c):--f||g.resolveWith(b,c)}},i,j,k;if(e>1)for(i=new Array(e),j=new Array(e),k=new Array(e);e>b;b++)c[b]&&n.isFunction(c[b].promise)?c[b].promise().done(h(b,k,c)).fail(g.reject).progress(h(b,j,i)):--f;return f||g.resolveWith(k,c),g.promise()}});var I;n.fn.ready=function(a){return n.ready.promise().done(a),this},n.extend({isReady:!1,readyWait:1,holdReady:function(a){a?n.readyWait++:n.ready(!0)},ready:function(a){if(a===!0?!--n.readyWait:!n.isReady){if(!z.body)return setTimeout(n.ready);n.isReady=!0,a!==!0&&--n.readyWait>0||(I.resolveWith(z,[n]),n.fn.trigger&&n(z).trigger("ready").off("ready"))}}});function J(){z.addEventListener?(z.removeEventListener("DOMContentLoaded",K,!1),a.removeEventListener("load",K,!1)):(z.detachEvent("onreadystatechange",K),a.detachEvent("onload",K))}function K(){(z.addEventListener||"load"===event.type||"complete"===z.readyState)&&(J(),n.ready())}n.ready.promise=function(b){if(!I)if(I=n.Deferred(),"complete"===z.readyState)setTimeout(n.ready);else if(z.addEventListener)z.addEventListener("DOMContentLoaded",K,!1),a.addEventListener("load",K,!1);else{z.attachEvent("onreadystatechange",K),a.attachEvent("onload",K);var c=!1;try{c=null==a.frameElement&&z.documentElement}catch(d){}c&&c.doScroll&&!function e(){if(!n.isReady){try{c.doScroll("left")}catch(a){return setTimeout(e,50)}J(),n.ready()}}()}return I.promise(b)};var L="undefined",M;for(M in n(l))break;l.ownLast="0"!==M,l.inlineBlockNeedsLayout=!1,n(function(){var a,b,c=z.getElementsByTagName("body")[0];c&&(a=z.createElement("div"),a.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",b=z.createElement("div"),c.appendChild(a).appendChild(b),typeof b.style.zoom!==L&&(b.style.cssText="border:0;margin:0;width:1px;padding:1px;display:inline;zoom:1",(l.inlineBlockNeedsLayout=3===b.offsetWidth)&&(c.style.zoom=1)),c.removeChild(a),a=b=null)}),function(){var a=z.createElement("div");if(null==l.deleteExpando){l.deleteExpando=!0;try{delete a.test}catch(b){l.deleteExpando=!1}}a=null}(),n.acceptData=function(a){var b=n.noData[(a.nodeName+" ").toLowerCase()],c=+a.nodeType||1;return 1!==c&&9!==c?!1:!b||b!==!0&&a.getAttribute("classid")===b};var N=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,O=/([A-Z])/g;function P(a,b,c){if(void 0===c&&1===a.nodeType){var d="data-"+b.replace(O,"-$1").toLowerCase();if(c=a.getAttribute(d),"string"==typeof c){try{c="true"===c?!0:"false"===c?!1:"null"===c?null:+c+""===c?+c:N.test(c)?n.parseJSON(c):c}catch(e){}n.data(a,b,c)}else c=void 0}return c}function Q(a){var b;for(b in a)if(("data"!==b||!n.isEmptyObject(a[b]))&&"toJSON"!==b)return!1;return!0}function R(a,b,d,e){if(n.acceptData(a)){var f,g,h=n.expando,i=a.nodeType,j=i?n.cache:a,k=i?a[h]:a[h]&&h;if(k&&j[k]&&(e||j[k].data)||void 0!==d||"string"!=typeof b)return k||(k=i?a[h]=c.pop()||n.guid++:h),j[k]||(j[k]=i?{}:{toJSON:n.noop}),("object"==typeof b||"function"==typeof b)&&(e?j[k]=n.extend(j[k],b):j[k].data=n.extend(j[k].data,b)),g=j[k],e||(g.data||(g.data={}),g=g.data),void 0!==d&&(g[n.camelCase(b)]=d),"string"==typeof b?(f=g[b],null==f&&(f=g[n.camelCase(b)])):f=g,f
}}function S(a,b,c){if(n.acceptData(a)){var d,e,f=a.nodeType,g=f?n.cache:a,h=f?a[n.expando]:n.expando;if(g[h]){if(b&&(d=c?g[h]:g[h].data)){n.isArray(b)?b=b.concat(n.map(b,n.camelCase)):b in d?b=[b]:(b=n.camelCase(b),b=b in d?[b]:b.split(" ")),e=b.length;while(e--)delete d[b[e]];if(c?!Q(d):!n.isEmptyObject(d))return}(c||(delete g[h].data,Q(g[h])))&&(f?n.cleanData([a],!0):l.deleteExpando||g!=g.window?delete g[h]:g[h]=null)}}}n.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(a){return a=a.nodeType?n.cache[a[n.expando]]:a[n.expando],!!a&&!Q(a)},data:function(a,b,c){return R(a,b,c)},removeData:function(a,b){return S(a,b)},_data:function(a,b,c){return R(a,b,c,!0)},_removeData:function(a,b){return S(a,b,!0)}}),n.fn.extend({data:function(a,b){var c,d,e,f=this[0],g=f&&f.attributes;if(void 0===a){if(this.length&&(e=n.data(f),1===f.nodeType&&!n._data(f,"parsedAttrs"))){c=g.length;while(c--)d=g[c].name,0===d.indexOf("data-")&&(d=n.camelCase(d.slice(5)),P(f,d,e[d]));n._data(f,"parsedAttrs",!0)}return e}return"object"==typeof a?this.each(function(){n.data(this,a)}):arguments.length>1?this.each(function(){n.data(this,a,b)}):f?P(f,a,n.data(f,a)):void 0},removeData:function(a){return this.each(function(){n.removeData(this,a)})}}),n.extend({queue:function(a,b,c){var d;return a?(b=(b||"fx")+"queue",d=n._data(a,b),c&&(!d||n.isArray(c)?d=n._data(a,b,n.makeArray(c)):d.push(c)),d||[]):void 0},dequeue:function(a,b){b=b||"fx";var c=n.queue(a,b),d=c.length,e=c.shift(),f=n._queueHooks(a,b),g=function(){n.dequeue(a,b)};"inprogress"===e&&(e=c.shift(),d--),e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return n._data(a,c)||n._data(a,c,{empty:n.Callbacks("once memory").add(function(){n._removeData(a,b+"queue"),n._removeData(a,c)})})}}),n.fn.extend({queue:function(a,b){var c=2;return"string"!=typeof a&&(b=a,a="fx",c--),arguments.length<c?n.queue(this[0],a):void 0===b?this:this.each(function(){var c=n.queue(this,a,b);n._queueHooks(this,a),"fx"===a&&"inprogress"!==c[0]&&n.dequeue(this,a)})},dequeue:function(a){return this.each(function(){n.dequeue(this,a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,b){var c,d=1,e=n.Deferred(),f=this,g=this.length,h=function(){--d||e.resolveWith(f,[f])};"string"!=typeof a&&(b=a,a=void 0),a=a||"fx";while(g--)c=n._data(f[g],a+"queueHooks"),c&&c.empty&&(d++,c.empty.add(h));return h(),e.promise(b)}});var T=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,U=["Top","Right","Bottom","Left"],V=function(a,b){return a=b||a,"none"===n.css(a,"display")||!n.contains(a.ownerDocument,a)},W=n.access=function(a,b,c,d,e,f,g){var h=0,i=a.length,j=null==c;if("object"===n.type(c)){e=!0;for(h in c)n.access(a,b,h,c[h],!0,f,g)}else if(void 0!==d&&(e=!0,n.isFunction(d)||(g=!0),j&&(g?(b.call(a,d),b=null):(j=b,b=function(a,b,c){return j.call(n(a),c)})),b))for(;i>h;h++)b(a[h],c,g?d:d.call(a[h],h,b(a[h],c)));return e?a:j?b.call(a):i?b(a[0],c):f},X=/^(?:checkbox|radio)$/i;!function(){var a=z.createDocumentFragment(),b=z.createElement("div"),c=z.createElement("input");if(b.setAttribute("className","t"),b.innerHTML="  <link/><table></table><a href='/a'>a</a>",l.leadingWhitespace=3===b.firstChild.nodeType,l.tbody=!b.getElementsByTagName("tbody").length,l.htmlSerialize=!!b.getElementsByTagName("link").length,l.html5Clone="<:nav></:nav>"!==z.createElement("nav").cloneNode(!0).outerHTML,c.type="checkbox",c.checked=!0,a.appendChild(c),l.appendChecked=c.checked,b.innerHTML="<textarea>x</textarea>",l.noCloneChecked=!!b.cloneNode(!0).lastChild.defaultValue,a.appendChild(b),b.innerHTML="<input type='radio' checked='checked' name='t'/>",l.checkClone=b.cloneNode(!0).cloneNode(!0).lastChild.checked,l.noCloneEvent=!0,b.attachEvent&&(b.attachEvent("onclick",function(){l.noCloneEvent=!1}),b.cloneNode(!0).click()),null==l.deleteExpando){l.deleteExpando=!0;try{delete b.test}catch(d){l.deleteExpando=!1}}a=b=c=null}(),function(){var b,c,d=z.createElement("div");for(b in{submit:!0,change:!0,focusin:!0})c="on"+b,(l[b+"Bubbles"]=c in a)||(d.setAttribute(c,"t"),l[b+"Bubbles"]=d.attributes[c].expando===!1);d=null}();var Y=/^(?:input|select|textarea)$/i,Z=/^key/,$=/^(?:mouse|contextmenu)|click/,_=/^(?:focusinfocus|focusoutblur)$/,ab=/^([^.]*)(?:\.(.+)|)$/;function bb(){return!0}function cb(){return!1}function db(){try{return z.activeElement}catch(a){}}n.event={global:{},add:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,o,p,q,r=n._data(a);if(r){c.handler&&(i=c,c=i.handler,e=i.selector),c.guid||(c.guid=n.guid++),(g=r.events)||(g=r.events={}),(k=r.handle)||(k=r.handle=function(a){return typeof n===L||a&&n.event.triggered===a.type?void 0:n.event.dispatch.apply(k.elem,arguments)},k.elem=a),b=(b||"").match(F)||[""],h=b.length;while(h--)f=ab.exec(b[h])||[],o=q=f[1],p=(f[2]||"").split(".").sort(),o&&(j=n.event.special[o]||{},o=(e?j.delegateType:j.bindType)||o,j=n.event.special[o]||{},l=n.extend({type:o,origType:q,data:d,handler:c,guid:c.guid,selector:e,needsContext:e&&n.expr.match.needsContext.test(e),namespace:p.join(".")},i),(m=g[o])||(m=g[o]=[],m.delegateCount=0,j.setup&&j.setup.call(a,d,p,k)!==!1||(a.addEventListener?a.addEventListener(o,k,!1):a.attachEvent&&a.attachEvent("on"+o,k))),j.add&&(j.add.call(a,l),l.handler.guid||(l.handler.guid=c.guid)),e?m.splice(m.delegateCount++,0,l):m.push(l),n.event.global[o]=!0);a=null}},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,o,p,q,r=n.hasData(a)&&n._data(a);if(r&&(k=r.events)){b=(b||"").match(F)||[""],j=b.length;while(j--)if(h=ab.exec(b[j])||[],o=q=h[1],p=(h[2]||"").split(".").sort(),o){l=n.event.special[o]||{},o=(d?l.delegateType:l.bindType)||o,m=k[o]||[],h=h[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),i=f=m.length;while(f--)g=m[f],!e&&q!==g.origType||c&&c.guid!==g.guid||h&&!h.test(g.namespace)||d&&d!==g.selector&&("**"!==d||!g.selector)||(m.splice(f,1),g.selector&&m.delegateCount--,l.remove&&l.remove.call(a,g));i&&!m.length&&(l.teardown&&l.teardown.call(a,p,r.handle)!==!1||n.removeEvent(a,o,r.handle),delete k[o])}else for(o in k)n.event.remove(a,o+b[j],c,d,!0);n.isEmptyObject(k)&&(delete r.handle,n._removeData(a,"events"))}},trigger:function(b,c,d,e){var f,g,h,i,k,l,m,o=[d||z],p=j.call(b,"type")?b.type:b,q=j.call(b,"namespace")?b.namespace.split("."):[];if(h=l=d=d||z,3!==d.nodeType&&8!==d.nodeType&&!_.test(p+n.event.triggered)&&(p.indexOf(".")>=0&&(q=p.split("."),p=q.shift(),q.sort()),g=p.indexOf(":")<0&&"on"+p,b=b[n.expando]?b:new n.Event(p,"object"==typeof b&&b),b.isTrigger=e?2:3,b.namespace=q.join("."),b.namespace_re=b.namespace?new RegExp("(^|\\.)"+q.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,b.result=void 0,b.target||(b.target=d),c=null==c?[b]:n.makeArray(c,[b]),k=n.event.special[p]||{},e||!k.trigger||k.trigger.apply(d,c)!==!1)){if(!e&&!k.noBubble&&!n.isWindow(d)){for(i=k.delegateType||p,_.test(i+p)||(h=h.parentNode);h;h=h.parentNode)o.push(h),l=h;l===(d.ownerDocument||z)&&o.push(l.defaultView||l.parentWindow||a)}m=0;while((h=o[m++])&&!b.isPropagationStopped())b.type=m>1?i:k.bindType||p,f=(n._data(h,"events")||{})[b.type]&&n._data(h,"handle"),f&&f.apply(h,c),f=g&&h[g],f&&f.apply&&n.acceptData(h)&&(b.result=f.apply(h,c),b.result===!1&&b.preventDefault());if(b.type=p,!e&&!b.isDefaultPrevented()&&(!k._default||k._default.apply(o.pop(),c)===!1)&&n.acceptData(d)&&g&&d[p]&&!n.isWindow(d)){l=d[g],l&&(d[g]=null),n.event.triggered=p;try{d[p]()}catch(r){}n.event.triggered=void 0,l&&(d[g]=l)}return b.result}},dispatch:function(a){a=n.event.fix(a);var b,c,e,f,g,h=[],i=d.call(arguments),j=(n._data(this,"events")||{})[a.type]||[],k=n.event.special[a.type]||{};if(i[0]=a,a.delegateTarget=this,!k.preDispatch||k.preDispatch.call(this,a)!==!1){h=n.event.handlers.call(this,a,j),b=0;while((f=h[b++])&&!a.isPropagationStopped()){a.currentTarget=f.elem,g=0;while((e=f.handlers[g++])&&!a.isImmediatePropagationStopped())(!a.namespace_re||a.namespace_re.test(e.namespace))&&(a.handleObj=e,a.data=e.data,c=((n.event.special[e.origType]||{}).handle||e.handler).apply(f.elem,i),void 0!==c&&(a.result=c)===!1&&(a.preventDefault(),a.stopPropagation()))}return k.postDispatch&&k.postDispatch.call(this,a),a.result}},handlers:function(a,b){var c,d,e,f,g=[],h=b.delegateCount,i=a.target;if(h&&i.nodeType&&(!a.button||"click"!==a.type))for(;i!=this;i=i.parentNode||this)if(1===i.nodeType&&(i.disabled!==!0||"click"!==a.type)){for(e=[],f=0;h>f;f++)d=b[f],c=d.selector+" ",void 0===e[c]&&(e[c]=d.needsContext?n(c,this).index(i)>=0:n.find(c,this,null,[i]).length),e[c]&&e.push(d);e.length&&g.push({elem:i,handlers:e})}return h<b.length&&g.push({elem:this,handlers:b.slice(h)}),g},fix:function(a){if(a[n.expando])return a;var b,c,d,e=a.type,f=a,g=this.fixHooks[e];g||(this.fixHooks[e]=g=$.test(e)?this.mouseHooks:Z.test(e)?this.keyHooks:{}),d=g.props?this.props.concat(g.props):this.props,a=new n.Event(f),b=d.length;while(b--)c=d[b],a[c]=f[c];return a.target||(a.target=f.srcElement||z),3===a.target.nodeType&&(a.target=a.target.parentNode),a.metaKey=!!a.metaKey,g.filter?g.filter(a,f):a},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){return null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode),a}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,b){var c,d,e,f=b.button,g=b.fromElement;return null==a.pageX&&null!=b.clientX&&(d=a.target.ownerDocument||z,e=d.documentElement,c=d.body,a.pageX=b.clientX+(e&&e.scrollLeft||c&&c.scrollLeft||0)-(e&&e.clientLeft||c&&c.clientLeft||0),a.pageY=b.clientY+(e&&e.scrollTop||c&&c.scrollTop||0)-(e&&e.clientTop||c&&c.clientTop||0)),!a.relatedTarget&&g&&(a.relatedTarget=g===a.target?b.toElement:g),a.which||void 0===f||(a.which=1&f?1:2&f?3:4&f?2:0),a}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==db()&&this.focus)try{return this.focus(),!1}catch(a){}},delegateType:"focusin"},blur:{trigger:function(){return this===db()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return n.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0},_default:function(a){return n.nodeName(a.target,"a")}},beforeunload:{postDispatch:function(a){void 0!==a.result&&(a.originalEvent.returnValue=a.result)}}},simulate:function(a,b,c,d){var e=n.extend(new n.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?n.event.trigger(e,null,b):n.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},n.removeEvent=z.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){var d="on"+b;a.detachEvent&&(typeof a[d]===L&&(a[d]=null),a.detachEvent(d,c))},n.Event=function(a,b){return this instanceof n.Event?(a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&(a.returnValue===!1||a.getPreventDefault&&a.getPreventDefault())?bb:cb):this.type=a,b&&n.extend(this,b),this.timeStamp=a&&a.timeStamp||n.now(),void(this[n.expando]=!0)):new n.Event(a,b)},n.Event.prototype={isDefaultPrevented:cb,isPropagationStopped:cb,isImmediatePropagationStopped:cb,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=bb,a&&(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=bb,a&&(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=bb,this.stopPropagation()}},n.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){n.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=this,e=a.relatedTarget,f=a.handleObj;return(!e||e!==d&&!n.contains(d,e))&&(a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b),c}}}),l.submitBubbles||(n.event.special.submit={setup:function(){return n.nodeName(this,"form")?!1:void n.event.add(this,"click._submit keypress._submit",function(a){var b=a.target,c=n.nodeName(b,"input")||n.nodeName(b,"button")?b.form:void 0;c&&!n._data(c,"submitBubbles")&&(n.event.add(c,"submit._submit",function(a){a._submit_bubble=!0}),n._data(c,"submitBubbles",!0))})},postDispatch:function(a){a._submit_bubble&&(delete a._submit_bubble,this.parentNode&&!a.isTrigger&&n.event.simulate("submit",this.parentNode,a,!0))},teardown:function(){return n.nodeName(this,"form")?!1:void n.event.remove(this,"._submit")}}),l.changeBubbles||(n.event.special.change={setup:function(){return Y.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(n.event.add(this,"propertychange._change",function(a){"checked"===a.originalEvent.propertyName&&(this._just_changed=!0)}),n.event.add(this,"click._change",function(a){this._just_changed&&!a.isTrigger&&(this._just_changed=!1),n.event.simulate("change",this,a,!0)})),!1):void n.event.add(this,"beforeactivate._change",function(a){var b=a.target;Y.test(b.nodeName)&&!n._data(b,"changeBubbles")&&(n.event.add(b,"change._change",function(a){!this.parentNode||a.isSimulated||a.isTrigger||n.event.simulate("change",this.parentNode,a,!0)}),n._data(b,"changeBubbles",!0))})},handle:function(a){var b=a.target;return this!==b||a.isSimulated||a.isTrigger||"radio"!==b.type&&"checkbox"!==b.type?a.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return n.event.remove(this,"._change"),!Y.test(this.nodeName)}}),l.focusinBubbles||n.each({focus:"focusin",blur:"focusout"},function(a,b){var c=function(a){n.event.simulate(b,a.target,n.event.fix(a),!0)};n.event.special[b]={setup:function(){var d=this.ownerDocument||this,e=n._data(d,b);e||d.addEventListener(a,c,!0),n._data(d,b,(e||0)+1)},teardown:function(){var d=this.ownerDocument||this,e=n._data(d,b)-1;e?n._data(d,b,e):(d.removeEventListener(a,c,!0),n._removeData(d,b))}}}),n.fn.extend({on:function(a,b,c,d,e){var f,g;if("object"==typeof a){"string"!=typeof b&&(c=c||b,b=void 0);for(f in a)this.on(f,b,c,a[f],e);return this}if(null==c&&null==d?(d=b,c=b=void 0):null==d&&("string"==typeof b?(d=c,c=void 0):(d=c,c=b,b=void 0)),d===!1)d=cb;else if(!d)return this;return 1===e&&(g=d,d=function(a){return n().off(a),g.apply(this,arguments)},d.guid=g.guid||(g.guid=n.guid++)),this.each(function(){n.event.add(this,a,d,c,b)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,b,c){var d,e;if(a&&a.preventDefault&&a.handleObj)return d=a.handleObj,n(a.delegateTarget).off(d.namespace?d.origType+"."+d.namespace:d.origType,d.selector,d.handler),this;if("object"==typeof a){for(e in a)this.off(e,b,a[e]);return this}return(b===!1||"function"==typeof b)&&(c=b,b=void 0),c===!1&&(c=cb),this.each(function(){n.event.remove(this,a,c,b)})},trigger:function(a,b){return this.each(function(){n.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];return c?n.event.trigger(a,b,c,!0):void 0}});function eb(a){var b=fb.split("|"),c=a.createDocumentFragment();if(c.createElement)while(b.length)c.createElement(b.pop());return c}var fb="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",gb=/ jQuery\d+="(?:null|\d+)"/g,hb=new RegExp("<(?:"+fb+")[\\s/>]","i"),ib=/^\s+/,jb=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,kb=/<([\w:]+)/,lb=/<tbody/i,mb=/<|&#?\w+;/,nb=/<(?:script|style|link)/i,ob=/checked\s*(?:[^=]|=\s*.checked.)/i,pb=/^$|\/(?:java|ecma)script/i,qb=/^true\/(.*)/,rb=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,sb={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:l.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},tb=eb(z),ub=tb.appendChild(z.createElement("div"));sb.optgroup=sb.option,sb.tbody=sb.tfoot=sb.colgroup=sb.caption=sb.thead,sb.th=sb.td;function vb(a,b){var c,d,e=0,f=typeof a.getElementsByTagName!==L?a.getElementsByTagName(b||"*"):typeof a.querySelectorAll!==L?a.querySelectorAll(b||"*"):void 0;if(!f)for(f=[],c=a.childNodes||a;null!=(d=c[e]);e++)!b||n.nodeName(d,b)?f.push(d):n.merge(f,vb(d,b));return void 0===b||b&&n.nodeName(a,b)?n.merge([a],f):f}function wb(a){X.test(a.type)&&(a.defaultChecked=a.checked)}function xb(a,b){return n.nodeName(a,"table")&&n.nodeName(11!==b.nodeType?b:b.firstChild,"tr")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function yb(a){return a.type=(null!==n.find.attr(a,"type"))+"/"+a.type,a}function zb(a){var b=qb.exec(a.type);return b?a.type=b[1]:a.removeAttribute("type"),a}function Ab(a,b){for(var c,d=0;null!=(c=a[d]);d++)n._data(c,"globalEval",!b||n._data(b[d],"globalEval"))}function Bb(a,b){if(1===b.nodeType&&n.hasData(a)){var c,d,e,f=n._data(a),g=n._data(b,f),h=f.events;if(h){delete g.handle,g.events={};for(c in h)for(d=0,e=h[c].length;e>d;d++)n.event.add(b,c,h[c][d])}g.data&&(g.data=n.extend({},g.data))}}function Cb(a,b){var c,d,e;if(1===b.nodeType){if(c=b.nodeName.toLowerCase(),!l.noCloneEvent&&b[n.expando]){e=n._data(b);for(d in e.events)n.removeEvent(b,d,e.handle);b.removeAttribute(n.expando)}"script"===c&&b.text!==a.text?(yb(b).text=a.text,zb(b)):"object"===c?(b.parentNode&&(b.outerHTML=a.outerHTML),l.html5Clone&&a.innerHTML&&!n.trim(b.innerHTML)&&(b.innerHTML=a.innerHTML)):"input"===c&&X.test(a.type)?(b.defaultChecked=b.checked=a.checked,b.value!==a.value&&(b.value=a.value)):"option"===c?b.defaultSelected=b.selected=a.defaultSelected:("input"===c||"textarea"===c)&&(b.defaultValue=a.defaultValue)}}n.extend({clone:function(a,b,c){var d,e,f,g,h,i=n.contains(a.ownerDocument,a);if(l.html5Clone||n.isXMLDoc(a)||!hb.test("<"+a.nodeName+">")?f=a.cloneNode(!0):(ub.innerHTML=a.outerHTML,ub.removeChild(f=ub.firstChild)),!(l.noCloneEvent&&l.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||n.isXMLDoc(a)))for(d=vb(f),h=vb(a),g=0;null!=(e=h[g]);++g)d[g]&&Cb(e,d[g]);if(b)if(c)for(h=h||vb(a),d=d||vb(f),g=0;null!=(e=h[g]);g++)Bb(e,d[g]);else Bb(a,f);return d=vb(f,"script"),d.length>0&&Ab(d,!i&&vb(a,"script")),d=h=e=null,f},buildFragment:function(a,b,c,d){for(var e,f,g,h,i,j,k,m=a.length,o=eb(b),p=[],q=0;m>q;q++)if(f=a[q],f||0===f)if("object"===n.type(f))n.merge(p,f.nodeType?[f]:f);else if(mb.test(f)){h=h||o.appendChild(b.createElement("div")),i=(kb.exec(f)||["",""])[1].toLowerCase(),k=sb[i]||sb._default,h.innerHTML=k[1]+f.replace(jb,"<$1></$2>")+k[2],e=k[0];while(e--)h=h.lastChild;if(!l.leadingWhitespace&&ib.test(f)&&p.push(b.createTextNode(ib.exec(f)[0])),!l.tbody){f="table"!==i||lb.test(f)?"<table>"!==k[1]||lb.test(f)?0:h:h.firstChild,e=f&&f.childNodes.length;while(e--)n.nodeName(j=f.childNodes[e],"tbody")&&!j.childNodes.length&&f.removeChild(j)}n.merge(p,h.childNodes),h.textContent="";while(h.firstChild)h.removeChild(h.firstChild);h=o.lastChild}else p.push(b.createTextNode(f));h&&o.removeChild(h),l.appendChecked||n.grep(vb(p,"input"),wb),q=0;while(f=p[q++])if((!d||-1===n.inArray(f,d))&&(g=n.contains(f.ownerDocument,f),h=vb(o.appendChild(f),"script"),g&&Ab(h),c)){e=0;while(f=h[e++])pb.test(f.type||"")&&c.push(f)}return h=null,o},cleanData:function(a,b){for(var d,e,f,g,h=0,i=n.expando,j=n.cache,k=l.deleteExpando,m=n.event.special;null!=(d=a[h]);h++)if((b||n.acceptData(d))&&(f=d[i],g=f&&j[f])){if(g.events)for(e in g.events)m[e]?n.event.remove(d,e):n.removeEvent(d,e,g.handle);j[f]&&(delete j[f],k?delete d[i]:typeof d.removeAttribute!==L?d.removeAttribute(i):d[i]=null,c.push(f))}}}),n.fn.extend({text:function(a){return W(this,function(a){return void 0===a?n.text(this):this.empty().append((this[0]&&this[0].ownerDocument||z).createTextNode(a))},null,a,arguments.length)},append:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=xb(this,a);b.appendChild(a)}})},prepend:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=xb(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},remove:function(a,b){for(var c,d=a?n.filter(a,this):this,e=0;null!=(c=d[e]);e++)b||1!==c.nodeType||n.cleanData(vb(c)),c.parentNode&&(b&&n.contains(c.ownerDocument,c)&&Ab(vb(c,"script")),c.parentNode.removeChild(c));return this},empty:function(){for(var a,b=0;null!=(a=this[b]);b++){1===a.nodeType&&n.cleanData(vb(a,!1));while(a.firstChild)a.removeChild(a.firstChild);a.options&&n.nodeName(a,"select")&&(a.options.length=0)}return this},clone:function(a,b){return a=null==a?!1:a,b=null==b?a:b,this.map(function(){return n.clone(this,a,b)})},html:function(a){return W(this,function(a){var b=this[0]||{},c=0,d=this.length;if(void 0===a)return 1===b.nodeType?b.innerHTML.replace(gb,""):void 0;if(!("string"!=typeof a||nb.test(a)||!l.htmlSerialize&&hb.test(a)||!l.leadingWhitespace&&ib.test(a)||sb[(kb.exec(a)||["",""])[1].toLowerCase()])){a=a.replace(jb,"<$1></$2>");try{for(;d>c;c++)b=this[c]||{},1===b.nodeType&&(n.cleanData(vb(b,!1)),b.innerHTML=a);b=0}catch(e){}}b&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=arguments[0];return this.domManip(arguments,function(b){a=this.parentNode,n.cleanData(vb(this)),a&&a.replaceChild(b,this)}),a&&(a.length||a.nodeType)?this:this.remove()},detach:function(a){return this.remove(a,!0)},domManip:function(a,b){a=e.apply([],a);var c,d,f,g,h,i,j=0,k=this.length,m=this,o=k-1,p=a[0],q=n.isFunction(p);if(q||k>1&&"string"==typeof p&&!l.checkClone&&ob.test(p))return this.each(function(c){var d=m.eq(c);q&&(a[0]=p.call(this,c,d.html())),d.domManip(a,b)});if(k&&(i=n.buildFragment(a,this[0].ownerDocument,!1,this),c=i.firstChild,1===i.childNodes.length&&(i=c),c)){for(g=n.map(vb(i,"script"),yb),f=g.length;k>j;j++)d=i,j!==o&&(d=n.clone(d,!0,!0),f&&n.merge(g,vb(d,"script"))),b.call(this[j],d,j);if(f)for(h=g[g.length-1].ownerDocument,n.map(g,zb),j=0;f>j;j++)d=g[j],pb.test(d.type||"")&&!n._data(d,"globalEval")&&n.contains(h,d)&&(d.src?n._evalUrl&&n._evalUrl(d.src):n.globalEval((d.text||d.textContent||d.innerHTML||"").replace(rb,"")));i=c=null}return this}}),n.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){n.fn[a]=function(a){for(var c,d=0,e=[],g=n(a),h=g.length-1;h>=d;d++)c=d===h?this:this.clone(!0),n(g[d])[b](c),f.apply(e,c.get());return this.pushStack(e)}});var Db,Eb={};function Fb(b,c){var d=n(c.createElement(b)).appendTo(c.body),e=a.getDefaultComputedStyle?a.getDefaultComputedStyle(d[0]).display:n.css(d[0],"display");return d.detach(),e}function Gb(a){var b=z,c=Eb[a];return c||(c=Fb(a,b),"none"!==c&&c||(Db=(Db||n("<iframe frameborder='0' width='0' height='0'/>")).appendTo(b.documentElement),b=(Db[0].contentWindow||Db[0].contentDocument).document,b.write(),b.close(),c=Fb(a,b),Db.detach()),Eb[a]=c),c}!function(){var a,b,c=z.createElement("div"),d="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;padding:0;margin:0;border:0";c.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",a=c.getElementsByTagName("a")[0],a.style.cssText="float:left;opacity:.5",l.opacity=/^0.5/.test(a.style.opacity),l.cssFloat=!!a.style.cssFloat,c.style.backgroundClip="content-box",c.cloneNode(!0).style.backgroundClip="",l.clearCloneStyle="content-box"===c.style.backgroundClip,a=c=null,l.shrinkWrapBlocks=function(){var a,c,e,f;if(null==b){if(a=z.getElementsByTagName("body")[0],!a)return;f="border:0;width:0;height:0;position:absolute;top:0;left:-9999px",c=z.createElement("div"),e=z.createElement("div"),a.appendChild(c).appendChild(e),b=!1,typeof e.style.zoom!==L&&(e.style.cssText=d+";width:1px;padding:1px;zoom:1",e.innerHTML="<div></div>",e.firstChild.style.width="5px",b=3!==e.offsetWidth),a.removeChild(c),a=c=e=null}return b}}();var Hb=/^margin/,Ib=new RegExp("^("+T+")(?!px)[a-z%]+$","i"),Jb,Kb,Lb=/^(top|right|bottom|left)$/;a.getComputedStyle?(Jb=function(a){return a.ownerDocument.defaultView.getComputedStyle(a,null)},Kb=function(a,b,c){var d,e,f,g,h=a.style;return c=c||Jb(a),g=c?c.getPropertyValue(b)||c[b]:void 0,c&&(""!==g||n.contains(a.ownerDocument,a)||(g=n.style(a,b)),Ib.test(g)&&Hb.test(b)&&(d=h.width,e=h.minWidth,f=h.maxWidth,h.minWidth=h.maxWidth=h.width=g,g=c.width,h.width=d,h.minWidth=e,h.maxWidth=f)),void 0===g?g:g+""}):z.documentElement.currentStyle&&(Jb=function(a){return a.currentStyle},Kb=function(a,b,c){var d,e,f,g,h=a.style;return c=c||Jb(a),g=c?c[b]:void 0,null==g&&h&&h[b]&&(g=h[b]),Ib.test(g)&&!Lb.test(b)&&(d=h.left,e=a.runtimeStyle,f=e&&e.left,f&&(e.left=a.currentStyle.left),h.left="fontSize"===b?"1em":g,g=h.pixelLeft+"px",h.left=d,f&&(e.left=f)),void 0===g?g:g+""||"auto"});function Mb(a,b){return{get:function(){var c=a();if(null!=c)return c?void delete this.get:(this.get=b).apply(this,arguments)}}}!function(){var b,c,d,e,f,g,h=z.createElement("div"),i="border:0;width:0;height:0;position:absolute;top:0;left:-9999px",j="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;padding:0;margin:0;border:0";h.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",b=h.getElementsByTagName("a")[0],b.style.cssText="float:left;opacity:.5",l.opacity=/^0.5/.test(b.style.opacity),l.cssFloat=!!b.style.cssFloat,h.style.backgroundClip="content-box",h.cloneNode(!0).style.backgroundClip="",l.clearCloneStyle="content-box"===h.style.backgroundClip,b=h=null,n.extend(l,{reliableHiddenOffsets:function(){if(null!=c)return c;var a,b,d,e=z.createElement("div"),f=z.getElementsByTagName("body")[0];if(f)return e.setAttribute("className","t"),e.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",a=z.createElement("div"),a.style.cssText=i,f.appendChild(a).appendChild(e),e.innerHTML="<table><tr><td></td><td>t</td></tr></table>",b=e.getElementsByTagName("td"),b[0].style.cssText="padding:0;margin:0;border:0;display:none",d=0===b[0].offsetHeight,b[0].style.display="",b[1].style.display="none",c=d&&0===b[0].offsetHeight,f.removeChild(a),e=f=null,c},boxSizing:function(){return null==d&&k(),d},boxSizingReliable:function(){return null==e&&k(),e},pixelPosition:function(){return null==f&&k(),f},reliableMarginRight:function(){var b,c,d,e;if(null==g&&a.getComputedStyle){if(b=z.getElementsByTagName("body")[0],!b)return;c=z.createElement("div"),d=z.createElement("div"),c.style.cssText=i,b.appendChild(c).appendChild(d),e=d.appendChild(z.createElement("div")),e.style.cssText=d.style.cssText=j,e.style.marginRight=e.style.width="0",d.style.width="1px",g=!parseFloat((a.getComputedStyle(e,null)||{}).marginRight),b.removeChild(c)}return g}});function k(){var b,c,h=z.getElementsByTagName("body")[0];h&&(b=z.createElement("div"),c=z.createElement("div"),b.style.cssText=i,h.appendChild(b).appendChild(c),c.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;display:block;padding:1px;border:1px;width:4px;margin-top:1%;top:1%",n.swap(h,null!=h.style.zoom?{zoom:1}:{},function(){d=4===c.offsetWidth}),e=!0,f=!1,g=!0,a.getComputedStyle&&(f="1%"!==(a.getComputedStyle(c,null)||{}).top,e="4px"===(a.getComputedStyle(c,null)||{width:"4px"}).width),h.removeChild(b),c=h=null)}}(),n.swap=function(a,b,c,d){var e,f,g={};for(f in b)g[f]=a.style[f],a.style[f]=b[f];e=c.apply(a,d||[]);for(f in b)a.style[f]=g[f];return e};var Nb=/alpha\([^)]*\)/i,Ob=/opacity\s*=\s*([^)]*)/,Pb=/^(none|table(?!-c[ea]).+)/,Qb=new RegExp("^("+T+")(.*)$","i"),Rb=new RegExp("^([+-])=("+T+")","i"),Sb={position:"absolute",visibility:"hidden",display:"block"},Tb={letterSpacing:0,fontWeight:400},Ub=["Webkit","O","Moz","ms"];function Vb(a,b){if(b in a)return b;var c=b.charAt(0).toUpperCase()+b.slice(1),d=b,e=Ub.length;while(e--)if(b=Ub[e]+c,b in a)return b;return d}function Wb(a,b){for(var c,d,e,f=[],g=0,h=a.length;h>g;g++)d=a[g],d.style&&(f[g]=n._data(d,"olddisplay"),c=d.style.display,b?(f[g]||"none"!==c||(d.style.display=""),""===d.style.display&&V(d)&&(f[g]=n._data(d,"olddisplay",Gb(d.nodeName)))):f[g]||(e=V(d),(c&&"none"!==c||!e)&&n._data(d,"olddisplay",e?c:n.css(d,"display"))));for(g=0;h>g;g++)d=a[g],d.style&&(b&&"none"!==d.style.display&&""!==d.style.display||(d.style.display=b?f[g]||"":"none"));return a}function Xb(a,b,c){var d=Qb.exec(b);return d?Math.max(0,d[1]-(c||0))+(d[2]||"px"):b}function Yb(a,b,c,d,e){for(var f=c===(d?"border":"content")?4:"width"===b?1:0,g=0;4>f;f+=2)"margin"===c&&(g+=n.css(a,c+U[f],!0,e)),d?("content"===c&&(g-=n.css(a,"padding"+U[f],!0,e)),"margin"!==c&&(g-=n.css(a,"border"+U[f]+"Width",!0,e))):(g+=n.css(a,"padding"+U[f],!0,e),"padding"!==c&&(g+=n.css(a,"border"+U[f]+"Width",!0,e)));return g}function Zb(a,b,c){var d=!0,e="width"===b?a.offsetWidth:a.offsetHeight,f=Jb(a),g=l.boxSizing()&&"border-box"===n.css(a,"boxSizing",!1,f);if(0>=e||null==e){if(e=Kb(a,b,f),(0>e||null==e)&&(e=a.style[b]),Ib.test(e))return e;d=g&&(l.boxSizingReliable()||e===a.style[b]),e=parseFloat(e)||0}return e+Yb(a,b,c||(g?"border":"content"),d,f)+"px"}n.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=Kb(a,"opacity");return""===c?"1":c}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":l.cssFloat?"cssFloat":"styleFloat"},style:function(a,b,c,d){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var e,f,g,h=n.camelCase(b),i=a.style;if(b=n.cssProps[h]||(n.cssProps[h]=Vb(i,h)),g=n.cssHooks[b]||n.cssHooks[h],void 0===c)return g&&"get"in g&&void 0!==(e=g.get(a,!1,d))?e:i[b];if(f=typeof c,"string"===f&&(e=Rb.exec(c))&&(c=(e[1]+1)*e[2]+parseFloat(n.css(a,b)),f="number"),null!=c&&c===c&&("number"!==f||n.cssNumber[h]||(c+="px"),l.clearCloneStyle||""!==c||0!==b.indexOf("background")||(i[b]="inherit"),!(g&&"set"in g&&void 0===(c=g.set(a,c,d)))))try{i[b]="",i[b]=c}catch(j){}}},css:function(a,b,c,d){var e,f,g,h=n.camelCase(b);return b=n.cssProps[h]||(n.cssProps[h]=Vb(a.style,h)),g=n.cssHooks[b]||n.cssHooks[h],g&&"get"in g&&(f=g.get(a,!0,c)),void 0===f&&(f=Kb(a,b,d)),"normal"===f&&b in Tb&&(f=Tb[b]),""===c||c?(e=parseFloat(f),c===!0||n.isNumeric(e)?e||0:f):f}}),n.each(["height","width"],function(a,b){n.cssHooks[b]={get:function(a,c,d){return c?0===a.offsetWidth&&Pb.test(n.css(a,"display"))?n.swap(a,Sb,function(){return Zb(a,b,d)}):Zb(a,b,d):void 0},set:function(a,c,d){var e=d&&Jb(a);return Xb(a,c,d?Yb(a,b,d,l.boxSizing()&&"border-box"===n.css(a,"boxSizing",!1,e),e):0)}}}),l.opacity||(n.cssHooks.opacity={get:function(a,b){return Ob.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle,e=n.isNumeric(b)?"alpha(opacity="+100*b+")":"",f=d&&d.filter||c.filter||"";c.zoom=1,(b>=1||""===b)&&""===n.trim(f.replace(Nb,""))&&c.removeAttribute&&(c.removeAttribute("filter"),""===b||d&&!d.filter)||(c.filter=Nb.test(f)?f.replace(Nb,e):f+" "+e)}}),n.cssHooks.marginRight=Mb(l.reliableMarginRight,function(a,b){return b?n.swap(a,{display:"inline-block"},Kb,[a,"marginRight"]):void 0}),n.each({margin:"",padding:"",border:"Width"},function(a,b){n.cssHooks[a+b]={expand:function(c){for(var d=0,e={},f="string"==typeof c?c.split(" "):[c];4>d;d++)e[a+U[d]+b]=f[d]||f[d-2]||f[0];return e}},Hb.test(a)||(n.cssHooks[a+b].set=Xb)}),n.fn.extend({css:function(a,b){return W(this,function(a,b,c){var d,e,f={},g=0;if(n.isArray(b)){for(d=Jb(a),e=b.length;e>g;g++)f[b[g]]=n.css(a,b[g],!1,d);return f}return void 0!==c?n.style(a,b,c):n.css(a,b)
},a,b,arguments.length>1)},show:function(){return Wb(this,!0)},hide:function(){return Wb(this)},toggle:function(a){return"boolean"==typeof a?a?this.show():this.hide():this.each(function(){V(this)?n(this).show():n(this).hide()})}});function $b(a,b,c,d,e){return new $b.prototype.init(a,b,c,d,e)}n.Tween=$b,$b.prototype={constructor:$b,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||"swing",this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(n.cssNumber[c]?"":"px")},cur:function(){var a=$b.propHooks[this.prop];return a&&a.get?a.get(this):$b.propHooks._default.get(this)},run:function(a){var b,c=$b.propHooks[this.prop];return this.pos=b=this.options.duration?n.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):$b.propHooks._default.set(this),this}},$b.prototype.init.prototype=$b.prototype,$b.propHooks={_default:{get:function(a){var b;return null==a.elem[a.prop]||a.elem.style&&null!=a.elem.style[a.prop]?(b=n.css(a.elem,a.prop,""),b&&"auto"!==b?b:0):a.elem[a.prop]},set:function(a){n.fx.step[a.prop]?n.fx.step[a.prop](a):a.elem.style&&(null!=a.elem.style[n.cssProps[a.prop]]||n.cssHooks[a.prop])?n.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now}}},$b.propHooks.scrollTop=$b.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},n.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2}},n.fx=$b.prototype.init,n.fx.step={};var _b,ac,bc=/^(?:toggle|show|hide)$/,cc=new RegExp("^(?:([+-])=|)("+T+")([a-z%]*)$","i"),dc=/queueHooks$/,ec=[jc],fc={"*":[function(a,b){var c=this.createTween(a,b),d=c.cur(),e=cc.exec(b),f=e&&e[3]||(n.cssNumber[a]?"":"px"),g=(n.cssNumber[a]||"px"!==f&&+d)&&cc.exec(n.css(c.elem,a)),h=1,i=20;if(g&&g[3]!==f){f=f||g[3],e=e||[],g=+d||1;do h=h||".5",g/=h,n.style(c.elem,a,g+f);while(h!==(h=c.cur()/d)&&1!==h&&--i)}return e&&(g=c.start=+g||+d||0,c.unit=f,c.end=e[1]?g+(e[1]+1)*e[2]:+e[2]),c}]};function gc(){return setTimeout(function(){_b=void 0}),_b=n.now()}function hc(a,b){var c,d={height:a},e=0;for(b=b?1:0;4>e;e+=2-b)c=U[e],d["margin"+c]=d["padding"+c]=a;return b&&(d.opacity=d.width=a),d}function ic(a,b,c){for(var d,e=(fc[b]||[]).concat(fc["*"]),f=0,g=e.length;g>f;f++)if(d=e[f].call(c,b,a))return d}function jc(a,b,c){var d,e,f,g,h,i,j,k,m=this,o={},p=a.style,q=a.nodeType&&V(a),r=n._data(a,"fxshow");c.queue||(h=n._queueHooks(a,"fx"),null==h.unqueued&&(h.unqueued=0,i=h.empty.fire,h.empty.fire=function(){h.unqueued||i()}),h.unqueued++,m.always(function(){m.always(function(){h.unqueued--,n.queue(a,"fx").length||h.empty.fire()})})),1===a.nodeType&&("height"in b||"width"in b)&&(c.overflow=[p.overflow,p.overflowX,p.overflowY],j=n.css(a,"display"),k=Gb(a.nodeName),"none"===j&&(j=k),"inline"===j&&"none"===n.css(a,"float")&&(l.inlineBlockNeedsLayout&&"inline"!==k?p.zoom=1:p.display="inline-block")),c.overflow&&(p.overflow="hidden",l.shrinkWrapBlocks()||m.always(function(){p.overflow=c.overflow[0],p.overflowX=c.overflow[1],p.overflowY=c.overflow[2]}));for(d in b)if(e=b[d],bc.exec(e)){if(delete b[d],f=f||"toggle"===e,e===(q?"hide":"show")){if("show"!==e||!r||void 0===r[d])continue;q=!0}o[d]=r&&r[d]||n.style(a,d)}if(!n.isEmptyObject(o)){r?"hidden"in r&&(q=r.hidden):r=n._data(a,"fxshow",{}),f&&(r.hidden=!q),q?n(a).show():m.done(function(){n(a).hide()}),m.done(function(){var b;n._removeData(a,"fxshow");for(b in o)n.style(a,b,o[b])});for(d in o)g=ic(q?r[d]:0,d,m),d in r||(r[d]=g.start,q&&(g.end=g.start,g.start="width"===d||"height"===d?1:0))}}function kc(a,b){var c,d,e,f,g;for(c in a)if(d=n.camelCase(c),e=b[d],f=a[c],n.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),g=n.cssHooks[d],g&&"expand"in g){f=g.expand(f),delete a[d];for(c in f)c in a||(a[c]=f[c],b[c]=e)}else b[d]=e}function lc(a,b,c){var d,e,f=0,g=ec.length,h=n.Deferred().always(function(){delete i.elem}),i=function(){if(e)return!1;for(var b=_b||gc(),c=Math.max(0,j.startTime+j.duration-b),d=c/j.duration||0,f=1-d,g=0,i=j.tweens.length;i>g;g++)j.tweens[g].run(f);return h.notifyWith(a,[j,f,c]),1>f&&i?c:(h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:n.extend({},b),opts:n.extend(!0,{specialEasing:{}},c),originalProperties:b,originalOptions:c,startTime:_b||gc(),duration:c.duration,tweens:[],createTween:function(b,c){var d=n.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(d),d},stop:function(b){var c=0,d=b?j.tweens.length:0;if(e)return this;for(e=!0;d>c;c++)j.tweens[c].run(1);return b?h.resolveWith(a,[j,b]):h.rejectWith(a,[j,b]),this}}),k=j.props;for(kc(k,j.opts.specialEasing);g>f;f++)if(d=ec[f].call(j,a,k,j.opts))return d;return n.map(k,ic,j),n.isFunction(j.opts.start)&&j.opts.start.call(a,j),n.fx.timer(n.extend(i,{elem:a,anim:j,queue:j.opts.queue})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always)}n.Animation=n.extend(lc,{tweener:function(a,b){n.isFunction(a)?(b=a,a=["*"]):a=a.split(" ");for(var c,d=0,e=a.length;e>d;d++)c=a[d],fc[c]=fc[c]||[],fc[c].unshift(b)},prefilter:function(a,b){b?ec.unshift(a):ec.push(a)}}),n.speed=function(a,b,c){var d=a&&"object"==typeof a?n.extend({},a):{complete:c||!c&&b||n.isFunction(a)&&a,duration:a,easing:c&&b||b&&!n.isFunction(b)&&b};return d.duration=n.fx.off?0:"number"==typeof d.duration?d.duration:d.duration in n.fx.speeds?n.fx.speeds[d.duration]:n.fx.speeds._default,(null==d.queue||d.queue===!0)&&(d.queue="fx"),d.old=d.complete,d.complete=function(){n.isFunction(d.old)&&d.old.call(this),d.queue&&n.dequeue(this,d.queue)},d},n.fn.extend({fadeTo:function(a,b,c,d){return this.filter(V).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=n.isEmptyObject(a),f=n.speed(b,c,d),g=function(){var b=lc(this,n.extend({},a),f);(e||n._data(this,"finish"))&&b.stop(!0)};return g.finish=g,e||f.queue===!1?this.each(g):this.queue(f.queue,g)},stop:function(a,b,c){var d=function(a){var b=a.stop;delete a.stop,b(c)};return"string"!=typeof a&&(c=b,b=a,a=void 0),b&&a!==!1&&this.queue(a||"fx",[]),this.each(function(){var b=!0,e=null!=a&&a+"queueHooks",f=n.timers,g=n._data(this);if(e)g[e]&&g[e].stop&&d(g[e]);else for(e in g)g[e]&&g[e].stop&&dc.test(e)&&d(g[e]);for(e=f.length;e--;)f[e].elem!==this||null!=a&&f[e].queue!==a||(f[e].anim.stop(c),b=!1,f.splice(e,1));(b||!c)&&n.dequeue(this,a)})},finish:function(a){return a!==!1&&(a=a||"fx"),this.each(function(){var b,c=n._data(this),d=c[a+"queue"],e=c[a+"queueHooks"],f=n.timers,g=d?d.length:0;for(c.finish=!0,n.queue(this,a,[]),e&&e.stop&&e.stop.call(this,!0),b=f.length;b--;)f[b].elem===this&&f[b].queue===a&&(f[b].anim.stop(!0),f.splice(b,1));for(b=0;g>b;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}}),n.each(["toggle","show","hide"],function(a,b){var c=n.fn[b];n.fn[b]=function(a,d,e){return null==a||"boolean"==typeof a?c.apply(this,arguments):this.animate(hc(b,!0),a,d,e)}}),n.each({slideDown:hc("show"),slideUp:hc("hide"),slideToggle:hc("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){n.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),n.timers=[],n.fx.tick=function(){var a,b=n.timers,c=0;for(_b=n.now();c<b.length;c++)a=b[c],a()||b[c]!==a||b.splice(c--,1);b.length||n.fx.stop(),_b=void 0},n.fx.timer=function(a){n.timers.push(a),a()?n.fx.start():n.timers.pop()},n.fx.interval=13,n.fx.start=function(){ac||(ac=setInterval(n.fx.tick,n.fx.interval))},n.fx.stop=function(){clearInterval(ac),ac=null},n.fx.speeds={slow:600,fast:200,_default:400},n.fn.delay=function(a,b){return a=n.fx?n.fx.speeds[a]||a:a,b=b||"fx",this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},function(){var a,b,c,d,e=z.createElement("div");e.setAttribute("className","t"),e.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",a=e.getElementsByTagName("a")[0],c=z.createElement("select"),d=c.appendChild(z.createElement("option")),b=e.getElementsByTagName("input")[0],a.style.cssText="top:1px",l.getSetAttribute="t"!==e.className,l.style=/top/.test(a.getAttribute("style")),l.hrefNormalized="/a"===a.getAttribute("href"),l.checkOn=!!b.value,l.optSelected=d.selected,l.enctype=!!z.createElement("form").enctype,c.disabled=!0,l.optDisabled=!d.disabled,b=z.createElement("input"),b.setAttribute("value",""),l.input=""===b.getAttribute("value"),b.value="t",b.setAttribute("type","radio"),l.radioValue="t"===b.value,a=b=c=d=e=null}();var mc=/\r/g;n.fn.extend({val:function(a){var b,c,d,e=this[0];{if(arguments.length)return d=n.isFunction(a),this.each(function(c){var e;1===this.nodeType&&(e=d?a.call(this,c,n(this).val()):a,null==e?e="":"number"==typeof e?e+="":n.isArray(e)&&(e=n.map(e,function(a){return null==a?"":a+""})),b=n.valHooks[this.type]||n.valHooks[this.nodeName.toLowerCase()],b&&"set"in b&&void 0!==b.set(this,e,"value")||(this.value=e))});if(e)return b=n.valHooks[e.type]||n.valHooks[e.nodeName.toLowerCase()],b&&"get"in b&&void 0!==(c=b.get(e,"value"))?c:(c=e.value,"string"==typeof c?c.replace(mc,""):null==c?"":c)}}}),n.extend({valHooks:{option:{get:function(a){var b=n.find.attr(a,"value");return null!=b?b:n.text(a)}},select:{get:function(a){for(var b,c,d=a.options,e=a.selectedIndex,f="select-one"===a.type||0>e,g=f?null:[],h=f?e+1:d.length,i=0>e?h:f?e:0;h>i;i++)if(c=d[i],!(!c.selected&&i!==e||(l.optDisabled?c.disabled:null!==c.getAttribute("disabled"))||c.parentNode.disabled&&n.nodeName(c.parentNode,"optgroup"))){if(b=n(c).val(),f)return b;g.push(b)}return g},set:function(a,b){var c,d,e=a.options,f=n.makeArray(b),g=e.length;while(g--)if(d=e[g],n.inArray(n.valHooks.option.get(d),f)>=0)try{d.selected=c=!0}catch(h){d.scrollHeight}else d.selected=!1;return c||(a.selectedIndex=-1),e}}}}),n.each(["radio","checkbox"],function(){n.valHooks[this]={set:function(a,b){return n.isArray(b)?a.checked=n.inArray(n(a).val(),b)>=0:void 0}},l.checkOn||(n.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value})});var nc,oc,pc=n.expr.attrHandle,qc=/^(?:checked|selected)$/i,rc=l.getSetAttribute,sc=l.input;n.fn.extend({attr:function(a,b){return W(this,n.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){n.removeAttr(this,a)})}}),n.extend({attr:function(a,b,c){var d,e,f=a.nodeType;if(a&&3!==f&&8!==f&&2!==f)return typeof a.getAttribute===L?n.prop(a,b,c):(1===f&&n.isXMLDoc(a)||(b=b.toLowerCase(),d=n.attrHooks[b]||(n.expr.match.bool.test(b)?oc:nc)),void 0===c?d&&"get"in d&&null!==(e=d.get(a,b))?e:(e=n.find.attr(a,b),null==e?void 0:e):null!==c?d&&"set"in d&&void 0!==(e=d.set(a,c,b))?e:(a.setAttribute(b,c+""),c):void n.removeAttr(a,b))},removeAttr:function(a,b){var c,d,e=0,f=b&&b.match(F);if(f&&1===a.nodeType)while(c=f[e++])d=n.propFix[c]||c,n.expr.match.bool.test(c)?sc&&rc||!qc.test(c)?a[d]=!1:a[n.camelCase("default-"+c)]=a[d]=!1:n.attr(a,c,""),a.removeAttribute(rc?c:d)},attrHooks:{type:{set:function(a,b){if(!l.radioValue&&"radio"===b&&n.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}}}}),oc={set:function(a,b,c){return b===!1?n.removeAttr(a,c):sc&&rc||!qc.test(c)?a.setAttribute(!rc&&n.propFix[c]||c,c):a[n.camelCase("default-"+c)]=a[c]=!0,c}},n.each(n.expr.match.bool.source.match(/\w+/g),function(a,b){var c=pc[b]||n.find.attr;pc[b]=sc&&rc||!qc.test(b)?function(a,b,d){var e,f;return d||(f=pc[b],pc[b]=e,e=null!=c(a,b,d)?b.toLowerCase():null,pc[b]=f),e}:function(a,b,c){return c?void 0:a[n.camelCase("default-"+b)]?b.toLowerCase():null}}),sc&&rc||(n.attrHooks.value={set:function(a,b,c){return n.nodeName(a,"input")?void(a.defaultValue=b):nc&&nc.set(a,b,c)}}),rc||(nc={set:function(a,b,c){var d=a.getAttributeNode(c);return d||a.setAttributeNode(d=a.ownerDocument.createAttribute(c)),d.value=b+="","value"===c||b===a.getAttribute(c)?b:void 0}},pc.id=pc.name=pc.coords=function(a,b,c){var d;return c?void 0:(d=a.getAttributeNode(b))&&""!==d.value?d.value:null},n.valHooks.button={get:function(a,b){var c=a.getAttributeNode(b);return c&&c.specified?c.value:void 0},set:nc.set},n.attrHooks.contenteditable={set:function(a,b,c){nc.set(a,""===b?!1:b,c)}},n.each(["width","height"],function(a,b){n.attrHooks[b]={set:function(a,c){return""===c?(a.setAttribute(b,"auto"),c):void 0}}})),l.style||(n.attrHooks.style={get:function(a){return a.style.cssText||void 0},set:function(a,b){return a.style.cssText=b+""}});var tc=/^(?:input|select|textarea|button|object)$/i,uc=/^(?:a|area)$/i;n.fn.extend({prop:function(a,b){return W(this,n.prop,a,b,arguments.length>1)},removeProp:function(a){return a=n.propFix[a]||a,this.each(function(){try{this[a]=void 0,delete this[a]}catch(b){}})}}),n.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(a,b,c){var d,e,f,g=a.nodeType;if(a&&3!==g&&8!==g&&2!==g)return f=1!==g||!n.isXMLDoc(a),f&&(b=n.propFix[b]||b,e=n.propHooks[b]),void 0!==c?e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:a[b]=c:e&&"get"in e&&null!==(d=e.get(a,b))?d:a[b]},propHooks:{tabIndex:{get:function(a){var b=n.find.attr(a,"tabindex");return b?parseInt(b,10):tc.test(a.nodeName)||uc.test(a.nodeName)&&a.href?0:-1}}}}),l.hrefNormalized||n.each(["href","src"],function(a,b){n.propHooks[b]={get:function(a){return a.getAttribute(b,4)}}}),l.optSelected||(n.propHooks.selected={get:function(a){var b=a.parentNode;return b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex),null}}),n.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){n.propFix[this.toLowerCase()]=this}),l.enctype||(n.propFix.enctype="encoding");var vc=/[\t\r\n\f]/g;n.fn.extend({addClass:function(a){var b,c,d,e,f,g,h=0,i=this.length,j="string"==typeof a&&a;if(n.isFunction(a))return this.each(function(b){n(this).addClass(a.call(this,b,this.className))});if(j)for(b=(a||"").match(F)||[];i>h;h++)if(c=this[h],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(vc," "):" ")){f=0;while(e=b[f++])d.indexOf(" "+e+" ")<0&&(d+=e+" ");g=n.trim(d),c.className!==g&&(c.className=g)}return this},removeClass:function(a){var b,c,d,e,f,g,h=0,i=this.length,j=0===arguments.length||"string"==typeof a&&a;if(n.isFunction(a))return this.each(function(b){n(this).removeClass(a.call(this,b,this.className))});if(j)for(b=(a||"").match(F)||[];i>h;h++)if(c=this[h],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(vc," "):"")){f=0;while(e=b[f++])while(d.indexOf(" "+e+" ")>=0)d=d.replace(" "+e+" "," ");g=a?n.trim(d):"",c.className!==g&&(c.className=g)}return this},toggleClass:function(a,b){var c=typeof a;return"boolean"==typeof b&&"string"===c?b?this.addClass(a):this.removeClass(a):this.each(n.isFunction(a)?function(c){n(this).toggleClass(a.call(this,c,this.className,b),b)}:function(){if("string"===c){var b,d=0,e=n(this),f=a.match(F)||[];while(b=f[d++])e.hasClass(b)?e.removeClass(b):e.addClass(b)}else(c===L||"boolean"===c)&&(this.className&&n._data(this,"__className__",this.className),this.className=this.className||a===!1?"":n._data(this,"__className__")||"")})},hasClass:function(a){for(var b=" "+a+" ",c=0,d=this.length;d>c;c++)if(1===this[c].nodeType&&(" "+this[c].className+" ").replace(vc," ").indexOf(b)>=0)return!0;return!1}}),n.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){n.fn[b]=function(a,c){return arguments.length>0?this.on(b,null,a,c):this.trigger(b)}}),n.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)}});var wc=n.now(),xc=/\?/,yc=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;n.parseJSON=function(b){if(a.JSON&&a.JSON.parse)return a.JSON.parse(b+"");var c,d=null,e=n.trim(b+"");return e&&!n.trim(e.replace(yc,function(a,b,e,f){return c&&b&&(d=0),0===d?a:(c=e||b,d+=!f-!e,"")}))?Function("return "+e)():n.error("Invalid JSON: "+b)},n.parseXML=function(b){var c,d;if(!b||"string"!=typeof b)return null;try{a.DOMParser?(d=new DOMParser,c=d.parseFromString(b,"text/xml")):(c=new ActiveXObject("Microsoft.XMLDOM"),c.async="false",c.loadXML(b))}catch(e){c=void 0}return c&&c.documentElement&&!c.getElementsByTagName("parsererror").length||n.error("Invalid XML: "+b),c};var zc,Ac,Bc=/#.*$/,Cc=/([?&])_=[^&]*/,Dc=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Ec=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Fc=/^(?:GET|HEAD)$/,Gc=/^\/\//,Hc=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,Ic={},Jc={},Kc="*/".concat("*");try{Ac=location.href}catch(Lc){Ac=z.createElement("a"),Ac.href="",Ac=Ac.href}zc=Hc.exec(Ac.toLowerCase())||[];function Mc(a){return function(b,c){"string"!=typeof b&&(c=b,b="*");var d,e=0,f=b.toLowerCase().match(F)||[];if(n.isFunction(c))while(d=f[e++])"+"===d.charAt(0)?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function Nc(a,b,c,d){var e={},f=a===Jc;function g(h){var i;return e[h]=!0,n.each(a[h]||[],function(a,h){var j=h(b,c,d);return"string"!=typeof j||f||e[j]?f?!(i=j):void 0:(b.dataTypes.unshift(j),g(j),!1)}),i}return g(b.dataTypes[0])||!e["*"]&&g("*")}function Oc(a,b){var c,d,e=n.ajaxSettings.flatOptions||{};for(d in b)void 0!==b[d]&&((e[d]?a:c||(c={}))[d]=b[d]);return c&&n.extend(!0,a,c),a}function Pc(a,b,c){var d,e,f,g,h=a.contents,i=a.dataTypes;while("*"===i[0])i.shift(),void 0===e&&(e=a.mimeType||b.getResponseHeader("Content-Type"));if(e)for(g in h)if(h[g]&&h[g].test(e)){i.unshift(g);break}if(i[0]in c)f=i[0];else{for(g in c){if(!i[0]||a.converters[g+" "+i[0]]){f=g;break}d||(d=g)}f=f||d}return f?(f!==i[0]&&i.unshift(f),c[f]):void 0}function Qc(a,b,c,d){var e,f,g,h,i,j={},k=a.dataTypes.slice();if(k[1])for(g in a.converters)j[g.toLowerCase()]=a.converters[g];f=k.shift();while(f)if(a.responseFields[f]&&(c[a.responseFields[f]]=b),!i&&d&&a.dataFilter&&(b=a.dataFilter(b,a.dataType)),i=f,f=k.shift())if("*"===f)f=i;else if("*"!==i&&i!==f){if(g=j[i+" "+f]||j["* "+f],!g)for(e in j)if(h=e.split(" "),h[1]===f&&(g=j[i+" "+h[0]]||j["* "+h[0]])){g===!0?g=j[e]:j[e]!==!0&&(f=h[0],k.unshift(h[1]));break}if(g!==!0)if(g&&a["throws"])b=g(b);else try{b=g(b)}catch(l){return{state:"parsererror",error:g?l:"No conversion from "+i+" to "+f}}}return{state:"success",data:b}}n.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Ac,type:"GET",isLocal:Ec.test(zc[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Kc,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":n.parseJSON,"text xml":n.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?Oc(Oc(a,n.ajaxSettings),b):Oc(n.ajaxSettings,a)},ajaxPrefilter:Mc(Ic),ajaxTransport:Mc(Jc),ajax:function(a,b){"object"==typeof a&&(b=a,a=void 0),b=b||{};var c,d,e,f,g,h,i,j,k=n.ajaxSetup({},b),l=k.context||k,m=k.context&&(l.nodeType||l.jquery)?n(l):n.event,o=n.Deferred(),p=n.Callbacks("once memory"),q=k.statusCode||{},r={},s={},t=0,u="canceled",v={readyState:0,getResponseHeader:function(a){var b;if(2===t){if(!j){j={};while(b=Dc.exec(f))j[b[1].toLowerCase()]=b[2]}b=j[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return 2===t?f:null},setRequestHeader:function(a,b){var c=a.toLowerCase();return t||(a=s[c]=s[c]||a,r[a]=b),this},overrideMimeType:function(a){return t||(k.mimeType=a),this},statusCode:function(a){var b;if(a)if(2>t)for(b in a)q[b]=[q[b],a[b]];else v.always(a[v.status]);return this},abort:function(a){var b=a||u;return i&&i.abort(b),x(0,b),this}};if(o.promise(v).complete=p.add,v.success=v.done,v.error=v.fail,k.url=((a||k.url||Ac)+"").replace(Bc,"").replace(Gc,zc[1]+"//"),k.type=b.method||b.type||k.method||k.type,k.dataTypes=n.trim(k.dataType||"*").toLowerCase().match(F)||[""],null==k.crossDomain&&(c=Hc.exec(k.url.toLowerCase()),k.crossDomain=!(!c||c[1]===zc[1]&&c[2]===zc[2]&&(c[3]||("http:"===c[1]?"80":"443"))===(zc[3]||("http:"===zc[1]?"80":"443")))),k.data&&k.processData&&"string"!=typeof k.data&&(k.data=n.param(k.data,k.traditional)),Nc(Ic,k,b,v),2===t)return v;h=k.global,h&&0===n.active++&&n.event.trigger("ajaxStart"),k.type=k.type.toUpperCase(),k.hasContent=!Fc.test(k.type),e=k.url,k.hasContent||(k.data&&(e=k.url+=(xc.test(e)?"&":"?")+k.data,delete k.data),k.cache===!1&&(k.url=Cc.test(e)?e.replace(Cc,"$1_="+wc++):e+(xc.test(e)?"&":"?")+"_="+wc++)),k.ifModified&&(n.lastModified[e]&&v.setRequestHeader("If-Modified-Since",n.lastModified[e]),n.etag[e]&&v.setRequestHeader("If-None-Match",n.etag[e])),(k.data&&k.hasContent&&k.contentType!==!1||b.contentType)&&v.setRequestHeader("Content-Type",k.contentType),v.setRequestHeader("Accept",k.dataTypes[0]&&k.accepts[k.dataTypes[0]]?k.accepts[k.dataTypes[0]]+("*"!==k.dataTypes[0]?", "+Kc+"; q=0.01":""):k.accepts["*"]);for(d in k.headers)v.setRequestHeader(d,k.headers[d]);if(k.beforeSend&&(k.beforeSend.call(l,v,k)===!1||2===t))return v.abort();u="abort";for(d in{success:1,error:1,complete:1})v[d](k[d]);if(i=Nc(Jc,k,b,v)){v.readyState=1,h&&m.trigger("ajaxSend",[v,k]),k.async&&k.timeout>0&&(g=setTimeout(function(){v.abort("timeout")},k.timeout));try{t=1,i.send(r,x)}catch(w){if(!(2>t))throw w;x(-1,w)}}else x(-1,"No Transport");function x(a,b,c,d){var j,r,s,u,w,x=b;2!==t&&(t=2,g&&clearTimeout(g),i=void 0,f=d||"",v.readyState=a>0?4:0,j=a>=200&&300>a||304===a,c&&(u=Pc(k,v,c)),u=Qc(k,u,v,j),j?(k.ifModified&&(w=v.getResponseHeader("Last-Modified"),w&&(n.lastModified[e]=w),w=v.getResponseHeader("etag"),w&&(n.etag[e]=w)),204===a||"HEAD"===k.type?x="nocontent":304===a?x="notmodified":(x=u.state,r=u.data,s=u.error,j=!s)):(s=x,(a||!x)&&(x="error",0>a&&(a=0))),v.status=a,v.statusText=(b||x)+"",j?o.resolveWith(l,[r,x,v]):o.rejectWith(l,[v,x,s]),v.statusCode(q),q=void 0,h&&m.trigger(j?"ajaxSuccess":"ajaxError",[v,k,j?r:s]),p.fireWith(l,[v,x]),h&&(m.trigger("ajaxComplete",[v,k]),--n.active||n.event.trigger("ajaxStop")))}return v},getJSON:function(a,b,c){return n.get(a,b,c,"json")},getScript:function(a,b){return n.get(a,void 0,b,"script")}}),n.each(["get","post"],function(a,b){n[b]=function(a,c,d,e){return n.isFunction(c)&&(e=e||d,d=c,c=void 0),n.ajax({url:a,type:b,dataType:e,data:c,success:d})}}),n.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(a,b){n.fn[b]=function(a){return this.on(b,a)}}),n._evalUrl=function(a){return n.ajax({url:a,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},n.fn.extend({wrapAll:function(a){if(n.isFunction(a))return this.each(function(b){n(this).wrapAll(a.call(this,b))});if(this[0]){var b=n(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){var a=this;while(a.firstChild&&1===a.firstChild.nodeType)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){return this.each(n.isFunction(a)?function(b){n(this).wrapInner(a.call(this,b))}:function(){var b=n(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=n.isFunction(a);return this.each(function(c){n(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){n.nodeName(this,"body")||n(this).replaceWith(this.childNodes)}).end()}}),n.expr.filters.hidden=function(a){return a.offsetWidth<=0&&a.offsetHeight<=0||!l.reliableHiddenOffsets()&&"none"===(a.style&&a.style.display||n.css(a,"display"))},n.expr.filters.visible=function(a){return!n.expr.filters.hidden(a)};var Rc=/%20/g,Sc=/\[\]$/,Tc=/\r?\n/g,Uc=/^(?:submit|button|image|reset|file)$/i,Vc=/^(?:input|select|textarea|keygen)/i;function Wc(a,b,c,d){var e;if(n.isArray(b))n.each(b,function(b,e){c||Sc.test(a)?d(a,e):Wc(a+"["+("object"==typeof e?b:"")+"]",e,c,d)});else if(c||"object"!==n.type(b))d(a,b);else for(e in b)Wc(a+"["+e+"]",b[e],c,d)}n.param=function(a,b){var c,d=[],e=function(a,b){b=n.isFunction(b)?b():null==b?"":b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};if(void 0===b&&(b=n.ajaxSettings&&n.ajaxSettings.traditional),n.isArray(a)||a.jquery&&!n.isPlainObject(a))n.each(a,function(){e(this.name,this.value)});else for(c in a)Wc(c,a[c],b,e);return d.join("&").replace(Rc,"+")},n.fn.extend({serialize:function(){return n.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=n.prop(this,"elements");return a?n.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!n(this).is(":disabled")&&Vc.test(this.nodeName)&&!Uc.test(a)&&(this.checked||!X.test(a))}).map(function(a,b){var c=n(this).val();return null==c?null:n.isArray(c)?n.map(c,function(a){return{name:b.name,value:a.replace(Tc,"\r\n")}}):{name:b.name,value:c.replace(Tc,"\r\n")}}).get()}}),n.ajaxSettings.xhr=void 0!==a.ActiveXObject?function(){return!this.isLocal&&/^(get|post|head|put|delete|options)$/i.test(this.type)&&$c()||_c()}:$c;var Xc=0,Yc={},Zc=n.ajaxSettings.xhr();a.ActiveXObject&&n(a).on("unload",function(){for(var a in Yc)Yc[a](void 0,!0)}),l.cors=!!Zc&&"withCredentials"in Zc,Zc=l.ajax=!!Zc,Zc&&n.ajaxTransport(function(a){if(!a.crossDomain||l.cors){var b;return{send:function(c,d){var e,f=a.xhr(),g=++Xc;if(f.open(a.type,a.url,a.async,a.username,a.password),a.xhrFields)for(e in a.xhrFields)f[e]=a.xhrFields[e];a.mimeType&&f.overrideMimeType&&f.overrideMimeType(a.mimeType),a.crossDomain||c["X-Requested-With"]||(c["X-Requested-With"]="XMLHttpRequest");for(e in c)void 0!==c[e]&&f.setRequestHeader(e,c[e]+"");f.send(a.hasContent&&a.data||null),b=function(c,e){var h,i,j;if(b&&(e||4===f.readyState))if(delete Yc[g],b=void 0,f.onreadystatechange=n.noop,e)4!==f.readyState&&f.abort();else{j={},h=f.status,"string"==typeof f.responseText&&(j.text=f.responseText);try{i=f.statusText}catch(k){i=""}h||!a.isLocal||a.crossDomain?1223===h&&(h=204):h=j.text?200:404}j&&d(h,i,j,f.getAllResponseHeaders())},a.async?4===f.readyState?setTimeout(b):f.onreadystatechange=Yc[g]=b:b()},abort:function(){b&&b(void 0,!0)}}}});function $c(){try{return new a.XMLHttpRequest}catch(b){}}function _c(){try{return new a.ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}n.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(a){return n.globalEval(a),a}}}),n.ajaxPrefilter("script",function(a){void 0===a.cache&&(a.cache=!1),a.crossDomain&&(a.type="GET",a.global=!1)}),n.ajaxTransport("script",function(a){if(a.crossDomain){var b,c=z.head||n("head")[0]||z.documentElement;return{send:function(d,e){b=z.createElement("script"),b.async=!0,a.scriptCharset&&(b.charset=a.scriptCharset),b.src=a.url,b.onload=b.onreadystatechange=function(a,c){(c||!b.readyState||/loaded|complete/.test(b.readyState))&&(b.onload=b.onreadystatechange=null,b.parentNode&&b.parentNode.removeChild(b),b=null,c||e(200,"success"))},c.insertBefore(b,c.firstChild)},abort:function(){b&&b.onload(void 0,!0)}}}});var ad=[],bd=/(=)\?(?=&|$)|\?\?/;n.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=ad.pop()||n.expando+"_"+wc++;return this[a]=!0,a}}),n.ajaxPrefilter("json jsonp",function(b,c,d){var e,f,g,h=b.jsonp!==!1&&(bd.test(b.url)?"url":"string"==typeof b.data&&!(b.contentType||"").indexOf("application/x-www-form-urlencoded")&&bd.test(b.data)&&"data");return h||"jsonp"===b.dataTypes[0]?(e=b.jsonpCallback=n.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,h?b[h]=b[h].replace(bd,"$1"+e):b.jsonp!==!1&&(b.url+=(xc.test(b.url)?"&":"?")+b.jsonp+"="+e),b.converters["script json"]=function(){return g||n.error(e+" was not called"),g[0]},b.dataTypes[0]="json",f=a[e],a[e]=function(){g=arguments},d.always(function(){a[e]=f,b[e]&&(b.jsonpCallback=c.jsonpCallback,ad.push(e)),g&&n.isFunction(f)&&f(g[0]),g=f=void 0}),"script"):void 0}),n.parseHTML=function(a,b,c){if(!a||"string"!=typeof a)return null;"boolean"==typeof b&&(c=b,b=!1),b=b||z;var d=v.exec(a),e=!c&&[];return d?[b.createElement(d[1])]:(d=n.buildFragment([a],b,e),e&&e.length&&n(e).remove(),n.merge([],d.childNodes))};var cd=n.fn.load;n.fn.load=function(a,b,c){if("string"!=typeof a&&cd)return cd.apply(this,arguments);var d,e,f,g=this,h=a.indexOf(" ");return h>=0&&(d=a.slice(h,a.length),a=a.slice(0,h)),n.isFunction(b)?(c=b,b=void 0):b&&"object"==typeof b&&(f="POST"),g.length>0&&n.ajax({url:a,type:f,dataType:"html",data:b}).done(function(a){e=arguments,g.html(d?n("<div>").append(n.parseHTML(a)).find(d):a)}).complete(c&&function(a,b){g.each(c,e||[a.responseText,b,a])}),this},n.expr.filters.animated=function(a){return n.grep(n.timers,function(b){return a===b.elem}).length};var dd=a.document.documentElement;function ed(a){return n.isWindow(a)?a:9===a.nodeType?a.defaultView||a.parentWindow:!1}n.offset={setOffset:function(a,b,c){var d,e,f,g,h,i,j,k=n.css(a,"position"),l=n(a),m={};"static"===k&&(a.style.position="relative"),h=l.offset(),f=n.css(a,"top"),i=n.css(a,"left"),j=("absolute"===k||"fixed"===k)&&n.inArray("auto",[f,i])>-1,j?(d=l.position(),g=d.top,e=d.left):(g=parseFloat(f)||0,e=parseFloat(i)||0),n.isFunction(b)&&(b=b.call(a,c,h)),null!=b.top&&(m.top=b.top-h.top+g),null!=b.left&&(m.left=b.left-h.left+e),"using"in b?b.using.call(a,m):l.css(m)}},n.fn.extend({offset:function(a){if(arguments.length)return void 0===a?this:this.each(function(b){n.offset.setOffset(this,a,b)});var b,c,d={top:0,left:0},e=this[0],f=e&&e.ownerDocument;if(f)return b=f.documentElement,n.contains(b,e)?(typeof e.getBoundingClientRect!==L&&(d=e.getBoundingClientRect()),c=ed(f),{top:d.top+(c.pageYOffset||b.scrollTop)-(b.clientTop||0),left:d.left+(c.pageXOffset||b.scrollLeft)-(b.clientLeft||0)}):d},position:function(){if(this[0]){var a,b,c={top:0,left:0},d=this[0];return"fixed"===n.css(d,"position")?b=d.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),n.nodeName(a[0],"html")||(c=a.offset()),c.top+=n.css(a[0],"borderTopWidth",!0),c.left+=n.css(a[0],"borderLeftWidth",!0)),{top:b.top-c.top-n.css(d,"marginTop",!0),left:b.left-c.left-n.css(d,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var a=this.offsetParent||dd;while(a&&!n.nodeName(a,"html")&&"static"===n.css(a,"position"))a=a.offsetParent;return a||dd})}}),n.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,b){var c=/Y/.test(b);n.fn[a]=function(d){return W(this,function(a,d,e){var f=ed(a);return void 0===e?f?b in f?f[b]:f.document.documentElement[d]:a[d]:void(f?f.scrollTo(c?n(f).scrollLeft():e,c?e:n(f).scrollTop()):a[d]=e)},a,d,arguments.length,null)}}),n.each(["top","left"],function(a,b){n.cssHooks[b]=Mb(l.pixelPosition,function(a,c){return c?(c=Kb(a,b),Ib.test(c)?n(a).position()[b]+"px":c):void 0})}),n.each({Height:"height",Width:"width"},function(a,b){n.each({padding:"inner"+a,content:b,"":"outer"+a},function(c,d){n.fn[d]=function(d,e){var f=arguments.length&&(c||"boolean"!=typeof d),g=c||(d===!0||e===!0?"margin":"border");return W(this,function(b,c,d){var e;return n.isWindow(b)?b.document.documentElement["client"+a]:9===b.nodeType?(e=b.documentElement,Math.max(b.body["scroll"+a],e["scroll"+a],b.body["offset"+a],e["offset"+a],e["client"+a])):void 0===d?n.css(b,c,g):n.style(b,c,d,g)},b,f?d:void 0,f,null)}})}),n.fn.size=function(){return this.length},n.fn.andSelf=n.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return n});var fd=a.jQuery,gd=a.$;return n.noConflict=function(b){return a.$===n&&(a.$=gd),b&&a.jQuery===n&&(a.jQuery=fd),n},typeof b===L&&(a.jQuery=a.$=n),n});

define('jquery-private', ['jquery'], function($) {
  $ = $.noConflict(true);
  if(window.$ && window.$.fn && window.$.fn.jquery === $.fn.jquery){
    return window.$;
  } else {
    return $;
  }
})
;
/*!

 handlebars v1.3.0

Copyright (C) 2011 by Yehuda Katz

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.

@license
*/
/* exported Handlebars */
var Handlebars = (function() {
// handlebars/safe-string.js
var __module4__ = (function() {
  
  var __exports__;
  // Build out our basic SafeString type
  function SafeString(string) {
    this.string = string;
  }

  SafeString.prototype.toString = function() {
    return "" + this.string;
  };

  __exports__ = SafeString;
  return __exports__;
})();

// handlebars/utils.js
var __module3__ = (function(__dependency1__) {
  
  var __exports__ = {};
  /*jshint -W004 */
  var SafeString = __dependency1__;

  var escape = {
    "&": "&amp;",
    "<": "&lt;",
    ">": "&gt;",
    '"': "&quot;",
    "'": "&#x27;",
    "`": "&#x60;"
  };

  var badChars = /[&<>"'`]/g;
  var possible = /[&<>"'`]/;

  function escapeChar(chr) {
    return escape[chr] || "&amp;";
  }

  function extend(obj, value) {
    for(var key in value) {
      if(Object.prototype.hasOwnProperty.call(value, key)) {
        obj[key] = value[key];
      }
    }
  }

  __exports__.extend = extend;var toString = Object.prototype.toString;
  __exports__.toString = toString;
  // Sourced from lodash
  // https://github.com/bestiejs/lodash/blob/master/LICENSE.txt
  var isFunction = function(value) {
    return typeof value === 'function';
  };
  // fallback for older versions of Chrome and Safari
  if (isFunction(/x/)) {
    isFunction = function(value) {
      return typeof value === 'function' && toString.call(value) === '[object Function]';
    };
  }
  var isFunction;
  __exports__.isFunction = isFunction;
  var isArray = Array.isArray || function(value) {
    return (value && typeof value === 'object') ? toString.call(value) === '[object Array]' : false;
  };
  __exports__.isArray = isArray;

  function escapeExpression(string) {
    // don't escape SafeStrings, since they're already safe
    if (string instanceof SafeString) {
      return string.toString();
    } else if (!string && string !== 0) {
      return "";
    }

    // Force a string conversion as this will be done by the append regardless and
    // the regex test will do this transparently behind the scenes, causing issues if
    // an object's to string has escaped characters in it.
    string = "" + string;

    if(!possible.test(string)) { return string; }
    return string.replace(badChars, escapeChar);
  }

  __exports__.escapeExpression = escapeExpression;function isEmpty(value) {
    if (!value && value !== 0) {
      return true;
    } else if (isArray(value) && value.length === 0) {
      return true;
    } else {
      return false;
    }
  }

  __exports__.isEmpty = isEmpty;
  return __exports__;
})(__module4__);

// handlebars/exception.js
var __module5__ = (function() {
  
  var __exports__;

  var errorProps = ['description', 'fileName', 'lineNumber', 'message', 'name', 'number', 'stack'];

  function Exception(message, node) {
    var line;
    if (node && node.firstLine) {
      line = node.firstLine;

      message += ' - ' + line + ':' + node.firstColumn;
    }

    var tmp = Error.prototype.constructor.call(this, message);

    // Unfortunately errors are not enumerable in Chrome (at least), so `for prop in tmp` doesn't work.
    for (var idx = 0; idx < errorProps.length; idx++) {
      this[errorProps[idx]] = tmp[errorProps[idx]];
    }

    if (line) {
      this.lineNumber = line;
      this.column = node.firstColumn;
    }
  }

  Exception.prototype = new Error();

  __exports__ = Exception;
  return __exports__;
})();

// handlebars/base.js
var __module2__ = (function(__dependency1__, __dependency2__) {
  
  var __exports__ = {};
  var Utils = __dependency1__;
  var Exception = __dependency2__;

  var VERSION = "1.3.0";
  __exports__.VERSION = VERSION;var COMPILER_REVISION = 4;
  __exports__.COMPILER_REVISION = COMPILER_REVISION;
  var REVISION_CHANGES = {
    1: '<= 1.0.rc.2', // 1.0.rc.2 is actually rev2 but doesn't report it
    2: '== 1.0.0-rc.3',
    3: '== 1.0.0-rc.4',
    4: '>= 1.0.0'
  };
  __exports__.REVISION_CHANGES = REVISION_CHANGES;
  var isArray = Utils.isArray,
      isFunction = Utils.isFunction,
      toString = Utils.toString,
      objectType = '[object Object]';

  function HandlebarsEnvironment(helpers, partials) {
    this.helpers = helpers || {};
    this.partials = partials || {};

    registerDefaultHelpers(this);
  }

  __exports__.HandlebarsEnvironment = HandlebarsEnvironment;HandlebarsEnvironment.prototype = {
    constructor: HandlebarsEnvironment,

    logger: logger,
    log: log,

    registerHelper: function(name, fn, inverse) {
      if (toString.call(name) === objectType) {
        if (inverse || fn) { throw new Exception('Arg not supported with multiple helpers'); }
        Utils.extend(this.helpers, name);
      } else {
        if (inverse) { fn.not = inverse; }
        this.helpers[name] = fn;
      }
    },

    registerPartial: function(name, str) {
      if (toString.call(name) === objectType) {
        Utils.extend(this.partials,  name);
      } else {
        this.partials[name] = str;
      }
    }
  };

  function registerDefaultHelpers(instance) {
    instance.registerHelper('helperMissing', function(arg) {
      if(arguments.length === 2) {
        return undefined;
      } else {
        throw new Exception("Missing helper: '" + arg + "'");
      }
    });

    instance.registerHelper('blockHelperMissing', function(context, options) {
      var inverse = options.inverse || function() {}, fn = options.fn;

      if (isFunction(context)) { context = context.call(this); }

      if(context === true) {
        return fn(this);
      } else if(context === false || context == null) {
        return inverse(this);
      } else if (isArray(context)) {
        if(context.length > 0) {
          return instance.helpers.each(context, options);
        } else {
          return inverse(this);
        }
      } else {
        return fn(context);
      }
    });

    instance.registerHelper('each', function(context, options) {
      var fn = options.fn, inverse = options.inverse;
      var i = 0, ret = "", data;

      if (isFunction(context)) { context = context.call(this); }

      if (options.data) {
        data = createFrame(options.data);
      }

      if(context && typeof context === 'object') {
        if (isArray(context)) {
          for(var j = context.length; i<j; i++) {
            if (data) {
              data.index = i;
              data.first = (i === 0);
              data.last  = (i === (context.length-1));
            }
            ret = ret + fn(context[i], { data: data });
          }
        } else {
          for(var key in context) {
            if(context.hasOwnProperty(key)) {
              if(data) { 
                data.key = key; 
                data.index = i;
                data.first = (i === 0);
              }
              ret = ret + fn(context[key], {data: data});
              i++;
            }
          }
        }
      }

      if(i === 0){
        ret = inverse(this);
      }

      return ret;
    });

    instance.registerHelper('if', function(conditional, options) {
      if (isFunction(conditional)) { conditional = conditional.call(this); }

      // Default behavior is to render the positive path if the value is truthy and not empty.
      // The `includeZero` option may be set to treat the condtional as purely not empty based on the
      // behavior of isEmpty. Effectively this determines if 0 is handled by the positive path or negative.
      if ((!options.hash.includeZero && !conditional) || Utils.isEmpty(conditional)) {
        return options.inverse(this);
      } else {
        return options.fn(this);
      }
    });

    instance.registerHelper('unless', function(conditional, options) {
      return instance.helpers['if'].call(this, conditional, {fn: options.inverse, inverse: options.fn, hash: options.hash});
    });

    instance.registerHelper('with', function(context, options) {
      if (isFunction(context)) { context = context.call(this); }

      if (!Utils.isEmpty(context)) return options.fn(context);
    });

    instance.registerHelper('log', function(context, options) {
      var level = options.data && options.data.level != null ? parseInt(options.data.level, 10) : 1;
      instance.log(level, context);
    });
  }

  var logger = {
    methodMap: { 0: 'debug', 1: 'info', 2: 'warn', 3: 'error' },

    // State enum
    DEBUG: 0,
    INFO: 1,
    WARN: 2,
    ERROR: 3,
    level: 3,

    // can be overridden in the host environment
    log: function(level, obj) {
      if (logger.level <= level) {
        var method = logger.methodMap[level];
        if (typeof console !== 'undefined' && console[method]) {
          console[method].call(console, obj);
        }
      }
    }
  };
  __exports__.logger = logger;
  function log(level, obj) { logger.log(level, obj); }

  __exports__.log = log;var createFrame = function(object) {
    var obj = {};
    Utils.extend(obj, object);
    return obj;
  };
  __exports__.createFrame = createFrame;
  return __exports__;
})(__module3__, __module5__);

// handlebars/runtime.js
var __module6__ = (function(__dependency1__, __dependency2__, __dependency3__) {
  
  var __exports__ = {};
  var Utils = __dependency1__;
  var Exception = __dependency2__;
  var COMPILER_REVISION = __dependency3__.COMPILER_REVISION;
  var REVISION_CHANGES = __dependency3__.REVISION_CHANGES;

  function checkRevision(compilerInfo) {
    var compilerRevision = compilerInfo && compilerInfo[0] || 1,
        currentRevision = COMPILER_REVISION;

    if (compilerRevision !== currentRevision) {
      if (compilerRevision < currentRevision) {
        var runtimeVersions = REVISION_CHANGES[currentRevision],
            compilerVersions = REVISION_CHANGES[compilerRevision];
        throw new Exception("Template was precompiled with an older version of Handlebars than the current runtime. "+
              "Please update your precompiler to a newer version ("+runtimeVersions+") or downgrade your runtime to an older version ("+compilerVersions+").");
      } else {
        // Use the embedded version info since the runtime doesn't know about this revision yet
        throw new Exception("Template was precompiled with a newer version of Handlebars than the current runtime. "+
              "Please update your runtime to a newer version ("+compilerInfo[1]+").");
      }
    }
  }

  __exports__.checkRevision = checkRevision;// TODO: Remove this line and break up compilePartial

  function template(templateSpec, env) {
    if (!env) {
      throw new Exception("No environment passed to template");
    }

    // Note: Using env.VM references rather than local var references throughout this section to allow
    // for external users to override these as psuedo-supported APIs.
    var invokePartialWrapper = function(partial, name, context, helpers, partials, data) {
      var result = env.VM.invokePartial.apply(this, arguments);
      if (result != null) { return result; }

      if (env.compile) {
        var options = { helpers: helpers, partials: partials, data: data };
        partials[name] = env.compile(partial, { data: data !== undefined }, env);
        return partials[name](context, options);
      } else {
        throw new Exception("The partial " + name + " could not be compiled when running in runtime-only mode");
      }
    };

    // Just add water
    var container = {
      escapeExpression: Utils.escapeExpression,
      invokePartial: invokePartialWrapper,
      programs: [],
      program: function(i, fn, data) {
        var programWrapper = this.programs[i];
        if(data) {
          programWrapper = program(i, fn, data);
        } else if (!programWrapper) {
          programWrapper = this.programs[i] = program(i, fn);
        }
        return programWrapper;
      },
      merge: function(param, common) {
        var ret = param || common;

        if (param && common && (param !== common)) {
          ret = {};
          Utils.extend(ret, common);
          Utils.extend(ret, param);
        }
        return ret;
      },
      programWithDepth: env.VM.programWithDepth,
      noop: env.VM.noop,
      compilerInfo: null
    };

    return function(context, options) {
      options = options || {};
      var namespace = options.partial ? options : env,
          helpers,
          partials;

      if (!options.partial) {
        helpers = options.helpers;
        partials = options.partials;
      }
      var result = templateSpec.call(
            container,
            namespace, context,
            helpers,
            partials,
            options.data);

      if (!options.partial) {
        env.VM.checkRevision(container.compilerInfo);
      }

      return result;
    };
  }

  __exports__.template = template;function programWithDepth(i, fn, data /*, $depth */) {
    var args = Array.prototype.slice.call(arguments, 3);

    var prog = function(context, options) {
      options = options || {};

      return fn.apply(this, [context, options.data || data].concat(args));
    };
    prog.program = i;
    prog.depth = args.length;
    return prog;
  }

  __exports__.programWithDepth = programWithDepth;function program(i, fn, data) {
    var prog = function(context, options) {
      options = options || {};

      return fn(context, options.data || data);
    };
    prog.program = i;
    prog.depth = 0;
    return prog;
  }

  __exports__.program = program;function invokePartial(partial, name, context, helpers, partials, data) {
    var options = { partial: true, helpers: helpers, partials: partials, data: data };

    if(partial === undefined) {
      throw new Exception("The partial " + name + " could not be found");
    } else if(partial instanceof Function) {
      return partial(context, options);
    }
  }

  __exports__.invokePartial = invokePartial;function noop() { return ""; }

  __exports__.noop = noop;
  return __exports__;
})(__module3__, __module5__, __module2__);

// handlebars.runtime.js
var __module1__ = (function(__dependency1__, __dependency2__, __dependency3__, __dependency4__, __dependency5__) {
  
  var __exports__;
  /*globals Handlebars: true */
  var base = __dependency1__;

  // Each of these augment the Handlebars object. No need to setup here.
  // (This is done to easily share code between commonjs and browse envs)
  var SafeString = __dependency2__;
  var Exception = __dependency3__;
  var Utils = __dependency4__;
  var runtime = __dependency5__;

  // For compatibility and usage outside of module systems, make the Handlebars object a namespace
  var create = function() {
    var hb = new base.HandlebarsEnvironment();

    Utils.extend(hb, base);
    hb.SafeString = SafeString;
    hb.Exception = Exception;
    hb.Utils = Utils;

    hb.VM = runtime;
    hb.template = function(spec) {
      return runtime.template(spec, hb);
    };

    return hb;
  };

  var Handlebars = create();
  Handlebars.create = create;

  __exports__ = Handlebars;
  return __exports__;
})(__module2__, __module4__, __module5__, __module3__, __module6__);

// handlebars/compiler/ast.js
var __module7__ = (function(__dependency1__) {
  
  var __exports__;
  var Exception = __dependency1__;

  function LocationInfo(locInfo){
    locInfo = locInfo || {};
    this.firstLine   = locInfo.first_line;
    this.firstColumn = locInfo.first_column;
    this.lastColumn  = locInfo.last_column;
    this.lastLine    = locInfo.last_line;
  }

  var AST = {
    ProgramNode: function(statements, inverseStrip, inverse, locInfo) {
      var inverseLocationInfo, firstInverseNode;
      if (arguments.length === 3) {
        locInfo = inverse;
        inverse = null;
      } else if (arguments.length === 2) {
        locInfo = inverseStrip;
        inverseStrip = null;
      }

      LocationInfo.call(this, locInfo);
      this.type = "program";
      this.statements = statements;
      this.strip = {};

      if(inverse) {
        firstInverseNode = inverse[0];
        if (firstInverseNode) {
          inverseLocationInfo = {
            first_line: firstInverseNode.firstLine,
            last_line: firstInverseNode.lastLine,
            last_column: firstInverseNode.lastColumn,
            first_column: firstInverseNode.firstColumn
          };
          this.inverse = new AST.ProgramNode(inverse, inverseStrip, inverseLocationInfo);
        } else {
          this.inverse = new AST.ProgramNode(inverse, inverseStrip);
        }
        this.strip.right = inverseStrip.left;
      } else if (inverseStrip) {
        this.strip.left = inverseStrip.right;
      }
    },

    MustacheNode: function(rawParams, hash, open, strip, locInfo) {
      LocationInfo.call(this, locInfo);
      this.type = "mustache";
      this.strip = strip;

      // Open may be a string parsed from the parser or a passed boolean flag
      if (open != null && open.charAt) {
        // Must use charAt to support IE pre-10
        var escapeFlag = open.charAt(3) || open.charAt(2);
        this.escaped = escapeFlag !== '{' && escapeFlag !== '&';
      } else {
        this.escaped = !!open;
      }

      if (rawParams instanceof AST.SexprNode) {
        this.sexpr = rawParams;
      } else {
        // Support old AST API
        this.sexpr = new AST.SexprNode(rawParams, hash);
      }

      this.sexpr.isRoot = true;

      // Support old AST API that stored this info in MustacheNode
      this.id = this.sexpr.id;
      this.params = this.sexpr.params;
      this.hash = this.sexpr.hash;
      this.eligibleHelper = this.sexpr.eligibleHelper;
      this.isHelper = this.sexpr.isHelper;
    },

    SexprNode: function(rawParams, hash, locInfo) {
      LocationInfo.call(this, locInfo);

      this.type = "sexpr";
      this.hash = hash;

      var id = this.id = rawParams[0];
      var params = this.params = rawParams.slice(1);

      // a mustache is an eligible helper if:
      // * its id is simple (a single part, not `this` or `..`)
      var eligibleHelper = this.eligibleHelper = id.isSimple;

      // a mustache is definitely a helper if:
      // * it is an eligible helper, and
      // * it has at least one parameter or hash segment
      this.isHelper = eligibleHelper && (params.length || hash);

      // if a mustache is an eligible helper but not a definite
      // helper, it is ambiguous, and will be resolved in a later
      // pass or at runtime.
    },

    PartialNode: function(partialName, context, strip, locInfo) {
      LocationInfo.call(this, locInfo);
      this.type         = "partial";
      this.partialName  = partialName;
      this.context      = context;
      this.strip = strip;
    },

    BlockNode: function(mustache, program, inverse, close, locInfo) {
      LocationInfo.call(this, locInfo);

      if(mustache.sexpr.id.original !== close.path.original) {
        throw new Exception(mustache.sexpr.id.original + " doesn't match " + close.path.original, this);
      }

      this.type = 'block';
      this.mustache = mustache;
      this.program  = program;
      this.inverse  = inverse;

      this.strip = {
        left: mustache.strip.left,
        right: close.strip.right
      };

      (program || inverse).strip.left = mustache.strip.right;
      (inverse || program).strip.right = close.strip.left;

      if (inverse && !program) {
        this.isInverse = true;
      }
    },

    ContentNode: function(string, locInfo) {
      LocationInfo.call(this, locInfo);
      this.type = "content";
      this.string = string;
    },

    HashNode: function(pairs, locInfo) {
      LocationInfo.call(this, locInfo);
      this.type = "hash";
      this.pairs = pairs;
    },

    IdNode: function(parts, locInfo) {
      LocationInfo.call(this, locInfo);
      this.type = "ID";

      var original = "",
          dig = [],
          depth = 0;

      for(var i=0,l=parts.length; i<l; i++) {
        var part = parts[i].part;
        original += (parts[i].separator || '') + part;

        if (part === ".." || part === "." || part === "this") {
          if (dig.length > 0) {
            throw new Exception("Invalid path: " + original, this);
          } else if (part === "..") {
            depth++;
          } else {
            this.isScoped = true;
          }
        } else {
          dig.push(part);
        }
      }

      this.original = original;
      this.parts    = dig;
      this.string   = dig.join('.');
      this.depth    = depth;

      // an ID is simple if it only has one part, and that part is not
      // `..` or `this`.
      this.isSimple = parts.length === 1 && !this.isScoped && depth === 0;

      this.stringModeValue = this.string;
    },

    PartialNameNode: function(name, locInfo) {
      LocationInfo.call(this, locInfo);
      this.type = "PARTIAL_NAME";
      this.name = name.original;
    },

    DataNode: function(id, locInfo) {
      LocationInfo.call(this, locInfo);
      this.type = "DATA";
      this.id = id;
    },

    StringNode: function(string, locInfo) {
      LocationInfo.call(this, locInfo);
      this.type = "STRING";
      this.original =
        this.string =
        this.stringModeValue = string;
    },

    IntegerNode: function(integer, locInfo) {
      LocationInfo.call(this, locInfo);
      this.type = "INTEGER";
      this.original =
        this.integer = integer;
      this.stringModeValue = Number(integer);
    },

    BooleanNode: function(bool, locInfo) {
      LocationInfo.call(this, locInfo);
      this.type = "BOOLEAN";
      this.bool = bool;
      this.stringModeValue = bool === "true";
    },

    CommentNode: function(comment, locInfo) {
      LocationInfo.call(this, locInfo);
      this.type = "comment";
      this.comment = comment;
    }
  };

  // Must be exported as an object rather than the root of the module as the jison lexer
  // most modify the object to operate properly.
  __exports__ = AST;
  return __exports__;
})(__module5__);

// handlebars/compiler/parser.js
var __module9__ = (function() {
  
  var __exports__;
  /* jshint ignore:start */
  /* Jison generated parser */
  var handlebars = (function(){
  var parser = {trace: function trace() { },
  yy: {},
  symbols_: {"error":2,"root":3,"statements":4,"EOF":5,"program":6,"simpleInverse":7,"statement":8,"openInverse":9,"closeBlock":10,"openBlock":11,"mustache":12,"partial":13,"CONTENT":14,"COMMENT":15,"OPEN_BLOCK":16,"sexpr":17,"CLOSE":18,"OPEN_INVERSE":19,"OPEN_ENDBLOCK":20,"path":21,"OPEN":22,"OPEN_UNESCAPED":23,"CLOSE_UNESCAPED":24,"OPEN_PARTIAL":25,"partialName":26,"partial_option0":27,"sexpr_repetition0":28,"sexpr_option0":29,"dataName":30,"param":31,"STRING":32,"INTEGER":33,"BOOLEAN":34,"OPEN_SEXPR":35,"CLOSE_SEXPR":36,"hash":37,"hash_repetition_plus0":38,"hashSegment":39,"ID":40,"EQUALS":41,"DATA":42,"pathSegments":43,"SEP":44,"$accept":0,"$end":1},
  terminals_: {2:"error",5:"EOF",14:"CONTENT",15:"COMMENT",16:"OPEN_BLOCK",18:"CLOSE",19:"OPEN_INVERSE",20:"OPEN_ENDBLOCK",22:"OPEN",23:"OPEN_UNESCAPED",24:"CLOSE_UNESCAPED",25:"OPEN_PARTIAL",32:"STRING",33:"INTEGER",34:"BOOLEAN",35:"OPEN_SEXPR",36:"CLOSE_SEXPR",40:"ID",41:"EQUALS",42:"DATA",44:"SEP"},
  productions_: [0,[3,2],[3,1],[6,2],[6,3],[6,2],[6,1],[6,1],[6,0],[4,1],[4,2],[8,3],[8,3],[8,1],[8,1],[8,1],[8,1],[11,3],[9,3],[10,3],[12,3],[12,3],[13,4],[7,2],[17,3],[17,1],[31,1],[31,1],[31,1],[31,1],[31,1],[31,3],[37,1],[39,3],[26,1],[26,1],[26,1],[30,2],[21,1],[43,3],[43,1],[27,0],[27,1],[28,0],[28,2],[29,0],[29,1],[38,1],[38,2]],
  performAction: function anonymous(yytext,yyleng,yylineno,yy,yystate,$$,_$) {

  var $0 = $$.length - 1;
  switch (yystate) {
  case 1: return new yy.ProgramNode($$[$0-1], this._$); 
  break;
  case 2: return new yy.ProgramNode([], this._$); 
  break;
  case 3:this.$ = new yy.ProgramNode([], $$[$0-1], $$[$0], this._$);
  break;
  case 4:this.$ = new yy.ProgramNode($$[$0-2], $$[$0-1], $$[$0], this._$);
  break;
  case 5:this.$ = new yy.ProgramNode($$[$0-1], $$[$0], [], this._$);
  break;
  case 6:this.$ = new yy.ProgramNode($$[$0], this._$);
  break;
  case 7:this.$ = new yy.ProgramNode([], this._$);
  break;
  case 8:this.$ = new yy.ProgramNode([], this._$);
  break;
  case 9:this.$ = [$$[$0]];
  break;
  case 10: $$[$0-1].push($$[$0]); this.$ = $$[$0-1]; 
  break;
  case 11:this.$ = new yy.BlockNode($$[$0-2], $$[$0-1].inverse, $$[$0-1], $$[$0], this._$);
  break;
  case 12:this.$ = new yy.BlockNode($$[$0-2], $$[$0-1], $$[$0-1].inverse, $$[$0], this._$);
  break;
  case 13:this.$ = $$[$0];
  break;
  case 14:this.$ = $$[$0];
  break;
  case 15:this.$ = new yy.ContentNode($$[$0], this._$);
  break;
  case 16:this.$ = new yy.CommentNode($$[$0], this._$);
  break;
  case 17:this.$ = new yy.MustacheNode($$[$0-1], null, $$[$0-2], stripFlags($$[$0-2], $$[$0]), this._$);
  break;
  case 18:this.$ = new yy.MustacheNode($$[$0-1], null, $$[$0-2], stripFlags($$[$0-2], $$[$0]), this._$);
  break;
  case 19:this.$ = {path: $$[$0-1], strip: stripFlags($$[$0-2], $$[$0])};
  break;
  case 20:this.$ = new yy.MustacheNode($$[$0-1], null, $$[$0-2], stripFlags($$[$0-2], $$[$0]), this._$);
  break;
  case 21:this.$ = new yy.MustacheNode($$[$0-1], null, $$[$0-2], stripFlags($$[$0-2], $$[$0]), this._$);
  break;
  case 22:this.$ = new yy.PartialNode($$[$0-2], $$[$0-1], stripFlags($$[$0-3], $$[$0]), this._$);
  break;
  case 23:this.$ = stripFlags($$[$0-1], $$[$0]);
  break;
  case 24:this.$ = new yy.SexprNode([$$[$0-2]].concat($$[$0-1]), $$[$0], this._$);
  break;
  case 25:this.$ = new yy.SexprNode([$$[$0]], null, this._$);
  break;
  case 26:this.$ = $$[$0];
  break;
  case 27:this.$ = new yy.StringNode($$[$0], this._$);
  break;
  case 28:this.$ = new yy.IntegerNode($$[$0], this._$);
  break;
  case 29:this.$ = new yy.BooleanNode($$[$0], this._$);
  break;
  case 30:this.$ = $$[$0];
  break;
  case 31:$$[$0-1].isHelper = true; this.$ = $$[$0-1];
  break;
  case 32:this.$ = new yy.HashNode($$[$0], this._$);
  break;
  case 33:this.$ = [$$[$0-2], $$[$0]];
  break;
  case 34:this.$ = new yy.PartialNameNode($$[$0], this._$);
  break;
  case 35:this.$ = new yy.PartialNameNode(new yy.StringNode($$[$0], this._$), this._$);
  break;
  case 36:this.$ = new yy.PartialNameNode(new yy.IntegerNode($$[$0], this._$));
  break;
  case 37:this.$ = new yy.DataNode($$[$0], this._$);
  break;
  case 38:this.$ = new yy.IdNode($$[$0], this._$);
  break;
  case 39: $$[$0-2].push({part: $$[$0], separator: $$[$0-1]}); this.$ = $$[$0-2]; 
  break;
  case 40:this.$ = [{part: $$[$0]}];
  break;
  case 43:this.$ = [];
  break;
  case 44:$$[$0-1].push($$[$0]);
  break;
  case 47:this.$ = [$$[$0]];
  break;
  case 48:$$[$0-1].push($$[$0]);
  break;
  }
  },
  table: [{3:1,4:2,5:[1,3],8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],22:[1,13],23:[1,14],25:[1,15]},{1:[3]},{5:[1,16],8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],22:[1,13],23:[1,14],25:[1,15]},{1:[2,2]},{5:[2,9],14:[2,9],15:[2,9],16:[2,9],19:[2,9],20:[2,9],22:[2,9],23:[2,9],25:[2,9]},{4:20,6:18,7:19,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,21],20:[2,8],22:[1,13],23:[1,14],25:[1,15]},{4:20,6:22,7:19,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,21],20:[2,8],22:[1,13],23:[1,14],25:[1,15]},{5:[2,13],14:[2,13],15:[2,13],16:[2,13],19:[2,13],20:[2,13],22:[2,13],23:[2,13],25:[2,13]},{5:[2,14],14:[2,14],15:[2,14],16:[2,14],19:[2,14],20:[2,14],22:[2,14],23:[2,14],25:[2,14]},{5:[2,15],14:[2,15],15:[2,15],16:[2,15],19:[2,15],20:[2,15],22:[2,15],23:[2,15],25:[2,15]},{5:[2,16],14:[2,16],15:[2,16],16:[2,16],19:[2,16],20:[2,16],22:[2,16],23:[2,16],25:[2,16]},{17:23,21:24,30:25,40:[1,28],42:[1,27],43:26},{17:29,21:24,30:25,40:[1,28],42:[1,27],43:26},{17:30,21:24,30:25,40:[1,28],42:[1,27],43:26},{17:31,21:24,30:25,40:[1,28],42:[1,27],43:26},{21:33,26:32,32:[1,34],33:[1,35],40:[1,28],43:26},{1:[2,1]},{5:[2,10],14:[2,10],15:[2,10],16:[2,10],19:[2,10],20:[2,10],22:[2,10],23:[2,10],25:[2,10]},{10:36,20:[1,37]},{4:38,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,7],22:[1,13],23:[1,14],25:[1,15]},{7:39,8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,21],20:[2,6],22:[1,13],23:[1,14],25:[1,15]},{17:23,18:[1,40],21:24,30:25,40:[1,28],42:[1,27],43:26},{10:41,20:[1,37]},{18:[1,42]},{18:[2,43],24:[2,43],28:43,32:[2,43],33:[2,43],34:[2,43],35:[2,43],36:[2,43],40:[2,43],42:[2,43]},{18:[2,25],24:[2,25],36:[2,25]},{18:[2,38],24:[2,38],32:[2,38],33:[2,38],34:[2,38],35:[2,38],36:[2,38],40:[2,38],42:[2,38],44:[1,44]},{21:45,40:[1,28],43:26},{18:[2,40],24:[2,40],32:[2,40],33:[2,40],34:[2,40],35:[2,40],36:[2,40],40:[2,40],42:[2,40],44:[2,40]},{18:[1,46]},{18:[1,47]},{24:[1,48]},{18:[2,41],21:50,27:49,40:[1,28],43:26},{18:[2,34],40:[2,34]},{18:[2,35],40:[2,35]},{18:[2,36],40:[2,36]},{5:[2,11],14:[2,11],15:[2,11],16:[2,11],19:[2,11],20:[2,11],22:[2,11],23:[2,11],25:[2,11]},{21:51,40:[1,28],43:26},{8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,3],22:[1,13],23:[1,14],25:[1,15]},{4:52,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,5],22:[1,13],23:[1,14],25:[1,15]},{14:[2,23],15:[2,23],16:[2,23],19:[2,23],20:[2,23],22:[2,23],23:[2,23],25:[2,23]},{5:[2,12],14:[2,12],15:[2,12],16:[2,12],19:[2,12],20:[2,12],22:[2,12],23:[2,12],25:[2,12]},{14:[2,18],15:[2,18],16:[2,18],19:[2,18],20:[2,18],22:[2,18],23:[2,18],25:[2,18]},{18:[2,45],21:56,24:[2,45],29:53,30:60,31:54,32:[1,57],33:[1,58],34:[1,59],35:[1,61],36:[2,45],37:55,38:62,39:63,40:[1,64],42:[1,27],43:26},{40:[1,65]},{18:[2,37],24:[2,37],32:[2,37],33:[2,37],34:[2,37],35:[2,37],36:[2,37],40:[2,37],42:[2,37]},{14:[2,17],15:[2,17],16:[2,17],19:[2,17],20:[2,17],22:[2,17],23:[2,17],25:[2,17]},{5:[2,20],14:[2,20],15:[2,20],16:[2,20],19:[2,20],20:[2,20],22:[2,20],23:[2,20],25:[2,20]},{5:[2,21],14:[2,21],15:[2,21],16:[2,21],19:[2,21],20:[2,21],22:[2,21],23:[2,21],25:[2,21]},{18:[1,66]},{18:[2,42]},{18:[1,67]},{8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,4],22:[1,13],23:[1,14],25:[1,15]},{18:[2,24],24:[2,24],36:[2,24]},{18:[2,44],24:[2,44],32:[2,44],33:[2,44],34:[2,44],35:[2,44],36:[2,44],40:[2,44],42:[2,44]},{18:[2,46],24:[2,46],36:[2,46]},{18:[2,26],24:[2,26],32:[2,26],33:[2,26],34:[2,26],35:[2,26],36:[2,26],40:[2,26],42:[2,26]},{18:[2,27],24:[2,27],32:[2,27],33:[2,27],34:[2,27],35:[2,27],36:[2,27],40:[2,27],42:[2,27]},{18:[2,28],24:[2,28],32:[2,28],33:[2,28],34:[2,28],35:[2,28],36:[2,28],40:[2,28],42:[2,28]},{18:[2,29],24:[2,29],32:[2,29],33:[2,29],34:[2,29],35:[2,29],36:[2,29],40:[2,29],42:[2,29]},{18:[2,30],24:[2,30],32:[2,30],33:[2,30],34:[2,30],35:[2,30],36:[2,30],40:[2,30],42:[2,30]},{17:68,21:24,30:25,40:[1,28],42:[1,27],43:26},{18:[2,32],24:[2,32],36:[2,32],39:69,40:[1,70]},{18:[2,47],24:[2,47],36:[2,47],40:[2,47]},{18:[2,40],24:[2,40],32:[2,40],33:[2,40],34:[2,40],35:[2,40],36:[2,40],40:[2,40],41:[1,71],42:[2,40],44:[2,40]},{18:[2,39],24:[2,39],32:[2,39],33:[2,39],34:[2,39],35:[2,39],36:[2,39],40:[2,39],42:[2,39],44:[2,39]},{5:[2,22],14:[2,22],15:[2,22],16:[2,22],19:[2,22],20:[2,22],22:[2,22],23:[2,22],25:[2,22]},{5:[2,19],14:[2,19],15:[2,19],16:[2,19],19:[2,19],20:[2,19],22:[2,19],23:[2,19],25:[2,19]},{36:[1,72]},{18:[2,48],24:[2,48],36:[2,48],40:[2,48]},{41:[1,71]},{21:56,30:60,31:73,32:[1,57],33:[1,58],34:[1,59],35:[1,61],40:[1,28],42:[1,27],43:26},{18:[2,31],24:[2,31],32:[2,31],33:[2,31],34:[2,31],35:[2,31],36:[2,31],40:[2,31],42:[2,31]},{18:[2,33],24:[2,33],36:[2,33],40:[2,33]}],
  defaultActions: {3:[2,2],16:[2,1],50:[2,42]},
  parseError: function parseError(str, hash) {
      throw new Error(str);
  },
  parse: function parse(input) {
      var self = this, stack = [0], vstack = [null], lstack = [], table = this.table, yytext = "", yylineno = 0, yyleng = 0, recovering = 0, TERROR = 2, EOF = 1;
      this.lexer.setInput(input);
      this.lexer.yy = this.yy;
      this.yy.lexer = this.lexer;
      this.yy.parser = this;
      if (typeof this.lexer.yylloc == "undefined")
          this.lexer.yylloc = {};
      var yyloc = this.lexer.yylloc;
      lstack.push(yyloc);
      var ranges = this.lexer.options && this.lexer.options.ranges;
      if (typeof this.yy.parseError === "function")
          this.parseError = this.yy.parseError;
      function popStack(n) {
          stack.length = stack.length - 2 * n;
          vstack.length = vstack.length - n;
          lstack.length = lstack.length - n;
      }
      function lex() {
          var token;
          token = self.lexer.lex() || 1;
          if (typeof token !== "number") {
              token = self.symbols_[token] || token;
          }
          return token;
      }
      var symbol, preErrorSymbol, state, action, a, r, yyval = {}, p, len, newState, expected;
      while (true) {
          state = stack[stack.length - 1];
          if (this.defaultActions[state]) {
              action = this.defaultActions[state];
          } else {
              if (symbol === null || typeof symbol == "undefined") {
                  symbol = lex();
              }
              action = table[state] && table[state][symbol];
          }
          if (typeof action === "undefined" || !action.length || !action[0]) {
              var errStr = "";
              if (!recovering) {
                  expected = [];
                  for (p in table[state])
                      if (this.terminals_[p] && p > 2) {
                          expected.push("'" + this.terminals_[p] + "'");
                      }
                  if (this.lexer.showPosition) {
                      errStr = "Parse error on line " + (yylineno + 1) + ":\n" + this.lexer.showPosition() + "\nExpecting " + expected.join(", ") + ", got '" + (this.terminals_[symbol] || symbol) + "'";
                  } else {
                      errStr = "Parse error on line " + (yylineno + 1) + ": Unexpected " + (symbol == 1?"end of input":"'" + (this.terminals_[symbol] || symbol) + "'");
                  }
                  this.parseError(errStr, {text: this.lexer.match, token: this.terminals_[symbol] || symbol, line: this.lexer.yylineno, loc: yyloc, expected: expected});
              }
          }
          if (action[0] instanceof Array && action.length > 1) {
              throw new Error("Parse Error: multiple actions possible at state: " + state + ", token: " + symbol);
          }
          switch (action[0]) {
          case 1:
              stack.push(symbol);
              vstack.push(this.lexer.yytext);
              lstack.push(this.lexer.yylloc);
              stack.push(action[1]);
              symbol = null;
              if (!preErrorSymbol) {
                  yyleng = this.lexer.yyleng;
                  yytext = this.lexer.yytext;
                  yylineno = this.lexer.yylineno;
                  yyloc = this.lexer.yylloc;
                  if (recovering > 0)
                      recovering--;
              } else {
                  symbol = preErrorSymbol;
                  preErrorSymbol = null;
              }
              break;
          case 2:
              len = this.productions_[action[1]][1];
              yyval.$ = vstack[vstack.length - len];
              yyval._$ = {first_line: lstack[lstack.length - (len || 1)].first_line, last_line: lstack[lstack.length - 1].last_line, first_column: lstack[lstack.length - (len || 1)].first_column, last_column: lstack[lstack.length - 1].last_column};
              if (ranges) {
                  yyval._$.range = [lstack[lstack.length - (len || 1)].range[0], lstack[lstack.length - 1].range[1]];
              }
              r = this.performAction.call(yyval, yytext, yyleng, yylineno, this.yy, action[1], vstack, lstack);
              if (typeof r !== "undefined") {
                  return r;
              }
              if (len) {
                  stack = stack.slice(0, -1 * len * 2);
                  vstack = vstack.slice(0, -1 * len);
                  lstack = lstack.slice(0, -1 * len);
              }
              stack.push(this.productions_[action[1]][0]);
              vstack.push(yyval.$);
              lstack.push(yyval._$);
              newState = table[stack[stack.length - 2]][stack[stack.length - 1]];
              stack.push(newState);
              break;
          case 3:
              return true;
          }
      }
      return true;
  }
  };


  function stripFlags(open, close) {
    return {
      left: open.charAt(2) === '~',
      right: close.charAt(0) === '~' || close.charAt(1) === '~'
    };
  }

  /* Jison generated lexer */
  var lexer = (function(){
  var lexer = ({EOF:1,
  parseError:function parseError(str, hash) {
          if (this.yy.parser) {
              this.yy.parser.parseError(str, hash);
          } else {
              throw new Error(str);
          }
      },
  setInput:function (input) {
          this._input = input;
          this._more = this._less = this.done = false;
          this.yylineno = this.yyleng = 0;
          this.yytext = this.matched = this.match = '';
          this.conditionStack = ['INITIAL'];
          this.yylloc = {first_line:1,first_column:0,last_line:1,last_column:0};
          if (this.options.ranges) this.yylloc.range = [0,0];
          this.offset = 0;
          return this;
      },
  input:function () {
          var ch = this._input[0];
          this.yytext += ch;
          this.yyleng++;
          this.offset++;
          this.match += ch;
          this.matched += ch;
          var lines = ch.match(/(?:\r\n?|\n).*/g);
          if (lines) {
              this.yylineno++;
              this.yylloc.last_line++;
          } else {
              this.yylloc.last_column++;
          }
          if (this.options.ranges) this.yylloc.range[1]++;

          this._input = this._input.slice(1);
          return ch;
      },
  unput:function (ch) {
          var len = ch.length;
          var lines = ch.split(/(?:\r\n?|\n)/g);

          this._input = ch + this._input;
          this.yytext = this.yytext.substr(0, this.yytext.length-len-1);
          //this.yyleng -= len;
          this.offset -= len;
          var oldLines = this.match.split(/(?:\r\n?|\n)/g);
          this.match = this.match.substr(0, this.match.length-1);
          this.matched = this.matched.substr(0, this.matched.length-1);

          if (lines.length-1) this.yylineno -= lines.length-1;
          var r = this.yylloc.range;

          this.yylloc = {first_line: this.yylloc.first_line,
            last_line: this.yylineno+1,
            first_column: this.yylloc.first_column,
            last_column: lines ?
                (lines.length === oldLines.length ? this.yylloc.first_column : 0) + oldLines[oldLines.length - lines.length].length - lines[0].length:
                this.yylloc.first_column - len
            };

          if (this.options.ranges) {
              this.yylloc.range = [r[0], r[0] + this.yyleng - len];
          }
          return this;
      },
  more:function () {
          this._more = true;
          return this;
      },
  less:function (n) {
          this.unput(this.match.slice(n));
      },
  pastInput:function () {
          var past = this.matched.substr(0, this.matched.length - this.match.length);
          return (past.length > 20 ? '...':'') + past.substr(-20).replace(/\n/g, "");
      },
  upcomingInput:function () {
          var next = this.match;
          if (next.length < 20) {
              next += this._input.substr(0, 20-next.length);
          }
          return (next.substr(0,20)+(next.length > 20 ? '...':'')).replace(/\n/g, "");
      },
  showPosition:function () {
          var pre = this.pastInput();
          var c = new Array(pre.length + 1).join("-");
          return pre + this.upcomingInput() + "\n" + c+"^";
      },
  next:function () {
          if (this.done) {
              return this.EOF;
          }
          if (!this._input) this.done = true;

          var token,
              match,
              tempMatch,
              index,
              col,
              lines;
          if (!this._more) {
              this.yytext = '';
              this.match = '';
          }
          var rules = this._currentRules();
          for (var i=0;i < rules.length; i++) {
              tempMatch = this._input.match(this.rules[rules[i]]);
              if (tempMatch && (!match || tempMatch[0].length > match[0].length)) {
                  match = tempMatch;
                  index = i;
                  if (!this.options.flex) break;
              }
          }
          if (match) {
              lines = match[0].match(/(?:\r\n?|\n).*/g);
              if (lines) this.yylineno += lines.length;
              this.yylloc = {first_line: this.yylloc.last_line,
                             last_line: this.yylineno+1,
                             first_column: this.yylloc.last_column,
                             last_column: lines ? lines[lines.length-1].length-lines[lines.length-1].match(/\r?\n?/)[0].length : this.yylloc.last_column + match[0].length};
              this.yytext += match[0];
              this.match += match[0];
              this.matches = match;
              this.yyleng = this.yytext.length;
              if (this.options.ranges) {
                  this.yylloc.range = [this.offset, this.offset += this.yyleng];
              }
              this._more = false;
              this._input = this._input.slice(match[0].length);
              this.matched += match[0];
              token = this.performAction.call(this, this.yy, this, rules[index],this.conditionStack[this.conditionStack.length-1]);
              if (this.done && this._input) this.done = false;
              if (token) return token;
              else return;
          }
          if (this._input === "") {
              return this.EOF;
          } else {
              return this.parseError('Lexical error on line '+(this.yylineno+1)+'. Unrecognized text.\n'+this.showPosition(),
                      {text: "", token: null, line: this.yylineno});
          }
      },
  lex:function lex() {
          var r = this.next();
          if (typeof r !== 'undefined') {
              return r;
          } else {
              return this.lex();
          }
      },
  begin:function begin(condition) {
          this.conditionStack.push(condition);
      },
  popState:function popState() {
          return this.conditionStack.pop();
      },
  _currentRules:function _currentRules() {
          return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules;
      },
  topState:function () {
          return this.conditionStack[this.conditionStack.length-2];
      },
  pushState:function begin(condition) {
          this.begin(condition);
      }});
  lexer.options = {};
  lexer.performAction = function anonymous(yy,yy_,$avoiding_name_collisions,YY_START) {


  function strip(start, end) {
    return yy_.yytext = yy_.yytext.substr(start, yy_.yyleng-end);
  }


  var YYSTATE=YY_START
  switch($avoiding_name_collisions) {
  case 0:
                                     if(yy_.yytext.slice(-2) === "\\\\") {
                                       strip(0,1);
                                       this.begin("mu");
                                     } else if(yy_.yytext.slice(-1) === "\\") {
                                       strip(0,1);
                                       this.begin("emu");
                                     } else {
                                       this.begin("mu");
                                     }
                                     if(yy_.yytext) return 14;
                                   
  break;
  case 1:return 14;
  break;
  case 2:
                                     this.popState();
                                     return 14;
                                   
  break;
  case 3:strip(0,4); this.popState(); return 15;
  break;
  case 4:return 35;
  break;
  case 5:return 36;
  break;
  case 6:return 25;
  break;
  case 7:return 16;
  break;
  case 8:return 20;
  break;
  case 9:return 19;
  break;
  case 10:return 19;
  break;
  case 11:return 23;
  break;
  case 12:return 22;
  break;
  case 13:this.popState(); this.begin('com');
  break;
  case 14:strip(3,5); this.popState(); return 15;
  break;
  case 15:return 22;
  break;
  case 16:return 41;
  break;
  case 17:return 40;
  break;
  case 18:return 40;
  break;
  case 19:return 44;
  break;
  case 20:// ignore whitespace
  break;
  case 21:this.popState(); return 24;
  break;
  case 22:this.popState(); return 18;
  break;
  case 23:yy_.yytext = strip(1,2).replace(/\\"/g,'"'); return 32;
  break;
  case 24:yy_.yytext = strip(1,2).replace(/\\'/g,"'"); return 32;
  break;
  case 25:return 42;
  break;
  case 26:return 34;
  break;
  case 27:return 34;
  break;
  case 28:return 33;
  break;
  case 29:return 40;
  break;
  case 30:yy_.yytext = strip(1,2); return 40;
  break;
  case 31:return 'INVALID';
  break;
  case 32:return 5;
  break;
  }
  };
  lexer.rules = [/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|\\\{\{|\\\\\{\{|$)))/,/^(?:[\s\S]*?--\}\})/,/^(?:\()/,/^(?:\))/,/^(?:\{\{(~)?>)/,/^(?:\{\{(~)?#)/,/^(?:\{\{(~)?\/)/,/^(?:\{\{(~)?\^)/,/^(?:\{\{(~)?\s*else\b)/,/^(?:\{\{(~)?\{)/,/^(?:\{\{(~)?&)/,/^(?:\{\{!--)/,/^(?:\{\{![\s\S]*?\}\})/,/^(?:\{\{(~)?)/,/^(?:=)/,/^(?:\.\.)/,/^(?:\.(?=([=~}\s\/.)])))/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}(~)?\}\})/,/^(?:(~)?\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=([~}\s)])))/,/^(?:false(?=([~}\s)])))/,/^(?:-?[0-9]+(?=([~}\s)])))/,/^(?:([^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=([=~}\s\/.)]))))/,/^(?:\[[^\]]*\])/,/^(?:.)/,/^(?:$)/];
  lexer.conditions = {"mu":{"rules":[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32],"inclusive":false},"emu":{"rules":[2],"inclusive":false},"com":{"rules":[3],"inclusive":false},"INITIAL":{"rules":[0,1,32],"inclusive":true}};
  return lexer;})()
  parser.lexer = lexer;
  function Parser () { this.yy = {}; }Parser.prototype = parser;parser.Parser = Parser;
  return new Parser;
  })();__exports__ = handlebars;
  /* jshint ignore:end */
  return __exports__;
})();

// handlebars/compiler/base.js
var __module8__ = (function(__dependency1__, __dependency2__) {
  
  var __exports__ = {};
  var parser = __dependency1__;
  var AST = __dependency2__;

  __exports__.parser = parser;

  function parse(input) {
    // Just return if an already-compile AST was passed in.
    if(input.constructor === AST.ProgramNode) { return input; }

    parser.yy = AST;
    return parser.parse(input);
  }

  __exports__.parse = parse;
  return __exports__;
})(__module9__, __module7__);

// handlebars/compiler/compiler.js
var __module10__ = (function(__dependency1__) {
  
  var __exports__ = {};
  var Exception = __dependency1__;

  function Compiler() {}

  __exports__.Compiler = Compiler;// the foundHelper register will disambiguate helper lookup from finding a
  // function in a context. This is necessary for mustache compatibility, which
  // requires that context functions in blocks are evaluated by blockHelperMissing,
  // and then proceed as if the resulting value was provided to blockHelperMissing.

  Compiler.prototype = {
    compiler: Compiler,

    disassemble: function() {
      var opcodes = this.opcodes, opcode, out = [], params, param;

      for (var i=0, l=opcodes.length; i<l; i++) {
        opcode = opcodes[i];

        if (opcode.opcode === 'DECLARE') {
          out.push("DECLARE " + opcode.name + "=" + opcode.value);
        } else {
          params = [];
          for (var j=0; j<opcode.args.length; j++) {
            param = opcode.args[j];
            if (typeof param === "string") {
              param = "\"" + param.replace("\n", "\\n") + "\"";
            }
            params.push(param);
          }
          out.push(opcode.opcode + " " + params.join(" "));
        }
      }

      return out.join("\n");
    },

    equals: function(other) {
      var len = this.opcodes.length;
      if (other.opcodes.length !== len) {
        return false;
      }

      for (var i = 0; i < len; i++) {
        var opcode = this.opcodes[i],
            otherOpcode = other.opcodes[i];
        if (opcode.opcode !== otherOpcode.opcode || opcode.args.length !== otherOpcode.args.length) {
          return false;
        }
        for (var j = 0; j < opcode.args.length; j++) {
          if (opcode.args[j] !== otherOpcode.args[j]) {
            return false;
          }
        }
      }

      len = this.children.length;
      if (other.children.length !== len) {
        return false;
      }
      for (i = 0; i < len; i++) {
        if (!this.children[i].equals(other.children[i])) {
          return false;
        }
      }

      return true;
    },

    guid: 0,

    compile: function(program, options) {
      this.opcodes = [];
      this.children = [];
      this.depths = {list: []};
      this.options = options;

      // These changes will propagate to the other compiler components
      var knownHelpers = this.options.knownHelpers;
      this.options.knownHelpers = {
        'helperMissing': true,
        'blockHelperMissing': true,
        'each': true,
        'if': true,
        'unless': true,
        'with': true,
        'log': true
      };
      if (knownHelpers) {
        for (var name in knownHelpers) {
          this.options.knownHelpers[name] = knownHelpers[name];
        }
      }

      return this.accept(program);
    },

    accept: function(node) {
      var strip = node.strip || {},
          ret;
      if (strip.left) {
        this.opcode('strip');
      }

      ret = this[node.type](node);

      if (strip.right) {
        this.opcode('strip');
      }

      return ret;
    },

    program: function(program) {
      var statements = program.statements;

      for(var i=0, l=statements.length; i<l; i++) {
        this.accept(statements[i]);
      }
      this.isSimple = l === 1;

      this.depths.list = this.depths.list.sort(function(a, b) {
        return a - b;
      });

      return this;
    },

    compileProgram: function(program) {
      var result = new this.compiler().compile(program, this.options);
      var guid = this.guid++, depth;

      this.usePartial = this.usePartial || result.usePartial;

      this.children[guid] = result;

      for(var i=0, l=result.depths.list.length; i<l; i++) {
        depth = result.depths.list[i];

        if(depth < 2) { continue; }
        else { this.addDepth(depth - 1); }
      }

      return guid;
    },

    block: function(block) {
      var mustache = block.mustache,
          program = block.program,
          inverse = block.inverse;

      if (program) {
        program = this.compileProgram(program);
      }

      if (inverse) {
        inverse = this.compileProgram(inverse);
      }

      var sexpr = mustache.sexpr;
      var type = this.classifySexpr(sexpr);

      if (type === "helper") {
        this.helperSexpr(sexpr, program, inverse);
      } else if (type === "simple") {
        this.simpleSexpr(sexpr);

        // now that the simple mustache is resolved, we need to
        // evaluate it by executing `blockHelperMissing`
        this.opcode('pushProgram', program);
        this.opcode('pushProgram', inverse);
        this.opcode('emptyHash');
        this.opcode('blockValue');
      } else {
        this.ambiguousSexpr(sexpr, program, inverse);

        // now that the simple mustache is resolved, we need to
        // evaluate it by executing `blockHelperMissing`
        this.opcode('pushProgram', program);
        this.opcode('pushProgram', inverse);
        this.opcode('emptyHash');
        this.opcode('ambiguousBlockValue');
      }

      this.opcode('append');
    },

    hash: function(hash) {
      var pairs = hash.pairs, pair, val;

      this.opcode('pushHash');

      for(var i=0, l=pairs.length; i<l; i++) {
        pair = pairs[i];
        val  = pair[1];

        if (this.options.stringParams) {
          if(val.depth) {
            this.addDepth(val.depth);
          }
          this.opcode('getContext', val.depth || 0);
          this.opcode('pushStringParam', val.stringModeValue, val.type);

          if (val.type === 'sexpr') {
            // Subexpressions get evaluated and passed in
            // in string params mode.
            this.sexpr(val);
          }
        } else {
          this.accept(val);
        }

        this.opcode('assignToHash', pair[0]);
      }
      this.opcode('popHash');
    },

    partial: function(partial) {
      var partialName = partial.partialName;
      this.usePartial = true;

      if(partial.context) {
        this.ID(partial.context);
      } else {
        this.opcode('push', 'depth0');
      }

      this.opcode('invokePartial', partialName.name);
      this.opcode('append');
    },

    content: function(content) {
      this.opcode('appendContent', content.string);
    },

    mustache: function(mustache) {
      this.sexpr(mustache.sexpr);

      if(mustache.escaped && !this.options.noEscape) {
        this.opcode('appendEscaped');
      } else {
        this.opcode('append');
      }
    },

    ambiguousSexpr: function(sexpr, program, inverse) {
      var id = sexpr.id,
          name = id.parts[0],
          isBlock = program != null || inverse != null;

      this.opcode('getContext', id.depth);

      this.opcode('pushProgram', program);
      this.opcode('pushProgram', inverse);

      this.opcode('invokeAmbiguous', name, isBlock);
    },

    simpleSexpr: function(sexpr) {
      var id = sexpr.id;

      if (id.type === 'DATA') {
        this.DATA(id);
      } else if (id.parts.length) {
        this.ID(id);
      } else {
        // Simplified ID for `this`
        this.addDepth(id.depth);
        this.opcode('getContext', id.depth);
        this.opcode('pushContext');
      }

      this.opcode('resolvePossibleLambda');
    },

    helperSexpr: function(sexpr, program, inverse) {
      var params = this.setupFullMustacheParams(sexpr, program, inverse),
          name = sexpr.id.parts[0];

      if (this.options.knownHelpers[name]) {
        this.opcode('invokeKnownHelper', params.length, name);
      } else if (this.options.knownHelpersOnly) {
        throw new Exception("You specified knownHelpersOnly, but used the unknown helper " + name, sexpr);
      } else {
        this.opcode('invokeHelper', params.length, name, sexpr.isRoot);
      }
    },

    sexpr: function(sexpr) {
      var type = this.classifySexpr(sexpr);

      if (type === "simple") {
        this.simpleSexpr(sexpr);
      } else if (type === "helper") {
        this.helperSexpr(sexpr);
      } else {
        this.ambiguousSexpr(sexpr);
      }
    },

    ID: function(id) {
      this.addDepth(id.depth);
      this.opcode('getContext', id.depth);

      var name = id.parts[0];
      if (!name) {
        this.opcode('pushContext');
      } else {
        this.opcode('lookupOnContext', id.parts[0]);
      }

      for(var i=1, l=id.parts.length; i<l; i++) {
        this.opcode('lookup', id.parts[i]);
      }
    },

    DATA: function(data) {
      this.options.data = true;
      if (data.id.isScoped || data.id.depth) {
        throw new Exception('Scoped data references are not supported: ' + data.original, data);
      }

      this.opcode('lookupData');
      var parts = data.id.parts;
      for(var i=0, l=parts.length; i<l; i++) {
        this.opcode('lookup', parts[i]);
      }
    },

    STRING: function(string) {
      this.opcode('pushString', string.string);
    },

    INTEGER: function(integer) {
      this.opcode('pushLiteral', integer.integer);
    },

    BOOLEAN: function(bool) {
      this.opcode('pushLiteral', bool.bool);
    },

    comment: function() {},

    // HELPERS
    opcode: function(name) {
      this.opcodes.push({ opcode: name, args: [].slice.call(arguments, 1) });
    },

    declare: function(name, value) {
      this.opcodes.push({ opcode: 'DECLARE', name: name, value: value });
    },

    addDepth: function(depth) {
      if(depth === 0) { return; }

      if(!this.depths[depth]) {
        this.depths[depth] = true;
        this.depths.list.push(depth);
      }
    },

    classifySexpr: function(sexpr) {
      var isHelper   = sexpr.isHelper;
      var isEligible = sexpr.eligibleHelper;
      var options    = this.options;

      // if ambiguous, we can possibly resolve the ambiguity now
      if (isEligible && !isHelper) {
        var name = sexpr.id.parts[0];

        if (options.knownHelpers[name]) {
          isHelper = true;
        } else if (options.knownHelpersOnly) {
          isEligible = false;
        }
      }

      if (isHelper) { return "helper"; }
      else if (isEligible) { return "ambiguous"; }
      else { return "simple"; }
    },

    pushParams: function(params) {
      var i = params.length, param;

      while(i--) {
        param = params[i];

        if(this.options.stringParams) {
          if(param.depth) {
            this.addDepth(param.depth);
          }

          this.opcode('getContext', param.depth || 0);
          this.opcode('pushStringParam', param.stringModeValue, param.type);

          if (param.type === 'sexpr') {
            // Subexpressions get evaluated and passed in
            // in string params mode.
            this.sexpr(param);
          }
        } else {
          this[param.type](param);
        }
      }
    },

    setupFullMustacheParams: function(sexpr, program, inverse) {
      var params = sexpr.params;
      this.pushParams(params);

      this.opcode('pushProgram', program);
      this.opcode('pushProgram', inverse);

      if (sexpr.hash) {
        this.hash(sexpr.hash);
      } else {
        this.opcode('emptyHash');
      }

      return params;
    }
  };

  function precompile(input, options, env) {
    if (input == null || (typeof input !== 'string' && input.constructor !== env.AST.ProgramNode)) {
      throw new Exception("You must pass a string or Handlebars AST to Handlebars.precompile. You passed " + input);
    }

    options = options || {};
    if (!('data' in options)) {
      options.data = true;
    }

    var ast = env.parse(input);
    var environment = new env.Compiler().compile(ast, options);
    return new env.JavaScriptCompiler().compile(environment, options);
  }

  __exports__.precompile = precompile;function compile(input, options, env) {
    if (input == null || (typeof input !== 'string' && input.constructor !== env.AST.ProgramNode)) {
      throw new Exception("You must pass a string or Handlebars AST to Handlebars.compile. You passed " + input);
    }

    options = options || {};

    if (!('data' in options)) {
      options.data = true;
    }

    var compiled;

    function compileInput() {
      var ast = env.parse(input);
      var environment = new env.Compiler().compile(ast, options);
      var templateSpec = new env.JavaScriptCompiler().compile(environment, options, undefined, true);
      return env.template(templateSpec);
    }

    // Template is only compiled on first use and cached after that point.
    return function(context, options) {
      if (!compiled) {
        compiled = compileInput();
      }
      return compiled.call(this, context, options);
    };
  }

  __exports__.compile = compile;
  return __exports__;
})(__module5__);

// handlebars/compiler/javascript-compiler.js
var __module11__ = (function(__dependency1__, __dependency2__) {
  
  var __exports__;
  var COMPILER_REVISION = __dependency1__.COMPILER_REVISION;
  var REVISION_CHANGES = __dependency1__.REVISION_CHANGES;
  var log = __dependency1__.log;
  var Exception = __dependency2__;

  function Literal(value) {
    this.value = value;
  }

  function JavaScriptCompiler() {}

  JavaScriptCompiler.prototype = {
    // PUBLIC API: You can override these methods in a subclass to provide
    // alternative compiled forms for name lookup and buffering semantics
    nameLookup: function(parent, name /* , type*/) {
      var wrap,
          ret;
      if (parent.indexOf('depth') === 0) {
        wrap = true;
      }

      if (/^[0-9]+$/.test(name)) {
        ret = parent + "[" + name + "]";
      } else if (JavaScriptCompiler.isValidJavaScriptVariableName(name)) {
        ret = parent + "." + name;
      }
      else {
        ret = parent + "['" + name + "']";
      }

      if (wrap) {
        return '(' + parent + ' && ' + ret + ')';
      } else {
        return ret;
      }
    },

    compilerInfo: function() {
      var revision = COMPILER_REVISION,
          versions = REVISION_CHANGES[revision];
      return "this.compilerInfo = ["+revision+",'"+versions+"'];\n";
    },

    appendToBuffer: function(string) {
      if (this.environment.isSimple) {
        return "return " + string + ";";
      } else {
        return {
          appendToBuffer: true,
          content: string,
          toString: function() { return "buffer += " + string + ";"; }
        };
      }
    },

    initializeBuffer: function() {
      return this.quotedString("");
    },

    namespace: "Handlebars",
    // END PUBLIC API

    compile: function(environment, options, context, asObject) {
      this.environment = environment;
      this.options = options || {};

      log('debug', this.environment.disassemble() + "\n\n");

      this.name = this.environment.name;
      this.isChild = !!context;
      this.context = context || {
        programs: [],
        environments: [],
        aliases: { }
      };

      this.preamble();

      this.stackSlot = 0;
      this.stackVars = [];
      this.registers = { list: [] };
      this.hashes = [];
      this.compileStack = [];
      this.inlineStack = [];

      this.compileChildren(environment, options);

      var opcodes = environment.opcodes, opcode;

      this.i = 0;

      for(var l=opcodes.length; this.i<l; this.i++) {
        opcode = opcodes[this.i];

        if(opcode.opcode === 'DECLARE') {
          this[opcode.name] = opcode.value;
        } else {
          this[opcode.opcode].apply(this, opcode.args);
        }

        // Reset the stripNext flag if it was not set by this operation.
        if (opcode.opcode !== this.stripNext) {
          this.stripNext = false;
        }
      }

      // Flush any trailing content that might be pending.
      this.pushSource('');

      if (this.stackSlot || this.inlineStack.length || this.compileStack.length) {
        throw new Exception('Compile completed with content left on stack');
      }

      return this.createFunctionContext(asObject);
    },

    preamble: function() {
      var out = [];

      if (!this.isChild) {
        var namespace = this.namespace;

        var copies = "helpers = this.merge(helpers, " + namespace + ".helpers);";
        if (this.environment.usePartial) { copies = copies + " partials = this.merge(partials, " + namespace + ".partials);"; }
        if (this.options.data) { copies = copies + " data = data || {};"; }
        out.push(copies);
      } else {
        out.push('');
      }

      if (!this.environment.isSimple) {
        out.push(", buffer = " + this.initializeBuffer());
      } else {
        out.push("");
      }

      // track the last context pushed into place to allow skipping the
      // getContext opcode when it would be a noop
      this.lastContext = 0;
      this.source = out;
    },

    createFunctionContext: function(asObject) {
      var locals = this.stackVars.concat(this.registers.list);

      if(locals.length > 0) {
        this.source[1] = this.source[1] + ", " + locals.join(", ");
      }

      // Generate minimizer alias mappings
      if (!this.isChild) {
        for (var alias in this.context.aliases) {
          if (this.context.aliases.hasOwnProperty(alias)) {
            this.source[1] = this.source[1] + ', ' + alias + '=' + this.context.aliases[alias];
          }
        }
      }

      if (this.source[1]) {
        this.source[1] = "var " + this.source[1].substring(2) + ";";
      }

      // Merge children
      if (!this.isChild) {
        this.source[1] += '\n' + this.context.programs.join('\n') + '\n';
      }

      if (!this.environment.isSimple) {
        this.pushSource("return buffer;");
      }

      var params = this.isChild ? ["depth0", "data"] : ["Handlebars", "depth0", "helpers", "partials", "data"];

      for(var i=0, l=this.environment.depths.list.length; i<l; i++) {
        params.push("depth" + this.environment.depths.list[i]);
      }

      // Perform a second pass over the output to merge content when possible
      var source = this.mergeSource();

      if (!this.isChild) {
        source = this.compilerInfo()+source;
      }

      if (asObject) {
        params.push(source);

        return Function.apply(this, params);
      } else {
        var functionSource = 'function ' + (this.name || '') + '(' + params.join(',') + ') {\n  ' + source + '}';
        log('debug', functionSource + "\n\n");
        return functionSource;
      }
    },
    mergeSource: function() {
      // WARN: We are not handling the case where buffer is still populated as the source should
      // not have buffer append operations as their final action.
      var source = '',
          buffer;
      for (var i = 0, len = this.source.length; i < len; i++) {
        var line = this.source[i];
        if (line.appendToBuffer) {
          if (buffer) {
            buffer = buffer + '\n    + ' + line.content;
          } else {
            buffer = line.content;
          }
        } else {
          if (buffer) {
            source += 'buffer += ' + buffer + ';\n  ';
            buffer = undefined;
          }
          source += line + '\n  ';
        }
      }
      return source;
    },

    // [blockValue]
    //
    // On stack, before: hash, inverse, program, value
    // On stack, after: return value of blockHelperMissing
    //
    // The purpose of this opcode is to take a block of the form
    // `{{#foo}}...{{/foo}}`, resolve the value of `foo`, and
    // replace it on the stack with the result of properly
    // invoking blockHelperMissing.
    blockValue: function() {
      this.context.aliases.blockHelperMissing = 'helpers.blockHelperMissing';

      var params = ["depth0"];
      this.setupParams(0, params);

      this.replaceStack(function(current) {
        params.splice(1, 0, current);
        return "blockHelperMissing.call(" + params.join(", ") + ")";
      });
    },

    // [ambiguousBlockValue]
    //
    // On stack, before: hash, inverse, program, value
    // Compiler value, before: lastHelper=value of last found helper, if any
    // On stack, after, if no lastHelper: same as [blockValue]
    // On stack, after, if lastHelper: value
    ambiguousBlockValue: function() {
      this.context.aliases.blockHelperMissing = 'helpers.blockHelperMissing';

      var params = ["depth0"];
      this.setupParams(0, params);

      var current = this.topStack();
      params.splice(1, 0, current);

      this.pushSource("if (!" + this.lastHelper + ") { " + current + " = blockHelperMissing.call(" + params.join(", ") + "); }");
    },

    // [appendContent]
    //
    // On stack, before: ...
    // On stack, after: ...
    //
    // Appends the string value of `content` to the current buffer
    appendContent: function(content) {
      if (this.pendingContent) {
        content = this.pendingContent + content;
      }
      if (this.stripNext) {
        content = content.replace(/^\s+/, '');
      }

      this.pendingContent = content;
    },

    // [strip]
    //
    // On stack, before: ...
    // On stack, after: ...
    //
    // Removes any trailing whitespace from the prior content node and flags
    // the next operation for stripping if it is a content node.
    strip: function() {
      if (this.pendingContent) {
        this.pendingContent = this.pendingContent.replace(/\s+$/, '');
      }
      this.stripNext = 'strip';
    },

    // [append]
    //
    // On stack, before: value, ...
    // On stack, after: ...
    //
    // Coerces `value` to a String and appends it to the current buffer.
    //
    // If `value` is truthy, or 0, it is coerced into a string and appended
    // Otherwise, the empty string is appended
    append: function() {
      // Force anything that is inlined onto the stack so we don't have duplication
      // when we examine local
      this.flushInline();
      var local = this.popStack();
      this.pushSource("if(" + local + " || " + local + " === 0) { " + this.appendToBuffer(local) + " }");
      if (this.environment.isSimple) {
        this.pushSource("else { " + this.appendToBuffer("''") + " }");
      }
    },

    // [appendEscaped]
    //
    // On stack, before: value, ...
    // On stack, after: ...
    //
    // Escape `value` and append it to the buffer
    appendEscaped: function() {
      this.context.aliases.escapeExpression = 'this.escapeExpression';

      this.pushSource(this.appendToBuffer("escapeExpression(" + this.popStack() + ")"));
    },

    // [getContext]
    //
    // On stack, before: ...
    // On stack, after: ...
    // Compiler value, after: lastContext=depth
    //
    // Set the value of the `lastContext` compiler value to the depth
    getContext: function(depth) {
      if(this.lastContext !== depth) {
        this.lastContext = depth;
      }
    },

    // [lookupOnContext]
    //
    // On stack, before: ...
    // On stack, after: currentContext[name], ...
    //
    // Looks up the value of `name` on the current context and pushes
    // it onto the stack.
    lookupOnContext: function(name) {
      this.push(this.nameLookup('depth' + this.lastContext, name, 'context'));
    },

    // [pushContext]
    //
    // On stack, before: ...
    // On stack, after: currentContext, ...
    //
    // Pushes the value of the current context onto the stack.
    pushContext: function() {
      this.pushStackLiteral('depth' + this.lastContext);
    },

    // [resolvePossibleLambda]
    //
    // On stack, before: value, ...
    // On stack, after: resolved value, ...
    //
    // If the `value` is a lambda, replace it on the stack by
    // the return value of the lambda
    resolvePossibleLambda: function() {
      this.context.aliases.functionType = '"function"';

      this.replaceStack(function(current) {
        return "typeof " + current + " === functionType ? " + current + ".apply(depth0) : " + current;
      });
    },

    // [lookup]
    //
    // On stack, before: value, ...
    // On stack, after: value[name], ...
    //
    // Replace the value on the stack with the result of looking
    // up `name` on `value`
    lookup: function(name) {
      this.replaceStack(function(current) {
        return current + " == null || " + current + " === false ? " + current + " : " + this.nameLookup(current, name, 'context');
      });
    },

    // [lookupData]
    //
    // On stack, before: ...
    // On stack, after: data, ...
    //
    // Push the data lookup operator
    lookupData: function() {
      this.pushStackLiteral('data');
    },

    // [pushStringParam]
    //
    // On stack, before: ...
    // On stack, after: string, currentContext, ...
    //
    // This opcode is designed for use in string mode, which
    // provides the string value of a parameter along with its
    // depth rather than resolving it immediately.
    pushStringParam: function(string, type) {
      this.pushStackLiteral('depth' + this.lastContext);

      this.pushString(type);

      // If it's a subexpression, the string result
      // will be pushed after this opcode.
      if (type !== 'sexpr') {
        if (typeof string === 'string') {
          this.pushString(string);
        } else {
          this.pushStackLiteral(string);
        }
      }
    },

    emptyHash: function() {
      this.pushStackLiteral('{}');

      if (this.options.stringParams) {
        this.push('{}'); // hashContexts
        this.push('{}'); // hashTypes
      }
    },
    pushHash: function() {
      if (this.hash) {
        this.hashes.push(this.hash);
      }
      this.hash = {values: [], types: [], contexts: []};
    },
    popHash: function() {
      var hash = this.hash;
      this.hash = this.hashes.pop();

      if (this.options.stringParams) {
        this.push('{' + hash.contexts.join(',') + '}');
        this.push('{' + hash.types.join(',') + '}');
      }

      this.push('{\n    ' + hash.values.join(',\n    ') + '\n  }');
    },

    // [pushString]
    //
    // On stack, before: ...
    // On stack, after: quotedString(string), ...
    //
    // Push a quoted version of `string` onto the stack
    pushString: function(string) {
      this.pushStackLiteral(this.quotedString(string));
    },

    // [push]
    //
    // On stack, before: ...
    // On stack, after: expr, ...
    //
    // Push an expression onto the stack
    push: function(expr) {
      this.inlineStack.push(expr);
      return expr;
    },

    // [pushLiteral]
    //
    // On stack, before: ...
    // On stack, after: value, ...
    //
    // Pushes a value onto the stack. This operation prevents
    // the compiler from creating a temporary variable to hold
    // it.
    pushLiteral: function(value) {
      this.pushStackLiteral(value);
    },

    // [pushProgram]
    //
    // On stack, before: ...
    // On stack, after: program(guid), ...
    //
    // Push a program expression onto the stack. This takes
    // a compile-time guid and converts it into a runtime-accessible
    // expression.
    pushProgram: function(guid) {
      if (guid != null) {
        this.pushStackLiteral(this.programExpression(guid));
      } else {
        this.pushStackLiteral(null);
      }
    },

    // [invokeHelper]
    //
    // On stack, before: hash, inverse, program, params..., ...
    // On stack, after: result of helper invocation
    //
    // Pops off the helper's parameters, invokes the helper,
    // and pushes the helper's return value onto the stack.
    //
    // If the helper is not found, `helperMissing` is called.
    invokeHelper: function(paramSize, name, isRoot) {
      this.context.aliases.helperMissing = 'helpers.helperMissing';
      this.useRegister('helper');

      var helper = this.lastHelper = this.setupHelper(paramSize, name, true);
      var nonHelper = this.nameLookup('depth' + this.lastContext, name, 'context');

      var lookup = 'helper = ' + helper.name + ' || ' + nonHelper;
      if (helper.paramsInit) {
        lookup += ',' + helper.paramsInit;
      }

      this.push(
        '('
          + lookup
          + ',helper '
            + '? helper.call(' + helper.callParams + ') '
            + ': helperMissing.call(' + helper.helperMissingParams + '))');

      // Always flush subexpressions. This is both to prevent the compounding size issue that
      // occurs when the code has to be duplicated for inlining and also to prevent errors
      // due to the incorrect options object being passed due to the shared register.
      if (!isRoot) {
        this.flushInline();
      }
    },

    // [invokeKnownHelper]
    //
    // On stack, before: hash, inverse, program, params..., ...
    // On stack, after: result of helper invocation
    //
    // This operation is used when the helper is known to exist,
    // so a `helperMissing` fallback is not required.
    invokeKnownHelper: function(paramSize, name) {
      var helper = this.setupHelper(paramSize, name);
      this.push(helper.name + ".call(" + helper.callParams + ")");
    },

    // [invokeAmbiguous]
    //
    // On stack, before: hash, inverse, program, params..., ...
    // On stack, after: result of disambiguation
    //
    // This operation is used when an expression like `{{foo}}`
    // is provided, but we don't know at compile-time whether it
    // is a helper or a path.
    //
    // This operation emits more code than the other options,
    // and can be avoided by passing the `knownHelpers` and
    // `knownHelpersOnly` flags at compile-time.
    invokeAmbiguous: function(name, helperCall) {
      this.context.aliases.functionType = '"function"';
      this.useRegister('helper');

      this.emptyHash();
      var helper = this.setupHelper(0, name, helperCall);

      var helperName = this.lastHelper = this.nameLookup('helpers', name, 'helper');

      var nonHelper = this.nameLookup('depth' + this.lastContext, name, 'context');
      var nextStack = this.nextStack();

      if (helper.paramsInit) {
        this.pushSource(helper.paramsInit);
      }
      this.pushSource('if (helper = ' + helperName + ') { ' + nextStack + ' = helper.call(' + helper.callParams + '); }');
      this.pushSource('else { helper = ' + nonHelper + '; ' + nextStack + ' = typeof helper === functionType ? helper.call(' + helper.callParams + ') : helper; }');
    },

    // [invokePartial]
    //
    // On stack, before: context, ...
    // On stack after: result of partial invocation
    //
    // This operation pops off a context, invokes a partial with that context,
    // and pushes the result of the invocation back.
    invokePartial: function(name) {
      var params = [this.nameLookup('partials', name, 'partial'), "'" + name + "'", this.popStack(), "helpers", "partials"];

      if (this.options.data) {
        params.push("data");
      }

      this.context.aliases.self = "this";
      this.push("self.invokePartial(" + params.join(", ") + ")");
    },

    // [assignToHash]
    //
    // On stack, before: value, hash, ...
    // On stack, after: hash, ...
    //
    // Pops a value and hash off the stack, assigns `hash[key] = value`
    // and pushes the hash back onto the stack.
    assignToHash: function(key) {
      var value = this.popStack(),
          context,
          type;

      if (this.options.stringParams) {
        type = this.popStack();
        context = this.popStack();
      }

      var hash = this.hash;
      if (context) {
        hash.contexts.push("'" + key + "': " + context);
      }
      if (type) {
        hash.types.push("'" + key + "': " + type);
      }
      hash.values.push("'" + key + "': (" + value + ")");
    },

    // HELPERS

    compiler: JavaScriptCompiler,

    compileChildren: function(environment, options) {
      var children = environment.children, child, compiler;

      for(var i=0, l=children.length; i<l; i++) {
        child = children[i];
        compiler = new this.compiler();

        var index = this.matchExistingProgram(child);

        if (index == null) {
          this.context.programs.push('');     // Placeholder to prevent name conflicts for nested children
          index = this.context.programs.length;
          child.index = index;
          child.name = 'program' + index;
          this.context.programs[index] = compiler.compile(child, options, this.context);
          this.context.environments[index] = child;
        } else {
          child.index = index;
          child.name = 'program' + index;
        }
      }
    },
    matchExistingProgram: function(child) {
      for (var i = 0, len = this.context.environments.length; i < len; i++) {
        var environment = this.context.environments[i];
        if (environment && environment.equals(child)) {
          return i;
        }
      }
    },

    programExpression: function(guid) {
      this.context.aliases.self = "this";

      if(guid == null) {
        return "self.noop";
      }

      var child = this.environment.children[guid],
          depths = child.depths.list, depth;

      var programParams = [child.index, child.name, "data"];

      for(var i=0, l = depths.length; i<l; i++) {
        depth = depths[i];

        if(depth === 1) { programParams.push("depth0"); }
        else { programParams.push("depth" + (depth - 1)); }
      }

      return (depths.length === 0 ? "self.program(" : "self.programWithDepth(") + programParams.join(", ") + ")";
    },

    register: function(name, val) {
      this.useRegister(name);
      this.pushSource(name + " = " + val + ";");
    },

    useRegister: function(name) {
      if(!this.registers[name]) {
        this.registers[name] = true;
        this.registers.list.push(name);
      }
    },

    pushStackLiteral: function(item) {
      return this.push(new Literal(item));
    },

    pushSource: function(source) {
      if (this.pendingContent) {
        this.source.push(this.appendToBuffer(this.quotedString(this.pendingContent)));
        this.pendingContent = undefined;
      }

      if (source) {
        this.source.push(source);
      }
    },

    pushStack: function(item) {
      this.flushInline();

      var stack = this.incrStack();
      if (item) {
        this.pushSource(stack + " = " + item + ";");
      }
      this.compileStack.push(stack);
      return stack;
    },

    replaceStack: function(callback) {
      var prefix = '',
          inline = this.isInline(),
          stack,
          createdStack,
          usedLiteral;

      // If we are currently inline then we want to merge the inline statement into the
      // replacement statement via ','
      if (inline) {
        var top = this.popStack(true);

        if (top instanceof Literal) {
          // Literals do not need to be inlined
          stack = top.value;
          usedLiteral = true;
        } else {
          // Get or create the current stack name for use by the inline
          createdStack = !this.stackSlot;
          var name = !createdStack ? this.topStackName() : this.incrStack();

          prefix = '(' + this.push(name) + ' = ' + top + '),';
          stack = this.topStack();
        }
      } else {
        stack = this.topStack();
      }

      var item = callback.call(this, stack);

      if (inline) {
        if (!usedLiteral) {
          this.popStack();
        }
        if (createdStack) {
          this.stackSlot--;
        }
        this.push('(' + prefix + item + ')');
      } else {
        // Prevent modification of the context depth variable. Through replaceStack
        if (!/^stack/.test(stack)) {
          stack = this.nextStack();
        }

        this.pushSource(stack + " = (" + prefix + item + ");");
      }
      return stack;
    },

    nextStack: function() {
      return this.pushStack();
    },

    incrStack: function() {
      this.stackSlot++;
      if(this.stackSlot > this.stackVars.length) { this.stackVars.push("stack" + this.stackSlot); }
      return this.topStackName();
    },
    topStackName: function() {
      return "stack" + this.stackSlot;
    },
    flushInline: function() {
      var inlineStack = this.inlineStack;
      if (inlineStack.length) {
        this.inlineStack = [];
        for (var i = 0, len = inlineStack.length; i < len; i++) {
          var entry = inlineStack[i];
          if (entry instanceof Literal) {
            this.compileStack.push(entry);
          } else {
            this.pushStack(entry);
          }
        }
      }
    },
    isInline: function() {
      return this.inlineStack.length;
    },

    popStack: function(wrapped) {
      var inline = this.isInline(),
          item = (inline ? this.inlineStack : this.compileStack).pop();

      if (!wrapped && (item instanceof Literal)) {
        return item.value;
      } else {
        if (!inline) {
          if (!this.stackSlot) {
            throw new Exception('Invalid stack pop');
          }
          this.stackSlot--;
        }
        return item;
      }
    },

    topStack: function(wrapped) {
      var stack = (this.isInline() ? this.inlineStack : this.compileStack),
          item = stack[stack.length - 1];

      if (!wrapped && (item instanceof Literal)) {
        return item.value;
      } else {
        return item;
      }
    },

    quotedString: function(str) {
      return '"' + str
        .replace(/\\/g, '\\\\')
        .replace(/"/g, '\\"')
        .replace(/\n/g, '\\n')
        .replace(/\r/g, '\\r')
        .replace(/\u2028/g, '\\u2028')   // Per Ecma-262 7.3 + 7.8.4
        .replace(/\u2029/g, '\\u2029') + '"';
    },

    setupHelper: function(paramSize, name, missingParams) {
      var params = [],
          paramsInit = this.setupParams(paramSize, params, missingParams);
      var foundHelper = this.nameLookup('helpers', name, 'helper');

      return {
        params: params,
        paramsInit: paramsInit,
        name: foundHelper,
        callParams: ["depth0"].concat(params).join(", "),
        helperMissingParams: missingParams && ["depth0", this.quotedString(name)].concat(params).join(", ")
      };
    },

    setupOptions: function(paramSize, params) {
      var options = [], contexts = [], types = [], param, inverse, program;

      options.push("hash:" + this.popStack());

      if (this.options.stringParams) {
        options.push("hashTypes:" + this.popStack());
        options.push("hashContexts:" + this.popStack());
      }

      inverse = this.popStack();
      program = this.popStack();

      // Avoid setting fn and inverse if neither are set. This allows
      // helpers to do a check for `if (options.fn)`
      if (program || inverse) {
        if (!program) {
          this.context.aliases.self = "this";
          program = "self.noop";
        }

        if (!inverse) {
          this.context.aliases.self = "this";
          inverse = "self.noop";
        }

        options.push("inverse:" + inverse);
        options.push("fn:" + program);
      }

      for(var i=0; i<paramSize; i++) {
        param = this.popStack();
        params.push(param);

        if(this.options.stringParams) {
          types.push(this.popStack());
          contexts.push(this.popStack());
        }
      }

      if (this.options.stringParams) {
        options.push("contexts:[" + contexts.join(",") + "]");
        options.push("types:[" + types.join(",") + "]");
      }

      if(this.options.data) {
        options.push("data:data");
      }

      return options;
    },

    // the params and contexts arguments are passed in arrays
    // to fill in
    setupParams: function(paramSize, params, useRegister) {
      var options = '{' + this.setupOptions(paramSize, params).join(',') + '}';

      if (useRegister) {
        this.useRegister('options');
        params.push('options');
        return 'options=' + options;
      } else {
        params.push(options);
        return '';
      }
    }
  };

  var reservedWords = (
    "break else new var" +
    " case finally return void" +
    " catch for switch while" +
    " continue function this with" +
    " default if throw" +
    " delete in try" +
    " do instanceof typeof" +
    " abstract enum int short" +
    " boolean export interface static" +
    " byte extends long super" +
    " char final native synchronized" +
    " class float package throws" +
    " const goto private transient" +
    " debugger implements protected volatile" +
    " double import public let yield"
  ).split(" ");

  var compilerWords = JavaScriptCompiler.RESERVED_WORDS = {};

  for(var i=0, l=reservedWords.length; i<l; i++) {
    compilerWords[reservedWords[i]] = true;
  }

  JavaScriptCompiler.isValidJavaScriptVariableName = function(name) {
    if(!JavaScriptCompiler.RESERVED_WORDS[name] && /^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(name)) {
      return true;
    }
    return false;
  };

  __exports__ = JavaScriptCompiler;
  return __exports__;
})(__module2__, __module5__);

// handlebars.js
var __module0__ = (function(__dependency1__, __dependency2__, __dependency3__, __dependency4__, __dependency5__) {
  
  var __exports__;
  /*globals Handlebars: true */
  var Handlebars = __dependency1__;

  // Compiler imports
  var AST = __dependency2__;
  var Parser = __dependency3__.parser;
  var parse = __dependency3__.parse;
  var Compiler = __dependency4__.Compiler;
  var compile = __dependency4__.compile;
  var precompile = __dependency4__.precompile;
  var JavaScriptCompiler = __dependency5__;

  var _create = Handlebars.create;
  var create = function() {
    var hb = _create();

    hb.compile = function(input, options) {
      return compile(input, options, hb);
    };
    hb.precompile = function (input, options) {
      return precompile(input, options, hb);
    };

    hb.AST = AST;
    hb.Compiler = Compiler;
    hb.JavaScriptCompiler = JavaScriptCompiler;
    hb.Parser = Parser;
    hb.parse = parse;

    return hb;
  };

  Handlebars = create();
  Handlebars.create = create;

  __exports__ = Handlebars;
  return __exports__;
})(__module1__, __module7__, __module8__, __module10__, __module11__);

  return __module0__;
})();

define("handlebars", (function (global) {
    return function () {
        var ret, fn;
       fn = function () {
				window.Handlebars = Handlebars;
				return Handlebars
			};
        ret = fn.apply(global, arguments);
        return ret || global.Handlebars;
    };
}(this)));

//     Backbone.js 1.1.0

//     (c) 2010-2011 Jeremy Ashkenas, DocumentCloud Inc.
//     (c) 2011-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
//     Backbone may be freely distributed under the MIT license.
//     For all details and documentation:
//     http://backbonejs.org

(function(){

  // Initial Setup
  // -------------

  // Save a reference to the global object (`window` in the browser, `exports`
  // on the server).
  var root = this;

  // Save the previous value of the `Backbone` variable, so that it can be
  // restored later on, if `noConflict` is used.
  var previousBackbone = root.Backbone;

  // Create local references to array methods we'll want to use later.
  var array = [];
  var push = array.push;
  var slice = array.slice;
  var splice = array.splice;

  // The top-level namespace. All public Backbone classes and modules will
  // be attached to this. Exported for both the browser and the server.
  var Backbone;
  if (typeof exports !== 'undefined') {
    Backbone = exports;
  } else {
    Backbone = root.Backbone = {};
  }

  // Current version of the library. Keep in sync with `package.json`.
  Backbone.VERSION = '1.1.0';

  // Require Underscore, if we're on the server, and it's not already present.
  var _ = root._;
  if (!_ && (typeof require !== 'undefined')) _ = require('underscore');

  // For Backbone's purposes, jQuery, Zepto, Ender, or My Library (kidding) owns
  // the `$` variable.
  Backbone.$ = root.jQuery || root.Zepto || root.ender || root.$;

  // Runs Backbone.js in *noConflict* mode, returning the `Backbone` variable
  // to its previous owner. Returns a reference to this Backbone object.
  Backbone.noConflict = function() {
    root.Backbone = previousBackbone;
    return this;
  };

  // Turn on `emulateHTTP` to support legacy HTTP servers. Setting this option
  // will fake `"PATCH"`, `"PUT"` and `"DELETE"` requests via the `_method` parameter and
  // set a `X-Http-Method-Override` header.
  Backbone.emulateHTTP = false;

  // Turn on `emulateJSON` to support legacy servers that can't deal with direct
  // `application/json` requests ... will encode the body as
  // `application/x-www-form-urlencoded` instead and will send the model in a
  // form param named `model`.
  Backbone.emulateJSON = false;

  // Backbone.Events
  // ---------------

  // A module that can be mixed in to *any object* in order to provide it with
  // custom events. You may bind with `on` or remove with `off` callback
  // functions to an event; `trigger`-ing an event fires all callbacks in
  // succession.
  //
  //     var object = {};
  //     _.extend(object, Backbone.Events);
  //     object.on('expand', function(){ alert('expanded'); });
  //     object.trigger('expand');
  //
  var Events = Backbone.Events = {

    // Bind an event to a `callback` function. Passing `"all"` will bind
    // the callback to all events fired.
    on: function(name, callback, context) {
      if (!eventsApi(this, 'on', name, [callback, context]) || !callback) return this;
      this._events || (this._events = {});
      var events = this._events[name] || (this._events[name] = []);
      events.push({callback: callback, context: context, ctx: context || this});
      return this;
    },

    // Bind an event to only be triggered a single time. After the first time
    // the callback is invoked, it will be removed.
    once: function(name, callback, context) {
      if (!eventsApi(this, 'once', name, [callback, context]) || !callback) return this;
      var self = this;
      var once = _.once(function() {
        self.off(name, once);
        callback.apply(this, arguments);
      });
      once._callback = callback;
      return this.on(name, once, context);
    },

    // Remove one or many callbacks. If `context` is null, removes all
    // callbacks with that function. If `callback` is null, removes all
    // callbacks for the event. If `name` is null, removes all bound
    // callbacks for all events.
    off: function(name, callback, context) {
      var retain, ev, events, names, i, l, j, k;
      if (!this._events || !eventsApi(this, 'off', name, [callback, context])) return this;
      if (!name && !callback && !context) {
        this._events = {};
        return this;
      }
      names = name ? [name] : _.keys(this._events);
      for (i = 0, l = names.length; i < l; i++) {
        name = names[i];
        if (events = this._events[name]) {
          this._events[name] = retain = [];
          if (callback || context) {
            for (j = 0, k = events.length; j < k; j++) {
              ev = events[j];
              if ((callback && callback !== ev.callback && callback !== ev.callback._callback) ||
                  (context && context !== ev.context)) {
                retain.push(ev);
              }
            }
          }
          if (!retain.length) delete this._events[name];
        }
      }

      return this;
    },

    // Trigger one or many events, firing all bound callbacks. Callbacks are
    // passed the same arguments as `trigger` is, apart from the event name
    // (unless you're listening on `"all"`, which will cause your callback to
    // receive the true name of the event as the first argument).
    trigger: function(name) {
      if (!this._events) return this;
      var args = slice.call(arguments, 1);
      if (!eventsApi(this, 'trigger', name, args)) return this;
      var events = this._events[name];
      var allEvents = this._events.all;
      if (events) triggerEvents(events, args);
      if (allEvents) triggerEvents(allEvents, arguments);
      return this;
    },

    // Tell this object to stop listening to either specific events ... or
    // to every object it's currently listening to.
    stopListening: function(obj, name, callback) {
      var listeningTo = this._listeningTo;
      if (!listeningTo) return this;
      var remove = !name && !callback;
      if (!callback && typeof name === 'object') callback = this;
      if (obj) (listeningTo = {})[obj._listenId] = obj;
      for (var id in listeningTo) {
        obj = listeningTo[id];
        obj.off(name, callback, this);
        if (remove || _.isEmpty(obj._events)) delete this._listeningTo[id];
      }
      return this;
    }

  };

  // Regular expression used to split event strings.
  var eventSplitter = /\s+/;

  // Implement fancy features of the Events API such as multiple event
  // names `"change blur"` and jQuery-style event maps `{change: action}`
  // in terms of the existing API.
  var eventsApi = function(obj, action, name, rest) {
    if (!name) return true;

    // Handle event maps.
    if (typeof name === 'object') {
      for (var key in name) {
        obj[action].apply(obj, [key, name[key]].concat(rest));
      }
      return false;
    }

    // Handle space separated event names.
    if (eventSplitter.test(name)) {
      var names = name.split(eventSplitter);
      for (var i = 0, l = names.length; i < l; i++) {
        obj[action].apply(obj, [names[i]].concat(rest));
      }
      return false;
    }

    return true;
  };

  // A difficult-to-believe, but optimized internal dispatch function for
  // triggering events. Tries to keep the usual cases speedy (most internal
  // Backbone events have 3 arguments).
  var triggerEvents = function(events, args) {
    var ev, i = -1, l = events.length, a1 = args[0], a2 = args[1], a3 = args[2];
    switch (args.length) {
      case 0: while (++i < l) (ev = events[i]).callback.call(ev.ctx); return;
      case 1: while (++i < l) (ev = events[i]).callback.call(ev.ctx, a1); return;
      case 2: while (++i < l) (ev = events[i]).callback.call(ev.ctx, a1, a2); return;
      case 3: while (++i < l) (ev = events[i]).callback.call(ev.ctx, a1, a2, a3); return;
      default: while (++i < l) (ev = events[i]).callback.apply(ev.ctx, args);
    }
  };

  var listenMethods = {listenTo: 'on', listenToOnce: 'once'};

  // Inversion-of-control versions of `on` and `once`. Tell *this* object to
  // listen to an event in another object ... keeping track of what it's
  // listening to.
  _.each(listenMethods, function(implementation, method) {
    Events[method] = function(obj, name, callback) {
      var listeningTo = this._listeningTo || (this._listeningTo = {});
      var id = obj._listenId || (obj._listenId = _.uniqueId('l'));
      listeningTo[id] = obj;
      if (!callback && typeof name === 'object') callback = this;
      obj[implementation](name, callback, this);
      return this;
    };
  });

  // Aliases for backwards compatibility.
  Events.bind   = Events.on;
  Events.unbind = Events.off;

  // Allow the `Backbone` object to serve as a global event bus, for folks who
  // want global "pubsub" in a convenient place.
  _.extend(Backbone, Events);

  // Backbone.Model
  // --------------

  // Backbone **Models** are the basic data object in the framework --
  // frequently representing a row in a table in a database on your server.
  // A discrete chunk of data and a bunch of useful, related methods for
  // performing computations and transformations on that data.

  // Create a new model with the specified attributes. A client id (`cid`)
  // is automatically generated and assigned for you.
  var Model = Backbone.Model = function(attributes, options) {
    var attrs = attributes || {};
    options || (options = {});
    this.cid = _.uniqueId('c');
    this.attributes = {};
    if (options.collection) this.collection = options.collection;
    if (options.parse) attrs = this.parse(attrs, options) || {};
    attrs = _.defaults({}, attrs, _.result(this, 'defaults'));
    this.set(attrs, options);
    this.changed = {};
    this.initialize.apply(this, arguments);
  };

  // Attach all inheritable methods to the Model prototype.
  _.extend(Model.prototype, Events, {

    // A hash of attributes whose current and previous value differ.
    changed: null,

    // The value returned during the last failed validation.
    validationError: null,

    // The default name for the JSON `id` attribute is `"id"`. MongoDB and
    // CouchDB users may want to set this to `"_id"`.
    idAttribute: 'id',

    // Initialize is an empty function by default. Override it with your own
    // initialization logic.
    initialize: function(){},

    // Return a copy of the model's `attributes` object.
    toJSON: function(options) {
      return _.clone(this.attributes);
    },

    // Proxy `Backbone.sync` by default -- but override this if you need
    // custom syncing semantics for *this* particular model.
    sync: function() {
      return Backbone.sync.apply(this, arguments);
    },

    // Get the value of an attribute.
    get: function(attr) {
      return this.attributes[attr];
    },

    // Get the HTML-escaped value of an attribute.
    escape: function(attr) {
      return _.escape(this.get(attr));
    },

    // Returns `true` if the attribute contains a value that is not null
    // or undefined.
    has: function(attr) {
      return this.get(attr) != null;
    },

    // Set a hash of model attributes on the object, firing `"change"`. This is
    // the core primitive operation of a model, updating the data and notifying
    // anyone who needs to know about the change in state. The heart of the beast.
    set: function(key, val, options) {
      var attr, attrs, unset, changes, silent, changing, prev, current;
      if (key == null) return this;

      // Handle both `"key", value` and `{key: value}` -style arguments.
      if (typeof key === 'object') {
        attrs = key;
        options = val;
      } else {
        (attrs = {})[key] = val;
      }

      options || (options = {});

      // Run validation.
      if (!this._validate(attrs, options)) return false;

      // Extract attributes and options.
      unset           = options.unset;
      silent          = options.silent;
      changes         = [];
      changing        = this._changing;
      this._changing  = true;

      if (!changing) {
        this._previousAttributes = _.clone(this.attributes);
        this.changed = {};
      }
      current = this.attributes, prev = this._previousAttributes;

      // Check for changes of `id`.
      if (this.idAttribute in attrs) this.id = attrs[this.idAttribute];

      // For each `set` attribute, update or delete the current value.
      for (attr in attrs) {
        val = attrs[attr];
        if (!_.isEqual(current[attr], val)) changes.push(attr);
        if (!_.isEqual(prev[attr], val)) {
          this.changed[attr] = val;
        } else {
          delete this.changed[attr];
        }
        unset ? delete current[attr] : current[attr] = val;
      }

      // Trigger all relevant attribute changes.
      if (!silent) {
        if (changes.length) this._pending = true;
        for (var i = 0, l = changes.length; i < l; i++) {
          this.trigger('change:' + changes[i], this, current[changes[i]], options);
        }
      }

      // You might be wondering why there's a `while` loop here. Changes can
      // be recursively nested within `"change"` events.
      if (changing) return this;
      if (!silent) {
        while (this._pending) {
          this._pending = false;
          this.trigger('change', this, options);
        }
      }
      this._pending = false;
      this._changing = false;
      return this;
    },

    // Remove an attribute from the model, firing `"change"`. `unset` is a noop
    // if the attribute doesn't exist.
    unset: function(attr, options) {
      return this.set(attr, void 0, _.extend({}, options, {unset: true}));
    },

    // Clear all attributes on the model, firing `"change"`.
    clear: function(options) {
      var attrs = {};
      for (var key in this.attributes) attrs[key] = void 0;
      return this.set(attrs, _.extend({}, options, {unset: true}));
    },

    // Determine if the model has changed since the last `"change"` event.
    // If you specify an attribute name, determine if that attribute has changed.
    hasChanged: function(attr) {
      if (attr == null) return !_.isEmpty(this.changed);
      return _.has(this.changed, attr);
    },

    // Return an object containing all the attributes that have changed, or
    // false if there are no changed attributes. Useful for determining what
    // parts of a view need to be updated and/or what attributes need to be
    // persisted to the server. Unset attributes will be set to undefined.
    // You can also pass an attributes object to diff against the model,
    // determining if there *would be* a change.
    changedAttributes: function(diff) {
      if (!diff) return this.hasChanged() ? _.clone(this.changed) : false;
      var val, changed = false;
      var old = this._changing ? this._previousAttributes : this.attributes;
      for (var attr in diff) {
        if (_.isEqual(old[attr], (val = diff[attr]))) continue;
        (changed || (changed = {}))[attr] = val;
      }
      return changed;
    },

    // Get the previous value of an attribute, recorded at the time the last
    // `"change"` event was fired.
    previous: function(attr) {
      if (attr == null || !this._previousAttributes) return null;
      return this._previousAttributes[attr];
    },

    // Get all of the attributes of the model at the time of the previous
    // `"change"` event.
    previousAttributes: function() {
      return _.clone(this._previousAttributes);
    },

    // Fetch the model from the server. If the server's representation of the
    // model differs from its current attributes, they will be overridden,
    // triggering a `"change"` event.
    fetch: function(options) {
      options = options ? _.clone(options) : {};
      if (options.parse === void 0) options.parse = true;
      var model = this;
      var success = options.success;
      options.success = function(resp) {
        if (!model.set(model.parse(resp, options), options)) return false;
        if (success) success(model, resp, options);
        model.trigger('sync', model, resp, options);
      };
      wrapError(this, options);
      return this.sync('read', this, options);
    },

    // Set a hash of model attributes, and sync the model to the server.
    // If the server returns an attributes hash that differs, the model's
    // state will be `set` again.
    save: function(key, val, options) {
      var attrs, method, xhr, attributes = this.attributes;

      // Handle both `"key", value` and `{key: value}` -style arguments.
      if (key == null || typeof key === 'object') {
        attrs = key;
        options = val;
      } else {
        (attrs = {})[key] = val;
      }

      options = _.extend({validate: true}, options);

      // If we're not waiting and attributes exist, save acts as
      // `set(attr).save(null, opts)` with validation. Otherwise, check if
      // the model will be valid when the attributes, if any, are set.
      if (attrs && !options.wait) {
        if (!this.set(attrs, options)) return false;
      } else {
        if (!this._validate(attrs, options)) return false;
      }

      // Set temporary attributes if `{wait: true}`.
      if (attrs && options.wait) {
        this.attributes = _.extend({}, attributes, attrs);
      }

      // After a successful server-side save, the client is (optionally)
      // updated with the server-side state.
      if (options.parse === void 0) options.parse = true;
      var model = this;
      var success = options.success;
      options.success = function(resp) {
        // Ensure attributes are restored during synchronous saves.
        model.attributes = attributes;
        var serverAttrs = model.parse(resp, options);
        if (options.wait) serverAttrs = _.extend(attrs || {}, serverAttrs);
        if (_.isObject(serverAttrs) && !model.set(serverAttrs, options)) {
          return false;
        }
        if (success) success(model, resp, options);
        model.trigger('sync', model, resp, options);
      };
      wrapError(this, options);

      method = this.isNew() ? 'create' : (options.patch ? 'patch' : 'update');
      if (method === 'patch') options.attrs = attrs;
      xhr = this.sync(method, this, options);

      // Restore attributes.
      if (attrs && options.wait) this.attributes = attributes;

      return xhr;
    },

    // Destroy this model on the server if it was already persisted.
    // Optimistically removes the model from its collection, if it has one.
    // If `wait: true` is passed, waits for the server to respond before removal.
    destroy: function(options) {
      options = options ? _.clone(options) : {};
      var model = this;
      var success = options.success;

      var destroy = function() {
        model.trigger('destroy', model, model.collection, options);
      };

      options.success = function(resp) {
        if (options.wait || model.isNew()) destroy();
        if (success) success(model, resp, options);
        if (!model.isNew()) model.trigger('sync', model, resp, options);
      };

      if (this.isNew()) {
        options.success();
        return false;
      }
      wrapError(this, options);

      var xhr = this.sync('delete', this, options);
      if (!options.wait) destroy();
      return xhr;
    },

    // Default URL for the model's representation on the server -- if you're
    // using Backbone's restful methods, override this to change the endpoint
    // that will be called.
    url: function() {
      var base = _.result(this, 'urlRoot') || _.result(this.collection, 'url') || urlError();
      if (this.isNew()) return base;
      return base + (base.charAt(base.length - 1) === '/' ? '' : '/') + encodeURIComponent(this.id);
    },

    // **parse** converts a response into the hash of attributes to be `set` on
    // the model. The default implementation is just to pass the response along.
    parse: function(resp, options) {
      return resp;
    },

    // Create a new model with identical attributes to this one.
    clone: function() {
      return new this.constructor(this.attributes);
    },

    // A model is new if it has never been saved to the server, and lacks an id.
    isNew: function() {
      return this.id == null;
    },

    // Check if the model is currently in a valid state.
    isValid: function(options) {
      return this._validate({}, _.extend(options || {}, { validate: true }));
    },

    // Run validation against the next complete set of model attributes,
    // returning `true` if all is well. Otherwise, fire an `"invalid"` event.
    _validate: function(attrs, options) {
      if (!options.validate || !this.validate) return true;
      attrs = _.extend({}, this.attributes, attrs);
      var error = this.validationError = this.validate(attrs, options) || null;
      if (!error) return true;
      this.trigger('invalid', this, error, _.extend(options, {validationError: error}));
      return false;
    }

  });

  // Underscore methods that we want to implement on the Model.
  var modelMethods = ['keys', 'values', 'pairs', 'invert', 'pick', 'omit'];

  // Mix in each Underscore method as a proxy to `Model#attributes`.
  _.each(modelMethods, function(method) {
    Model.prototype[method] = function() {
      var args = slice.call(arguments);
      args.unshift(this.attributes);
      return _[method].apply(_, args);
    };
  });

  // Backbone.Collection
  // -------------------

  // If models tend to represent a single row of data, a Backbone Collection is
  // more analagous to a table full of data ... or a small slice or page of that
  // table, or a collection of rows that belong together for a particular reason
  // -- all of the messages in this particular folder, all of the documents
  // belonging to this particular author, and so on. Collections maintain
  // indexes of their models, both in order, and for lookup by `id`.

  // Create a new **Collection**, perhaps to contain a specific type of `model`.
  // If a `comparator` is specified, the Collection will maintain
  // its models in sort order, as they're added and removed.
  var Collection = Backbone.Collection = function(models, options) {
    options || (options = {});
    if (options.model) this.model = options.model;
    if (options.comparator !== void 0) this.comparator = options.comparator;
    this._reset();
    this.initialize.apply(this, arguments);
    if (models) this.reset(models, _.extend({silent: true}, options));
  };

  // Default options for `Collection#set`.
  var setOptions = {add: true, remove: true, merge: true};
  var addOptions = {add: true, remove: false};

  // Define the Collection's inheritable methods.
  _.extend(Collection.prototype, Events, {

    // The default model for a collection is just a **Backbone.Model**.
    // This should be overridden in most cases.
    model: Model,

    // Initialize is an empty function by default. Override it with your own
    // initialization logic.
    initialize: function(){},

    // The JSON representation of a Collection is an array of the
    // models' attributes.
    toJSON: function(options) {
      return this.map(function(model){ return model.toJSON(options); });
    },

    // Proxy `Backbone.sync` by default.
    sync: function() {
      return Backbone.sync.apply(this, arguments);
    },

    // Add a model, or list of models to the set.
    add: function(models, options) {
      return this.set(models, _.extend({merge: false}, options, addOptions));
    },

    // Remove a model, or a list of models from the set.
    remove: function(models, options) {
      var singular = !_.isArray(models);
      models = singular ? [models] : _.clone(models);
      options || (options = {});
      var i, l, index, model;
      for (i = 0, l = models.length; i < l; i++) {
        model = models[i] = this.get(models[i]);
        if (!model) continue;
        delete this._byId[model.id];
        delete this._byId[model.cid];
        index = this.indexOf(model);
        this.models.splice(index, 1);
        this.length--;
        if (!options.silent) {
          options.index = index;
          model.trigger('remove', model, this, options);
        }
        this._removeReference(model);
      }
      return singular ? models[0] : models;
    },

    // Update a collection by `set`-ing a new list of models, adding new ones,
    // removing models that are no longer present, and merging models that
    // already exist in the collection, as necessary. Similar to **Model#set**,
    // the core operation for updating the data contained by the collection.
    set: function(models, options) {
      options = _.defaults({}, options, setOptions);
      if (options.parse) models = this.parse(models, options);
      var singular = !_.isArray(models);
      models = singular ? (models ? [models] : []) : _.clone(models);
      var i, l, id, model, attrs, existing, sort;
      var at = options.at;
      var targetModel = this.model;
      var sortable = this.comparator && (at == null) && options.sort !== false;
      var sortAttr = _.isString(this.comparator) ? this.comparator : null;
      var toAdd = [], toRemove = [], modelMap = {};
      var add = options.add, merge = options.merge, remove = options.remove;
      var order = !sortable && add && remove ? [] : false;

      // Turn bare objects into model references, and prevent invalid models
      // from being added.
      for (i = 0, l = models.length; i < l; i++) {
        attrs = models[i];
        if (attrs instanceof Model) {
          id = model = attrs;
        } else {
          id = attrs[targetModel.prototype.idAttribute];
        }

        // If a duplicate is found, prevent it from being added and
        // optionally merge it into the existing model.
        if (existing = this.get(id)) {
          if (remove) modelMap[existing.cid] = true;
          if (merge) {
            attrs = attrs === model ? model.attributes : attrs;
            if (options.parse) attrs = existing.parse(attrs, options);
            existing.set(attrs, options);
            if (sortable && !sort && existing.hasChanged(sortAttr)) sort = true;
          }
          models[i] = existing;

        // If this is a new, valid model, push it to the `toAdd` list.
        } else if (add) {
          model = models[i] = this._prepareModel(attrs, options);
          if (!model) continue;
          toAdd.push(model);

          // Listen to added models' events, and index models for lookup by
          // `id` and by `cid`.
          model.on('all', this._onModelEvent, this);
          this._byId[model.cid] = model;
          if (model.id != null) this._byId[model.id] = model;
        }
        if (order) order.push(existing || model);
      }

      // Remove nonexistent models if appropriate.
      if (remove) {
        for (i = 0, l = this.length; i < l; ++i) {
          if (!modelMap[(model = this.models[i]).cid]) toRemove.push(model);
        }
        if (toRemove.length) this.remove(toRemove, options);
      }

      // See if sorting is needed, update `length` and splice in new models.
      if (toAdd.length || (order && order.length)) {
        if (sortable) sort = true;
        this.length += toAdd.length;
        if (at != null) {
          for (i = 0, l = toAdd.length; i < l; i++) {
            this.models.splice(at + i, 0, toAdd[i]);
          }
        } else {
          if (order) this.models.length = 0;
          var orderedModels = order || toAdd;
          for (i = 0, l = orderedModels.length; i < l; i++) {
            this.models.push(orderedModels[i]);
          }
        }
      }

      // Silently sort the collection if appropriate.
      if (sort) this.sort({silent: true});

      // Unless silenced, it's time to fire all appropriate add/sort events.
      if (!options.silent) {
        for (i = 0, l = toAdd.length; i < l; i++) {
          (model = toAdd[i]).trigger('add', model, this, options);
        }
        if (sort || (order && order.length)) this.trigger('sort', this, options);
      }
      
      // Return the added (or merged) model (or models).
      return singular ? models[0] : models;
    },

    // When you have more items than you want to add or remove individually,
    // you can reset the entire set with a new list of models, without firing
    // any granular `add` or `remove` events. Fires `reset` when finished.
    // Useful for bulk operations and optimizations.
    reset: function(models, options) {
      options || (options = {});
      for (var i = 0, l = this.models.length; i < l; i++) {
        this._removeReference(this.models[i]);
      }
      options.previousModels = this.models;
      this._reset();
      models = this.add(models, _.extend({silent: true}, options));
      if (!options.silent) this.trigger('reset', this, options);
      return models;
    },

    // Add a model to the end of the collection.
    push: function(model, options) {
      return this.add(model, _.extend({at: this.length}, options));
    },

    // Remove a model from the end of the collection.
    pop: function(options) {
      var model = this.at(this.length - 1);
      this.remove(model, options);
      return model;
    },

    // Add a model to the beginning of the collection.
    unshift: function(model, options) {
      return this.add(model, _.extend({at: 0}, options));
    },

    // Remove a model from the beginning of the collection.
    shift: function(options) {
      var model = this.at(0);
      this.remove(model, options);
      return model;
    },

    // Slice out a sub-array of models from the collection.
    slice: function() {
      return slice.apply(this.models, arguments);
    },

    // Get a model from the set by id.
    get: function(obj) {
      if (obj == null) return void 0;
      return this._byId[obj.id] || this._byId[obj.cid] || this._byId[obj];
    },

    // Get the model at the given index.
    at: function(index) {
      return this.models[index];
    },

    // Return models with matching attributes. Useful for simple cases of
    // `filter`.
    where: function(attrs, first) {
      if (_.isEmpty(attrs)) return first ? void 0 : [];
      return this[first ? 'find' : 'filter'](function(model) {
        for (var key in attrs) {
          if (attrs[key] !== model.get(key)) return false;
        }
        return true;
      });
    },

    // Return the first model with matching attributes. Useful for simple cases
    // of `find`.
    findWhere: function(attrs) {
      return this.where(attrs, true);
    },

    // Force the collection to re-sort itself. You don't need to call this under
    // normal circumstances, as the set will maintain sort order as each item
    // is added.
    sort: function(options) {
      if (!this.comparator) throw new Error('Cannot sort a set without a comparator');
      options || (options = {});

      // Run sort based on type of `comparator`.
      if (_.isString(this.comparator) || this.comparator.length === 1) {
        this.models = this.sortBy(this.comparator, this);
      } else {
        this.models.sort(_.bind(this.comparator, this));
      }

      if (!options.silent) this.trigger('sort', this, options);
      return this;
    },

    // Pluck an attribute from each model in the collection.
    pluck: function(attr) {
      return _.invoke(this.models, 'get', attr);
    },

    // Fetch the default set of models for this collection, resetting the
    // collection when they arrive. If `reset: true` is passed, the response
    // data will be passed through the `reset` method instead of `set`.
    fetch: function(options) {
      options = options ? _.clone(options) : {};
      if (options.parse === void 0) options.parse = true;
      var success = options.success;
      var collection = this;
      options.success = function(resp) {
        var method = options.reset ? 'reset' : 'set';
        collection[method](resp, options);
        if (success) success(collection, resp, options);
        collection.trigger('sync', collection, resp, options);
      };
      wrapError(this, options);
      return this.sync('read', this, options);
    },

    // Create a new instance of a model in this collection. Add the model to the
    // collection immediately, unless `wait: true` is passed, in which case we
    // wait for the server to agree.
    create: function(model, options) {
      options = options ? _.clone(options) : {};
      if (!(model = this._prepareModel(model, options))) return false;
      if (!options.wait) this.add(model, options);
      var collection = this;
      var success = options.success;
      options.success = function(model, resp, options) {
        if (options.wait) collection.add(model, options);
        if (success) success(model, resp, options);
      };
      model.save(null, options);
      return model;
    },

    // **parse** converts a response into a list of models to be added to the
    // collection. The default implementation is just to pass it through.
    parse: function(resp, options) {
      return resp;
    },

    // Create a new collection with an identical list of models as this one.
    clone: function() {
      return new this.constructor(this.models);
    },

    // Private method to reset all internal state. Called when the collection
    // is first initialized or reset.
    _reset: function() {
      this.length = 0;
      this.models = [];
      this._byId  = {};
    },

    // Prepare a hash of attributes (or other model) to be added to this
    // collection.
    _prepareModel: function(attrs, options) {
      if (attrs instanceof Model) {
        if (!attrs.collection) attrs.collection = this;
        return attrs;
      }
      options = options ? _.clone(options) : {};
      options.collection = this;
      var model = new this.model(attrs, options);
      if (!model.validationError) return model;
      this.trigger('invalid', this, model.validationError, options);
      return false;
    },

    // Internal method to sever a model's ties to a collection.
    _removeReference: function(model) {
      if (this === model.collection) delete model.collection;
      model.off('all', this._onModelEvent, this);
    },

    // Internal method called every time a model in the set fires an event.
    // Sets need to update their indexes when models change ids. All other
    // events simply proxy through. "add" and "remove" events that originate
    // in other collections are ignored.
    _onModelEvent: function(event, model, collection, options) {
      if ((event === 'add' || event === 'remove') && collection !== this) return;
      if (event === 'destroy') this.remove(model, options);
      if (model && event === 'change:' + model.idAttribute) {
        delete this._byId[model.previous(model.idAttribute)];
        if (model.id != null) this._byId[model.id] = model;
      }
      this.trigger.apply(this, arguments);
    }

  });

  // Underscore methods that we want to implement on the Collection.
  // 90% of the core usefulness of Backbone Collections is actually implemented
  // right here:
  var methods = ['forEach', 'each', 'map', 'collect', 'reduce', 'foldl',
    'inject', 'reduceRight', 'foldr', 'find', 'detect', 'filter', 'select',
    'reject', 'every', 'all', 'some', 'any', 'include', 'contains', 'invoke',
    'max', 'min', 'toArray', 'size', 'first', 'head', 'take', 'initial', 'rest',
    'tail', 'drop', 'last', 'without', 'difference', 'indexOf', 'shuffle',
    'lastIndexOf', 'isEmpty', 'chain'];

  // Mix in each Underscore method as a proxy to `Collection#models`.
  _.each(methods, function(method) {
    Collection.prototype[method] = function() {
      var args = slice.call(arguments);
      args.unshift(this.models);
      return _[method].apply(_, args);
    };
  });

  // Underscore methods that take a property name as an argument.
  var attributeMethods = ['groupBy', 'countBy', 'sortBy'];

  // Use attributes instead of properties.
  _.each(attributeMethods, function(method) {
    Collection.prototype[method] = function(value, context) {
      var iterator = _.isFunction(value) ? value : function(model) {
        return model.get(value);
      };
      return _[method](this.models, iterator, context);
    };
  });

  // Backbone.View
  // -------------

  // Backbone Views are almost more convention than they are actual code. A View
  // is simply a JavaScript object that represents a logical chunk of UI in the
  // DOM. This might be a single item, an entire list, a sidebar or panel, or
  // even the surrounding frame which wraps your whole app. Defining a chunk of
  // UI as a **View** allows you to define your DOM events declaratively, without
  // having to worry about render order ... and makes it easy for the view to
  // react to specific changes in the state of your models.

  // Creating a Backbone.View creates its initial element outside of the DOM,
  // if an existing element is not provided...
  var View = Backbone.View = function(options) {
    this.cid = _.uniqueId('view');
    options || (options = {});
    _.extend(this, _.pick(options, viewOptions));
    this._ensureElement();
    this.initialize.apply(this, arguments);
    this.delegateEvents();
  };

  // Cached regex to split keys for `delegate`.
  var delegateEventSplitter = /^(\S+)\s*(.*)$/;

  // List of view options to be merged as properties.
  var viewOptions = ['model', 'collection', 'el', 'id', 'attributes', 'className', 'tagName', 'events'];

  // Set up all inheritable **Backbone.View** properties and methods.
  _.extend(View.prototype, Events, {

    // The default `tagName` of a View's element is `"div"`.
    tagName: 'div',

    // jQuery delegate for element lookup, scoped to DOM elements within the
    // current view. This should be preferred to global lookups where possible.
    $: function(selector) {
      return this.$el.find(selector);
    },

    // Initialize is an empty function by default. Override it with your own
    // initialization logic.
    initialize: function(){},

    // **render** is the core function that your view should override, in order
    // to populate its element (`this.el`), with the appropriate HTML. The
    // convention is for **render** to always return `this`.
    render: function() {
      return this;
    },

    // Remove this view by taking the element out of the DOM, and removing any
    // applicable Backbone.Events listeners.
    remove: function() {
      this.$el.remove();
      this.stopListening();
      return this;
    },

    // Change the view's element (`this.el` property), including event
    // re-delegation.
    setElement: function(element, delegate) {
      if (this.$el) this.undelegateEvents();
      this.$el = element instanceof Backbone.$ ? element : Backbone.$(element);
      this.el = this.$el[0];
      if (delegate !== false) this.delegateEvents();
      return this;
    },

    // Set callbacks, where `this.events` is a hash of
    //
    // *{"event selector": "callback"}*
    //
    //     {
    //       'mousedown .title':  'edit',
    //       'click .button':     'save',
    //       'click .open':       function(e) { ... }
    //     }
    //
    // pairs. Callbacks will be bound to the view, with `this` set properly.
    // Uses event delegation for efficiency.
    // Omitting the selector binds the event to `this.el`.
    // This only works for delegate-able events: not `focus`, `blur`, and
    // not `change`, `submit`, and `reset` in Internet Explorer.
    delegateEvents: function(events) {
      if (!(events || (events = _.result(this, 'events')))) return this;
      this.undelegateEvents();
      for (var key in events) {
        var method = events[key];
        if (!_.isFunction(method)) method = this[events[key]];
        if (!method) continue;

        var match = key.match(delegateEventSplitter);
        var eventName = match[1], selector = match[2];
        method = _.bind(method, this);
        eventName += '.delegateEvents' + this.cid;
        if (selector === '') {
          this.$el.on(eventName, method);
        } else {
          this.$el.on(eventName, selector, method);
        }
      }
      return this;
    },

    // Clears all callbacks previously bound to the view with `delegateEvents`.
    // You usually don't need to use this, but may wish to if you have multiple
    // Backbone views attached to the same DOM element.
    undelegateEvents: function() {
      this.$el.off('.delegateEvents' + this.cid);
      return this;
    },

    // Ensure that the View has a DOM element to render into.
    // If `this.el` is a string, pass it through `$()`, take the first
    // matching element, and re-assign it to `el`. Otherwise, create
    // an element from the `id`, `className` and `tagName` properties.
    _ensureElement: function() {
      if (!this.el) {
        var attrs = _.extend({}, _.result(this, 'attributes'));
        if (this.id) attrs.id = _.result(this, 'id');
        if (this.className) attrs['class'] = _.result(this, 'className');
        var $el = Backbone.$('<' + _.result(this, 'tagName') + '>').attr(attrs);
        this.setElement($el, false);
      } else {
        this.setElement(_.result(this, 'el'), false);
      }
    }

  });

  // Backbone.sync
  // -------------

  // Override this function to change the manner in which Backbone persists
  // models to the server. You will be passed the type of request, and the
  // model in question. By default, makes a RESTful Ajax request
  // to the model's `url()`. Some possible customizations could be:
  //
  // * Use `setTimeout` to batch rapid-fire updates into a single request.
  // * Send up the models as XML instead of JSON.
  // * Persist models via WebSockets instead of Ajax.
  //
  // Turn on `Backbone.emulateHTTP` in order to send `PUT` and `DELETE` requests
  // as `POST`, with a `_method` parameter containing the true HTTP method,
  // as well as all requests with the body as `application/x-www-form-urlencoded`
  // instead of `application/json` with the model in a param named `model`.
  // Useful when interfacing with server-side languages like **PHP** that make
  // it difficult to read the body of `PUT` requests.
  Backbone.sync = function(method, model, options) {
    var type = methodMap[method];

    // Default options, unless specified.
    _.defaults(options || (options = {}), {
      emulateHTTP: Backbone.emulateHTTP,
      emulateJSON: Backbone.emulateJSON
    });

    // Default JSON-request options.
    var params = {type: type, dataType: 'json'};

    // Ensure that we have a URL.
    if (!options.url) {
      params.url = _.result(model, 'url') || urlError();
    }

    // Ensure that we have the appropriate request data.
    if (options.data == null && model && (method === 'create' || method === 'update' || method === 'patch')) {
      params.contentType = 'application/json';
      params.data = JSON.stringify(options.attrs || model.toJSON(options));
    }

    // For older servers, emulate JSON by encoding the request into an HTML-form.
    if (options.emulateJSON) {
      params.contentType = 'application/x-www-form-urlencoded';
      params.data = params.data ? {model: params.data} : {};
    }

    // For older servers, emulate HTTP by mimicking the HTTP method with `_method`
    // And an `X-HTTP-Method-Override` header.
    if (options.emulateHTTP && (type === 'PUT' || type === 'DELETE' || type === 'PATCH')) {
      params.type = 'POST';
      if (options.emulateJSON) params.data._method = type;
      var beforeSend = options.beforeSend;
      options.beforeSend = function(xhr) {
        xhr.setRequestHeader('X-HTTP-Method-Override', type);
        if (beforeSend) return beforeSend.apply(this, arguments);
      };
    }

    // Don't process data on a non-GET request.
    if (params.type !== 'GET' && !options.emulateJSON) {
      params.processData = false;
    }

    // If we're sending a `PATCH` request, and we're in an old Internet Explorer
    // that still has ActiveX enabled by default, override jQuery to use that
    // for XHR instead. Remove this line when jQuery supports `PATCH` on IE8.
    if (params.type === 'PATCH' && noXhrPatch) {
      params.xhr = function() {
        return new ActiveXObject("Microsoft.XMLHTTP");
      };
    }

    // Make the request, allowing the user to override any Ajax options.
    var xhr = options.xhr = Backbone.ajax(_.extend(params, options));
    model.trigger('request', model, xhr, options);
    return xhr;
  };

  var noXhrPatch = typeof window !== 'undefined' && !!window.ActiveXObject && !(window.XMLHttpRequest && (new XMLHttpRequest).dispatchEvent);

  // Map from CRUD to HTTP for our default `Backbone.sync` implementation.
  var methodMap = {
    'create': 'POST',
    'update': 'PUT',
    'patch':  'PATCH',
    'delete': 'DELETE',
    'read':   'GET'
  };

  // Set the default implementation of `Backbone.ajax` to proxy through to `$`.
  // Override this if you'd like to use a different library.
  Backbone.ajax = function() {
    return Backbone.$.ajax.apply(Backbone.$, arguments);
  };

  // Backbone.Router
  // ---------------

  // Routers map faux-URLs to actions, and fire events when routes are
  // matched. Creating a new one sets its `routes` hash, if not set statically.
  var Router = Backbone.Router = function(options) {
    options || (options = {});
    if (options.routes) this.routes = options.routes;
    this._bindRoutes();
    this.initialize.apply(this, arguments);
  };

  // Cached regular expressions for matching named param parts and splatted
  // parts of route strings.
  var optionalParam = /\((.*?)\)/g;
  var namedParam    = /(\(\?)?:\w+/g;
  var splatParam    = /\*\w+/g;
  var escapeRegExp  = /[\-{}\[\]+?.,\\\^$|#\s]/g;

  // Set up all inheritable **Backbone.Router** properties and methods.
  _.extend(Router.prototype, Events, {

    // Initialize is an empty function by default. Override it with your own
    // initialization logic.
    initialize: function(){},

    // Manually bind a single named route to a callback. For example:
    //
    //     this.route('search/:query/p:num', 'search', function(query, num) {
    //       ...
    //     });
    //
    route: function(route, name, callback) {
      if (!_.isRegExp(route)) route = this._routeToRegExp(route);
      if (_.isFunction(name)) {
        callback = name;
        name = '';
      }
      if (!callback) callback = this[name];
      var router = this;
      Backbone.history.route(route, function(fragment) {
        var args = router._extractParameters(route, fragment);
        callback && callback.apply(router, args);
        router.trigger.apply(router, ['route:' + name].concat(args));
        router.trigger('route', name, args);
        Backbone.history.trigger('route', router, name, args);
      });
      return this;
    },

    // Simple proxy to `Backbone.history` to save a fragment into the history.
    navigate: function(fragment, options) {
      Backbone.history.navigate(fragment, options);
      return this;
    },

    // Bind all defined routes to `Backbone.history`. We have to reverse the
    // order of the routes here to support behavior where the most general
    // routes can be defined at the bottom of the route map.
    _bindRoutes: function() {
      if (!this.routes) return;
      this.routes = _.result(this, 'routes');
      var route, routes = _.keys(this.routes);
      while ((route = routes.pop()) != null) {
        this.route(route, this.routes[route]);
      }
    },

    // Convert a route string into a regular expression, suitable for matching
    // against the current location hash.
    _routeToRegExp: function(route) {
      route = route.replace(escapeRegExp, '\\$&')
                   .replace(optionalParam, '(?:$1)?')
                   .replace(namedParam, function(match, optional) {
                     return optional ? match : '([^\/]+)';
                   })
                   .replace(splatParam, '(.*?)');
      return new RegExp('^' + route + '$');
    },

    // Given a route, and a URL fragment that it matches, return the array of
    // extracted decoded parameters. Empty or unmatched parameters will be
    // treated as `null` to normalize cross-browser behavior.
    _extractParameters: function(route, fragment) {
      var params = route.exec(fragment).slice(1);
      return _.map(params, function(param) {
        return param ? decodeURIComponent(param) : null;
      });
    }

  });

  // Backbone.History
  // ----------------

  // Handles cross-browser history management, based on either
  // [pushState](http://diveintohtml5.info/history.html) and real URLs, or
  // [onhashchange](https://developer.mozilla.org/en-US/docs/DOM/window.onhashchange)
  // and URL fragments. If the browser supports neither (old IE, natch),
  // falls back to polling.
  var History = Backbone.History = function() {
    this.handlers = [];
    _.bindAll(this, 'checkUrl');

    // Ensure that `History` can be used outside of the browser.
    if (typeof window !== 'undefined') {
      this.location = window.location;
      this.history = window.history;
    }
  };

  // Cached regex for stripping a leading hash/slash and trailing space.
  var routeStripper = /^[#\/]|\s+$/g;

  // Cached regex for stripping leading and trailing slashes.
  var rootStripper = /^\/+|\/+$/g;

  // Cached regex for detecting MSIE.
  var isExplorer = /msie [\w.]+/;

  // Cached regex for removing a trailing slash.
  var trailingSlash = /\/$/;

  // Cached regex for stripping urls of hash and query.
  var pathStripper = /[?#].*$/;

  // Has the history handling already been started?
  History.started = false;

  // Set up all inheritable **Backbone.History** properties and methods.
  _.extend(History.prototype, Events, {

    // The default interval to poll for hash changes, if necessary, is
    // twenty times a second.
    interval: 50,

    // Gets the true hash value. Cannot use location.hash directly due to bug
    // in Firefox where location.hash will always be decoded.
    getHash: function(window) {
      var match = (window || this).location.href.match(/#(.*)$/);
      return match ? match[1] : '';
    },

    // Get the cross-browser normalized URL fragment, either from the URL,
    // the hash, or the override.
    getFragment: function(fragment, forcePushState) {
      if (fragment == null) {
        if (this._hasPushState || !this._wantsHashChange || forcePushState) {
          fragment = this.location.pathname;
          var root = this.root.replace(trailingSlash, '');
          if (!fragment.indexOf(root)) fragment = fragment.slice(root.length);
        } else {
          fragment = this.getHash();
        }
      }
      return fragment.replace(routeStripper, '');
    },

    // Start the hash change handling, returning `true` if the current URL matches
    // an existing route, and `false` otherwise.
    start: function(options) {
      if (History.started) throw new Error("Backbone.history has already been started");
      History.started = true;

      // Figure out the initial configuration. Do we need an iframe?
      // Is pushState desired ... is it available?
      this.options          = _.extend({root: '/'}, this.options, options);
      this.root             = this.options.root;
      this._wantsHashChange = this.options.hashChange !== false;
      this._wantsPushState  = !!this.options.pushState;
      this._hasPushState    = !!(this.options.pushState && this.history && this.history.pushState);
      var fragment          = this.getFragment();
      var docMode           = document.documentMode;
      var oldIE             = (isExplorer.exec(navigator.userAgent.toLowerCase()) && (!docMode || docMode <= 7));

      // Normalize root to always include a leading and trailing slash.
      this.root = ('/' + this.root + '/').replace(rootStripper, '/');

      if (oldIE && this._wantsHashChange) {
        this.iframe = Backbone.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo('body')[0].contentWindow;
        this.navigate(fragment);
      }

      // Depending on whether we're using pushState or hashes, and whether
      // 'onhashchange' is supported, determine how we check the URL state.
      if (this._hasPushState) {
        Backbone.$(window).on('popstate', this.checkUrl);
      } else if (this._wantsHashChange && ('onhashchange' in window) && !oldIE) {
        Backbone.$(window).on('hashchange', this.checkUrl);
      } else if (this._wantsHashChange) {
        this._checkUrlInterval = setInterval(this.checkUrl, this.interval);
      }

      // Determine if we need to change the base url, for a pushState link
      // opened by a non-pushState browser.
      this.fragment = fragment;
      var loc = this.location;
      var atRoot = loc.pathname.replace(/[^\/]$/, '$&/') === this.root;

      // Transition from hashChange to pushState or vice versa if both are
      // requested.
      if (this._wantsHashChange && this._wantsPushState) {

        // If we've started off with a route from a `pushState`-enabled
        // browser, but we're currently in a browser that doesn't support it...
        if (!this._hasPushState && !atRoot) {
          this.fragment = this.getFragment(null, true);
          this.location.replace(this.root + this.location.search + '#' + this.fragment);
          // Return immediately as browser will do redirect to new url
          return true;

        // Or if we've started out with a hash-based route, but we're currently
        // in a browser where it could be `pushState`-based instead...
        } else if (this._hasPushState && atRoot && loc.hash) {
          this.fragment = this.getHash().replace(routeStripper, '');
          this.history.replaceState({}, document.title, this.root + this.fragment + loc.search);
        }

      }

      if (!this.options.silent) return this.loadUrl();
    },

    // Disable Backbone.history, perhaps temporarily. Not useful in a real app,
    // but possibly useful for unit testing Routers.
    stop: function() {
      Backbone.$(window).off('popstate', this.checkUrl).off('hashchange', this.checkUrl);
      clearInterval(this._checkUrlInterval);
      History.started = false;
    },

    // Add a route to be tested when the fragment changes. Routes added later
    // may override previous routes.
    route: function(route, callback) {
      this.handlers.unshift({route: route, callback: callback});
    },

    // Checks the current URL to see if it has changed, and if it has,
    // calls `loadUrl`, normalizing across the hidden iframe.
    checkUrl: function(e) {
      var current = this.getFragment();
      if (current === this.fragment && this.iframe) {
        current = this.getFragment(this.getHash(this.iframe));
      }
      if (current === this.fragment) return false;
      if (this.iframe) this.navigate(current);
      this.loadUrl();
    },

    // Attempt to load the current URL fragment. If a route succeeds with a
    // match, returns `true`. If no defined routes matches the fragment,
    // returns `false`.
    loadUrl: function(fragment) {
      fragment = this.fragment = this.getFragment(fragment);
      return _.any(this.handlers, function(handler) {
        if (handler.route.test(fragment)) {
          handler.callback(fragment);
          return true;
        }
      });
    },

    // Save a fragment into the hash history, or replace the URL state if the
    // 'replace' option is passed. You are responsible for properly URL-encoding
    // the fragment in advance.
    //
    // The options object can contain `trigger: true` if you wish to have the
    // route callback be fired (not usually desirable), or `replace: true`, if
    // you wish to modify the current URL without adding an entry to the history.
    navigate: function(fragment, options) {
      if (!History.started) return false;
      if (!options || options === true) options = {trigger: !!options};

      var url = this.root + (fragment = this.getFragment(fragment || ''));

      // Strip the fragment of the query and hash for matching.
      fragment = fragment.replace(pathStripper, '');

      if (this.fragment === fragment) return;
      this.fragment = fragment;

      // Don't include a trailing slash on the root.
      if (fragment === '' && url !== '/') url = url.slice(0, -1);

      // If pushState is available, we use it to set the fragment as a real URL.
      if (this._hasPushState) {
        this.history[options.replace ? 'replaceState' : 'pushState']({}, document.title, url);

      // If hash changes haven't been explicitly disabled, update the hash
      // fragment to store history.
      } else if (this._wantsHashChange) {
        this._updateHash(this.location, fragment, options.replace);
        if (this.iframe && (fragment !== this.getFragment(this.getHash(this.iframe)))) {
          // Opening and closing the iframe tricks IE7 and earlier to push a
          // history entry on hash-tag change.  When replace is true, we don't
          // want this.
          if(!options.replace) this.iframe.document.open().close();
          this._updateHash(this.iframe.location, fragment, options.replace);
        }

      // If you've told us that you explicitly don't want fallback hashchange-
      // based history, then `navigate` becomes a page refresh.
      } else {
        return this.location.assign(url);
      }
      if (options.trigger) return this.loadUrl(fragment);
    },

    // Update the hash location, either replacing the current entry, or adding
    // a new one to the browser history.
    _updateHash: function(location, fragment, replace) {
      if (replace) {
        var href = location.href.replace(/(javascript:|#).*$/, '');
        location.replace(href + '#' + fragment);
      } else {
        // Some browsers require that `hash` contains a leading #.
        location.hash = '#' + fragment;
      }
    }

  });

  // Create the default Backbone.history.
  Backbone.history = new History;

  // Helpers
  // -------

  // Helper function to correctly set up the prototype chain, for subclasses.
  // Similar to `goog.inherits`, but uses a hash of prototype properties and
  // class properties to be extended.
  var extend = function(protoProps, staticProps) {
    var parent = this;
    var child;

    // The constructor function for the new subclass is either defined by you
    // (the "constructor" property in your `extend` definition), or defaulted
    // by us to simply call the parent's constructor.
    if (protoProps && _.has(protoProps, 'constructor')) {
      child = protoProps.constructor;
    } else {
      child = function(){ return parent.apply(this, arguments); };
    }

    // Add static properties to the constructor function, if supplied.
    _.extend(child, parent, staticProps);

    // Set the prototype chain to inherit from `parent`, without calling
    // `parent`'s constructor function.
    var Surrogate = function(){ this.constructor = child; };
    Surrogate.prototype = parent.prototype;
    child.prototype = new Surrogate;

    // Add prototype properties (instance properties) to the subclass,
    // if supplied.
    if (protoProps) _.extend(child.prototype, protoProps);

    // Set a convenience property in case the parent's prototype is needed
    // later.
    child.__super__ = parent.prototype;

    return child;
  };

  // Set up inheritance for the model, collection, router, view and history.
  Model.extend = Collection.extend = Router.extend = View.extend = History.extend = extend;

  // Throw an error when a URL is needed, and none is supplied.
  var urlError = function() {
    throw new Error('A "url" property or function must be specified');
  };

  // Wrap an optional error callback with a fallback error event.
  var wrapError = function(model, options) {
    var error = options.error;
    options.error = function(resp) {
      if (error) error(model, resp, options);
      model.trigger('error', model, resp, options);
    };
  };

}).call(this);

define("backbone", ["underscore","jquery","handlebars"], (function (global) {
    return function () {
        var ret, fn;
        return ret || global.Backbone;
    };
}(this)));

/**
 * W2GI AJAX Layer for Backbone
 * WALB
 * @namespace Backbone
 */

define('walb',['backbone', 'jquery'], function(Backbone, $) {

	/**
	 * This is a copy of the old Backbone.sync
	 * @method Backbone.jsonSync
	 * @param {String} method
	 * @param {Backbone.Model|Backbone.Collection} model
	 * @param {Object} options
	 */
	Backbone.jsonSync = Backbone.sync;

	var optionalFormdata = {
		where:      'where',
		limit:      'limit',
		endDate:    'param1',
		startDate:  'param2',
		param1:     'param1',
		param2:     'param2',
		param3:     'param3',
		order:      'order',
		offset:     'offset',
		columns:    'columns',
    geolocs:    'geolocs',
    dataview:		'dataview',
    searchradius: 'searchradius',
    social: 			'social'
	}

	/**
	 * @method Backbone.w2giSync
	 * @param {String} method
	 * @param {Backbone.Model|Backbone.Collection} model
	 * @param {Object} options
	 */
	Backbone.w2giSync = function(method, model, options) {
		var self = this, formdata, reqObj, ajaxURL= '', cache = {}

		var getW2GICookie = function () {
			var name = 'W2GISM=',
				ca = document.cookie.split(';')
			for(var i=0;i < ca.length;i++) {
				var c = ca[i]
				while (c.charAt(0) ==' ')  { c = c.substring(1, c.length) }
				if (c.indexOf(name) === 0) { return c.substring(name.length, c.length) }
			}
			return null
		}

		var setW2GICookie = function () {
			var cookie = getW2GICookie()
			if (cookie) {
				clearW2GICookie()
				var date = new Date()
				date.setTime(date.getTime()+(1*24*60*60*1000))
				if (/-\d+/g.test(cookie)) {
					cookie = cookie.split("-")[0]
				}
				document.cookie = 'W2GISM=' + cookie + '-' + Math.floor(Math.random()*1000) + ';expires=' + date.toGMTString()+';domain=.'+document.domain+';path=/'
			}
		}

		var clearW2GICookie = function() {
			var str = 'W2GISM=;expires=Thu, 01-Jan-1970 00:00:00 GMT;domain=.ignite.dev.where2getit.com;'
			document.cookie = str
		}

		if (!!options.formdata){
			formdata = options.formdata;
		}
		else {
			formdata = {
				_like: Math.random(),
				objectname: (options.objectName || model.objectName || model.get('objectName') || model.model.objectName)
			};

			if (!formdata.objectname) {
				delete formdata.objectName
			}
		}

		ajaxURL += (options.url || model.get('url') || model.url || model.model.url || W2GI.config.url || 'rest')
		ajaxURL += '/' + options.method || ''
		ajaxURL += '?like=' + Math.random()
		ajaxURL += ace.locale.current ? '&lang=' + ace.locale.current : '';

		if(!!options.allowcache) {
			delete formdata._like;
		}

		switch(method) {
			case "read":
				// getlist req
				//Id no longer present
				//formdata._id = options.formdataid || 'getlist';

				if (typeof options.softmatch != 'undefined') {
					formdata._softmatch = '1';
				}

				/*_.each(optionalFormdata, function(param, option) {
					if (typeof options[option] != 'undefined') {
						formdata[param] = options[option];
					}
				});
				*/
			break;
			case "update":
				// object_edit req
				formdata._id = options.formdataid || 'object_edit';
				formdata['object'] = model.toJSON();
			break;
			case "create":
				// object_add req
				formdata._id = options.formdataid || 'object_add';
				formdata['object'] = model.toJSON();
			break;
		}

        _.each(formdata, function(param) {
            if (param === false) {
                formdata[param] = '0'
            } else if (param === true) {
                formdata[param] = '1'
            }
        });

		if (!formdata._id) {
			//return;
		}

		reqObj = {
			'request': {
				'appkey': W2GI.config.appkey || options.appkey || $('#appkey').val(),  //TODO: need to get this from some kind of config
				'formdata': formdata
			}
		}

		if (formdata.geoip) {
			reqObj.request['geoip'] = 1
		}

		if (!options.noAccount) {
			reqObj.request.account = options.account || $('#account').val()
		}

		// ajax activity
		var $ajaxTA = $(options.ajaxLoader || '.ajax-loader' );
		if (!$ajaxTA.length) {
			$ajaxTA = $('#ajax_activity');
		}
		$ajaxTA.toggle(true);


		// we attach a random number to the session id
		if (formdata._id === 'getreport') {
			setW2GICookie()
		}
		var reqStr = JSON.stringify(reqObj),
			cachedResponse = ace.cache.get(reqStr)

		if (cachedResponse && !options.noCache) {
			if (cachedResponse.attributes) {
				options.responseAttributes = cachedResponse.attributes
				if (cachedResponse.collectioncount) {
					options.responseAttributes.collectioncount = cachedResponse.collectioncount
				}
			}
			if (cachedResponse && cachedResponse.collection && cachedResponse.collectionname !== 'multiple_address') {
				cachedResponse = cachedResponse.collection || {};
			}
			var tagName = (model.tagName || (model.model ? model.model.tagName : null));
			if (tagName && !!res[tagName]) { res = res[tagName] || []; }
			if (typeof options.success == 'function') {
				options.success(cachedResponse, options);
			}
			if (!!model) {
				model.trigger('sync', model, cachedResponse, options);
			}
			return
		}

		$.ajax({
			url: ajaxURL,
			type: 'POST',
			beforeSend: function(xhr) {
				if (!!model) { model.trigger('request', model, xhr, options) }
			},
            contentType: 'application/json',
			data: reqStr,
            dataType:'json'
		}).done(function(response, status, xhr){
			var res  = response.response ? response.response : response
			$ajaxTA.toggle(false);

			if (response.code && response.code != '1' && response.code != '1006') {
				$(document).trigger("w2gi:fetchError", {
					xhr: xhr,
					error: res && res.message,
					errorCode: response.code
				})
				//error(xhr, response.message.text, response.code);
				return;
			}

			if (method == 'read') {
				ace.cache.add(reqStr, res)
				if (res.attributes) {
					options.responseAttributes = res.attributes
					options.responseAttributes.collectionName = res.collectionname
					if (res.collectioncount) {
						options.responseAttributes.collectioncount = res.collectioncount
					}
				}



				if (res && res.collection && res.collectionname !== 'multiple_address') {
					res = res.collection || {};
				}

				var tagName = (model.tagName || (model.model ? model.model.tagName : null));
				if (tagName && !!res[tagName]) { res = res[tagName] || []; }
				// nested array like multiple_address
				// if (!_.isEmpty(res) && _.isArray(res) && res.length === 1) {
					// res = res[0]
				// }
			}
			else {
				// backbone will try to set attributes if response has data
				res = '';
			}

			if (typeof options.success == 'function') {
				options.success(res, options);
			}
			if (!!model) {
				model.trigger('sync', model, res, options);
			}
		}).fail(function(xhr, errorType, err) {
			$(document).trigger("w2gi:fetchError", {
				xhr: xhr,
				errorType: errorType,
				error:  xhr.responseText
			})
			$ajaxTA.toggle(false);
			if (typeof options.error == 'function') {
				options.error(model, xhr, options);
			}
			if (!!model) {
				model.trigger('error', model, xhr, options);
			}

			var loc = xhr.getResponseHeader('Location');
			if (loc) {
				location.href = loc;
			}
		})
	}
	/**
	 * W2GI override of Backbone.sync
	 * By default this will use Backbone.w2giSync.
	 * To use the original Backbone.sync, pass jsonSync: true
	 * in the options object.
	 * @method
	 * @param {String} method
	 * @param {Backbone.Model|Backbone.Collection} model
	 * @param {Object} options
	 */
	Backbone.sync = function(method, model, options) {
		options = !!options ? options : {};
		if(options.jsonSync) {
			Backbone.jsonSync(method, model, options);
		} else {
			//Backbone.w2giSync(method, model, options);
			Backbone.w2giSync.apply(this, arguments)
		}
	};

	//return WALB
 })
;
/**
*
*   Core module - load modules, event aggregator
*
    @method load core.load - loads modules from an optional container
    @param {Object} target - (optional) load all modules specified by html elements with a data-acemodule attribute

    @method EA - core.EA - event aggregator
*
*/

define('core',[
    'backbone',
    'walb',
    'jquery'
    ],
    function( Backbone, WALB, $){

     if (!('remove' in Element.prototype)) {
        Element.prototype.remove = function() {
            if (this.parentNode) {
                this.parentNode.removeChild(this)
            }
        }
    }
	var core = {

        loadModule: function (el) {
            var $el         = $(el)
            var moduleName  = $el.data('w2gi')

            require(['src/' + moduleName +'/module'],
                function(object) {
                    var opts = W2GI.config[moduleName]

                    if (opts) {
                        delete W2GI.config[moduleName]
                        if (opts.drivingdirections) {
                            W2GI.config.language = opts.drivingdirections.language
                            W2GI.config.region = opts.drivingdirections.region
                        }

                    }
                    var options = _.extend({element:$el}, opts)
                    object.init(options)
            })
        },
        /*
        *   Get all elements on the page with 'data-w2gi'
        */
        load: function(target) {
            var el      = target || $('html'),
                modules = $('[data-w2gi]', el)
            if (W2GI.config.autoStart === false) {
                delete W2GI.config.autoStart
                return
            }
            _.each(modules, core.loadModule)
        },

        cache: {
            _cache: {},
            add: function(key, value) {
                this._cache[key] = value;
            },
            get: function(key) {
                return this._cache[key];
            },
            destroy: function() {
                this._cache = null;
            }
        }
    }
	return core
})
;
//      Pop Easy | jQuery Modal Plugin
//      Version 1.0
//      Created 2013 by Thomas Grauer
///////////////////////////////////////////////////////////////////////////////////////
//      Permission is hereby granted, free of charge, to any person obtaining
//      a copy of this software and associated documentation files (the
//      "Software"), to deal in the Software without restriction, including
//      without limitation the rights to use, copy, modify, merge, publish,
//      distribute, sublicense, and/or sell copies of the Software, and to
//      permit persons to whom the Software is furnished to do so, subject to
//      the following conditions:
//
//      The above copyright notice and this permission notice shall be
//      included in all copies or substantial portions of the Software.
//
//      THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
//      EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
//      MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
//      NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
//      LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
//      OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
//      WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
///////////////////////////////////////////////////////////////////////////////////////

(function (factory) {
    if (typeof define === 'function' && define.amd) {
        // AMD. Register as an anonymous module.
        define('dialog',['jquery'], factory);
    } else {
        // Browser globals
        factory(jQuery);
    }
}(function ($) {
    //$.fn.jqueryPlugin = function () {};

//(function($){

    $.fn.modal= function(options){
       
        options = $.extend({
            trigger: '.modalLink',
            olay: 'div.overlay',
            modals: 'div.modal',
            animationEffect: 'fadeIn',
            animationSpeed: 400,
            moveModalSpeed: 'slow',
            background: '000',
            opacity: 0.8,
            openOnLoad: true,
            docClose: true,
            closeByEscape: true,
            moveOnScroll: true,
            resizeWindow: true,
            video:'',
            videoClass:'video',
            close:'.closeBtn'
            
        },options);
       
        var olay = $(options.olay);
        var modals = $(options.modals);
        var currentModal =  $('.modal');
        var isopen=false;
       
        if (options.animationEffect==='fadein'){options.animationEffect = 'fadeIn';}
        if (options.animationEffect==='slidedown'){options.animationEffect = 'slideDown';}
        
        olay.css({opacity : 0});
                
        if(options.openOnLoad) {
            openModal();
        }else{
            olay.hide();
            modals.hide();
        }
        
        $(options.trigger).bind('click', function(e){
            e.preventDefault();
            
            if ($('.modalLink').length >1) {
                getModal = $(this).attr('href');
                currentModal = $(getModal);    
            }else{
                currentModal = $('.modal');
            }
            openModal();
        });
        
        function openModal(){
            $('.' + options.videoClass).attr('src',options.video);
            modals.hide();
            currentModal.css({
                top:$(window).height() /2 - currentModal.outerHeight() /2 + $(window).scrollTop(),
                left:$(window).width() /2 - currentModal.outerWidth() /2 + $(window).scrollLeft()
            });
                
            if(isopen===false){
                olay.css({opacity : options.opacity, backgroundColor: '#'+options.background});
                olay[options.animationEffect](options.animationSpeed);
                currentModal.delay(options.animationSpeed)[options.animationEffect](options.animationSpeed); 
            }else{
                currentModal.show();
            }
            
            isopen=true;
        }
        
        function moveModal(){
            modals
            .stop(true)
            .animate({
            top:$(window).height() /2 - modals.outerHeight() /2 + $(window).scrollTop(),
            left:$(window).width() /2 - modals.outerWidth() /2 + $(window).scrollLeft()
            },options.moveModalSpeed);
        }
        
        function closeModal(){
            $('.' + options.videoClass).attr('src',''); 
            isopen=false;
            modals.fadeOut(100, function(){
                if (options.animationEffect === 'slideDown') {
                    olay.slideUp();
                }else if (options.animationEffect === 'fadeIn') {
                    olay.fadeOut();
                }
            });
            return false;
        }
        
        if(options.docClose){
            olay.bind('click', closeModal);
        }
        
        $(options.close).bind('click', closeModal);
        
        if (options.closeByEscape) {
            $(window).bind('keyup', function(e){
                if(e.which === 27){
                    closeModal();
                }
            });
        }
        
        if (options.resizeWindow) {
            $(window).bind('resize', moveModal);
        }else{
            return false;
        }
        
        if (options.moveOnScroll) {
            $(window).bind('scroll', moveModal);
        }else{
            return false;
        }
    };
}));

/**
*
* Base View stub for now
* 
*
*/

define('src/core/baseview',['dialog', 'jquery', 'backbone'], function(dialog, $, Backbone) {
        /*
        *   Event aggregator
        */
        Backbone.View.prototype.ea = _.extend({}, Backbone.Events)
        /*
        * Underscore mixins
        */
        
        return Backbone.View.extend({
          setCSSClasses: function(options) {

          },
          getQueryParams: function() {
            var match,
                pl     = /\+/g,  // Regex for replacing addition symbol with a space
                search = /([^&=]+)=?([^&]*)/g,
                decode = function (s) { return decodeURIComponent(s.replace(pl, " ")); },
                query  = window.location.search.substring(1)

            urlParams = {};
            while (match = search.exec(query)) {
               urlParams[decode(match[1]).toLowerCase()] = decode(match[2])
            }
            return urlParams 
        },

        dialogOpen: function(content) {

          //$('.modal').modal()
        },

        getParamsMultiple: function() {
          var regex = new RegExp('addressline' + "=([^&#]*)", 'ig'),
              params = window.location.search.match(regex)
              result = []

          if (params && params.length && params.length > 1) {
            var queryItems = params.map(function(e) { return e.split('=')[1] }),
                qp = this.getQueryParams(),
                sa, ea

            sa = {
              addressline: decodeURIComponent((queryItems[0] + '').replace(/\+/g, '%20')),
              latitude: qp.latitude || '',
              longitude: qp.longitude || ''
            }
            ea = {
              addressline: decodeURIComponent((queryItems[1] + '').replace(/\+/g, '%20')),
              latitude: qp.dest_latitude || '',
              longitude: qp.dest_longitude || '' 
            }
            result = [sa, ea]
          }
          return result
        },
        
        checkQuery: function() {
            var query = window.location.search,
                params = null

            if (query && query.length > 0) {
                params = this.getQueryParams()
            }
            if (params && params.redirection) {
              delete params.redirection
            }
            return _.isEmpty(params) ? null : params
        },
        populateForm: function(form, items) {
          this.deserializeForm(form, items)
        },
        getFormValues: function(form, noValues) {
          var result = {},
              noValues
          $( 'input', '#' + form ).each(function() {

              var el = $(this),
                  type  = el.attr('type')
              if ($(this).attr('name')) {
                if (type === 'checkbox') {
                  var chk = $(this).is(':checked')
                  if (chk) {
                    result[$(this).attr('name')] = '' + ( this.value == 'on' ? true : this.value)
                  }
                } else if (type === 'radio'){
                  var chk = $(this).is(':checked')
                  if (chk) {
                    result[$(this).attr('name')] = $(this).val()   
                  }
                } else {
                  result[$(this).attr('name')] = $(this).val().replace(/[|&;$%@"<>/\()+]/g, '')
                }
              }              
          })
          $( 'select', '#' + form ).each(function() {
            var thisVal = $(this).val()
            if (thisVal) {
              result[$(this).attr('name')] = thisVal //.replace(/[|&;$%@"<>/\()+]/g, '')  
            }
            
          })
          return result
        },
        deserializeForm: function(form, items) {
          var params = items || this.checkQuery()

          if (!_.isEmpty(params)) {
            params = _.omit(params, 'form')
            if(form == 'driving_directions') params = _.omit(params, 'addressline')
            try {
                if(form == 'locator_search' && items && items.addressline && items.addressline.length && this.searchedLonLat == true)  {
                    $('#' + form).find('[name=addressline]').val(items.addressline);
                 }
            } catch (e) {}
            $.each(params, function(i, el) {
              var fel = $('#' + form).find('*[name="' + i + '"]'),
                  type = '', 
                  tag = ''

               if (fel.length > 0 && !fel[0].attributes['exclude']) {

                   tag = fel[0].tagName.toLowerCase();

                   if (tag == "select" || tag == "textarea") {
                      $(fel).val(el)
                   }
                   else if (tag == "input") {
                      type = $(fel[0]).attr("type")
                       if (type == "text" || type == "password" || type == "hidden") {
                          ($(fel).val().length == 0 || $(fel).val() == "Enter street address, city, state or zip code") && fel.val(el);
                       } 
                       else if (type == "checkbox") {
                          if (el) { fel.attr("checked", "checked") }
                       }
                       else if (type == "radio") {
                           fel.filter('[value="'+el+'"]').attr("checked", "checked")
                       }
                   }
              }
            })
            return params
          }
        },
	runLocaleProcessor: function(htmlContent) {
		try {
			var preHtml = '<div>' + htmlContent + '</div>';
			var htmlObj = $(preHtml);
			var elemList = htmlObj.find('*[msgid]');
			elemList.each(function(e, elem) {
				var msgid = $(elem).attr('msgid'); 
				elem.innerHTML = ace.locale.gettext(msgid);
			});
			var html = htmlObj.html();
			// If IE11 or Edge Browser
			if (navigator.appVersion.indexOf('Trident/') < 0 && navigator.appVersion.indexOf('Edge/') < 0) {
				html = html.replace(/#if=""/g, '#if');
				html = html.replace(/{{=""\s+/g, '{{/');
				html = html.replace(/}}=""/g, '}}');
			} else {
				html = html.replace(/{{#if=""/g, '{{/if}}');
				html = html.replace(/if}}="" {{=""/g, '{{#if');
			}
			htmlContent = html;
		} catch (e) {
		}

		return htmlContent;
	},
        loadTemplate: function(template, options) {
          var html = $('script#' + template).html() || "";
	  html = this.runLocaleProcessor(html);
          return Handlebars.compile(html, options)
        },
        /**
         * Same as `loadTemplate`, but instead of using an `id` it uses the
         * `data` attribute to return multiple templates in a hash, with the
         * key equal to the `id` of the elements found.
         *
         * @param {string} dataName The name of the `data` attribute to use
         *     to fetch the templates
         * @param {Object} options Options.
         * @return {Object.<string, Function>}
         * @protected
         */
        loadTemplates: function(dataName, options) {
          var templates = {};
          var els = $('script[data-' + dataName + '=true]');
          var el
          for (var i = 0, len = els.length; i < len; i++) {
            el = els[i];
	    var html = $(el).html();
	    html = this.runLocaleProcessor(html);
            templates[el.id] = Handlebars.compile(
              html,
              options
            );
          }
          return templates;
        },
        getTarget: function(ev) {
          return $(ev.target ? ev.target : $(ev.srcElement))
        }
      })
  }
)
;
// OpenLayers 3. See http://openlayers.org/
// License: https://raw.githubusercontent.com/openlayers/ol3/master/LICENSE.md
// Version: v3.10.1-61-gc86a61e-4-g3a24070

(function (root, factory) {
  if (typeof exports === "object") {
    module.exports = factory();
  } else if (typeof define === "function" && define.amd) {
    define('ol',[], factory);
  } else {
    root.ol = factory();
  }
}(this, function () {
  var OPENLAYERS = {};
  var l,aa=aa||{},ba=this;function ca(a){return void 0!==a}function t(a,c,d){a=a.split(".");d=d||ba;a[0]in d||!d.execScript||d.execScript("var "+a[0]);for(var e;a.length&&(e=a.shift());)!a.length&&ca(c)?d[e]=c:d[e]?d=d[e]:d=d[e]={}}function da(){}function ea(a){a.Eb=function(){return a.jg?a.jg:a.jg=new a}}
function fa(a){var c=typeof a;if("object"==c)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return c;var d=Object.prototype.toString.call(a);if("[object Window]"==d)return"object";if("[object Array]"==d||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==d||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==c&&"undefined"==typeof a.call)return"object";return c}function ga(a){return"array"==fa(a)}function ha(a){var c=fa(a);return"array"==c||"object"==c&&"number"==typeof a.length}function ia(a){return"string"==typeof a}function ja(a){return"number"==typeof a}function ka(a){return"function"==fa(a)}function la(a){var c=typeof a;return"object"==c&&null!=a||"function"==c}function v(a){return a[ma]||(a[ma]=++na)}var ma="closure_uid_"+(1E9*Math.random()>>>0),na=0;
function oa(a,c,d){return a.call.apply(a.bind,arguments)}function pa(a,c,d){if(!a)throw Error();if(2<arguments.length){var e=Array.prototype.slice.call(arguments,2);return function(){var d=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(d,e);return a.apply(c,d)}}return function(){return a.apply(c,arguments)}}function qa(a,c,d){qa=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?oa:pa;return qa.apply(null,arguments)}
function ra(a,c){var d=Array.prototype.slice.call(arguments,1);return function(){var c=d.slice();c.push.apply(c,arguments);return a.apply(this,c)}}var sa=Date.now||function(){return+new Date};function w(a,c){function d(){}d.prototype=c.prototype;a.ca=c.prototype;a.prototype=new d;a.prototype.constructor=a;a.Ho=function(a,d,g){for(var h=Array(arguments.length-2),k=2;k<arguments.length;k++)h[k-2]=arguments[k];return c.prototype[d].apply(a,h)}};var ta,ua;function va(){};function xa(a){if(Error.captureStackTrace)Error.captureStackTrace(this,xa);else{var c=Error().stack;c&&(this.stack=c)}a&&(this.message=String(a))}w(xa,Error);xa.prototype.name="CustomError";var ya;function za(a,c){var d=a.length-c.length;return 0<=d&&a.indexOf(c,d)==d}function Aa(a,c){for(var d=a.split("%s"),e="",f=Array.prototype.slice.call(arguments,1);f.length&&1<d.length;)e+=d.shift()+f.shift();return e+d.join("%s")}var Ba=String.prototype.trim?function(a){return a.trim()}:function(a){return a.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")};
function Ca(a){if(!Da.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(Ea,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(Fa,"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(Ga,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(Ha,"&quot;"));-1!=a.indexOf("'")&&(a=a.replace(Ia,"&#39;"));-1!=a.indexOf("\x00")&&(a=a.replace(Ja,"&#0;"));return a}var Ea=/&/g,Fa=/</g,Ga=/>/g,Ha=/"/g,Ia=/'/g,Ja=/\x00/g,Da=/[\x00&<>"']/,Ka=String.prototype.repeat?function(a,c){return a.repeat(c)}:function(a,c){return Array(c+1).join(a)};
function La(a){a=ca(void 0)?a.toFixed(void 0):String(a);var c=a.indexOf(".");-1==c&&(c=a.length);return Ka("0",Math.max(0,2-c))+a}
function Na(a,c){for(var d=0,e=Ba(String(a)).split("."),f=Ba(String(c)).split("."),g=Math.max(e.length,f.length),h=0;0==d&&h<g;h++){var k=e[h]||"",m=f[h]||"",n=RegExp("(\\d*)(\\D*)","g"),p=RegExp("(\\d*)(\\D*)","g");do{var q=n.exec(k)||["","",""],r=p.exec(m)||["","",""];if(0==q[0].length&&0==r[0].length)break;d=Pa(0==q[1].length?0:parseInt(q[1],10),0==r[1].length?0:parseInt(r[1],10))||Pa(0==q[2].length,0==r[2].length)||Pa(q[2],r[2])}while(0==d)}return d}function Pa(a,c){return a<c?-1:a>c?1:0};function Qa(a,c,d){return Math.min(Math.max(a,c),d)}function Ra(a,c,d,e,f,g){var h=f-d,k=g-e;if(0!==h||0!==k){var m=((a-d)*h+(c-e)*k)/(h*h+k*k);1<m?(d=f,e=g):0<m&&(d+=h*m,e+=k*m)}return Sa(a,c,d,e)}function Sa(a,c,d,e){a=d-a;c=e-c;return a*a+c*c}function Ta(a){return a*Math.PI/180};function Va(a){return function(c){if(c)return[Qa(c[0],a[0],a[2]),Qa(c[1],a[1],a[3])]}}function Wa(a){return a};var Xa=Array.prototype;function Ya(a,c){return Xa.indexOf.call(a,c,void 0)}function Za(a,c){Xa.forEach.call(a,c,void 0)}function $a(a,c){return Xa.filter.call(a,c,void 0)}function ab(a,c){return Xa.map.call(a,c,void 0)}function bb(a,c){return Xa.some.call(a,c,void 0)}function cb(a,c){var d=db(a,c,void 0);return 0>d?null:ia(a)?a.charAt(d):a[d]}function db(a,c,d){for(var e=a.length,f=ia(a)?a.split(""):a,g=0;g<e;g++)if(g in f&&c.call(d,f[g],g,a))return g;return-1}
function fb(a,c){var d=Ya(a,c),e;(e=0<=d)&&Xa.splice.call(a,d,1);return e}function gb(a){return Xa.concat.apply(Xa,arguments)}function hb(a){var c=a.length;if(0<c){for(var d=Array(c),e=0;e<c;e++)d[e]=a[e];return d}return[]}function ib(a,c){for(var d=1;d<arguments.length;d++){var e=arguments[d];if(ha(e)){var f=a.length||0,g=e.length||0;a.length=f+g;for(var h=0;h<g;h++)a[f+h]=e[h]}else a.push(e)}}function jb(a,c,d,e){Xa.splice.apply(a,kb(arguments,1))}
function kb(a,c,d){return 2>=arguments.length?Xa.slice.call(a,c):Xa.slice.call(a,c,d)}function lb(a,c){a.sort(c||mb)}function nb(a){for(var c=ob,d=0;d<a.length;d++)a[d]={index:d,value:a[d]};var e=c||mb;lb(a,function(a,c){return e(a.value,c.value)||a.index-c.index});for(d=0;d<a.length;d++)a[d]=a[d].value}function pb(a,c){if(!ha(a)||!ha(c)||a.length!=c.length)return!1;for(var d=a.length,e=rb,f=0;f<d;f++)if(!e(a[f],c[f]))return!1;return!0}function mb(a,c){return a>c?1:a<c?-1:0}
function rb(a,c){return a===c}function sb(a){for(var c=[],d=0;d<arguments.length;d++){var e=arguments[d];if(ga(e))for(var f=0;f<e.length;f+=8192)for(var g=sb.apply(null,kb(e,f,f+8192)),h=0;h<g.length;h++)c.push(g[h]);else c.push(e)}return c};function tb(a,c){return 0<=a.indexOf(c)}function ub(a,c,d){var e=a.length;if(a[0]<=c)return 0;if(!(c<=a[e-1]))if(0<d)for(d=1;d<e;++d){if(a[d]<c)return d-1}else if(0>d)for(d=1;d<e;++d){if(a[d]<=c)return d}else for(d=1;d<e;++d){if(a[d]==c)return d;if(a[d]<c)return a[d-1]-c<c-a[d]?d-1:d}return e-1};function vb(a){return function(c,d,e){if(void 0!==c)return c=ub(a,c,e),c=Qa(c+d,0,a.length-1),a[c]}}function wb(a,c,d){return function(e,f,g){if(void 0!==e)return e=Math.max(Math.floor(Math.log(c/e)/Math.log(a)+(0<g?0:0>g?1:.5))+f,0),void 0!==d&&(e=Math.min(e,d)),c/Math.pow(a,e)}};function xb(a){if(void 0!==a)return 0}function yb(a,c){if(void 0!==a)return a+c}function zb(a){var c=2*Math.PI/a;return function(a,e){if(void 0!==a)return a=Math.floor((a+e)/c+.5)*c}}function Ab(){var a=Ta(5);return function(c,d){if(void 0!==c)return Math.abs(c+d)<=a?0:c+d}};function Bb(a,c,d){this.center=a;this.resolution=c;this.rotation=d};var Cb;a:{var Db=ba.navigator;if(Db){var Eb=Db.userAgent;if(Eb){Cb=Eb;break a}}Cb=""}function Fb(a){return-1!=Cb.indexOf(a)};function Gb(a,c,d){for(var e in a)c.call(d,a[e],e,a)}function Hb(a,c){for(var d in a)if(c.call(void 0,a[d],d,a))return!0;return!1}function Jb(a){var c=0,d;for(d in a)c++;return c}function Kb(a){var c=[],d=0,e;for(e in a)c[d++]=a[e];return c}function Lb(a){var c=[],d=0,e;for(e in a)c[d++]=e;return c}function Mb(a,c){return c in a}function Nb(a,c){for(var d in a)if(a[d]==c)return!0;return!1}function Ob(a,c){for(var d in a)if(c.call(void 0,a[d],d,a))return d}
function Pb(a){for(var c in a)return!1;return!0}function Qb(a){for(var c in a)delete a[c]}function Rb(a,c,d){return c in a?a[c]:d}function Sb(a,c){var d=[];return c in a?a[c]:a[c]=d}function Tb(a){var c={},d;for(d in a)c[d]=a[d];return c}function Ub(a){var c=fa(a);if("object"==c||"array"==c){if(ka(a.clone))return a.clone();var c="array"==c?[]:{},d;for(d in a)c[d]=Ub(a[d]);return c}return a}var Vb="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");
function Wb(a,c){for(var d,e,f=1;f<arguments.length;f++){e=arguments[f];for(d in e)a[d]=e[d];for(var g=0;g<Vb.length;g++)d=Vb[g],Object.prototype.hasOwnProperty.call(e,d)&&(a[d]=e[d])}};var Xb=Fb("Opera")||Fb("OPR"),Yb=Fb("Trident")||Fb("MSIE"),Zb=Fb("Edge"),$b=Fb("Gecko")&&!(-1!=Cb.toLowerCase().indexOf("webkit")&&!Fb("Edge"))&&!(Fb("Trident")||Fb("MSIE"))&&!Fb("Edge"),ac=-1!=Cb.toLowerCase().indexOf("webkit")&&!Fb("Edge"),bc=Fb("Macintosh"),cc=Fb("Windows"),dc=Fb("Linux")||Fb("CrOS");function ec(){var a=Cb;if($b)return/rv\:([^\);]+)(\)|;)/.exec(a);if(Zb)return/Edge\/([\d\.]+)/.exec(a);if(Yb)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(a);if(ac)return/WebKit\/(\S+)/.exec(a)}
function fc(){var a=ba.document;return a?a.documentMode:void 0}var gc=function(){if(Xb&&ba.opera){var a;var c=ba.opera.version;try{a=c()}catch(d){a=c}return a}a="";(c=ec())&&(a=c?c[1]:"");return Yb&&(c=fc(),c>parseFloat(a))?String(c):a}(),hc={};function ic(a){return hc[a]||(hc[a]=0<=Na(gc,a))}var jc=ba.document,kc=jc&&Yb?fc()||("CSS1Compat"==jc.compatMode?parseInt(gc,10):5):void 0;var mc=!Yb||9<=kc,nc=!Yb||9<=kc,oc=Yb&&!ic("9");!ac||ic("528");$b&&ic("1.9b")||Yb&&ic("8")||Xb&&ic("9.5")||ac&&ic("528");$b&&!ic("8")||Yb&&ic("9");function pc(){0!=qc&&(rc[v(this)]=this);this.ea=this.ea;this.ka=this.ka}var qc=0,rc={};pc.prototype.ea=!1;pc.prototype.Vc=function(){if(!this.ea&&(this.ea=!0,this.Z(),0!=qc)){var a=v(this);delete rc[a]}};function sc(a,c){var d=ra(tc,c);a.ea?d.call(void 0):(a.ka||(a.ka=[]),a.ka.push(ca(void 0)?qa(d,void 0):d))}pc.prototype.Z=function(){if(this.ka)for(;this.ka.length;)this.ka.shift()()};function tc(a){a&&"function"==typeof a.Vc&&a.Vc()};function uc(a,c){this.type=a;this.g=this.target=c;this.i=!1;this.gh=!0}uc.prototype.c=function(){this.i=!0};uc.prototype.preventDefault=function(){this.gh=!1};function vc(a){a.c()}function wc(a){a.preventDefault()};var xc=Yb?"focusout":"DOMFocusOut";function yc(a){yc[" "](a);return a}yc[" "]=da;function zc(a,c){uc.call(this,a?a.type:"");this.relatedTarget=this.g=this.target=null;this.B=this.j=this.button=this.screenY=this.screenX=this.clientY=this.clientX=this.offsetY=this.offsetX=0;this.A=this.f=this.a=this.D=!1;this.state=null;this.l=!1;this.b=null;if(a){var d=this.type=a.type,e=a.changedTouches?a.changedTouches[0]:null;this.target=a.target||a.srcElement;this.g=c;var f=a.relatedTarget;if(f){if($b){var g;a:{try{yc(f.nodeName);g=!0;break a}catch(h){}g=!1}g||(f=null)}}else"mouseover"==d?
f=a.fromElement:"mouseout"==d&&(f=a.toElement);this.relatedTarget=f;null===e?(this.offsetX=ac||void 0!==a.offsetX?a.offsetX:a.layerX,this.offsetY=ac||void 0!==a.offsetY?a.offsetY:a.layerY,this.clientX=void 0!==a.clientX?a.clientX:a.pageX,this.clientY=void 0!==a.clientY?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0);this.button=
a.button;this.j=a.keyCode||0;this.B=a.charCode||("keypress"==d?a.keyCode:0);this.D=a.ctrlKey;this.a=a.altKey;this.f=a.shiftKey;this.A=a.metaKey;this.l=bc?a.metaKey:a.ctrlKey;this.state=a.state;this.b=a;a.defaultPrevented&&this.preventDefault()}}w(zc,uc);var Ac=[1,4,2];function Bc(a){return(mc?0==a.b.button:"click"==a.type?!0:!!(a.b.button&Ac[0]))&&!(ac&&bc&&a.D)}zc.prototype.c=function(){zc.ca.c.call(this);this.b.stopPropagation?this.b.stopPropagation():this.b.cancelBubble=!0};
zc.prototype.preventDefault=function(){zc.ca.preventDefault.call(this);var a=this.b;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,oc)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(c){}};var Cc="closure_listenable_"+(1E6*Math.random()|0);function Dc(a){return!(!a||!a[Cc])}var Ec=0;function Fc(a,c,d,e,f){this.listener=a;this.b=null;this.src=c;this.type=d;this.Oc=!!e;this.Qd=f;this.key=++Ec;this.Ec=this.wd=!1}function Gc(a){a.Ec=!0;a.listener=null;a.b=null;a.src=null;a.Qd=null};function Hc(a){this.src=a;this.b={};this.a=0}Hc.prototype.add=function(a,c,d,e,f){var g=a.toString();a=this.b[g];a||(a=this.b[g]=[],this.a++);var h=Jc(a,c,e,f);-1<h?(c=a[h],d||(c.wd=!1)):(c=new Fc(c,this.src,g,!!e,f),c.wd=d,a.push(c));return c};Hc.prototype.remove=function(a,c,d,e){a=a.toString();if(!(a in this.b))return!1;var f=this.b[a];c=Jc(f,c,d,e);return-1<c?(Gc(f[c]),Xa.splice.call(f,c,1),0==f.length&&(delete this.b[a],this.a--),!0):!1};
function Kc(a,c){var d=c.type;if(!(d in a.b))return!1;var e=fb(a.b[d],c);e&&(Gc(c),0==a.b[d].length&&(delete a.b[d],a.a--));return e}function Lc(a,c,d,e,f){a=a.b[c.toString()];c=-1;a&&(c=Jc(a,d,e,f));return-1<c?a[c]:null}function Mc(a,c,d){var e=ca(c),f=e?c.toString():"",g=ca(d);return Hb(a.b,function(a){for(var c=0;c<a.length;++c)if(!(e&&a[c].type!=f||g&&a[c].Oc!=d))return!0;return!1})}
function Jc(a,c,d,e){for(var f=0;f<a.length;++f){var g=a[f];if(!g.Ec&&g.listener==c&&g.Oc==!!d&&g.Qd==e)return f}return-1};var Nc="closure_lm_"+(1E6*Math.random()|0),Oc={},Pc=0;function B(a,c,d,e,f){if(ga(c)){for(var g=0;g<c.length;g++)B(a,c[g],d,e,f);return null}d=Qc(d);return Dc(a)?a.Sa(c,d,e,f):Rc(a,c,d,!1,e,f)}
function Rc(a,c,d,e,f,g){if(!c)throw Error("Invalid event type");var h=!!f,k=Sc(a);k||(a[Nc]=k=new Hc(a));d=k.add(c,d,e,f,g);if(d.b)return d;e=Tc();d.b=e;e.src=a;e.listener=d;if(a.addEventListener)a.addEventListener(c.toString(),e,h);else if(a.attachEvent)a.attachEvent(Uc(c.toString()),e);else throw Error("addEventListener and attachEvent are unavailable.");Pc++;return d}
function Tc(){var a=Vc,c=nc?function(d){return a.call(c.src,c.listener,d)}:function(d){d=a.call(c.src,c.listener,d);if(!d)return d};return c}function Wc(a,c,d,e,f){if(ga(c)){for(var g=0;g<c.length;g++)Wc(a,c[g],d,e,f);return null}d=Qc(d);return Dc(a)?a.jb.add(String(c),d,!0,e,f):Rc(a,c,d,!0,e,f)}function Xc(a,c,d,e,f){if(ga(c))for(var g=0;g<c.length;g++)Xc(a,c[g],d,e,f);else d=Qc(d),Dc(a)?a.Af(c,d,e,f):a&&(a=Sc(a))&&(c=Lc(a,c,d,!!e,f))&&Yc(c)}
function Yc(a){if(ja(a)||!a||a.Ec)return!1;var c=a.src;if(Dc(c))return Kc(c.jb,a);var d=a.type,e=a.b;c.removeEventListener?c.removeEventListener(d,e,a.Oc):c.detachEvent&&c.detachEvent(Uc(d),e);Pc--;(d=Sc(c))?(Kc(d,a),0==d.a&&(d.src=null,c[Nc]=null)):Gc(a);return!0}function Uc(a){return a in Oc?Oc[a]:Oc[a]="on"+a}function Zc(a,c,d,e){var f=!0;if(a=Sc(a))if(c=a.b[c.toString()])for(c=c.concat(),a=0;a<c.length;a++){var g=c[a];g&&g.Oc==d&&!g.Ec&&(g=$c(g,e),f=f&&!1!==g)}return f}
function $c(a,c){var d=a.listener,e=a.Qd||a.src;a.wd&&Yc(a);return d.call(e,c)}
function Vc(a,c){if(a.Ec)return!0;if(!nc){var d;if(!(d=c))a:{d=["window","event"];for(var e=ba,f;f=d.shift();)if(null!=e[f])e=e[f];else{d=null;break a}d=e}f=d;d=new zc(f,this);e=!0;if(!(0>f.keyCode||void 0!=f.returnValue)){a:{var g=!1;if(0==f.keyCode)try{f.keyCode=-1;break a}catch(m){g=!0}if(g||void 0==f.returnValue)f.returnValue=!0}f=[];for(g=d.g;g;g=g.parentNode)f.push(g);for(var g=a.type,h=f.length-1;!d.i&&0<=h;h--){d.g=f[h];var k=Zc(f[h],g,!0,d),e=e&&k}for(h=0;!d.i&&h<f.length;h++)d.g=f[h],k=
Zc(f[h],g,!1,d),e=e&&k}return e}return $c(a,new zc(c,this))}function Sc(a){a=a[Nc];return a instanceof Hc?a:null}var ad="__closure_events_fn_"+(1E9*Math.random()>>>0);function Qc(a){if(ka(a))return a;a[ad]||(a[ad]=function(c){return a.handleEvent(c)});return a[ad]};function bd(){pc.call(this);this.jb=new Hc(this);this.sd=this;this.Pa=null}w(bd,pc);bd.prototype[Cc]=!0;l=bd.prototype;l.addEventListener=function(a,c,d,e){B(this,a,c,d,e)};l.removeEventListener=function(a,c,d,e){Xc(this,a,c,d,e)};
l.s=function(a){var c,d=this.Pa;if(d)for(c=[];d;d=d.Pa)c.push(d);var d=this.sd,e=a.type||a;if(ia(a))a=new uc(a,d);else if(a instanceof uc)a.target=a.target||d;else{var f=a;a=new uc(e,d);Wb(a,f)}var f=!0,g;if(c)for(var h=c.length-1;!a.i&&0<=h;h--)g=a.g=c[h],f=cd(g,e,!0,a)&&f;a.i||(g=a.g=d,f=cd(g,e,!0,a)&&f,a.i||(f=cd(g,e,!1,a)&&f));if(c)for(h=0;!a.i&&h<c.length;h++)g=a.g=c[h],f=cd(g,e,!1,a)&&f;return f};
l.Z=function(){bd.ca.Z.call(this);if(this.jb){var a=this.jb,c=0,d;for(d in a.b){for(var e=a.b[d],f=0;f<e.length;f++)++c,Gc(e[f]);delete a.b[d];a.a--}}this.Pa=null};l.Sa=function(a,c,d,e){return this.jb.add(String(a),c,!1,d,e)};l.Af=function(a,c,d,e){return this.jb.remove(String(a),c,d,e)};
function cd(a,c,d,e){c=a.jb.b[String(c)];if(!c)return!0;c=c.concat();for(var f=!0,g=0;g<c.length;++g){var h=c[g];if(h&&!h.Ec&&h.Oc==d){var k=h.listener,m=h.Qd||h.src;h.wd&&Kc(a.jb,h);f=!1!==k.call(m,e)&&f}}return f&&0!=e.gh}function dd(a,c,d){return Mc(a.jb,ca(c)?String(c):void 0,d)};function ed(){bd.call(this);this.b=0}w(ed,bd);function fd(a){Yc(a)}l=ed.prototype;l.u=function(){++this.b;this.s("change")};l.L=function(){return this.b};l.G=function(a,c,d){return B(this,a,c,!1,d)};l.M=function(a,c,d){return Wc(this,a,c,!1,d)};l.K=function(a,c,d){Xc(this,a,c,!1,d)};l.N=fd;function gd(a,c,d){uc.call(this,a);this.key=c;this.oldValue=d}w(gd,uc);function hd(a){ed.call(this);v(this);this.D={};void 0!==a&&this.I(a)}w(hd,ed);var id={};function jd(a){return id.hasOwnProperty(a)?id[a]:id[a]="change:"+a}l=hd.prototype;l.get=function(a){var c;this.D.hasOwnProperty(a)&&(c=this.D[a]);return c};l.P=function(){return Object.keys(this.D)};l.R=function(){var a={},c;for(c in this.D)a[c]=this.D[c];return a};
function kd(a,c,d){var e;e=jd(c);a.s(new gd(e,c,d));a.s(new gd("propertychange",c,d))}l.set=function(a,c){var d=this.D[a];this.D[a]=c;kd(this,a,d)};l.I=function(a){for(var c in a)this.set(c,a[c])};l.T=function(a){if(a in this.D){var c=this.D[a];delete this.D[a];kd(this,a,c)}};function ld(a,c,d){void 0===d&&(d=[0,0]);d[0]=a[0]+2*c;d[1]=a[1]+2*c;return d}function md(a,c,d){void 0===d&&(d=[0,0]);d[0]=a[0]*c+.5|0;d[1]=a[1]*c+.5|0;return d}function nd(a,c){if(ga(a))return a;void 0===c?c=[a,a]:(c[0]=a,c[1]=a);return c};function od(a,c){var d=a%c;return 0>d*c?d+c:d}function pd(a,c,d){return a+d*(c-a)};function qd(a,c){a[0]+=c[0];a[1]+=c[1];return a}function rd(a,c){var d=a[0],e=a[1],f=c[0],g=c[1],h=f[0],f=f[1],k=g[0],g=g[1],m=k-h,n=g-f,d=0===m&&0===n?0:(m*(d-h)+n*(e-f))/(m*m+n*n||0);0>=d||(1<=d?(h=k,f=g):(h+=d*m,f+=d*n));return[h,f]}function sd(a,c){var d=od(a+180,360)-180,e=Math.abs(Math.round(3600*d));return Math.floor(e/3600)+"\u00b0 "+La(Math.floor(e/60%60))+"\u2032 "+La(Math.floor(e%60))+"\u2033 "+c.charAt(0>d?1:0)}
function td(a,c,d){return a?c.replace("{x}",a[0].toFixed(d)).replace("{y}",a[1].toFixed(d)):""}function ud(a,c){for(var d=!0,e=a.length-1;0<=e;--e)if(a[e]!=c[e]){d=!1;break}return d}function vd(a,c){var d=Math.cos(c),e=Math.sin(c),f=a[1]*d+a[0]*e;a[0]=a[0]*d-a[1]*e;a[1]=f;return a}function wd(a,c){var d=a[0]-c[0],e=a[1]-c[1];return d*d+e*e}function xd(a,c){return wd(a,rd(a,c))}function yd(a,c){return td(a,"{x}, {y}",c)};function zd(a){this.length=a.length||a;for(var c=0;c<this.length;c++)this[c]=a[c]||0}zd.prototype.b=4;zd.prototype.set=function(a,c){c=c||0;for(var d=0;d<a.length&&c+d<this.length;d++)this[c+d]=a[d]};zd.prototype.toString=Array.prototype.join;"undefined"==typeof Float32Array&&(zd.BYTES_PER_ELEMENT=4,zd.prototype.BYTES_PER_ELEMENT=zd.prototype.b,zd.prototype.set=zd.prototype.set,zd.prototype.toString=zd.prototype.toString,t("Float32Array",zd,void 0));function Ad(a){this.length=a.length||a;for(var c=0;c<this.length;c++)this[c]=a[c]||0}Ad.prototype.b=8;Ad.prototype.set=function(a,c){c=c||0;for(var d=0;d<a.length&&c+d<this.length;d++)this[c+d]=a[d]};Ad.prototype.toString=Array.prototype.join;if("undefined"==typeof Float64Array){try{Ad.BYTES_PER_ELEMENT=8}catch(a){}Ad.prototype.BYTES_PER_ELEMENT=Ad.prototype.b;Ad.prototype.set=Ad.prototype.set;Ad.prototype.toString=Ad.prototype.toString;t("Float64Array",Ad,void 0)};function Bd(a,c,d,e,f){a[0]=c;a[1]=d;a[2]=e;a[3]=f};function Cd(){var a=Array(16);Dd(a,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);return a}function Ed(){var a=Array(16);Dd(a,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return a}function Dd(a,c,d,e,f,g,h,k,m,n,p,q,r,u,y,A,F){a[0]=c;a[1]=d;a[2]=e;a[3]=f;a[4]=g;a[5]=h;a[6]=k;a[7]=m;a[8]=n;a[9]=p;a[10]=q;a[11]=r;a[12]=u;a[13]=y;a[14]=A;a[15]=F}
function Fd(a,c){a[0]=c[0];a[1]=c[1];a[2]=c[2];a[3]=c[3];a[4]=c[4];a[5]=c[5];a[6]=c[6];a[7]=c[7];a[8]=c[8];a[9]=c[9];a[10]=c[10];a[11]=c[11];a[12]=c[12];a[13]=c[13];a[14]=c[14];a[15]=c[15]}function Gd(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1}
function Hd(a,c,d){var e=a[0],f=a[1],g=a[2],h=a[3],k=a[4],m=a[5],n=a[6],p=a[7],q=a[8],r=a[9],u=a[10],y=a[11],A=a[12],F=a[13],z=a[14];a=a[15];var x=c[0],K=c[1],J=c[2],I=c[3],O=c[4],wa=c[5],Ua=c[6],M=c[7],Ma=c[8],qb=c[9],Oa=c[10],Ib=c[11],eb=c[12],Ic=c[13],lc=c[14];c=c[15];d[0]=e*x+k*K+q*J+A*I;d[1]=f*x+m*K+r*J+F*I;d[2]=g*x+n*K+u*J+z*I;d[3]=h*x+p*K+y*J+a*I;d[4]=e*O+k*wa+q*Ua+A*M;d[5]=f*O+m*wa+r*Ua+F*M;d[6]=g*O+n*wa+u*Ua+z*M;d[7]=h*O+p*wa+y*Ua+a*M;d[8]=e*Ma+k*qb+q*Oa+A*Ib;d[9]=f*Ma+m*qb+r*Oa+F*Ib;d[10]=
g*Ma+n*qb+u*Oa+z*Ib;d[11]=h*Ma+p*qb+y*Oa+a*Ib;d[12]=e*eb+k*Ic+q*lc+A*c;d[13]=f*eb+m*Ic+r*lc+F*c;d[14]=g*eb+n*Ic+u*lc+z*c;d[15]=h*eb+p*Ic+y*lc+a*c}
function Id(a,c){var d=a[0],e=a[1],f=a[2],g=a[3],h=a[4],k=a[5],m=a[6],n=a[7],p=a[8],q=a[9],r=a[10],u=a[11],y=a[12],A=a[13],F=a[14],z=a[15],x=d*k-e*h,K=d*m-f*h,J=d*n-g*h,I=e*m-f*k,O=e*n-g*k,wa=f*n-g*m,Ua=p*A-q*y,M=p*F-r*y,Ma=p*z-u*y,qb=q*F-r*A,Oa=q*z-u*A,Ib=r*z-u*F,eb=x*Ib-K*Oa+J*qb+I*Ma-O*M+wa*Ua;0!=eb&&(eb=1/eb,c[0]=(k*Ib-m*Oa+n*qb)*eb,c[1]=(-e*Ib+f*Oa-g*qb)*eb,c[2]=(A*wa-F*O+z*I)*eb,c[3]=(-q*wa+r*O-u*I)*eb,c[4]=(-h*Ib+m*Ma-n*M)*eb,c[5]=(d*Ib-f*Ma+g*M)*eb,c[6]=(-y*wa+F*J-z*K)*eb,c[7]=(p*wa-r*J+u*
K)*eb,c[8]=(h*Oa-k*Ma+n*Ua)*eb,c[9]=(-d*Oa+e*Ma-g*Ua)*eb,c[10]=(y*O-A*J+z*x)*eb,c[11]=(-p*O+q*J-u*x)*eb,c[12]=(-h*qb+k*M-m*Ua)*eb,c[13]=(d*qb-e*M+f*Ua)*eb,c[14]=(-y*I+A*K-F*x)*eb,c[15]=(p*I-q*K+r*x)*eb)}function Jd(a,c,d){var e=a[1]*c+a[5]*d+0*a[9]+a[13],f=a[2]*c+a[6]*d+0*a[10]+a[14],g=a[3]*c+a[7]*d+0*a[11]+a[15];a[12]=a[0]*c+a[4]*d+0*a[8]+a[12];a[13]=e;a[14]=f;a[15]=g}
function Kd(a,c,d){Dd(a,a[0]*c,a[1]*c,a[2]*c,a[3]*c,a[4]*d,a[5]*d,a[6]*d,a[7]*d,1*a[8],1*a[9],1*a[10],1*a[11],a[12],a[13],a[14],a[15])}function Ld(a,c){var d=a[0],e=a[1],f=a[2],g=a[3],h=a[4],k=a[5],m=a[6],n=a[7],p=Math.cos(c),q=Math.sin(c);a[0]=d*p+h*q;a[1]=e*p+k*q;a[2]=f*p+m*q;a[3]=g*p+n*q;a[4]=d*-q+h*p;a[5]=e*-q+k*p;a[6]=f*-q+m*p;a[7]=g*-q+n*p}new Float64Array(3);new Float64Array(3);new Float64Array(4);new Float64Array(4);new Float64Array(4);new Float64Array(16);function Md(a){for(var c=Nd(),d=0,e=a.length;d<e;++d)Od(c,a[d]);return c}function Pd(a,c,d){var e=Math.min.apply(null,a),f=Math.min.apply(null,c);a=Math.max.apply(null,a);c=Math.max.apply(null,c);return Qd(e,f,a,c,d)}function Rd(a,c,d){return d?(d[0]=a[0]-c,d[1]=a[1]-c,d[2]=a[2]+c,d[3]=a[3]+c,d):[a[0]-c,a[1]-c,a[2]+c,a[3]+c]}function Sd(a,c){return c?(c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],c):a.slice()}
function Td(a,c,d){c=c<a[0]?a[0]-c:a[2]<c?c-a[2]:0;a=d<a[1]?a[1]-d:a[3]<d?d-a[3]:0;return c*c+a*a}function Ud(a,c){return Vd(a,c[0],c[1])}function Wd(a,c){return a[0]<=c[0]&&c[2]<=a[2]&&a[1]<=c[1]&&c[3]<=a[3]}function Vd(a,c,d){return a[0]<=c&&c<=a[2]&&a[1]<=d&&d<=a[3]}function Xd(a,c){var d=a[1],e=a[2],f=a[3],g=c[0],h=c[1],k=0;g<a[0]?k=k|16:g>e&&(k=k|4);h<d?k|=8:h>f&&(k|=2);0===k&&(k=1);return k}function Nd(){return[Infinity,Infinity,-Infinity,-Infinity]}
function Qd(a,c,d,e,f){return f?(f[0]=a,f[1]=c,f[2]=d,f[3]=e,f):[a,c,d,e]}function Yd(a,c){var d=a[0],e=a[1];return Qd(d,e,d,e,c)}function Zd(a,c){return a[0]==c[0]&&a[2]==c[2]&&a[1]==c[1]&&a[3]==c[3]}function $d(a,c){c[0]<a[0]&&(a[0]=c[0]);c[2]>a[2]&&(a[2]=c[2]);c[1]<a[1]&&(a[1]=c[1]);c[3]>a[3]&&(a[3]=c[3]);return a}function Od(a,c){c[0]<a[0]&&(a[0]=c[0]);c[0]>a[2]&&(a[2]=c[0]);c[1]<a[1]&&(a[1]=c[1]);c[1]>a[3]&&(a[3]=c[1])}
function ae(a,c,d,e,f){for(;d<e;d+=f){var g=a,h=c[d],k=c[d+1];g[0]=Math.min(g[0],h);g[1]=Math.min(g[1],k);g[2]=Math.max(g[2],h);g[3]=Math.max(g[3],k)}return a}function be(a,c,d){var e;return(e=c.call(d,ce(a)))||(e=c.call(d,de(a)))||(e=c.call(d,ee(a)))?e:(e=c.call(d,fe(a)))?e:!1}function ce(a){return[a[0],a[1]]}function de(a){return[a[2],a[1]]}function ge(a){return[(a[0]+a[2])/2,(a[1]+a[3])/2]}
function he(a,c,d,e){var f=c*e[0]/2;e=c*e[1]/2;c=Math.cos(d);d=Math.sin(d);f=[-f,-f,f,f];e=[-e,e,-e,e];var g,h,k;for(g=0;4>g;++g)h=f[g],k=e[g],f[g]=a[0]+h*c-k*d,e[g]=a[1]+h*d+k*c;return Pd(f,e,void 0)}function ie(a){return a[3]-a[1]}function je(a,c,d){d=d?d:Nd();ke(a,c)&&(d[0]=a[0]>c[0]?a[0]:c[0],d[1]=a[1]>c[1]?a[1]:c[1],d[2]=a[2]<c[2]?a[2]:c[2],d[3]=a[3]<c[3]?a[3]:c[3]);return d}function fe(a){return[a[0],a[3]]}function ee(a){return[a[2],a[3]]}function le(a){return a[2]-a[0]}
function ke(a,c){return a[0]<=c[2]&&a[2]>=c[0]&&a[1]<=c[3]&&a[3]>=c[1]}function me(a){return a[2]<a[0]||a[3]<a[1]}function ne(a,c){var d=(a[2]-a[0])/2*(c-1),e=(a[3]-a[1])/2*(c-1);a[0]-=d;a[2]+=d;a[1]-=e;a[3]+=e}function oe(a,c,d){a=[a[0],a[1],a[0],a[3],a[2],a[1],a[2],a[3]];c(a,a,2);return Pd([a[0],a[2],a[4],a[6]],[a[1],a[3],a[5],a[7]],d)};function pe(a){return function(){return a}}var qe=pe(!1),re=pe(!0),se=pe(null);function te(a){return a}function ue(a){var c;c=c||0;return function(){return a.apply(this,Array.prototype.slice.call(arguments,0,c))}}function ve(a){var c=arguments,d=c.length;return function(){for(var a,f=0;f<d;f++)a=c[f].apply(this,arguments);return a}}function we(a){var c=arguments,d=c.length;return function(){for(var a=0;a<d;a++)if(!c[a].apply(this,arguments))return!1;return!0}};/*

 Latitude/longitude spherical geodesy formulae taken from
 http://www.movable-type.co.uk/scripts/latlong.html
 Licensed under CC-BY-3.0.
*/
function xe(a){this.radius=a}xe.prototype.a=function(a){for(var c=0,d=a.length,e=a[d-1][0],f=a[d-1][1],g=0;g<d;g++)var h=a[g][0],k=a[g][1],c=c+Ta(h-e)*(2+Math.sin(Ta(f))+Math.sin(Ta(k))),e=h,f=k;return c*this.radius*this.radius/2};xe.prototype.b=function(a,c){var d=Ta(a[1]),e=Ta(c[1]),f=(e-d)/2,g=Ta(c[0]-a[0])/2,d=Math.sin(f)*Math.sin(f)+Math.sin(g)*Math.sin(g)*Math.cos(d)*Math.cos(e);return 2*this.radius*Math.atan2(Math.sqrt(d),Math.sqrt(1-d))};
xe.prototype.offset=function(a,c,d){var e=Ta(a[1]);c/=this.radius;var f=Math.asin(Math.sin(e)*Math.cos(c)+Math.cos(e)*Math.sin(c)*Math.cos(d));return[180*(Ta(a[0])+Math.atan2(Math.sin(d)*Math.sin(c)*Math.cos(e),Math.cos(c)-Math.sin(e)*Math.sin(f)))/Math.PI,180*f/Math.PI]};var ye=new xe(6370997);var ze={};ze.degrees=2*Math.PI*ye.radius/360;ze.ft=.3048;ze.m=1;ze["us-ft"]=1200/3937;
function Ae(a){this.b=a.code;this.a=a.units;this.j=void 0!==a.extent?a.extent:null;this.i=void 0!==a.worldExtent?a.worldExtent:null;this.g=void 0!==a.axisOrientation?a.axisOrientation:"enu";this.f=void 0!==a.global?a.global:!1;this.c=!(!this.f||!this.j);this.D=void 0!==a.getPointResolution?a.getPointResolution:this.kj;this.l=null;var c=Be,d=a.code;if("function"==typeof proj4&&void 0===c[d]){var e=proj4.defs(d);if(void 0!==e){void 0!==e.axis&&void 0===a.axisOrientation&&(this.g=e.axis);void 0===a.units&&
(a=e.units,void 0===e.to_meter||void 0!==a&&void 0!==ze[a]||(a=e.to_meter.toString(),ze[a]=e.to_meter),this.a=a);for(var f in c)a=proj4.defs(f),void 0!==a&&(c=Ce(f),a===e?De([c,this]):(a=proj4(f,d),Ee(c,this,a.forward,a.inverse)))}}}l=Ae.prototype;l.Ki=function(){return this.b};l.S=function(){return this.j};l.Dl=function(){return this.a};l.Hd=function(){return ze[this.a]};l.vj=function(){return this.i};function Fe(a){return a.g}l.hk=function(){return this.f};
l.Vn=function(a){this.f=a;this.c=!(!a||!this.j)};l.El=function(a){this.j=a;this.c=!(!this.f||!a)};l.io=function(a){this.i=a};l.Un=function(a){this.D=a};l.kj=function(a,c){if("degrees"==this.a)return a;var d=Ge(this,Ce("EPSG:4326")),e=[c[0]-a/2,c[1],c[0]+a/2,c[1],c[0],c[1]-a/2,c[0],c[1]+a/2],e=d(e,e,2),d=(ye.b(e.slice(0,2),e.slice(2,4))+ye.b(e.slice(4,6),e.slice(6,8)))/2,e=this.Hd();void 0!==e&&(d/=e);return d};l.getPointResolution=function(a,c){return this.D(a,c)};var Be={},He={};
function De(a){Je(a);a.forEach(function(c){a.forEach(function(a){c!==a&&Ke(c,a,Le)})})}function Me(){var a=Ne,c=Oe,d=Pe;Qe.forEach(function(e){a.forEach(function(a){Ke(e,a,c);Ke(a,e,d)})})}function Re(a){Be[a.b]=a;Ke(a,a,Le)}function Je(a){var c=[];a.forEach(function(a){c.push(Re(a))})}function Se(a){return a?ia(a)?Ce(a):a:Ce("EPSG:3857")}function Ke(a,c,d){a=a.b;c=c.b;a in He||(He[a]={});He[a][c]=d}function Ee(a,c,d,e){a=Ce(a);c=Ce(c);Ke(a,c,Te(d));Ke(c,a,Te(e))}
function Te(a){return function(c,d,e){var f=c.length;e=void 0!==e?e:2;d=void 0!==d?d:Array(f);var g,h;for(h=0;h<f;h+=e)for(g=a([c[h],c[h+1]]),d[h]=g[0],d[h+1]=g[1],g=e-1;2<=g;--g)d[h+g]=c[h+g];return d}}function Ce(a){var c;a instanceof Ae?c=a:ia(a)?(c=Be[a],void 0===c&&"function"==typeof proj4&&void 0!==proj4.defs(a)&&(c=new Ae({code:a}),Re(c))):c=null;return c}function Ue(a,c){return a===c?!0:a.b===c.b?!0:a.a!=c.a?!1:Ge(a,c)===Le}function Ve(a,c){var d=Ce(a),e=Ce(c);return Ge(d,e)}
function Ge(a,c){var d=a.b,e=c.b,f;d in He&&e in He[d]&&(f=He[d][e]);void 0===f&&(f=We);return f}function We(a,c){if(void 0!==c&&a!==c){for(var d=0,e=a.length;d<e;++d)c[d]=a[d];a=c}return a}function Le(a,c){var d;if(void 0!==c){d=0;for(var e=a.length;d<e;++d)c[d]=a[d];d=c}else d=a.slice();return d}function Xe(a,c,d){return Ve(c,d)(a,void 0,a.length)}function Ye(a,c,d){c=Ve(c,d);return oe(a,c)};function Ze(){hd.call(this);this.B=Nd();this.A=-1;this.g={};this.l=this.j=0}w(Ze,hd);l=Ze.prototype;l.$a=function(a,c){var d=c?c:[NaN,NaN];this.Ya(a[0],a[1],d,Infinity);return d};l.Le=function(a){return this.Zb(a[0],a[1])};l.Zb=qe;l.S=function(a){this.A!=this.b&&(this.B=this.xd(this.B),this.A=this.b);var c=this.B;a?(a[0]=c[0],a[1]=c[1],a[2]=c[2],a[3]=c[3]):a=c;return a};l.hb=function(a){return this.Kd(a*a)};l.Va=function(a,c){this.Rb(Ve(a,c));return this};function $e(a,c,d,e,f,g){var h=f[0],k=f[1],m=f[4],n=f[5],p=f[12];f=f[13];for(var q=g?g:[],r=0;c<d;c+=e){var u=a[c],y=a[c+1];q[r++]=h*u+m*y+p;q[r++]=k*u+n*y+f}g&&q.length!=r&&(q.length=r);return q};function af(){Ze.call(this);this.a="XY";this.H=2;this.o=null}w(af,Ze);function bf(a){if("XY"==a)return 2;if("XYZ"==a||"XYM"==a)return 3;if("XYZM"==a)return 4}l=af.prototype;l.Zb=qe;l.xd=function(a){var c=this.o,d=this.o.length,e=this.H;a=Qd(Infinity,Infinity,-Infinity,-Infinity,a);return ae(a,c,0,d,e)};l.vb=function(){return this.o.slice(0,this.H)};l.wb=function(){return this.o.slice(this.o.length-this.H)};l.xb=function(){return this.a};
l.Kd=function(a){this.l!=this.b&&(Qb(this.g),this.j=0,this.l=this.b);if(0>a||0!==this.j&&a<=this.j)return this;var c=a.toString();if(this.g.hasOwnProperty(c))return this.g[c];var d=this.vc(a);if(d.o.length<this.o.length)return this.g[c]=d;this.j=a;return this};l.vc=function(){return this};function cf(a,c,d){a.H=bf(c);a.a=c;a.o=d}function df(a,c,d,e){if(c)d=bf(c);else{for(c=0;c<e;++c){if(0===d.length){a.a="XY";a.H=2;return}d=d[0]}d=d.length;c=2==d?"XY":3==d?"XYZ":4==d?"XYZM":void 0}a.a=c;a.H=d}
l.Rb=function(a){this.o&&(a(this.o,this.o,this.H),this.u())};l.yc=function(a,c){var d=this.o;if(d){var e=d.length,f=this.H,g=d?d:[],h=0,k,m;for(k=0;k<e;k+=f)for(g[h++]=d[k]+a,g[h++]=d[k+1]+c,m=k+2;m<k+f;++m)g[h++]=d[m];d&&g.length!=h&&(g.length=h);this.u()}};function ef(a,c,d,e){for(var f=0,g=a[d-e],h=a[d-e+1];c<d;c+=e)var k=a[c],m=a[c+1],f=f+(h*k-g*m),g=k,h=m;return f/2}function ff(a,c,d,e){var f=0,g,h;g=0;for(h=d.length;g<h;++g){var k=d[g],f=f+ef(a,c,k,e);c=k}return f};function gf(a,c,d,e,f,g,h){var k=a[c],m=a[c+1],n=a[d]-k,p=a[d+1]-m;if(0!==n||0!==p)if(g=((f-k)*n+(g-m)*p)/(n*n+p*p),1<g)c=d;else if(0<g){for(f=0;f<e;++f)h[f]=pd(a[c+f],a[d+f],g);h.length=e;return}for(f=0;f<e;++f)h[f]=a[c+f];h.length=e}function hf(a,c,d,e,f){var g=a[c],h=a[c+1];for(c+=e;c<d;c+=e){var k=a[c],m=a[c+1],g=Sa(g,h,k,m);g>f&&(f=g);g=k;h=m}return f}function jf(a,c,d,e,f){var g,h;g=0;for(h=d.length;g<h;++g){var k=d[g];f=hf(a,c,k,e,f);c=k}return f}
function kf(a,c,d,e,f,g,h,k,m,n,p){if(c==d)return n;var q;if(0===f){q=Sa(h,k,a[c],a[c+1]);if(q<n){for(p=0;p<e;++p)m[p]=a[c+p];m.length=e;return q}return n}for(var r=p?p:[NaN,NaN],u=c+e;u<d;)if(gf(a,u-e,u,e,h,k,r),q=Sa(h,k,r[0],r[1]),q<n){n=q;for(p=0;p<e;++p)m[p]=r[p];m.length=e;u+=e}else u+=e*Math.max((Math.sqrt(q)-Math.sqrt(n))/f|0,1);if(g&&(gf(a,d-e,c,e,h,k,r),q=Sa(h,k,r[0],r[1]),q<n)){n=q;for(p=0;p<e;++p)m[p]=r[p];m.length=e}return n}
function lf(a,c,d,e,f,g,h,k,m,n,p){p=p?p:[NaN,NaN];var q,r;q=0;for(r=d.length;q<r;++q){var u=d[q];n=kf(a,c,u,e,f,g,h,k,m,n,p);c=u}return n};function mf(a,c){var d=0,e,f;e=0;for(f=c.length;e<f;++e)a[d++]=c[e];return d}function nf(a,c,d,e){var f,g;f=0;for(g=d.length;f<g;++f){var h=d[f],k;for(k=0;k<e;++k)a[c++]=h[k]}return c}function of(a,c,d,e,f){f=f?f:[];var g=0,h,k;h=0;for(k=d.length;h<k;++h)c=nf(a,c,d[h],e),f[g++]=c;f.length=g;return f};function pf(a,c,d,e,f){f=void 0!==f?f:[];for(var g=0;c<d;c+=e)f[g++]=a.slice(c,c+e);f.length=g;return f}function qf(a,c,d,e,f){f=void 0!==f?f:[];var g=0,h,k;h=0;for(k=d.length;h<k;++h){var m=d[h];f[g++]=pf(a,c,m,e,f[g]);c=m}f.length=g;return f};function rf(a,c,d,e,f,g,h){var k=(d-c)/e;if(3>k){for(;c<d;c+=e)g[h++]=a[c],g[h++]=a[c+1];return h}var m=Array(k);m[0]=1;m[k-1]=1;d=[c,d-e];for(var n=0,p;0<d.length;){var q=d.pop(),r=d.pop(),u=0,y=a[r],A=a[r+1],F=a[q],z=a[q+1];for(p=r+e;p<q;p+=e){var x=Ra(a[p],a[p+1],y,A,F,z);x>u&&(n=p,u=x)}u>f&&(m[(n-c)/e]=1,r+e<n&&d.push(r,n),n+e<q&&d.push(n,q))}for(p=0;p<k;++p)m[p]&&(g[h++]=a[c+p*e],g[h++]=a[c+p*e+1]);return h}
function sf(a,c,d,e,f,g,h,k){var m,n;m=0;for(n=d.length;m<n;++m){var p=d[m];a:{var q=a,r=p,u=e,y=f,A=g;if(c!=r){var F=y*Math.round(q[c]/y),z=y*Math.round(q[c+1]/y);c+=u;A[h++]=F;A[h++]=z;var x=void 0,K=void 0;do if(x=y*Math.round(q[c]/y),K=y*Math.round(q[c+1]/y),c+=u,c==r){A[h++]=x;A[h++]=K;break a}while(x==F&&K==z);for(;c<r;){var J,I;J=y*Math.round(q[c]/y);I=y*Math.round(q[c+1]/y);c+=u;if(J!=x||I!=K){var O=x-F,wa=K-z,Ua=J-F,M=I-z;O*M==wa*Ua&&(0>O&&Ua<O||O==Ua||0<O&&Ua>O)&&(0>wa&&M<wa||wa==M||0<wa&&
M>wa)||(A[h++]=x,A[h++]=K,F=x,z=K);x=J;K=I}}A[h++]=x;A[h++]=K}}k.push(h);c=p}return h};function tf(a,c){af.call(this);this.c=this.i=-1;this.ja(a,c)}w(tf,af);l=tf.prototype;l.clone=function(){var a=new tf(null);uf(a,this.a,this.o.slice());return a};l.Ya=function(a,c,d,e){if(e<Td(this.S(),a,c))return e;this.c!=this.b&&(this.i=Math.sqrt(hf(this.o,0,this.o.length,this.H,0)),this.c=this.b);return kf(this.o,0,this.o.length,this.H,this.i,!0,a,c,d,e)};l.el=function(){return ef(this.o,0,this.o.length,this.H)};l.V=function(){return pf(this.o,0,this.o.length,this.H)};
l.vc=function(a){var c=[];c.length=rf(this.o,0,this.o.length,this.H,a,c,0);a=new tf(null);uf(a,"XY",c);return a};l.X=function(){return"LinearRing"};l.ja=function(a,c){a?(df(this,c,a,1),this.o||(this.o=[]),this.o.length=nf(this.o,0,a,this.H),this.u()):uf(this,"XY",null)};function uf(a,c,d){cf(a,c,d);a.u()};function C(a,c){af.call(this);this.ja(a,c)}w(C,af);l=C.prototype;l.clone=function(){var a=new C(null);vf(a,this.a,this.o.slice());return a};l.Ya=function(a,c,d,e){var f=this.o;a=Sa(a,c,f[0],f[1]);if(a<e){e=this.H;for(c=0;c<e;++c)d[c]=f[c];d.length=e;return a}return e};l.V=function(){return this.o?this.o.slice():[]};l.xd=function(a){return Yd(this.o,a)};l.X=function(){return"Point"};l.va=function(a){return Vd(a,this.o[0],this.o[1])};
l.ja=function(a,c){a?(df(this,c,a,0),this.o||(this.o=[]),this.o.length=mf(this.o,a),this.u()):vf(this,"XY",null)};function vf(a,c,d){cf(a,c,d);a.u()};function wf(a,c,d,e,f){return!be(f,function(f){return!xf(a,c,d,e,f[0],f[1])})}function xf(a,c,d,e,f,g){for(var h=!1,k=a[d-e],m=a[d-e+1];c<d;c+=e){var n=a[c],p=a[c+1];m>g!=p>g&&f<(n-k)*(g-m)/(p-m)+k&&(h=!h);k=n;m=p}return h}function yf(a,c,d,e,f,g){if(0===d.length||!xf(a,c,d[0],e,f,g))return!1;var h;c=1;for(h=d.length;c<h;++c)if(xf(a,d[c-1],d[c],e,f,g))return!1;return!0};function zf(a,c,d,e,f,g,h){var k,m,n,p,q,r=f[g+1],u=[],y=d[0];n=a[y-e];q=a[y-e+1];for(k=c;k<y;k+=e){p=a[k];m=a[k+1];if(r<=q&&m<=r||q<=r&&r<=m)n=(r-q)/(m-q)*(p-n)+n,u.push(n);n=p;q=m}y=NaN;q=-Infinity;u.sort();n=u[0];k=1;for(m=u.length;k<m;++k){p=u[k];var A=Math.abs(p-n);A>q&&(n=(n+p)/2,yf(a,c,d,e,n,r)&&(y=n,q=A));n=p}isNaN(y)&&(y=f[g]);return h?(h.push(y,r),h):[y,r]};function Af(a,c,d,e,f,g){for(var h=[a[c],a[c+1]],k=[],m;c+e<d;c+=e){k[0]=a[c+e];k[1]=a[c+e+1];if(m=f.call(g,h,k))return m;h[0]=k[0];h[1]=k[1]}return!1};function Bf(a,c,d,e,f){var g=ae(Nd(),a,c,d,e);return ke(f,g)?Wd(f,g)||g[0]>=f[0]&&g[2]<=f[2]||g[1]>=f[1]&&g[3]<=f[3]?!0:Af(a,c,d,e,function(a,c){var d=!1,e=Xd(f,a),g=Xd(f,c);if(1===e||1===g)d=!0;else{var q=f[0],r=f[1],u=f[2],y=f[3],A=c[0],F=c[1],z=(F-a[1])/(A-a[0]);g&2&&!(e&2)&&(d=A-(F-y)/z,d=d>=q&&d<=u);d||!(g&4)||e&4||(d=F-(A-u)*z,d=d>=r&&d<=y);d||!(g&8)||e&8||(d=A-(F-r)/z,d=d>=q&&d<=u);d||!(g&16)||e&16||(d=F-(A-q)*z,d=d>=r&&d<=y)}return d}):!1}
function Cf(a,c,d,e,f){var g=d[0];if(!(Bf(a,c,g,e,f)||xf(a,c,g,e,f[0],f[1])||xf(a,c,g,e,f[0],f[3])||xf(a,c,g,e,f[2],f[1])||xf(a,c,g,e,f[2],f[3])))return!1;if(1===d.length)return!0;c=1;for(g=d.length;c<g;++c)if(wf(a,d[c-1],d[c],e,f))return!1;return!0};function Df(a,c,d,e){for(var f=0,g=a[d-e],h=a[d-e+1];c<d;c+=e)var k=a[c],m=a[c+1],f=f+(k-g)*(m+h),g=k,h=m;return 0<f}function Ef(a,c,d,e){var f=0;e=void 0!==e?e:!1;var g,h;g=0;for(h=c.length;g<h;++g){var k=c[g],f=Df(a,f,k,d);if(0===g){if(e&&f||!e&&!f)return!1}else if(e&&!f||!e&&f)return!1;f=k}return!0}
function Ff(a,c,d,e,f){f=void 0!==f?f:!1;var g,h;g=0;for(h=d.length;g<h;++g){var k=d[g],m=Df(a,c,k,e);if(0===g?f&&m||!f&&!m:f&&!m||!f&&m)for(var m=a,n=k,p=e;c<n-p;){var q;for(q=0;q<p;++q){var r=m[c+q];m[c+q]=m[n-p+q];m[n-p+q]=r}c+=p;n-=p}c=k}return c}function Gf(a,c,d,e){var f=0,g,h;g=0;for(h=c.length;g<h;++g)f=Ff(a,f,c[g],d,e);return f};function D(a,c){af.call(this);this.c=[];this.v=-1;this.C=null;this.U=this.O=this.J=-1;this.i=null;this.ja(a,c)}w(D,af);l=D.prototype;l.pi=function(a){this.o?ib(this.o,a.o):this.o=a.o.slice();this.c.push(this.o.length);this.u()};l.clone=function(){var a=new D(null);Hf(a,this.a,this.o.slice(),this.c.slice());return a};l.Ya=function(a,c,d,e){if(e<Td(this.S(),a,c))return e;this.O!=this.b&&(this.J=Math.sqrt(jf(this.o,0,this.c,this.H,0)),this.O=this.b);return lf(this.o,0,this.c,this.H,this.J,!0,a,c,d,e)};
l.Zb=function(a,c){return yf(If(this),0,this.c,this.H,a,c)};l.hl=function(){return ff(If(this),0,this.c,this.H)};l.V=function(a){var c;void 0!==a?(c=If(this).slice(),Ff(c,0,this.c,this.H,a)):c=this.o;return qf(c,0,this.c,this.H)};function Jf(a){if(a.v!=a.b){var c=ge(a.S());a.C=zf(If(a),0,a.c,a.H,c,0);a.v=a.b}return a.C}l.Vi=function(){return new C(Jf(this))};l.$i=function(){return this.c.length};
l.Yf=function(a){if(0>a||this.c.length<=a)return null;var c=new tf(null);uf(c,this.a,this.o.slice(0===a?0:this.c[a-1],this.c[a]));return c};l.Gd=function(){var a=this.a,c=this.o,d=this.c,e=[],f=0,g,h;g=0;for(h=d.length;g<h;++g){var k=d[g],m=new tf(null);uf(m,a,c.slice(f,k));e.push(m);f=k}return e};function If(a){if(a.U!=a.b){var c=a.o;Ef(c,a.c,a.H)?a.i=c:(a.i=c.slice(),a.i.length=Ff(a.i,0,a.c,a.H));a.U=a.b}return a.i}
l.vc=function(a){var c=[],d=[];c.length=sf(this.o,0,this.c,this.H,Math.sqrt(a),c,0,d);a=new D(null);Hf(a,"XY",c,d);return a};l.X=function(){return"Polygon"};l.va=function(a){return Cf(If(this),0,this.c,this.H,a)};l.ja=function(a,c){if(a){df(this,c,a,2);this.o||(this.o=[]);var d=of(this.o,0,a,this.H,this.c);this.o.length=0===d.length?0:d[d.length-1];this.u()}else Hf(this,"XY",null,this.c)};function Hf(a,c,d,e){cf(a,c,d);a.c=e;a.u()}
function Kf(a,c,d,e){var f=e?e:32;e=[];var g;for(g=0;g<f;++g)ib(e,a.offset(c,d,2*Math.PI*g/f));e.push(e[0],e[1]);a=new D(null);Hf(a,"XY",e,[e.length]);return a}function Lf(a){var c=a[0],d=a[1],e=a[2];a=a[3];c=[c,d,c,a,e,a,e,d,c,d];d=new D(null);Hf(d,"XY",c,[c.length]);return d}function Mf(a,c,d){var e=c?c:32,f=a.H;c=a.a;for(var g=new D(null,c),e=f*(e+1),f=[],h=0;h<e;h++)f[h]=0;Hf(g,c,f,[f.length]);Nf(g,a.cd(),a.hf(),d);return g}
function Nf(a,c,d,e){var f=a.o,g=a.a,h=a.H,k=a.c,m=f.length/h-1;e=e?e:0;for(var n,p,q=0;q<=m;++q)p=q*h,n=e+2*od(q,m)*Math.PI/m,f[p]=c[0]+d*Math.cos(n),f[p+1]=c[1]+d*Math.sin(n);Hf(a,g,f,k)};function Of(a){hd.call(this);a=a||{};this.c=[0,0];var c={};c.center=void 0!==a.center?a.center:null;this.g=Se(a.projection);var d,e,f,g=void 0!==a.minZoom?a.minZoom:0;d=void 0!==a.maxZoom?a.maxZoom:28;var h=void 0!==a.zoomFactor?a.zoomFactor:2;if(void 0!==a.resolutions)d=a.resolutions,e=d[0],f=d[d.length-1],d=vb(d);else{e=Se(a.projection);f=e.S();var k=(f?Math.max(le(f),ie(f)):360*ze.degrees/ze[e.a])/256/Math.pow(2,0),m=k/Math.pow(2,28);e=a.maxResolution;void 0!==e?g=0:e=k/Math.pow(h,g);f=a.minResolution;
void 0===f&&(f=void 0!==a.maxZoom?void 0!==a.maxResolution?e/Math.pow(h,d):k/Math.pow(h,d):m);d=g+Math.floor(Math.log(e/f)/Math.log(h));f=e/Math.pow(h,d-g);d=wb(h,e,d-g)}this.a=e;this.i=f;this.f=g;g=void 0!==a.extent?Va(a.extent):Wa;(void 0!==a.enableRotation?a.enableRotation:1)?(e=a.constrainRotation,e=void 0===e||!0===e?Ab():!1===e?yb:ja(e)?zb(e):yb):e=xb;this.j=new Bb(g,d,e);void 0!==a.resolution?c.resolution=a.resolution:void 0!==a.zoom&&(c.resolution=this.constrainResolution(this.a,a.zoom-this.f));
c.rotation=void 0!==a.rotation?a.rotation:0;this.I(c)}w(Of,hd);l=Of.prototype;l.yd=function(a){return this.j.center(a)};l.constrainResolution=function(a,c,d){return this.j.resolution(a,c||0,d||0)};l.constrainRotation=function(a,c){return this.j.rotation(a,c||0)};l.Ia=function(){return this.get("center")};l.Mc=function(a){var c=this.Ia(),d=this.ba(),e=this.wa();return he(c,d,e,a)};l.Pk=function(){return this.g};l.ba=function(){return this.get("resolution")};
function Qf(a){var c=a.a,d=Math.log(c/a.i)/Math.log(2);return function(a){return c/Math.pow(2,a*d)}}l.wa=function(){return this.get("rotation")};function Rf(a){var c=a.a,d=Math.log(c/a.i)/Math.log(2);return function(a){return Math.log(c/a)/Math.log(2)/d}}function Sf(a){var c=a.Ia(),d=a.g,e=a.ba();a=a.wa();return{center:[Math.round(c[0]/e)*e,Math.round(c[1]/e)*e],projection:void 0!==d?d:null,resolution:e,rotation:a}}
l.wj=function(){var a,c=this.ba();if(void 0!==c){var d,e=0;do{d=this.constrainResolution(this.a,e);if(d==c){a=e;break}++e}while(d>this.i)}return void 0!==a?this.f+a:a};
l.Oe=function(a,c,d){a instanceof af||(a=Lf(a));var e=d||{};d=void 0!==e.padding?e.padding:[0,0,0,0];var f=void 0!==e.constrainResolution?e.constrainResolution:!0,g=void 0!==e.nearest?e.nearest:!1,h;void 0!==e.minResolution?h=e.minResolution:void 0!==e.maxZoom?h=this.constrainResolution(this.a,e.maxZoom-this.f,0):h=0;var k=a.o,m=this.wa(),e=Math.cos(-m),m=Math.sin(-m),n=Infinity,p=Infinity,q=-Infinity,r=-Infinity;a=a.H;for(var u=0,y=k.length;u<y;u+=a)var A=k[u]*e-k[u+1]*m,F=k[u]*m+k[u+1]*e,n=Math.min(n,
A),p=Math.min(p,F),q=Math.max(q,A),r=Math.max(r,F);k=[n,p,q,r];c=[c[0]-d[1]-d[3],c[1]-d[0]-d[2]];c=Math.max(le(k)/c[0],ie(k)/c[1]);c=isNaN(c)?h:Math.max(c,h);f&&(h=this.constrainResolution(c,0,0),!g&&h<c&&(h=this.constrainResolution(h,-1,0)),c=h);this.zb(c);m=-m;g=(n+q)/2+(d[1]-d[3])/2*c;d=(p+r)/2+(d[0]-d[2])/2*c;this.Ua([g*e-d*m,d*e+g*m])};
l.vi=function(a,c,d){var e=this.wa(),f=Math.cos(-e),e=Math.sin(-e),g=a[0]*f-a[1]*e;a=a[1]*f+a[0]*e;var h=this.ba(),g=g+(c[0]/2-d[0])*h;a+=(d[1]-c[1]/2)*h;e=-e;this.Ua([g*f-a*e,a*f+g*e])};function Tf(a){return!!a.Ia()&&void 0!==a.ba()}l.rotate=function(a,c){if(void 0!==c){var d,e=this.Ia();void 0!==e&&(d=[e[0]-c[0],e[1]-c[1]],vd(d,a-this.wa()),qd(d,c));this.Ua(d)}this.$d(a)};l.Ua=function(a){this.set("center",a)};function Uf(a,c){a.c[1]+=c}l.zb=function(a){this.set("resolution",a)};
l.$d=function(a){this.set("rotation",a)};l.jo=function(a){a=this.constrainResolution(this.a,a-this.f,0);this.zb(a)};function Vf(a){return Math.pow(a,3)}function Wf(a){return 1-Vf(1-a)}function Xf(a){return 3*a*a-2*a*a*a}function Yf(a){return a}function Zf(a){return.5>a?Xf(2*a):1-Xf(2*(a-.5))};function $f(a){var c=a.source,d=a.start?a.start:Date.now(),e=c[0],f=c[1],g=void 0!==a.duration?a.duration:1E3,h=a.easing?a.easing:Xf;return function(a,c){if(c.time<d)return c.animate=!0,c.viewHints[0]+=1,!0;if(c.time<d+g){var n=1-h((c.time-d)/g),p=e-c.viewState.center[0],q=f-c.viewState.center[1];c.animate=!0;c.viewState.center[0]+=n*p;c.viewState.center[1]+=n*q;c.viewHints[0]+=1;return!0}return!1}}
function ag(a){var c=a.rotation?a.rotation:0,d=a.start?a.start:Date.now(),e=void 0!==a.duration?a.duration:1E3,f=a.easing?a.easing:Xf,g=a.anchor?a.anchor:null;return function(a,k){if(k.time<d)return k.animate=!0,k.viewHints[0]+=1,!0;if(k.time<d+e){var m=1-f((k.time-d)/e),m=(c-k.viewState.rotation)*m;k.animate=!0;k.viewState.rotation+=m;if(g){var n=k.viewState.center;n[0]-=g[0];n[1]-=g[1];vd(n,m);qd(n,g)}k.viewHints[0]+=1;return!0}return!1}}
function bg(a){var c=a.resolution,d=a.start?a.start:Date.now(),e=void 0!==a.duration?a.duration:1E3,f=a.easing?a.easing:Xf;return function(a,h){if(h.time<d)return h.animate=!0,h.viewHints[0]+=1,!0;if(h.time<d+e){var k=1-f((h.time-d)/e),m=c-h.viewState.resolution;h.animate=!0;h.viewState.resolution+=k*m;h.viewHints[0]+=1;return!0}return!1}};function cg(a,c,d,e){return void 0!==e?(e[0]=a,e[1]=c,e[2]=d,e):[a,c,d]}function dg(a,c,d){return a+"/"+c+"/"+d}function eg(a){var c=a[0],d=Array(c),e=1<<c-1,f,g;for(f=0;f<c;++f)g=48,a[1]&e&&(g+=1),a[2]&e&&(g+=2),d[f]=String.fromCharCode(g),e>>=1;return d.join("")}function fg(a){return dg(a[0],a[1],a[2])}function gg(a,c,d){var e=a[0],f=hg(c,a);d=ig(d);if(Ud(d,f))return a;a=le(d);f[0]+=a*Math.ceil((d[0]-f[0])/a);return c.Md(f,e)}
function jg(a,c){var d=a[0],e=a[1],f=a[2];if(c.minZoom>d||d>c.maxZoom)return!1;var g=c.S();return(d=g?kg(c,g,d):c.a?c.a[d]:null)?lg(d,e,f):!0};function mg(a,c,d,e){this.b=a;this.f=c;this.a=d;this.c=e}mg.prototype.contains=function(a){return lg(this,a[1],a[2])};function lg(a,c,d){return a.b<=c&&c<=a.f&&a.a<=d&&d<=a.c}function ng(a,c){return a.b==c.b&&a.a==c.a&&a.f==c.f&&a.c==c.c}function og(a){return a.c-a.a+1}function pg(a){return a.f-a.b+1}function qg(a,c){return a.b<=c.f&&a.f>=c.b&&a.a<=c.c&&a.c>=c.a};function rg(a){this.a=a.html;this.b=a.tileRanges?a.tileRanges:null}rg.prototype.c=function(){return this.a};function sg(a,c,d){uc.call(this,a,d);this.element=c}w(sg,uc);function tg(a){hd.call(this);this.a=a?a:[];ug(this)}w(tg,hd);l=tg.prototype;l.clear=function(){for(;0<this.Jb();)this.pop()};l.cf=function(a){var c,d;c=0;for(d=a.length;c<d;++c)this.push(a[c]);return this};l.forEach=function(a,c){this.a.forEach(a,c)};l.yk=function(){return this.a};l.item=function(a){return this.a[a]};l.Jb=function(){return this.get("length")};l.Rd=function(a,c){jb(this.a,a,0,c);ug(this);this.s(new sg("add",c,this))};
l.pop=function(){return this.xf(this.Jb()-1)};l.push=function(a){var c=this.a.length;this.Rd(c,a);return c};l.remove=function(a){var c=this.a,d,e;d=0;for(e=c.length;d<e;++d)if(c[d]===a)return this.xf(d)};l.xf=function(a){var c=this.a[a];Xa.splice.call(this.a,a,1);ug(this);this.s(new sg("remove",c,this));return c};l.Rn=function(a,c){var d=this.Jb();if(a<d)d=this.a[a],this.a[a]=c,this.s(new sg("remove",d,this)),this.s(new sg("add",c,this));else{for(;d<a;++d)this.Rd(d,void 0);this.Rd(a,c)}};
function ug(a){a.set("length",a.a.length)};var vg=/^#(?:[0-9a-f]{3}){1,2}$/i,wg=/^(?:rgb)?\((0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2})\)$/i,xg=/^(?:rgba)?\((0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2}),\s?(0|1|0\.\d{0,10})\)$/i;function yg(a){return ga(a)?a:zg(a)}function Ag(a){if(!ia(a)){var c=a[0];c!=(c|0)&&(c=c+.5|0);var d=a[1];d!=(d|0)&&(d=d+.5|0);var e=a[2];e!=(e|0)&&(e=e+.5|0);a="rgba("+c+","+d+","+e+","+a[3]+")"}return a}
var zg=function(){var a={},c=0;return function(d){var e;if(a.hasOwnProperty(d))e=a[d];else{if(1024<=c){e=0;for(var f in a)0===(e++&3)&&(delete a[f],--c)}var g,h;vg.exec(d)?(h=3==d.length-1?1:2,e=parseInt(d.substr(1+0*h,h),16),f=parseInt(d.substr(1+1*h,h),16),g=parseInt(d.substr(1+2*h,h),16),1==h&&(e=(e<<4)+e,f=(f<<4)+f,g=(g<<4)+g),e=[e,f,g,1]):(h=xg.exec(d))?(e=Number(h[1]),f=Number(h[2]),g=Number(h[3]),h=Number(h[4]),e=[e,f,g,h],e=Bg(e,e)):(h=wg.exec(d))?(e=Number(h[1]),f=Number(h[2]),g=Number(h[3]),
e=[e,f,g,1],e=Bg(e,e)):e=void 0;a[d]=e;++c}return e}}();function Bg(a,c){var d=c||[];d[0]=Qa(a[0]+.5|0,0,255);d[1]=Qa(a[1]+.5|0,0,255);d[2]=Qa(a[2]+.5|0,0,255);d[3]=Qa(a[3],0,1);return d};var Cg=!Yb||9<=kc;!$b&&!Yb||Yb&&9<=kc||$b&&ic("1.9.1");Yb&&ic("9");function Dg(a,c){this.x=ca(a)?a:0;this.y=ca(c)?c:0}l=Dg.prototype;l.clone=function(){return new Dg(this.x,this.y)};l.ceil=function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);return this};l.floor=function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this};l.round=function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this};l.scale=function(a,c){var d=ja(c)?c:a;this.x*=a;this.y*=d;return this};function Eg(a,c){this.width=a;this.height=c}l=Eg.prototype;l.clone=function(){return new Eg(this.width,this.height)};l.ti=function(){return this.width*this.height};l.za=function(){return!this.ti()};l.ceil=function(){this.width=Math.ceil(this.width);this.height=Math.ceil(this.height);return this};l.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};l.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};
l.scale=function(a,c){var d=ja(c)?c:a;this.width*=a;this.height*=d;return this};function Fg(a){return a?new Gg(Hg(a)):ya||(ya=new Gg)}function Ig(a){var c=document;return ia(a)?c.getElementById(a):a}function Jg(a,c){Gb(c,function(c,e){"style"==e?a.style.cssText=c:"class"==e?a.className=c:"for"==e?a.htmlFor=c:Kg.hasOwnProperty(e)?a.setAttribute(Kg[e],c):0==e.lastIndexOf("aria-",0)||0==e.lastIndexOf("data-",0)?a.setAttribute(e,c):a[e]=c})}
var Kg={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function Lg(a){a=a.document.documentElement;return new Eg(a.clientWidth,a.clientHeight)}
function Mg(a,c,d){var e=arguments,f=document,g=e[0],h=e[1];if(!Cg&&h&&(h.name||h.type)){g=["<",g];h.name&&g.push(' name="',Ca(h.name),'"');if(h.type){g.push(' type="',Ca(h.type),'"');var k={};Wb(k,h);delete k.type;h=k}g.push(">");g=g.join("")}g=f.createElement(g);h&&(ia(h)?g.className=h:ga(h)?g.className=h.join(" "):Jg(g,h));2<e.length&&Ng(f,g,e,2);return g}
function Ng(a,c,d,e){function f(d){d&&c.appendChild(ia(d)?a.createTextNode(d):d)}for(;e<d.length;e++){var g=d[e];!ha(g)||la(g)&&0<g.nodeType?f(g):Za(Og(g)?hb(g):g,f)}}function Pg(a){return document.createElement(a)}function Qg(a,c){Ng(Hg(a),a,arguments,1)}function Rg(a){for(var c;c=a.firstChild;)a.removeChild(c)}function Sg(a,c,d){a.insertBefore(c,a.childNodes[d]||null)}function Tg(a){a&&a.parentNode&&a.parentNode.removeChild(a)}function Ug(a,c){var d=c.parentNode;d&&d.replaceChild(a,c)}
function Vg(a){if(ca(a.firstElementChild))a=a.firstElementChild;else for(a=a.firstChild;a&&1!=a.nodeType;)a=a.nextSibling;return a}function Wg(a,c){if(a.contains&&1==c.nodeType)return a==c||a.contains(c);if("undefined"!=typeof a.compareDocumentPosition)return a==c||Boolean(a.compareDocumentPosition(c)&16);for(;c&&a!=c;)c=c.parentNode;return c==a}function Hg(a){return 9==a.nodeType?a:a.ownerDocument||a.document}
function Og(a){if(a&&"number"==typeof a.length){if(la(a))return"function"==typeof a.item||"string"==typeof a.item;if(ka(a))return"function"==typeof a.item}return!1}function Gg(a){this.b=a||ba.document||document}function Xg(){return!0}
function Yg(a){var c=a.b;a=c.scrollingElement?c.scrollingElement:ac?c.body||c.documentElement:c.documentElement;c=c.parentWindow||c.defaultView;return Yb&&ic("10")&&c.pageYOffset!=a.scrollTop?new Dg(a.scrollLeft,a.scrollTop):new Dg(c.pageXOffset||a.scrollLeft,c.pageYOffset||a.scrollTop)}Gg.prototype.appendChild=function(a,c){a.appendChild(c)};Gg.prototype.contains=Wg;function Zg(a){if(a.classList)return a.classList;a=a.className;return ia(a)&&a.match(/\S+/g)||[]}function $g(a,c){var d;a.classList?d=a.classList.contains(c):(d=Zg(a),d=0<=Ya(d,c));return d}function ah(a,c){a.classList?a.classList.add(c):$g(a,c)||(a.className+=0<a.className.length?" "+c:c)}function bh(a,c){a.classList?a.classList.remove(c):$g(a,c)&&(a.className=$a(Zg(a),function(a){return a!=c}).join(" "))}function ch(a,c){$g(a,c)?bh(a,c):ah(a,c)};function dh(a,c,d,e){this.top=a;this.right=c;this.bottom=d;this.left=e}l=dh.prototype;l.clone=function(){return new dh(this.top,this.right,this.bottom,this.left)};l.contains=function(a){return this&&a?a instanceof dh?a.left>=this.left&&a.right<=this.right&&a.top>=this.top&&a.bottom<=this.bottom:a.x>=this.left&&a.x<=this.right&&a.y>=this.top&&a.y<=this.bottom:!1};
l.ceil=function(){this.top=Math.ceil(this.top);this.right=Math.ceil(this.right);this.bottom=Math.ceil(this.bottom);this.left=Math.ceil(this.left);return this};l.floor=function(){this.top=Math.floor(this.top);this.right=Math.floor(this.right);this.bottom=Math.floor(this.bottom);this.left=Math.floor(this.left);return this};l.round=function(){this.top=Math.round(this.top);this.right=Math.round(this.right);this.bottom=Math.round(this.bottom);this.left=Math.round(this.left);return this};
l.scale=function(a,c){var d=ja(c)?c:a;this.left*=a;this.right*=a;this.top*=d;this.bottom*=d;return this};function eh(a,c,d,e){this.left=a;this.top=c;this.width=d;this.height=e}l=eh.prototype;l.clone=function(){return new eh(this.left,this.top,this.width,this.height)};l.contains=function(a){return a instanceof eh?this.left<=a.left&&this.left+this.width>=a.left+a.width&&this.top<=a.top&&this.top+this.height>=a.top+a.height:a.x>=this.left&&a.x<=this.left+this.width&&a.y>=this.top&&a.y<=this.top+this.height};
l.distance=function(a){var c=a.x<this.left?this.left-a.x:Math.max(a.x-(this.left+this.width),0);a=a.y<this.top?this.top-a.y:Math.max(a.y-(this.top+this.height),0);return Math.sqrt(c*c+a*a)};l.ceil=function(){this.left=Math.ceil(this.left);this.top=Math.ceil(this.top);this.width=Math.ceil(this.width);this.height=Math.ceil(this.height);return this};l.floor=function(){this.left=Math.floor(this.left);this.top=Math.floor(this.top);this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};
l.round=function(){this.left=Math.round(this.left);this.top=Math.round(this.top);this.width=Math.round(this.width);this.height=Math.round(this.height);return this};l.scale=function(a,c){var d=ja(c)?c:a;this.left*=a;this.width*=a;this.top*=d;this.height*=d;return this};function fh(a,c){var d=Hg(a);return d.defaultView&&d.defaultView.getComputedStyle&&(d=d.defaultView.getComputedStyle(a,null))?d[c]||d.getPropertyValue(c)||"":""}function gh(a,c){return fh(a,c)||(a.currentStyle?a.currentStyle[c]:null)||a.style&&a.style[c]}function hh(a,c,d){var e;c instanceof Dg?(e=c.x,c=c.y):(e=c,c=d);a.style.left=ih(e);a.style.top=ih(c)}
function jh(a){var c;try{c=a.getBoundingClientRect()}catch(d){return{left:0,top:0,right:0,bottom:0}}Yb&&a.ownerDocument.body&&(a=a.ownerDocument,c.left-=a.documentElement.clientLeft+a.body.clientLeft,c.top-=a.documentElement.clientTop+a.body.clientTop);return c}function kh(a){if(1==a.nodeType)return a=jh(a),new Dg(a.left,a.top);a=a.changedTouches?a.changedTouches[0]:a;return new Dg(a.clientX,a.clientY)}function ih(a){"number"==typeof a&&(a=a+"px");return a}
function lh(a){var c=mh;if("none"!=gh(a,"display"))return c(a);var d=a.style,e=d.display,f=d.visibility,g=d.position;d.visibility="hidden";d.position="absolute";d.display="inline";a=c(a);d.display=e;d.position=g;d.visibility=f;return a}function mh(a){var c=a.offsetWidth,d=a.offsetHeight,e=ac&&!c&&!d;return ca(c)&&!e||!a.getBoundingClientRect?new Eg(c,d):(a=jh(a),new Eg(a.right-a.left,a.bottom-a.top))}function nh(a,c){a.style.display=c?"":"none"}
function oh(a,c,d,e){if(/^\d+px?$/.test(c))return parseInt(c,10);var f=a.style[d],g=a.runtimeStyle[d];a.runtimeStyle[d]=a.currentStyle[d];a.style[d]=c;c=a.style[e];a.style[d]=f;a.runtimeStyle[d]=g;return c}function ph(a,c){var d=a.currentStyle?a.currentStyle[c]:null;return d?oh(a,d,"left","pixelLeft"):0}
function qh(a,c){if(Yb){var d=ph(a,c+"Left"),e=ph(a,c+"Right"),f=ph(a,c+"Top"),g=ph(a,c+"Bottom");return new dh(f,e,g,d)}d=fh(a,c+"Left");e=fh(a,c+"Right");f=fh(a,c+"Top");g=fh(a,c+"Bottom");return new dh(parseFloat(f),parseFloat(e),parseFloat(g),parseFloat(d))}var rh={thin:2,medium:4,thick:6};function sh(a,c){if("none"==(a.currentStyle?a.currentStyle[c+"Style"]:null))return 0;var d=a.currentStyle?a.currentStyle[c+"Width"]:null;return d in rh?rh[d]:oh(a,d,"left","pixelLeft")}
function th(a){if(Yb&&!(9<=kc)){var c=sh(a,"borderLeft"),d=sh(a,"borderRight"),e=sh(a,"borderTop");a=sh(a,"borderBottom");return new dh(e,d,a,c)}c=fh(a,"borderLeftWidth");d=fh(a,"borderRightWidth");e=fh(a,"borderTopWidth");a=fh(a,"borderBottomWidth");return new dh(parseFloat(e),parseFloat(d),parseFloat(a),parseFloat(c))};function uh(a,c,d){uc.call(this,a);this.map=c;this.frameState=void 0!==d?d:null}w(uh,uc);function vh(a){hd.call(this);this.element=a.element?a.element:null;this.a=this.U=null;this.B=[];this.render=a.render?a.render:va;a.target&&this.f(a.target)}w(vh,hd);vh.prototype.Z=function(){Tg(this.element);vh.ca.Z.call(this)};vh.prototype.g=function(){return this.a};
vh.prototype.setMap=function(a){this.a&&Tg(this.element);0<this.B.length&&(this.B.forEach(Yc),this.B.length=0);if(this.a=a)(this.U?this.U:a.C).appendChild(this.element),this.render!==va&&this.B.push(B(a,"postrender",this.render,!1,this)),a.render()};vh.prototype.f=function(a){this.U=Ig(a)};function wh(){this.c=0;this.f={};this.a=this.b=null}l=wh.prototype;l.clear=function(){this.c=0;this.f={};this.a=this.b=null};function xh(a,c){return a.f.hasOwnProperty(c)}l.forEach=function(a,c){for(var d=this.b;d;)a.call(c,d.mc,d.Ud,this),d=d.cb};l.get=function(a){a=this.f[a];if(a===this.a)return a.mc;a===this.b?(this.b=this.b.cb,this.b.Nb=null):(a.cb.Nb=a.Nb,a.Nb.cb=a.cb);a.cb=null;a.Nb=this.a;this.a=this.a.cb=a;return a.mc};l.Sb=function(){return this.c};
l.P=function(){var a=Array(this.c),c=0,d;for(d=this.a;d;d=d.Nb)a[c++]=d.Ud;return a};l.Wb=function(){var a=Array(this.c),c=0,d;for(d=this.a;d;d=d.Nb)a[c++]=d.mc;return a};l.pop=function(){var a=this.b;delete this.f[a.Ud];a.cb&&(a.cb.Nb=null);this.b=a.cb;this.b||(this.a=null);--this.c;return a.mc};l.set=function(a,c){var d={Ud:a,cb:null,Nb:this.a,mc:c};this.a?this.a.cb=d:this.b=d;this.a=d;this.f[a]=d;++this.c};function yh(a){wh.call(this);this.g=void 0!==a?a:2048}w(yh,wh);function zh(a){return a.Sb()>a.g};function Ah(a,c){bd.call(this);this.b=a;this.state=c}w(Ah,bd);function Bh(a){a.s("change")}Ah.prototype.nb=function(){return v(this).toString()};Ah.prototype.j=function(){return this.b};function Ch(a){hd.call(this);this.i=Ce(a.projection);this.j=void 0!==a.attributions?a.attributions:null;this.U=a.logo;this.A=void 0!==a.state?a.state:"ready";this.O=void 0!==a.wrapX?a.wrapX:!1}w(Ch,hd);l=Ch.prototype;l.ee=va;l.na=function(){return this.j};l.ma=function(){return this.U};l.oa=function(){return this.i};l.pa=function(){return this.A};function Dh(a){return a.O}l.la=function(a){this.j=a;this.u()};function Eh(a,c){a.A=c;a.u()};function Fh(a){this.minZoom=void 0!==a.minZoom?a.minZoom:0;this.b=a.resolutions;this.maxZoom=this.b.length-1;this.c=void 0!==a.origin?a.origin:null;this.g=null;void 0!==a.origins&&(this.g=a.origins);var c=a.extent;void 0===c||this.c||this.g||(this.c=fe(c));this.j=null;void 0!==a.tileSizes&&(this.j=a.tileSizes);this.l=void 0!==a.tileSize?a.tileSize:this.j?null:256;this.B=void 0!==c?c:null;this.a=null;void 0!==a.sizes?this.a=a.sizes.map(function(a){return new mg(Math.min(0,a[0]),Math.max(a[0]-1,-1),
Math.min(0,a[1]),Math.max(a[1]-1,-1))},this):c&&Gh(this,c);this.f=[0,0]}var Hh=[0,0,0];function Ih(a,c,d,e,f){f=a.Ea(c,f);for(c=c[0]-1;c>=a.minZoom;){if(d.call(null,c,kg(a,f,c,e)))return!0;--c}return!1}l=Fh.prototype;l.S=function(){return this.B};l.Zf=function(){return this.maxZoom};l.$f=function(){return this.minZoom};l.ua=function(a){return this.c?this.c:this.g[a]};l.ba=function(a){return this.b[a]};l.Pg=function(){return this.b};
function Jh(a,c,d,e){return c[0]<a.maxZoom?(e=a.Ea(c,e),kg(a,e,c[0]+1,d)):null}function Kh(a,c,d,e){Lh(a,c[0],c[1],d,!1,Hh);var f=Hh[1],g=Hh[2];Lh(a,c[2],c[3],d,!0,Hh);a=Hh[1];c=Hh[2];void 0!==e?(e.b=f,e.f=a,e.a=g,e.c=c):e=new mg(f,a,g,c);return e}function kg(a,c,d,e){d=a.ba(d);return Kh(a,c,d,e)}function hg(a,c){var d=a.ua(c[0]),e=a.ba(c[0]),f=nd(a.La(c[0]),a.f);return[d[0]+(c[1]+.5)*f[0]*e,d[1]+(c[2]+.5)*f[1]*e]}
l.Ea=function(a,c){var d=this.ua(a[0]),e=this.ba(a[0]),f=nd(this.La(a[0]),this.f),g=d[0]+a[1]*f[0]*e,d=d[1]+a[2]*f[1]*e;return Qd(g,d,g+f[0]*e,d+f[1]*e,c)};l.ad=function(a,c,d){return Lh(this,a[0],a[1],c,!1,d)};function Lh(a,c,d,e,f,g){var h=Mh(a,e),k=e/a.ba(h),m=a.ua(h);a=nd(a.La(h),a.f);c=k*Math.floor((c-m[0])/e+(f?.5:0))/a[0];d=k*Math.floor((d-m[1])/e+(f?0:.5))/a[1];f?(c=Math.ceil(c)-1,d=Math.ceil(d)-1):(c=Math.floor(c),d=Math.floor(d));return cg(h,c,d,g)}
l.Md=function(a,c,d){c=this.ba(c);return Lh(this,a[0],a[1],c,!1,d)};l.La=function(a){return this.l?this.l:this.j[a]};function Mh(a,c){var d=ub(a.b,c,0);return Qa(d,a.minZoom,a.maxZoom)}function Gh(a,c){for(var d=a.b.length,e=Array(d),f=a.minZoom;f<d;++f)e[f]=kg(a,c,f);a.a=e}function Nh(a){var c={};Wb(c,void 0!==a?a:{});void 0===c.extent&&(c.extent=Ce("EPSG:3857").S());c.resolutions=Oh(c.extent,c.maxZoom,c.tileSize);delete c.maxZoom;return new Fh(c)}
function Oh(a,c,d){c=void 0!==c?c:42;var e=ie(a);a=le(a);d=nd(void 0!==d?d:256);d=Math.max(a/d[0],e/d[1]);c+=1;e=Array(c);for(a=0;a<c;++a)e[a]=d/Math.pow(2,a);return e}function ig(a){a=Ce(a);var c=a.S();c||(a=180*ze.degrees/a.Hd(),c=Qd(-a,-a,a,a));return c};function Ph(a){Ch.call(this,{attributions:a.attributions,extent:a.extent,logo:a.logo,projection:a.projection,state:a.state,wrapX:a.wrapX});this.da=void 0!==a.opaque?a.opaque:!1;this.ga=void 0!==a.tilePixelRatio?a.tilePixelRatio:1;this.tileGrid=void 0!==a.tileGrid?a.tileGrid:null;this.a=new yh;this.c=[0,0]}w(Ph,Ch);function Rh(a,c,d,e){for(var f=!0,g,h,k=d.b;k<=d.f;++k)for(var m=d.a;m<=d.c;++m)g=a.lb(c,k,m),h=!1,xh(a.a,g)&&(g=a.a.get(g),(h=2===g.state)&&(h=!1!==e(g))),h||(f=!1);return f}l=Ph.prototype;
l.Ed=function(){return 0};l.lb=dg;l.Fa=function(){return this.tileGrid};function Sh(a,c){var d;if(a.tileGrid)d=a.tileGrid;else if(d=c.l,!d){d=ig(c);var e=Oh(d,void 0,void 0);d=new Fh({extent:d,origin:fe(d),resolutions:e,tileSize:void 0});c.l=d}return d}l.Vb=function(a,c,d){c=Sh(this,d);return md(nd(c.La(a),this.c),this.ga,this.c)};function Th(a,c,d){d=void 0!==d?d:a.i;var e=Sh(a,d);a.O&&d.f&&(c=gg(c,e,d));return jg(c,e)?c:null}l.Cf=va;function Uh(a,c){uc.call(this,a);this.tile=c}w(Uh,uc);function Vh(a){a=a?a:{};this.C=Pg("UL");this.A=Pg("LI");this.C.appendChild(this.A);nh(this.A,!1);this.c=void 0!==a.collapsed?a.collapsed:!0;this.i=void 0!==a.collapsible?a.collapsible:!0;this.i||(this.c=!1);var c=a.className?a.className:"ol-attribution",d=a.tipLabel?a.tipLabel:"Attributions",e=a.collapseLabel?a.collapseLabel:"\u00bb";this.O=ia(e)?Mg("SPAN",{},e):e;e=a.label?a.label:"i";this.J=ia(e)?Mg("SPAN",{},e):e;d=Mg("BUTTON",{type:"button",title:d},this.i&&!this.c?this.O:this.J);B(d,"click",
this.Sk,!1,this);B(d,["mouseout",xc],function(){this.blur()},!1);c=Mg("DIV",c+" ol-unselectable ol-control"+(this.c&&this.i?" ol-collapsed":"")+(this.i?"":" ol-uncollapsible"),this.C,d);vh.call(this,{element:c,render:a.render?a.render:Wh,target:a.target});this.v=!0;this.l={};this.j={};this.Y={}}w(Vh,vh);
function Wh(a){if(a=a.frameState){var c,d,e,f,g,h,k,m,n,p,q,r=a.layerStatesArray,u=Tb(a.attributions),y={},A=a.viewState.projection;d=0;for(c=r.length;d<c;d++)if(h=r[d].layer.fa())if(p=v(h).toString(),n=h.j)for(e=0,f=n.length;e<f;e++)if(k=n[e],m=v(k).toString(),!(m in u)){if(g=a.usedTiles[p]){var F=Sh(h,A);a:{q=k;var z=A;if(q.b){var x=void 0,K=void 0,J=void 0,I=void 0;for(I in g)if(I in q.b)for(var J=g[I],O,x=0,K=q.b[I].length;x<K;++x){O=q.b[I][x];if(qg(O,J)){q=!0;break a}var wa=kg(F,z.S(),parseInt(I,
10)),Ua=pg(wa);if(J.b<wa.b||J.f>wa.f)if(qg(O,new mg(od(J.b,Ua),od(J.f,Ua),J.a,J.c))||pg(J)>Ua&&qg(O,wa)){q=!0;break a}}q=!1}else q=!0}}else q=!1;q?(m in y&&delete y[m],u[m]=k):y[m]=k}c=[u,y];d=c[0];c=c[1];for(var M in this.l)M in d?(this.j[M]||(nh(this.l[M],!0),this.j[M]=!0),delete d[M]):M in c?(this.j[M]&&(nh(this.l[M],!1),delete this.j[M]),delete c[M]):(Tg(this.l[M]),delete this.l[M],delete this.j[M]);for(M in d)e=Pg("LI"),e.innerHTML=d[M].a,this.C.appendChild(e),this.l[M]=e,this.j[M]=!0;for(M in c)e=
Pg("LI"),e.innerHTML=c[M].a,nh(e,!1),this.C.appendChild(e),this.l[M]=e;M=!Pb(this.j)||!Pb(a.logos);this.v!=M&&(nh(this.element,M),this.v=M);M&&Pb(this.j)?ah(this.element,"ol-logo-only"):bh(this.element,"ol-logo-only");var Ma;a=a.logos;M=this.Y;for(Ma in M)Ma in a||(Tg(M[Ma]),delete M[Ma]);for(var qb in a)d=a[qb],d instanceof HTMLElement&&(this.A.appendChild(d),M[qb]=d),qb in M||(Ma=new Image,Ma.src=qb,""===d?d=Ma:(d=Mg("A",{href:d}),d.appendChild(Ma)),this.A.appendChild(d),M[qb]=d);nh(this.A,!Pb(a))}else this.v&&
(nh(this.element,!1),this.v=!1)}l=Vh.prototype;l.Sk=function(a){a.preventDefault();Xh(this)};function Xh(a){ch(a.element,"ol-collapsed");a.c?Ug(a.O,a.J):Ug(a.J,a.O);a.c=!a.c}l.Rk=function(){return this.i};l.Uk=function(a){this.i!==a&&(this.i=a,ch(this.element,"ol-uncollapsible"),!a&&this.c&&Xh(this))};l.Tk=function(a){this.i&&this.c!==a&&Xh(this)};l.Qk=function(){return this.c};function Yh(a){a=a?a:{};var c=a.className?a.className:"ol-rotate",d=a.label?a.label:"\u21e7";this.c=null;ia(d)?this.c=Mg("SPAN","ol-compass",d):(this.c=d,ah(this.c,"ol-compass"));d=Mg("BUTTON",{"class":c+"-reset",type:"button",title:a.tipLabel?a.tipLabel:"Reset rotation"},this.c);B(d,"click",Yh.prototype.A,!1,this);c=Mg("DIV",c+" ol-unselectable ol-control",d);vh.call(this,{element:c,render:a.render?a.render:Zh,target:a.target});this.i=a.duration?a.duration:250;this.j=void 0!==a.autoHide?a.autoHide:
!0;this.l=void 0;this.j&&ah(this.element,"ol-hidden")}w(Yh,vh);Yh.prototype.A=function(a){a.preventDefault();a=this.a;var c=a.aa();if(c){var d=c.wa();void 0!==d&&(0<this.i&&(d%=2*Math.PI,d<-Math.PI&&(d+=2*Math.PI),d>Math.PI&&(d-=2*Math.PI),a.Ba(ag({rotation:d,duration:this.i,easing:Wf}))),c.$d(0))}};
function Zh(a){if(a=a.frameState){a=a.viewState.rotation;if(a!=this.l){var c="rotate("+a+"rad)";if(this.j){var d=this.element;0===a?ah(d,"ol-hidden"):bh(d,"ol-hidden")}this.c.style.msTransform=c;this.c.style.webkitTransform=c;this.c.style.transform=c}this.l=a}};function $h(a){a=a?a:{};var c=a.className?a.className:"ol-zoom",d=a.delta?a.delta:1,e=a.zoomOutLabel?a.zoomOutLabel:"\u2212",f=a.zoomOutTipLabel?a.zoomOutTipLabel:"Zoom out",g=Mg("BUTTON",{"class":c+"-in",type:"button",title:a.zoomInTipLabel?a.zoomInTipLabel:"Zoom in"},a.zoomInLabel?a.zoomInLabel:"+");B(g,"click",ra($h.prototype.j,d),!1,this);e=Mg("BUTTON",{"class":c+"-out",type:"button",title:f},e);B(e,"click",ra($h.prototype.j,-d),!1,this);c=Mg("DIV",c+" ol-unselectable ol-control",g,e);vh.call(this,
{element:c,target:a.target});this.c=void 0!==a.duration?a.duration:250}w($h,vh);$h.prototype.j=function(a,c){c.preventDefault();var d=this.a,e=d.aa();if(e){var f=e.ba();f&&(0<this.c&&d.Ba(bg({resolution:f,duration:this.c,easing:Wf})),d=e.constrainResolution(f,a),e.zb(d))}};function ai(a){a=a?a:{};var c=new tg;(void 0!==a.zoom?a.zoom:1)&&c.push(new $h(a.zoomOptions));(void 0!==a.rotate?a.rotate:1)&&c.push(new Yh(a.rotateOptions));(void 0!==a.attribution?a.attribution:1)&&c.push(new Vh(a.attributionOptions));return c};var bi=ac?"webkitfullscreenchange":$b?"mozfullscreenchange":Yb?"MSFullscreenChange":"fullscreenchange";function ci(){var a=Fg().b,c=a.body;return!!(c.webkitRequestFullscreen||c.mozRequestFullScreen&&a.mozFullScreenEnabled||c.msRequestFullscreen&&a.msFullscreenEnabled||c.requestFullscreen&&a.fullscreenEnabled)}
function di(a){a.webkitRequestFullscreen?a.webkitRequestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.msRequestFullscreen?a.msRequestFullscreen():a.requestFullscreen&&a.requestFullscreen()}function ei(){var a=Fg().b;return!!(a.webkitIsFullScreen||a.mozFullScreen||a.msFullscreenElement||a.fullscreenElement)};function fi(a){a=a?a:{};this.c=a.className?a.className:"ol-full-screen";var c=a.label?a.label:"\u2194";this.j=ia(c)?document.createTextNode(String(c)):c;c=a.labelActive?a.labelActive:"\u00d7";this.i=ia(c)?document.createTextNode(String(c)):c;c=a.tipLabel?a.tipLabel:"Toggle full-screen";c=Mg("BUTTON",{"class":this.c+"-"+ei(),type:"button",title:c},this.j);B(c,"click",this.v,!1,this);B(ba.document,bi,this.l,!1,this);var d=this.c+" ol-unselectable ol-control "+(ci()?"":"ol-unsupported"),c=Mg("DIV",d,
c);vh.call(this,{element:c,target:a.target});this.A=void 0!==a.keys?a.keys:!1}w(fi,vh);fi.prototype.v=function(a){a.preventDefault();ci()&&(a=this.a)&&(ei()?(a=Fg().b,a.webkitCancelFullScreen?a.webkitCancelFullScreen():a.mozCancelFullScreen?a.mozCancelFullScreen():a.msExitFullscreen?a.msExitFullscreen():a.exitFullscreen&&a.exitFullscreen()):(a=a.ff(),a=Ig(a),this.A?a.mozRequestFullScreenWithKeys?a.mozRequestFullScreenWithKeys():a.webkitRequestFullscreen?a.webkitRequestFullscreen():di(a):di(a)))};
fi.prototype.l=function(){var a=this.c+"-true",c=this.c+"-false",d=Vg(this.element),e=this.a;ei()?($g(d,c)&&(bh(d,c),ah(d,a)),Ug(this.i,this.j)):($g(d,a)&&(bh(d,a),ah(d,c)),Ug(this.j,this.i));e&&e.Hc()};function gi(a){a=a?a:{};var c=Mg("DIV",a.className?a.className:"ol-mouse-position");vh.call(this,{element:c,render:a.render?a.render:hi,target:a.target});B(this,jd("projection"),this.Vk,!1,this);a.coordinateFormat&&this.jh(a.coordinateFormat);a.projection&&this.vg(Ce(a.projection));this.A=a.undefinedHTML?a.undefinedHTML:"";this.l=c.innerHTML;this.i=this.j=this.c=null}w(gi,vh);
function hi(a){a=a.frameState;a?this.c!=a.viewState.projection&&(this.c=a.viewState.projection,this.j=null):this.c=null;ii(this,this.i)}l=gi.prototype;l.Vk=function(){this.j=null};l.Vf=function(){return this.get("coordinateFormat")};l.ug=function(){return this.get("projection")};l.Pj=function(a){this.i=this.a.Cd(a.b);ii(this,this.i)};l.Qj=function(){ii(this,null);this.i=null};
l.setMap=function(a){gi.ca.setMap.call(this,a);a&&(a=a.a,this.B.push(B(a,"mousemove",this.Pj,!1,this),B(a,"mouseout",this.Qj,!1,this)))};l.jh=function(a){this.set("coordinateFormat",a)};l.vg=function(a){this.set("projection",a)};function ii(a,c){var d=a.A;if(c&&a.c){if(!a.j){var e=a.ug();a.j=e?Ge(a.c,e):We}if(e=a.a.ya(c))a.j(e,e),d=(d=a.Vf())?d(e):e.toString()}a.l&&d==a.l||(a.element.innerHTML=d,a.l=d)};function ji(a,c,d){pc.call(this);this.qa=null;this.c=!1;this.j=a;this.g=d;this.b=c||window;this.a=qa(this.f,this)}w(ji,pc);ji.prototype.start=function(){ki(this);this.c=!1;var a=li(this),c=mi(this);a&&!c&&this.b.mozRequestAnimationFrame?(this.qa=B(this.b,"MozBeforePaint",this.a),this.b.mozRequestAnimationFrame(null),this.c=!0):this.qa=a&&c?a.call(this.b,this.a):this.b.setTimeout(ue(this.a),20)};
function ki(a){if(null!=a.qa){var c=li(a),d=mi(a);c&&!d&&a.b.mozRequestAnimationFrame?Yc(a.qa):c&&d?d.call(a.b,a.qa):a.b.clearTimeout(a.qa)}a.qa=null}ji.prototype.f=function(){this.c&&this.qa&&Yc(this.qa);this.qa=null;this.j.call(this.g,sa())};ji.prototype.Z=function(){ki(this);ji.ca.Z.call(this)};function li(a){a=a.b;return a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||a.oRequestAnimationFrame||a.msRequestAnimationFrame||null}
function mi(a){a=a.b;return a.cancelAnimationFrame||a.cancelRequestAnimationFrame||a.webkitCancelRequestAnimationFrame||a.mozCancelRequestAnimationFrame||a.oCancelRequestAnimationFrame||a.msCancelRequestAnimationFrame||null};function ni(a){ba.setTimeout(function(){throw a;},0)}function oi(a,c){var d=a;c&&(d=qa(a,c));d=pi(d);!ka(ba.setImmediate)||ba.Window&&ba.Window.prototype&&ba.Window.prototype.setImmediate==ba.setImmediate?(qi||(qi=ri()),qi(d)):ba.setImmediate(d)}var qi;
function ri(){var a=ba.MessageChannel;"undefined"===typeof a&&"undefined"!==typeof window&&window.postMessage&&window.addEventListener&&!Fb("Presto")&&(a=function(){var a=document.createElement("IFRAME");a.style.display="none";a.src="";document.documentElement.appendChild(a);var c=a.contentWindow,a=c.document;a.open();a.write("");a.close();var d="callImmediate"+Math.random(),e="file:"==c.location.protocol?"*":c.location.protocol+"//"+c.location.host,a=qa(function(a){if(("*"==e||a.origin==e)&&a.data==
d)this.port1.onmessage()},this);c.addEventListener("message",a,!1);this.port1={};this.port2={postMessage:function(){c.postMessage(d,e)}}});if("undefined"!==typeof a&&!Fb("Trident")&&!Fb("MSIE")){var c=new a,d={},e=d;c.port1.onmessage=function(){if(ca(d.next)){d=d.next;var a=d.Rf;d.Rf=null;a()}};return function(a){e.next={Rf:a};e=e.next;c.port2.postMessage(0)}}return"undefined"!==typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?function(a){var c=document.createElement("SCRIPT");
c.onreadystatechange=function(){c.onreadystatechange=null;c.parentNode.removeChild(c);c=null;a();a=null};document.documentElement.appendChild(c)}:function(a){ba.setTimeout(a,0)}}var pi=te;function si(a,c){this.a={};this.b=[];this.c=0;var d=arguments.length;if(1<d){if(d%2)throw Error("Uneven number of arguments");for(var e=0;e<d;e+=2)this.set(arguments[e],arguments[e+1])}else if(a){a instanceof si?(d=a.P(),e=a.Wb()):(d=Lb(a),e=Kb(a));for(var f=0;f<d.length;f++)this.set(d[f],e[f])}}l=si.prototype;l.Sb=function(){return this.c};l.Wb=function(){ti(this);for(var a=[],c=0;c<this.b.length;c++)a.push(this.a[this.b[c]]);return a};l.P=function(){ti(this);return this.b.concat()};
l.za=function(){return 0==this.c};l.clear=function(){this.a={};this.c=this.b.length=0};l.remove=function(a){return ui(this.a,a)?(delete this.a[a],this.c--,this.b.length>2*this.c&&ti(this),!0):!1};function ti(a){if(a.c!=a.b.length){for(var c=0,d=0;c<a.b.length;){var e=a.b[c];ui(a.a,e)&&(a.b[d++]=e);c++}a.b.length=d}if(a.c!=a.b.length){for(var f={},d=c=0;c<a.b.length;)e=a.b[c],ui(f,e)||(a.b[d++]=e,f[e]=1),c++;a.b.length=d}}l.get=function(a,c){return ui(this.a,a)?this.a[a]:c};
l.set=function(a,c){ui(this.a,a)||(this.c++,this.b.push(a));this.a[a]=c};l.forEach=function(a,c){for(var d=this.P(),e=0;e<d.length;e++){var f=d[e],g=this.get(f);a.call(c,g,f,this)}};l.clone=function(){return new si(this)};function ui(a,c){return Object.prototype.hasOwnProperty.call(a,c)};function vi(){this.b=sa()}new vi;vi.prototype.set=function(a){this.b=a};vi.prototype.reset=function(){this.set(sa())};vi.prototype.get=function(){return this.b};function wi(a){bd.call(this);this.b=a||window;this.a=B(this.b,"resize",this.f,!1,this);this.c=Lg(this.b||window)}w(wi,bd);wi.prototype.Z=function(){wi.ca.Z.call(this);this.a&&(Yc(this.a),this.a=null);this.c=this.b=null};wi.prototype.f=function(){var a=Lg(this.b||window),c=this.c;a==c||a&&c&&a.width==c.width&&a.height==c.height||(this.c=a,this.s("resize"))};function xi(a,c,d,e,f){if(!(Yb||Zb||ac&&ic("525")))return!0;if(bc&&f)return yi(a);if(f&&!e)return!1;ja(c)&&(c=zi(c));if(!d&&(17==c||18==c||bc&&91==c))return!1;if((ac||Zb)&&e&&d)switch(a){case 220:case 219:case 221:case 192:case 186:case 189:case 187:case 188:case 190:case 191:case 192:case 222:return!1}if(Yb&&e&&c==a)return!1;switch(a){case 13:return!0;case 27:return!(ac||Zb)}return yi(a)}
function yi(a){if(48<=a&&57>=a||96<=a&&106>=a||65<=a&&90>=a||(ac||Zb)&&0==a)return!0;switch(a){case 32:case 43:case 63:case 64:case 107:case 109:case 110:case 111:case 186:case 59:case 189:case 187:case 61:case 188:case 190:case 191:case 192:case 222:case 219:case 220:case 221:return!0;default:return!1}}function zi(a){if($b)a=Ai(a);else if(bc&&ac)a:switch(a){case 93:a=91;break a}return a}
function Ai(a){switch(a){case 61:return 187;case 59:return 186;case 173:return 189;case 224:return 91;case 0:return 224;default:return a}};function Bi(a,c){bd.call(this);a&&Ci(this,a,c)}w(Bi,bd);l=Bi.prototype;l.bd=null;l.Sd=null;l.$e=null;l.Td=null;l.Ra=-1;l.Hb=-1;l.He=!1;
var Di={3:13,12:144,63232:38,63233:40,63234:37,63235:39,63236:112,63237:113,63238:114,63239:115,63240:116,63241:117,63242:118,63243:119,63244:120,63245:121,63246:122,63247:123,63248:44,63272:46,63273:36,63275:35,63276:33,63277:34,63289:144,63302:45},Ei={Up:38,Down:40,Left:37,Right:39,Enter:13,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,"U+007F":46,Home:36,End:35,PageUp:33,PageDown:34,Insert:45},Fi=Yb||Zb||ac&&ic("525"),Gi=bc&&$b;
Bi.prototype.b=function(a){if(ac||Zb)if(17==this.Ra&&!a.D||18==this.Ra&&!a.a||bc&&91==this.Ra&&!a.A)this.Hb=this.Ra=-1;-1==this.Ra&&(a.D&&17!=a.j?this.Ra=17:a.a&&18!=a.j?this.Ra=18:a.A&&91!=a.j&&(this.Ra=91));Fi&&!xi(a.j,this.Ra,a.f,a.D,a.a)?this.handleEvent(a):(this.Hb=zi(a.j),Gi&&(this.He=a.a))};Bi.prototype.a=function(a){this.Hb=this.Ra=-1;this.He=a.a};
Bi.prototype.handleEvent=function(a){var c=a.b,d,e,f=c.altKey;Yb&&"keypress"==a.type?(d=this.Hb,e=13!=d&&27!=d?c.keyCode:0):(ac||Zb)&&"keypress"==a.type?(d=this.Hb,e=0<=c.charCode&&63232>c.charCode&&yi(d)?c.charCode:0):Xb&&!ac?(d=this.Hb,e=yi(d)?c.keyCode:0):(d=c.keyCode||this.Hb,e=c.charCode||0,Gi&&(f=this.He),bc&&63==e&&224==d&&(d=191));var g=d=zi(d),h=c.keyIdentifier;d?63232<=d&&d in Di?g=Di[d]:25==d&&a.f&&(g=9):h&&h in Ei&&(g=Ei[h]);this.Ra=g;a=new Hi(g,e,0,c);a.a=f;this.s(a)};
function Ci(a,c,d){a.Td&&Ii(a);a.bd=c;a.Sd=B(a.bd,"keypress",a,d);a.$e=B(a.bd,"keydown",a.b,d,a);a.Td=B(a.bd,"keyup",a.a,d,a)}function Ii(a){a.Sd&&(Yc(a.Sd),Yc(a.$e),Yc(a.Td),a.Sd=null,a.$e=null,a.Td=null);a.bd=null;a.Ra=-1;a.Hb=-1}Bi.prototype.Z=function(){Bi.ca.Z.call(this);Ii(this)};function Hi(a,c,d,e){zc.call(this,e);this.type="key";this.j=a;this.B=c}w(Hi,zc);function Ji(a,c){bd.call(this);var d=this.b=a;(d=la(d)&&1==d.nodeType?this.b:this.b?this.b.body:null)&&gh(d,"direction");this.a=B(this.b,$b?"DOMMouseScroll":"mousewheel",this,c)}w(Ji,bd);
Ji.prototype.handleEvent=function(a){var c=0,d=0;a=a.b;if("mousewheel"==a.type){c=1;if(Yb||ac&&(cc||ic("532.0")))c=40;d=Ki(-a.wheelDelta,c);c=ca(a.wheelDeltaX)?Ki(-a.wheelDeltaY,c):d}else d=a.detail,100<d?d=3:-100>d&&(d=-3),ca(a.axis)&&a.axis===a.HORIZONTAL_AXIS||(c=d);ja(this.c)&&(c=Math.min(Math.max(c,-this.c),this.c));d=new Li(d,a,0,c);this.s(d)};function Ki(a,c){return ac&&(bc||dc)&&0!=a%c?a:a/c}Ji.prototype.Z=function(){Ji.ca.Z.call(this);Yc(this.a);this.a=null};
function Li(a,c,d,e){zc.call(this,c);this.type="mousewheel";this.detail=a;this.v=e}w(Li,zc);function Mi(a,c,d){uc.call(this,a);this.b=c;a=d?d:{};this.buttons=Ni(a);this.pressure=Oi(a,this.buttons);this.bubbles="bubbles"in a?a.bubbles:!1;this.cancelable="cancelable"in a?a.cancelable:!1;this.view="view"in a?a.view:null;this.detail="detail"in a?a.detail:null;this.screenX="screenX"in a?a.screenX:0;this.screenY="screenY"in a?a.screenY:0;this.clientX="clientX"in a?a.clientX:0;this.clientY="clientY"in a?a.clientY:0;this.button="button"in a?a.button:0;this.relatedTarget="relatedTarget"in a?a.relatedTarget:
null;this.pointerId="pointerId"in a?a.pointerId:0;this.width="width"in a?a.width:0;this.height="height"in a?a.height:0;this.pointerType="pointerType"in a?a.pointerType:"";this.isPrimary="isPrimary"in a?a.isPrimary:!1;c.preventDefault&&(this.preventDefault=function(){c.preventDefault()})}w(Mi,uc);function Ni(a){if(a.buttons||Pi)a=a.buttons;else switch(a.which){case 1:a=1;break;case 2:a=4;break;case 3:a=2;break;default:a=0}return a}
function Oi(a,c){var d=0;a.pressure?d=a.pressure:d=c?.5:0;return d}var Pi=!1;try{Pi=1===(new MouseEvent("click",{buttons:1})).buttons}catch(a){};function Qi(a,c){var d=Pg("CANVAS");a&&(d.width=a);c&&(d.height=c);return d.getContext("2d")}
var Ri=function(){var a;return function(){if(void 0===a)if(ba.getComputedStyle){var c=Pg("P"),d,e={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};document.body.appendChild(c);for(var f in e)f in c.style&&(c.style[f]="translate(1px,1px)",d=ba.getComputedStyle(c).getPropertyValue(e[f]));Tg(c);a=d&&"none"!==d}else a=!1;return a}}(),Si=function(){var a;return function(){if(void 0===a)if(ba.getComputedStyle){var c=
Pg("P"),d,e={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};document.body.appendChild(c);for(var f in e)f in c.style&&(c.style[f]="translate3d(1px,1px,1px)",d=ba.getComputedStyle(c).getPropertyValue(e[f]));Tg(c);a=d&&"none"!==d}else a=!1;return a}}();function Ti(a,c){var d=a.style;d.WebkitTransform=c;d.MozTransform=c;d.b=c;d.msTransform=c;d.transform=c;Yb&&ic("9.0")&&(a.style.transformOrigin="0 0")}
function Ui(a,c){var d;if(Si()){var e=Array(16);for(d=0;16>d;++d)e[d]=c[d].toFixed(6);Ti(a,"matrix3d("+e.join(",")+")")}else if(Ri()){var e=[c[0],c[1],c[4],c[5],c[12],c[13]],f=Array(6);for(d=0;6>d;++d)f[d]=e[d].toFixed(6);Ti(a,"matrix("+f.join(",")+")")}else a.style.left=Math.round(c[12])+"px",a.style.top=Math.round(c[13])+"px"};var Vi=["experimental-webgl","webgl","webkit-3d","moz-webgl"];function Wi(a,c){var d,e,f=Vi.length;for(e=0;e<f;++e)try{if(d=a.getContext(Vi[e],c))return d}catch(g){}return null};var Xi,Yi=ba.devicePixelRatio||1,Zi=!1,$i=function(){if(!("HTMLCanvasElement"in ba))return!1;try{var a=Qi();return a?(void 0!==a.setLineDash&&(Zi=!0),!0):!1}catch(c){return!1}}(),aj="DeviceOrientationEvent"in ba,bj="geolocation"in ba.navigator,cj="ontouchstart"in ba,dj="PointerEvent"in ba,ej=!!ba.navigator.msPointerEnabled,fj=!1,gj,hj=[];if("WebGLRenderingContext"in ba)try{var ij=Wi(Pg("CANVAS"),{failIfMajorPerformanceCaveat:!0});ij&&(fj=!0,gj=ij.getParameter(ij.MAX_TEXTURE_SIZE),hj=ij.getSupportedExtensions())}catch(a){}
Xi=fj;ua=hj;ta=gj;function jj(a,c){this.b=a;this.g=c};function kj(a){jj.call(this,a,{mousedown:this.jk,mousemove:this.kk,mouseup:this.nk,mouseover:this.mk,mouseout:this.lk});this.a=a.a;this.c=[]}w(kj,jj);function lj(a,c){for(var d=a.c,e=c.clientX,f=c.clientY,g=0,h=d.length,k;g<h&&(k=d[g]);g++){var m=Math.abs(f-k[1]);if(25>=Math.abs(e-k[0])&&25>=m)return!0}return!1}function mj(a){var c=nj(a,a.b),d=c.preventDefault;c.preventDefault=function(){a.preventDefault();d()};c.pointerId=1;c.isPrimary=!0;c.pointerType="mouse";return c}l=kj.prototype;
l.jk=function(a){if(!lj(this,a)){(1).toString()in this.a&&this.cancel(a);var c=mj(a);this.a[(1).toString()]=a;oj(this.b,qj,c,a)}};l.kk=function(a){if(!lj(this,a)){var c=mj(a);oj(this.b,rj,c,a)}};l.nk=function(a){if(!lj(this,a)){var c=this.a[(1).toString()];c&&c.button===a.button&&(c=mj(a),oj(this.b,sj,c,a),delete this.a[(1).toString()])}};l.mk=function(a){if(!lj(this,a)){var c=mj(a);tj(this.b,c,a)}};l.lk=function(a){if(!lj(this,a)){var c=mj(a);uj(this.b,c,a)}};
l.cancel=function(a){var c=mj(a);this.b.cancel(c,a);delete this.a[(1).toString()]};function vj(a){jj.call(this,a,{MSPointerDown:this.tk,MSPointerMove:this.uk,MSPointerUp:this.xk,MSPointerOut:this.vk,MSPointerOver:this.wk,MSPointerCancel:this.sk,MSGotPointerCapture:this.qk,MSLostPointerCapture:this.rk});this.a=a.a;this.c=["","unavailable","touch","pen","mouse"]}w(vj,jj);function wj(a,c){var d=c;ja(c.b.pointerType)&&(d=nj(c,c.b),d.pointerType=a.c[c.b.pointerType]);return d}l=vj.prototype;l.tk=function(a){this.a[a.b.pointerId.toString()]=a;var c=wj(this,a);oj(this.b,qj,c,a)};
l.uk=function(a){var c=wj(this,a);oj(this.b,rj,c,a)};l.xk=function(a){var c=wj(this,a);oj(this.b,sj,c,a);delete this.a[a.b.pointerId.toString()]};l.vk=function(a){var c=wj(this,a);uj(this.b,c,a)};l.wk=function(a){var c=wj(this,a);tj(this.b,c,a)};l.sk=function(a){var c=wj(this,a);this.b.cancel(c,a);delete this.a[a.b.pointerId.toString()]};l.rk=function(a){this.b.s(new Mi("lostpointercapture",a,a.b))};l.qk=function(a){this.b.s(new Mi("gotpointercapture",a,a.b))};function xj(a){jj.call(this,a,{pointerdown:this.fn,pointermove:this.gn,pointerup:this.kn,pointerout:this.hn,pointerover:this.jn,pointercancel:this.en,gotpointercapture:this.xj,lostpointercapture:this.ik})}w(xj,jj);l=xj.prototype;l.fn=function(a){yj(this.b,a)};l.gn=function(a){yj(this.b,a)};l.kn=function(a){yj(this.b,a)};l.hn=function(a){yj(this.b,a)};l.jn=function(a){yj(this.b,a)};l.en=function(a){yj(this.b,a)};l.ik=function(a){yj(this.b,a)};l.xj=function(a){yj(this.b,a)};function zj(a,c){jj.call(this,a,{touchstart:this.no,touchmove:this.mo,touchend:this.lo,touchcancel:this.ko});this.a=a.a;this.i=c;this.c=void 0;this.j=0;this.f=void 0}w(zj,jj);l=zj.prototype;l.fh=function(){this.j=0;this.f=void 0};
function Aj(a,c,d){c=nj(c,d);c.pointerId=d.identifier+2;c.bubbles=!0;c.cancelable=!0;c.detail=a.j;c.button=0;c.buttons=1;c.width=d.webkitRadiusX||d.radiusX||0;c.height=d.webkitRadiusY||d.radiusY||0;c.pressure=d.webkitForce||d.force||.5;c.isPrimary=a.c===d.identifier;c.pointerType="touch";c.clientX=d.clientX;c.clientY=d.clientY;c.screenX=d.screenX;c.screenY=d.screenY;return c}
function Bj(a,c,d){function e(){c.preventDefault()}var f=Array.prototype.slice.call(c.b.changedTouches),g=f.length,h,k;for(h=0;h<g;++h)k=Aj(a,c,f[h]),k.preventDefault=e,d.call(a,c,k)}
l.no=function(a){var c=a.b.touches,d=Lb(this.a),e=d.length;if(e>=c.length){var f=[],g,h,k;for(g=0;g<e;++g){h=d[g];k=this.a[h];var m;if(!(m=1==h))a:{m=c.length;for(var n=void 0,p=0;p<m;p++)if(n=c[p],n.identifier===h-2){m=!0;break a}m=!1}m||f.push(k.gc)}for(g=0;g<f.length;++g)this.Ie(a,f[g])}c=Jb(this.a);if(0===c||1===c&&(1).toString()in this.a)this.c=a.b.changedTouches[0].identifier,void 0!==this.f&&ba.clearTimeout(this.f);Cj(this,a);this.j++;Bj(this,a,this.an)};
l.an=function(a,c){this.a[c.pointerId]={target:c.target,gc:c,Qg:c.target};var d=this.b;c.bubbles=!0;oj(d,Dj,c,a);d=this.b;c.bubbles=!1;oj(d,Ej,c,a);oj(this.b,qj,c,a)};l.mo=function(a){a.preventDefault();Bj(this,a,this.pk)};l.pk=function(a,c){var d=this.a[c.pointerId];if(d){var e=d.gc,f=d.Qg;oj(this.b,rj,c,a);e&&f!==c.target&&(e.relatedTarget=c.target,c.relatedTarget=f,e.target=f,c.target?(uj(this.b,e,a),tj(this.b,c,a)):(c.target=f,c.relatedTarget=null,this.Ie(a,c)));d.gc=c;d.Qg=c.target}};
l.lo=function(a){Cj(this,a);Bj(this,a,this.oo)};l.oo=function(a,c){oj(this.b,sj,c,a);this.b.gc(c,a);var d=this.b;c.bubbles=!1;oj(d,Fj,c,a);delete this.a[c.pointerId];c.isPrimary&&(this.c=void 0,this.f=ba.setTimeout(qa(this.fh,this),200))};l.ko=function(a){Bj(this,a,this.Ie)};l.Ie=function(a,c){this.b.cancel(c,a);this.b.gc(c,a);var d=this.b;c.bubbles=!1;oj(d,Fj,c,a);delete this.a[c.pointerId];c.isPrimary&&(this.c=void 0,this.f=ba.setTimeout(qa(this.fh,this),200))};
function Cj(a,c){var d=a.i.c,e=c.b.changedTouches[0];if(a.c===e.identifier){var f=[e.clientX,e.clientY];d.push(f);ba.setTimeout(function(){fb(d,f)},2500)}};function Gj(a){bd.call(this);this.f=a;this.a={};this.c={};this.b=[];dj?Hj(this,new xj(this)):ej?Hj(this,new vj(this)):(a=new kj(this),Hj(this,a),cj&&Hj(this,new zj(this,a)));a=this.b.length;for(var c,d=0;d<a;d++)c=this.b[d],Ij(this,Object.keys(c.g))}w(Gj,bd);function Hj(a,c){var d=Object.keys(c.g);d&&(d.forEach(function(a){var d=c.g[a];d&&(this.c[a]=qa(d,c))},a),a.b.push(c))}Gj.prototype.g=function(a){var c=this.c[a.type];c&&c(a)};
function Ij(a,c){c.forEach(function(a){B(this.f,a,this.g,!1,this)},a)}function Jj(a,c){c.forEach(function(a){Xc(this.f,a,this.g,!1,this)},a)}function nj(a,c){for(var d={},e,f=0,g=Kj.length;f<g;f++)e=Kj[f][0],d[e]=a[e]||c[e]||Kj[f][1];return d}Gj.prototype.gc=function(a,c){a.bubbles=!0;oj(this,Lj,a,c)};Gj.prototype.cancel=function(a,c){oj(this,Mj,a,c)};function uj(a,c,d){a.gc(c,d);var e=c.relatedTarget;e&&Wg(c.target,e)||(c.bubbles=!1,oj(a,Fj,c,d))}
function tj(a,c,d){c.bubbles=!0;oj(a,Dj,c,d);var e=c.relatedTarget;e&&Wg(c.target,e)||(c.bubbles=!1,oj(a,Ej,c,d))}function oj(a,c,d,e){a.s(new Mi(c,e,d))}function yj(a,c){a.s(new Mi(c.type,c,c.b))}Gj.prototype.Z=function(){for(var a=this.b.length,c,d=0;d<a;d++)c=this.b[d],Jj(this,Object.keys(c.g));Gj.ca.Z.call(this)};
var rj="pointermove",qj="pointerdown",sj="pointerup",Dj="pointerover",Lj="pointerout",Ej="pointerenter",Fj="pointerleave",Mj="pointercancel",Kj=[["bubbles",!1],["cancelable",!1],["view",null],["detail",null],["screenX",0],["screenY",0],["clientX",0],["clientY",0],["ctrlKey",!1],["altKey",!1],["shiftKey",!1],["metaKey",!1],["button",0],["relatedTarget",null],["buttons",0],["pointerId",0],["width",0],["height",0],["pressure",0],["tiltX",0],["tiltY",0],["pointerType",""],["hwTimestamp",0],["isPrimary",
!1],["type",""],["target",null],["currentTarget",null],["which",0]];function Nj(a,c,d,e,f){uh.call(this,a,c,f);this.b=d;this.originalEvent=d.b;this.pixel=c.Cd(this.originalEvent);this.coordinate=c.ya(this.pixel);this.dragging=void 0!==e?e:!1}w(Nj,uh);Nj.prototype.preventDefault=function(){Nj.ca.preventDefault.call(this);this.b.preventDefault()};Nj.prototype.c=function(){Nj.ca.c.call(this);this.b.c()};function Oj(a,c,d,e,f){Nj.call(this,a,c,d.b,e,f);this.a=d}w(Oj,Nj);
function Pj(a){bd.call(this);this.c=a;this.j=0;this.i=!1;this.a=this.l=this.f=null;a=this.c.a;this.A=0;this.B={};this.g=new Gj(a);this.b=null;this.l=B(this.g,qj,this.Tj,!1,this);this.D=B(this.g,rj,this.Fn,!1,this)}w(Pj,bd);function Qj(a,c){var d;d=new Oj(Rj,a.c,c);a.s(d);0!==a.j?(ba.clearTimeout(a.j),a.j=0,d=new Oj(Sj,a.c,c),a.s(d)):a.j=ba.setTimeout(qa(function(){this.j=0;var a=new Oj(Tj,this.c,c);this.s(a)},a),250)}
function Uj(a,c){c.type==Vj||c.type==Wj?delete a.B[c.pointerId]:c.type==Xj&&(a.B[c.pointerId]=!0);a.A=Jb(a.B)}l=Pj.prototype;l.fg=function(a){Uj(this,a);var c=new Oj(Vj,this.c,a);this.s(c);!this.i&&0===a.button&&Qj(this,this.a);0===this.A&&(this.f.forEach(Yc),this.f=null,this.i=!1,this.a=null,tc(this.b),this.b=null)};
l.Tj=function(a){Uj(this,a);var c=new Oj(Xj,this.c,a);this.s(c);this.a=a;this.f||(this.b=new Gj(document),this.f=[B(this.b,Yj,this.Lk,!1,this),B(this.b,Vj,this.fg,!1,this),B(this.g,Wj,this.fg,!1,this)])};l.Lk=function(a){if(a.clientX!=this.a.clientX||a.clientY!=this.a.clientY){this.i=!0;var c=new Oj(Zj,this.c,a,this.i);this.s(c)}a.preventDefault()};l.Fn=function(a){this.s(new Oj(a.type,this.c,a,!(!this.a||a.clientX==this.a.clientX&&a.clientY==this.a.clientY)))};
l.Z=function(){this.D&&(Yc(this.D),this.D=null);this.l&&(Yc(this.l),this.l=null);this.f&&(this.f.forEach(Yc),this.f=null);this.b&&(tc(this.b),this.b=null);this.g&&(tc(this.g),this.g=null);Pj.ca.Z.call(this)};var Tj="singleclick",Rj="click",Sj="dblclick",Zj="pointerdrag",Yj="pointermove",Xj="pointerdown",Vj="pointerup",Wj="pointercancel",ak={Fo:Tj,uo:Rj,vo:Sj,yo:Zj,Bo:Yj,xo:Xj,Eo:Vj,Do:"pointerover",Co:"pointerout",zo:"pointerenter",Ao:"pointerleave",wo:Wj};function bk(a){hd.call(this);var c=Tb(a);c.opacity=void 0!==a.opacity?a.opacity:1;c.visible=void 0!==a.visible?a.visible:!0;c.zIndex=void 0!==a.zIndex?a.zIndex:0;c.maxResolution=void 0!==a.maxResolution?a.maxResolution:Infinity;c.minResolution=void 0!==a.minResolution?a.minResolution:0;this.I(c)}w(bk,hd);
function ck(a){var c=a.Kb(),d=a.Ye(),e=a.mb(),f=a.S(),g=a.Lb(),h=a.Fb(),k=a.Gb();return{layer:a,opacity:Qa(c,0,1),A:d,visible:e,Ib:!0,extent:f,zIndex:g,maxResolution:h,minResolution:Math.max(k,0)}}l=bk.prototype;l.S=function(){return this.get("extent")};l.Fb=function(){return this.get("maxResolution")};l.Gb=function(){return this.get("minResolution")};l.Kb=function(){return this.get("opacity")};l.mb=function(){return this.get("visible")};l.Lb=function(){return this.get("zIndex")};
l.$b=function(a){this.set("extent",a)};l.ic=function(a){this.set("maxResolution",a)};l.jc=function(a){this.set("minResolution",a)};l.ac=function(a){this.set("opacity",a)};l.bc=function(a){this.set("visible",a)};l.cc=function(a){this.set("zIndex",a)};function dk(){};function ek(a,c,d,e,f,g){uc.call(this,a,c);this.vectorContext=d;this.frameState=e;this.context=f;this.glContext=g}w(ek,uc);function fk(a){var c=Tb(a);delete c.source;bk.call(this,c);this.j=this.l=this.i=null;a.map&&this.setMap(a.map);B(this,jd("source"),this.Zj,!1,this);this.Gc(a.source?a.source:null)}w(fk,bk);function gk(a,c){return a.visible&&c>=a.minResolution&&c<a.maxResolution}l=fk.prototype;l.Xe=function(a){a=a?a:[];a.push(ck(this));return a};l.fa=function(){return this.get("source")||null};l.Ye=function(){var a=this.fa();return a?a.A:"undefined"};l.Cl=function(){this.u()};
l.Zj=function(){this.j&&(Yc(this.j),this.j=null);var a=this.fa();a&&(this.j=B(a,"change",this.Cl,!1,this));this.u()};l.setMap=function(a){Yc(this.i);this.i=null;a||this.u();Yc(this.l);this.l=null;a&&(this.i=B(a,"precompose",function(a){var d=ck(this);d.Ib=!1;d.zIndex=Infinity;a.frameState.layerStatesArray.push(d);a.frameState.layerStates[v(this)]=d},!1,this),this.l=B(this,"change",a.render,!1,a),this.u())};l.Gc=function(a){this.set("source",a)};function hk(a,c,d,e,f){bd.call(this);this.j=f;this.extent=a;this.g=d;this.resolution=c;this.state=e}w(hk,bd);function ik(a){a.s("change")}hk.prototype.S=function(){return this.extent};hk.prototype.ba=function(){return this.resolution};function jk(a,c,d,e,f,g,h,k){Gd(a);0===c&&0===d||Jd(a,c,d);1==e&&1==f||Kd(a,e,f);0!==g&&Ld(a,g);0===h&&0===k||Jd(a,h,k);return a}function kk(a,c){return a[0]==c[0]&&a[1]==c[1]&&a[4]==c[4]&&a[5]==c[5]&&a[12]==c[12]&&a[13]==c[13]}function lk(a,c,d){var e=a[1],f=a[5],g=a[13],h=c[0];c=c[1];d[0]=a[0]*h+a[4]*c+a[12];d[1]=e*h+f*c+g;return d};function mk(a){ed.call(this);this.a=a}w(mk,ed);l=mk.prototype;l.Wa=va;l.dc=function(a,c,d,e){a=a.slice();lk(c.pixelToCoordinateMatrix,a,a);if(this.Wa(a,c,re,this))return d.call(e,this.a)};l.ce=qe;l.zd=function(a,c){return function(d,e){return Rh(a,d,e,function(a){c[d]||(c[d]={});c[d][a.b.toString()]=a})}};l.Fl=function(a){2===a.target.state&&nk(this)};function ok(a,c){var d=c.state;2!=d&&3!=d&&B(c,"change",a.Fl,!1,a);0==d&&(c.load(),d=c.state);return 2==d}
function nk(a){var c=a.a;c.mb()&&"ready"==c.Ye()&&a.u()}function pk(a,c){zh(c.a)&&a.postRenderFunctions.push(ra(function(a,c,f){c=v(a).toString();a=a.a;f=f.usedTiles[c];for(var g;zh(a)&&!(c=a.b.mc,g=c.b[0].toString(),g in f&&f[g].contains(c.b));)a.pop().Vc()},c))}function qk(a,c){if(c){var d,e,f;e=0;for(f=c.length;e<f;++e)d=c[e],a[v(d).toString()]=d}}function rk(a,c){var d=c.U;void 0!==d&&(ia(d)?a.logos[d]="":la(d)&&(a.logos[d.src]=d.href))}
function sk(a,c,d,e){c=v(c).toString();d=d.toString();c in a?d in a[c]?(a=a[c][d],e.b<a.b&&(a.b=e.b),e.f>a.f&&(a.f=e.f),e.a<a.a&&(a.a=e.a),e.c>a.c&&(a.c=e.c)):a[c][d]=e:(a[c]={},a[c][d]=e)}function tk(a,c,d){return[c*(Math.round(a[0]/c)+d[0]%2/2),c*(Math.round(a[1]/c)+d[1]%2/2)]}
function uk(a,c,d,e,f,g,h,k,m,n){var p=v(c).toString();p in a.wantedTiles||(a.wantedTiles[p]={});var q=a.wantedTiles[p];a=a.tileQueue;var r=d.minZoom,u,y,A,F,z,x;for(x=h;x>=r;--x)for(y=kg(d,g,x,y),A=d.ba(x),F=y.b;F<=y.f;++F)for(z=y.a;z<=y.c;++z)h-x<=k?(u=c.Ub(x,F,z,e,f),0==u.state&&(q[fg(u.b)]=!0,u.nb()in a.c||vk(a,[u,p,hg(d,u.b),A])),void 0!==m&&m.call(n,u)):c.Cf(x,F,z)};function wk(a){this.A=a.opacity;this.C=a.rotateWithView;this.D=a.rotation;this.B=a.scale;this.O=a.snapToPixel}l=wk.prototype;l.ge=function(){return this.A};l.Jd=function(){return this.C};l.he=function(){return this.D};l.ie=function(){return this.B};l.Ld=function(){return this.O};l.je=function(a){this.A=a};l.ke=function(a){this.D=a};l.le=function(a){this.B=a};function xk(a){a=a||{};this.g=void 0!==a.anchor?a.anchor:[.5,.5];this.f=null;this.a=void 0!==a.anchorOrigin?a.anchorOrigin:"top-left";this.i=void 0!==a.anchorXUnits?a.anchorXUnits:"fraction";this.l=void 0!==a.anchorYUnits?a.anchorYUnits:"fraction";var c=void 0!==a.crossOrigin?a.crossOrigin:null,d=void 0!==a.img?a.img:null,e=void 0!==a.imgSize?a.imgSize:null,f=a.src;void 0!==f&&0!==f.length||!d||(f=d.src);var g=void 0!==a.src?0:2,h=yk.Eb(),k=h.get(f,c);k||(k=new zk(d,f,e,c,g),h.set(f,c,k));this.b=
k;this.ea=void 0!==a.offset?a.offset:[0,0];this.c=void 0!==a.offsetOrigin?a.offsetOrigin:"top-left";this.j=null;this.v=void 0!==a.size?a.size:null;wk.call(this,{opacity:void 0!==a.opacity?a.opacity:1,rotation:void 0!==a.rotation?a.rotation:0,scale:void 0!==a.scale?a.scale:1,snapToPixel:void 0!==a.snapToPixel?a.snapToPixel:!0,rotateWithView:void 0!==a.rotateWithView?a.rotateWithView:!1})}w(xk,wk);l=xk.prototype;
l.Db=function(){if(this.f)return this.f;var a=this.g,c=this.ob();if("fraction"==this.i||"fraction"==this.l){if(!c)return null;a=this.g.slice();"fraction"==this.i&&(a[0]*=c[0]);"fraction"==this.l&&(a[1]*=c[1])}if("top-left"!=this.a){if(!c)return null;a===this.g&&(a=this.g.slice());if("top-right"==this.a||"bottom-right"==this.a)a[0]=-a[0]+c[0];if("bottom-left"==this.a||"bottom-right"==this.a)a[1]=-a[1]+c[1]}return this.f=a};l.Mb=function(){return this.b.b};l.Fd=function(){return this.b.c};l.gd=function(){return this.b.a};
l.fe=function(){var a=this.b;if(!a.g)if(a.l){var c=a.c[0],d=a.c[1],e=Qi(c,d);e.fillRect(0,0,c,d);a.g=e.canvas}else a.g=a.b;return a.g};l.ua=function(){if(this.j)return this.j;var a=this.ea;if("top-left"!=this.c){var c=this.ob(),d=this.b.c;if(!c||!d)return null;a=a.slice();if("top-right"==this.c||"bottom-right"==this.c)a[0]=d[0]-c[0]-a[0];if("bottom-left"==this.c||"bottom-right"==this.c)a[1]=d[1]-c[1]-a[1]}return this.j=a};l.tm=function(){return this.b.j};l.ob=function(){return this.v?this.v:this.b.c};
l.bf=function(a,c){return B(this.b,"change",a,!1,c)};l.load=function(){this.b.load()};l.Bf=function(a,c){Xc(this.b,"change",a,!1,c)};function zk(a,c,d,e,f){bd.call(this);this.g=null;this.b=a?a:new Image;e&&(this.b.crossOrigin=e);this.f=null;this.a=f;this.c=d;this.j=c;this.l=!1;2==this.a&&Ak(this)}w(zk,bd);function Ak(a){var c=Qi(1,1);try{c.drawImage(a.b,0,0),c.getImageData(0,0,1,1)}catch(d){a.l=!0}}zk.prototype.i=function(){this.a=3;this.f.forEach(Yc);this.f=null;this.s("change")};
zk.prototype.D=function(){this.a=2;this.c=[this.b.width,this.b.height];this.f.forEach(Yc);this.f=null;Ak(this);this.s("change")};zk.prototype.load=function(){if(0==this.a){this.a=1;this.f=[Wc(this.b,"error",this.i,!1,this),Wc(this.b,"load",this.D,!1,this)];try{this.b.src=this.j}catch(a){this.i()}}};function yk(){this.b={};this.a=0}ea(yk);yk.prototype.clear=function(){this.b={};this.a=0};yk.prototype.get=function(a,c){var d=c+":"+a;return d in this.b?this.b[d]:null};
yk.prototype.set=function(a,c,d){this.b[c+":"+a]=d;++this.a};function Bk(a,c){pc.call(this);this.j=c;this.f={};this.B={}}w(Bk,pc);function Ck(a){var c=a.viewState,d=a.coordinateToPixelMatrix;jk(d,a.size[0]/2,a.size[1]/2,1/c.resolution,-1/c.resolution,-c.rotation,-c.center[0],-c.center[1]);Id(d,a.pixelToCoordinateMatrix)}l=Bk.prototype;l.Z=function(){Gb(this.f,tc);Bk.ca.Z.call(this)};
function Dk(){var a=yk.Eb();if(32<a.a){var c=0,d,e;for(d in a.b){e=a.b[d];var f;if(f=0===(c++&3))Dc(e)?e=dd(e,void 0,void 0):(e=Sc(e),e=!!e&&Mc(e,void 0,void 0)),f=!e;f&&(delete a.b[d],--a.a)}}}
l.kf=function(a,c,d,e,f,g){var h,k=c.viewState,m=k.resolution,n=k.projection,k=a;if(n.c){var n=n.S(),p=le(n),q=a[0];if(q<n[0]||q>n[2])k=[q+p*Math.ceil((n[0]-q)/p),a[1]]}n=c.layerStatesArray;for(p=n.length-1;0<=p;--p){var r=n[p],q=r.layer;if(!r.Ib||gk(r,m)&&f.call(g,q))if(r=Ek(this,q),q.fa()&&(h=r.Wa(Dh(q.fa())?k:a,c,d,e)),h)return h}};
l.Dg=function(a,c,d,e,f,g){var h,k=c.viewState.resolution,m=c.layerStatesArray,n;for(n=m.length-1;0<=n;--n){h=m[n];var p=h.layer;if(gk(h,k)&&f.call(g,p)&&(h=Ek(this,p).dc(a,c,d,e)))return h}};l.Eg=function(a,c,d,e){return void 0!==this.kf(a,c,re,this,d,e)};function Ek(a,c){var d=v(c).toString();if(d in a.f)return a.f[d];var e=a.Me(c);a.f[d]=e;a.B[d]=B(e,"change",a.Jj,!1,a);return e}l.Jj=function(){this.j.render()};l.se=va;
l.Ln=function(a,c){for(var d in this.f)if(!(c&&d in c.layerStates)){var e=d,f=this.f[e];delete this.f[e];Yc(this.B[e]);delete this.B[e];tc(f)}};function Fk(a,c){for(var d in a.f)if(!(d in c.layerStates)){c.postRenderFunctions.push(qa(a.Ln,a));break}}function ob(a,c){return a.zIndex-c.zIndex};function Gk(a,c){this.i=a;this.g=c;this.b=[];this.a=[];this.c={}}Gk.prototype.clear=function(){this.b.length=0;this.a.length=0;Qb(this.c)};function Hk(a){var c=a.b,d=a.a,e=c[0];1==c.length?(c.length=0,d.length=0):(c[0]=c.pop(),d[0]=d.pop(),Ik(a,0));c=a.g(e);delete a.c[c];return e}function vk(a,c){var d=a.i(c);Infinity!=d&&(a.b.push(c),a.a.push(d),a.c[a.g(c)]=!0,Jk(a,0,a.b.length-1))}Gk.prototype.Sb=function(){return this.b.length};Gk.prototype.za=function(){return 0===this.b.length};
function Ik(a,c){for(var d=a.b,e=a.a,f=d.length,g=d[c],h=e[c],k=c;c<f>>1;){var m=2*c+1,n=2*c+2,m=n<f&&e[n]<e[m]?n:m;d[c]=d[m];e[c]=e[m];c=m}d[c]=g;e[c]=h;Jk(a,k,c)}function Jk(a,c,d){var e=a.b;a=a.a;for(var f=e[d],g=a[d];d>c;){var h=d-1>>1;if(a[h]>g)e[d]=e[h],a[d]=a[h],d=h;else break}e[d]=f;a[d]=g}function Kk(a){var c=a.i,d=a.b,e=a.a,f=0,g=d.length,h,k,m;for(k=0;k<g;++k)h=d[k],m=c(h),Infinity==m?delete a.c[a.g(h)]:(e[f]=m,d[f++]=h);d.length=f;e.length=f;for(c=(a.b.length>>1)-1;0<=c;c--)Ik(a,c)};function Lk(a,c){Gk.call(this,function(c){return a.apply(null,c)},function(a){return a[0].nb()});this.l=c;this.f=0}w(Lk,Gk);Lk.prototype.j=function(a){a=a.target;var c=a.state;if(2===c||3===c||4===c)Xc(a,"change",this.j,!1,this),--this.f,this.l()};function Mk(a,c,d){for(var e=0,f;a.f<c&&e<d&&0<a.Sb();)f=Hk(a)[0],0===f.state&&(B(f,"change",a.j,!1,a),f.load(),++a.f,++e)};function Nk(a,c,d){this.f=a;this.c=c;this.j=d;this.b=[];this.a=this.g=0}function Ok(a,c){var d=a.f,e=a.a,f=a.c-e,g=Math.log(a.c/a.a)/a.f;return $f({source:c,duration:g,easing:function(a){return e*(Math.exp(d*a*g)-1)/f}})};function Pk(a){hd.call(this);this.B=null;this.g(!0);this.handleEvent=a.handleEvent}w(Pk,hd);Pk.prototype.c=function(){return this.get("active")};Pk.prototype.g=function(a){this.set("active",a)};Pk.prototype.setMap=function(a){this.B=a};function Qk(a,c,d,e,f){if(void 0!==d){var g=c.wa(),h=c.Ia();void 0!==g&&h&&f&&0<f&&(a.Ba(ag({rotation:g,duration:f,easing:Wf})),e&&a.Ba($f({source:h,duration:f,easing:Wf})));c.rotate(d,e)}}
function Rk(a,c,d,e,f){var g=c.ba();d=c.constrainResolution(g,d,0);Sk(a,c,d,e,f)}function Sk(a,c,d,e,f){if(d){var g=c.ba(),h=c.Ia();void 0!==g&&h&&d!==g&&f&&0<f&&(a.Ba(bg({resolution:g,duration:f,easing:Wf})),e&&a.Ba($f({source:h,duration:f,easing:Wf})));if(e){var k;a=c.Ia();f=c.ba();void 0!==a&&void 0!==f&&(k=[e[0]-d*(e[0]-a[0])/f,e[1]-d*(e[1]-a[1])/f]);c.Ua(k)}c.zb(d)}};function Tk(a){a=a?a:{};this.a=a.delta?a.delta:1;Pk.call(this,{handleEvent:Uk});this.f=a.duration?a.duration:250}w(Tk,Pk);function Uk(a){var c=!1,d=a.b;if(a.type==Sj){var c=a.map,e=a.coordinate,d=d.f?-this.a:this.a,f=c.aa();Rk(c,f,d,e,this.f);a.preventDefault();c=!0}return!c};function Vk(a){a=a.b;return a.a&&!a.l&&a.f}function Wk(a){return"pointermove"==a.type}function Xk(a){return a.type==Tj}function Yk(a){a=a.b;return!a.a&&!a.l&&!a.f}function Zk(a){a=a.b;return!a.a&&!a.l&&a.f}function $k(a){a=a.b.target.tagName;return"INPUT"!==a&&"SELECT"!==a&&"TEXTAREA"!==a}function al(a){return"mouse"==a.a.pointerType};function bl(a){a=a?a:{};Pk.call(this,{handleEvent:a.handleEvent?a.handleEvent:cl});this.nc=a.handleDownEvent?a.handleDownEvent:qe;this.oc=a.handleDragEvent?a.handleDragEvent:va;this.Kc=a.handleMoveEvent?a.handleMoveEvent:va;this.Ce=a.handleUpEvent?a.handleUpEvent:qe;this.v=!1;this.Y={};this.j=[]}w(bl,Pk);function dl(a){for(var c=a.length,d=0,e=0,f=0;f<c;f++)d+=a[f].clientX,e+=a[f].clientY;return[d/c,e/c]}
function cl(a){if(!(a instanceof Oj))return!0;var c=!1,d=a.type;if(d===Xj||d===Zj||d===Vj)d=a.a,a.type==Vj?delete this.Y[d.pointerId]:a.type==Xj?this.Y[d.pointerId]=d:d.pointerId in this.Y&&(this.Y[d.pointerId]=d),this.j=Kb(this.Y);this.v&&(a.type==Zj?this.oc(a):a.type==Vj&&(this.v=this.Ce(a)));a.type==Xj?(this.v=a=this.nc(a),c=this.kc(a)):a.type==Yj&&this.Kc(a);return!c}bl.prototype.kc=te;function el(a){bl.call(this,{handleDownEvent:fl,handleDragEvent:gl,handleUpEvent:hl});a=a?a:{};this.a=a.kinetic;this.f=this.i=null;this.A=a.condition?a.condition:Yk;this.l=!1}w(el,bl);function gl(a){var c=dl(this.j);this.a&&this.a.b.push(c[0],c[1],Date.now());if(this.f){var d=this.f[0]-c[0],e=c[1]-this.f[1];a=a.map;var f=a.aa(),g=Sf(f),e=d=[d,e],h=g.resolution;e[0]*=h;e[1]*=h;vd(d,g.rotation);qd(d,g.center);d=f.yd(d);a.render();f.Ua(d)}this.f=c}
function hl(a){a=a.map;var c=a.aa();if(0===this.j.length){var d;if(d=!this.l&&this.a)if(d=this.a,6>d.b.length)d=!1;else{var e=Date.now()-d.j,f=d.b.length-3;if(d.b[f+2]<e)d=!1;else{for(var g=f-3;0<g&&d.b[g+2]>e;)g-=3;var e=d.b[f+2]-d.b[g+2],h=d.b[f]-d.b[g],f=d.b[f+1]-d.b[g+1];d.g=Math.atan2(f,h);d.a=Math.sqrt(h*h+f*f)/e;d=d.a>d.c}}d&&(d=this.a,d=(d.c-d.a)/d.f,f=this.a.g,g=c.Ia(),this.i=Ok(this.a,g),a.Ba(this.i),g=a.Da(g),d=a.ya([g[0]-d*Math.cos(f),g[1]-d*Math.sin(f)]),d=c.yd(d),c.Ua(d));Uf(c,-1);a.render();
return!1}this.f=null;return!0}function fl(a){if(0<this.j.length&&this.A(a)){var c=a.map,d=c.aa();this.f=null;this.v||Uf(d,1);c.render();this.i&&fb(c.J,this.i)&&(d.Ua(a.frameState.viewState.center),this.i=null);this.a&&(a=this.a,a.b.length=0,a.g=0,a.a=0);this.l=1<this.j.length;return!0}return!1}el.prototype.kc=qe;function il(a){a=a?a:{};bl.call(this,{handleDownEvent:jl,handleDragEvent:kl,handleUpEvent:ll});this.f=a.condition?a.condition:Vk;this.a=void 0;this.i=a.duration?a.duration:250}w(il,bl);function kl(a){if(al(a)){var c=a.map,d=c.Ha();a=a.pixel;d=Math.atan2(d[1]/2-a[1],a[0]-d[0]/2);if(void 0!==this.a){a=d-this.a;var e=c.aa(),f=e.wa();c.render();Qk(c,e,f-a)}this.a=d}}
function ll(a){if(!al(a))return!0;a=a.map;var c=a.aa();Uf(c,-1);var d=c.wa(),e=this.i,d=c.constrainRotation(d,0);Qk(a,c,d,void 0,e);return!1}function jl(a){return al(a)&&Bc(a.b)&&this.f(a)?(a=a.map,Uf(a.aa(),1),a.render(),this.a=void 0,!0):!1}il.prototype.kc=qe;function ml(a){this.f=null;this.a=document.createElement("div");this.a.style.position="absolute";this.a.className="ol-box "+a;this.c=this.g=this.b=null}w(ml,pc);ml.prototype.Z=function(){this.setMap(null);ml.ca.Z.call(this)};function nl(a){var c=a.g,d=a.c;a=a.a.style;a.left=Math.min(c[0],d[0])+"px";a.top=Math.min(c[1],d[1])+"px";a.width=Math.abs(d[0]-c[0])+"px";a.height=Math.abs(d[1]-c[1])+"px"}
ml.prototype.setMap=function(a){if(this.b){this.b.O.removeChild(this.a);var c=this.a.style;c.left=c.top=c.width=c.height="inherit"}(this.b=a)&&this.b.O.appendChild(this.a)};function pl(a){var c=a.g,d=a.c,c=[c,[c[0],d[1]],d,[d[0],c[1]]].map(a.b.ya,a.b);c[4]=c[0].slice();a.f?a.f.ja([c]):a.f=new D([c])}ml.prototype.W=function(){return this.f};function ql(a,c){uc.call(this,a);this.coordinate=c}w(ql,uc);function rl(a){bl.call(this,{handleDownEvent:sl,handleDragEvent:tl,handleUpEvent:ul});a=a?a:{};this.f=new ml(a.className||"ol-dragbox");this.a=null;this.A=a.condition?a.condition:re}w(rl,bl);function tl(a){if(al(a)){var c=this.f;a=a.pixel;c.g=this.a;c.c=a;pl(c);nl(c)}}rl.prototype.W=function(){return this.f.W()};rl.prototype.l=va;
function ul(a){if(!al(a))return!0;this.f.setMap(null);var c=a.pixel[0]-this.a[0],d=a.pixel[1]-this.a[1];64<=c*c+d*d&&(this.l(a),this.s(new ql("boxend",a.coordinate)));return!1}function sl(a){if(al(a)&&Bc(a.b)&&this.A(a)){this.a=a.pixel;this.f.setMap(a.map);var c=this.f,d=this.a;c.g=this.a;c.c=d;pl(c);nl(c);this.s(new ql("boxstart",a.coordinate));return!0}return!1};function vl(a){a=a?a:{};var c=a.condition?a.condition:Zk;this.i=void 0!==a.duration?a.duration:200;rl.call(this,{condition:c,className:a.className||"ol-dragzoom"})}w(vl,rl);vl.prototype.l=function(){var a=this.B,c=a.aa(),d=a.Ha(),e=this.W().S(),d=c.constrainResolution(Math.max(le(e)/d[0],ie(e)/d[1])),f=c.ba(),g=c.Ia();a.Ba(bg({resolution:f,duration:this.i,easing:Wf}));a.Ba($f({source:g,duration:this.i,easing:Wf}));c.Ua(ge(e));c.zb(d)};function wl(a){Pk.call(this,{handleEvent:xl});a=a||{};this.a=void 0!==a.condition?a.condition:we(Yk,$k);this.f=void 0!==a.duration?a.duration:100;this.j=void 0!==a.pixelDelta?a.pixelDelta:128}w(wl,Pk);
function xl(a){var c=!1;if("key"==a.type){var d=a.b.j;if(this.a(a)&&(40==d||37==d||39==d||38==d)){var e=a.map,c=e.aa(),f=c.ba()*this.j,g=0,h=0;40==d?h=-f:37==d?g=-f:39==d?g=f:h=f;d=[g,h];vd(d,c.wa());f=this.f;if(g=c.Ia())f&&0<f&&e.Ba($f({source:g,duration:f,easing:Yf})),e=c.yd([g[0]+d[0],g[1]+d[1]]),c.Ua(e);a.preventDefault();c=!0}}return!c};function yl(a){Pk.call(this,{handleEvent:zl});a=a?a:{};this.f=a.condition?a.condition:$k;this.a=a.delta?a.delta:1;this.j=void 0!==a.duration?a.duration:100}w(yl,Pk);function zl(a){var c=!1;if("key"==a.type){var d=a.b.B;if(this.f(a)&&(43==d||45==d)){c=a.map;d=43==d?this.a:-this.a;c.render();var e=c.aa();Rk(c,e,d,void 0,this.j);a.preventDefault();c=!0}}return!c};function Al(a){Pk.call(this,{handleEvent:Bl});a=a||{};this.f=0;this.v=void 0!==a.duration?a.duration:250;this.l=void 0!==a.useAnchor?a.useAnchor:!0;this.a=null;this.i=this.j=void 0}w(Al,Pk);function Bl(a){var c=!1;if("mousewheel"==a.type){var c=a.map,d=a.b;this.l&&(this.a=a.coordinate);this.f+=d.v;void 0===this.j&&(this.j=Date.now());d=Math.max(80-(Date.now()-this.j),0);ba.clearTimeout(this.i);this.i=ba.setTimeout(qa(this.A,this,c),d);a.preventDefault();c=!0}return!c}
Al.prototype.A=function(a){var c=Qa(this.f,-1,1),d=a.aa();a.render();Rk(a,d,-c,this.a,this.v);this.f=0;this.a=null;this.i=this.j=void 0};Al.prototype.C=function(a){this.l=a;a||(this.a=null)};function Cl(a){bl.call(this,{handleDownEvent:Dl,handleDragEvent:El,handleUpEvent:Fl});a=a||{};this.f=null;this.i=void 0;this.a=!1;this.l=0;this.C=void 0!==a.threshold?a.threshold:.3;this.A=void 0!==a.duration?a.duration:250}w(Cl,bl);
function El(a){var c=0,d=this.j[0],e=this.j[1],d=Math.atan2(e.clientY-d.clientY,e.clientX-d.clientX);void 0!==this.i&&(c=d-this.i,this.l+=c,!this.a&&Math.abs(this.l)>this.C&&(this.a=!0));this.i=d;a=a.map;d=kh(a.a);e=dl(this.j);e[0]-=d.x;e[1]-=d.y;this.f=a.ya(e);this.a&&(d=a.aa(),e=d.wa(),a.render(),Qk(a,d,e+c,this.f))}function Fl(a){if(2>this.j.length){a=a.map;var c=a.aa();Uf(c,-1);if(this.a){var d=c.wa(),e=this.f,f=this.A,d=c.constrainRotation(d,0);Qk(a,c,d,e,f)}return!1}return!0}
function Dl(a){return 2<=this.j.length?(a=a.map,this.f=null,this.i=void 0,this.a=!1,this.l=0,this.v||Uf(a.aa(),1),a.render(),!0):!1}Cl.prototype.kc=qe;function Gl(a){bl.call(this,{handleDownEvent:Hl,handleDragEvent:Il,handleUpEvent:Jl});a=a?a:{};this.f=null;this.l=void 0!==a.duration?a.duration:400;this.a=void 0;this.i=1}w(Gl,bl);function Il(a){var c=1,d=this.j[0],e=this.j[1],f=d.clientX-e.clientX,d=d.clientY-e.clientY,f=Math.sqrt(f*f+d*d);void 0!==this.a&&(c=this.a/f);this.a=f;1!=c&&(this.i=c);a=a.map;var f=a.aa(),d=f.ba(),e=kh(a.a),g=dl(this.j);g[0]-=e.x;g[1]-=e.y;this.f=a.ya(g);a.render();Sk(a,f,d*c,this.f)}
function Jl(a){if(2>this.j.length){a=a.map;var c=a.aa();Uf(c,-1);var d=c.ba(),e=this.f,f=this.l,d=c.constrainResolution(d,0,this.i-1);Sk(a,c,d,e,f);return!1}return!0}function Hl(a){return 2<=this.j.length?(a=a.map,this.f=null,this.a=void 0,this.i=1,this.v||Uf(a.aa(),1),a.render(),!0):!1}Gl.prototype.kc=qe;function Kl(a){a=a?a:{};var c=new tg,d=new Nk(-.005,.05,100);(void 0!==a.altShiftDragRotate?a.altShiftDragRotate:1)&&c.push(new il);(void 0!==a.doubleClickZoom?a.doubleClickZoom:1)&&c.push(new Tk({delta:a.zoomDelta,duration:a.zoomDuration}));(void 0!==a.dragPan?a.dragPan:1)&&c.push(new el({kinetic:d}));(void 0!==a.pinchRotate?a.pinchRotate:1)&&c.push(new Cl);(void 0!==a.pinchZoom?a.pinchZoom:1)&&c.push(new Gl({duration:a.zoomDuration}));if(void 0!==a.keyboard?a.keyboard:1)c.push(new wl),c.push(new yl({delta:a.zoomDelta,
duration:a.zoomDuration}));(void 0!==a.mouseWheelZoom?a.mouseWheelZoom:1)&&c.push(new Al({duration:a.zoomDuration}));(void 0!==a.shiftDragZoom?a.shiftDragZoom:1)&&c.push(new vl({duration:a.zoomDuration}));return c};function Ll(a){var c=a||{};a=Tb(c);delete a.layers;c=c.layers;bk.call(this,a);this.c=[];this.a={};B(this,jd("layers"),this.Lj,!1,this);c?ga(c)&&(c=new tg(c.slice())):c=new tg;this.oh(c)}w(Ll,bk);l=Ll.prototype;l.Od=function(){this.mb()&&this.u()};
l.Lj=function(){this.c.forEach(Yc);this.c.length=0;var a=this.zc();this.c.push(B(a,"add",this.Kj,!1,this),B(a,"remove",this.Mj,!1,this));Gb(this.a,function(a){a.forEach(Yc)});Qb(this.a);var a=a.a,c,d,e;c=0;for(d=a.length;c<d;c++)e=a[c],this.a[v(e).toString()]=[B(e,"propertychange",this.Od,!1,this),B(e,"change",this.Od,!1,this)];this.u()};l.Kj=function(a){a=a.element;var c=v(a).toString();this.a[c]=[B(a,"propertychange",this.Od,!1,this),B(a,"change",this.Od,!1,this)];this.u()};
l.Mj=function(a){a=v(a.element).toString();this.a[a].forEach(Yc);delete this.a[a];this.u()};l.zc=function(){return this.get("layers")};l.oh=function(a){this.set("layers",a)};
l.Xe=function(a){var c=void 0!==a?a:[],d=c.length;this.zc().forEach(function(a){a.Xe(c)});a=ck(this);var e,f;for(e=c.length;d<e;d++)f=c[d],f.opacity*=a.opacity,f.visible=f.visible&&a.visible,f.maxResolution=Math.min(f.maxResolution,a.maxResolution),f.minResolution=Math.max(f.minResolution,a.minResolution),void 0!==a.extent&&(f.extent=void 0!==f.extent?je(f.extent,a.extent):a.extent);return c};l.Ye=function(){return"ready"};function Ml(a){Ae.call(this,{code:a,units:"m",extent:Nl,global:!0,worldExtent:Ol})}w(Ml,Ae);Ml.prototype.getPointResolution=function(a,c){var d=c[1]/6378137;return a/((Math.exp(d)+Math.exp(-d))/2)};var Pl=6378137*Math.PI,Nl=[-Pl,-Pl,Pl,Pl],Ol=[-180,-85,180,85],Ne="EPSG:3857 EPSG:102100 EPSG:102113 EPSG:900913 urn:ogc:def:crs:EPSG:6.18:3:3857 urn:ogc:def:crs:EPSG::3857 http://www.opengis.net/gml/srs/epsg.xml#3857".split(" ").map(function(a){return new Ml(a)});
function Oe(a,c,d){var e=a.length;d=1<d?d:2;void 0===c&&(2<d?c=a.slice():c=Array(e));for(var f=0;f<e;f+=d)c[f]=6378137*Math.PI*a[f]/180,c[f+1]=6378137*Math.log(Math.tan(Math.PI*(a[f+1]+90)/360));return c}function Pe(a,c,d){var e=a.length;d=1<d?d:2;void 0===c&&(2<d?c=a.slice():c=Array(e));for(var f=0;f<e;f+=d)c[f]=180*a[f]/(6378137*Math.PI),c[f+1]=360*Math.atan(Math.exp(a[f+1]/6378137))/Math.PI-90;return c};function Ql(a,c){Ae.call(this,{code:a,units:"degrees",extent:Rl,axisOrientation:c,global:!0,worldExtent:Rl})}w(Ql,Ae);Ql.prototype.getPointResolution=function(a){return a};
var Rl=[-180,-90,180,90],Qe=[new Ql("CRS:84"),new Ql("EPSG:4326","neu"),new Ql("urn:ogc:def:crs:EPSG::4326","neu"),new Ql("urn:ogc:def:crs:EPSG:6.6:4326","neu"),new Ql("urn:ogc:def:crs:OGC:1.3:CRS84"),new Ql("urn:ogc:def:crs:OGC:2:84"),new Ql("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new Ql("urn:x-ogc:def:crs:EPSG:4326","neu")];function Sl(){De(Ne);De(Qe);Me()};function Tl(a){fk.call(this,a?a:{})}w(Tl,fk);function E(a){a=a?a:{};var c=Tb(a);delete c.preload;delete c.useInterimTilesOnError;fk.call(this,c);this.f(void 0!==a.preload?a.preload:0);this.g(void 0!==a.useInterimTilesOnError?a.useInterimTilesOnError:!0)}w(E,fk);E.prototype.a=function(){return this.get("preload")};E.prototype.f=function(a){this.set("preload",a)};E.prototype.c=function(){return this.get("useInterimTilesOnError")};E.prototype.g=function(a){this.set("useInterimTilesOnError",a)};var Ul=[0,0,0,1],Vl=[],Wl=[0,0,0,1];function Xl(a){a=a||{};this.b=void 0!==a.color?a.color:null;this.a=void 0}Xl.prototype.c=function(){return this.b};Xl.prototype.f=function(a){this.b=a;this.a=void 0};Xl.prototype.ub=function(){void 0===this.a&&(this.a="f"+(this.b?Ag(this.b):"-"));return this.a};function Yl(){this.a=-1};function Zl(){this.a=-1;this.a=64;this.b=Array(4);this.g=Array(this.a);this.f=this.c=0;this.reset()}w(Zl,Yl);Zl.prototype.reset=function(){this.b[0]=1732584193;this.b[1]=4023233417;this.b[2]=2562383102;this.b[3]=271733878;this.f=this.c=0};
function $l(a,c,d){d||(d=0);var e=Array(16);if(ia(c))for(var f=0;16>f;++f)e[f]=c.charCodeAt(d++)|c.charCodeAt(d++)<<8|c.charCodeAt(d++)<<16|c.charCodeAt(d++)<<24;else for(f=0;16>f;++f)e[f]=c[d++]|c[d++]<<8|c[d++]<<16|c[d++]<<24;c=a.b[0];d=a.b[1];var f=a.b[2],g=a.b[3],h=0,h=c+(g^d&(f^g))+e[0]+3614090360&4294967295;c=d+(h<<7&4294967295|h>>>25);h=g+(f^c&(d^f))+e[1]+3905402710&4294967295;g=c+(h<<12&4294967295|h>>>20);h=f+(d^g&(c^d))+e[2]+606105819&4294967295;f=g+(h<<17&4294967295|h>>>15);h=d+(c^f&(g^
c))+e[3]+3250441966&4294967295;d=f+(h<<22&4294967295|h>>>10);h=c+(g^d&(f^g))+e[4]+4118548399&4294967295;c=d+(h<<7&4294967295|h>>>25);h=g+(f^c&(d^f))+e[5]+1200080426&4294967295;g=c+(h<<12&4294967295|h>>>20);h=f+(d^g&(c^d))+e[6]+2821735955&4294967295;f=g+(h<<17&4294967295|h>>>15);h=d+(c^f&(g^c))+e[7]+4249261313&4294967295;d=f+(h<<22&4294967295|h>>>10);h=c+(g^d&(f^g))+e[8]+1770035416&4294967295;c=d+(h<<7&4294967295|h>>>25);h=g+(f^c&(d^f))+e[9]+2336552879&4294967295;g=c+(h<<12&4294967295|h>>>20);h=f+
(d^g&(c^d))+e[10]+4294925233&4294967295;f=g+(h<<17&4294967295|h>>>15);h=d+(c^f&(g^c))+e[11]+2304563134&4294967295;d=f+(h<<22&4294967295|h>>>10);h=c+(g^d&(f^g))+e[12]+1804603682&4294967295;c=d+(h<<7&4294967295|h>>>25);h=g+(f^c&(d^f))+e[13]+4254626195&4294967295;g=c+(h<<12&4294967295|h>>>20);h=f+(d^g&(c^d))+e[14]+2792965006&4294967295;f=g+(h<<17&4294967295|h>>>15);h=d+(c^f&(g^c))+e[15]+1236535329&4294967295;d=f+(h<<22&4294967295|h>>>10);h=c+(f^g&(d^f))+e[1]+4129170786&4294967295;c=d+(h<<5&4294967295|
h>>>27);h=g+(d^f&(c^d))+e[6]+3225465664&4294967295;g=c+(h<<9&4294967295|h>>>23);h=f+(c^d&(g^c))+e[11]+643717713&4294967295;f=g+(h<<14&4294967295|h>>>18);h=d+(g^c&(f^g))+e[0]+3921069994&4294967295;d=f+(h<<20&4294967295|h>>>12);h=c+(f^g&(d^f))+e[5]+3593408605&4294967295;c=d+(h<<5&4294967295|h>>>27);h=g+(d^f&(c^d))+e[10]+38016083&4294967295;g=c+(h<<9&4294967295|h>>>23);h=f+(c^d&(g^c))+e[15]+3634488961&4294967295;f=g+(h<<14&4294967295|h>>>18);h=d+(g^c&(f^g))+e[4]+3889429448&4294967295;d=f+(h<<20&4294967295|
h>>>12);h=c+(f^g&(d^f))+e[9]+568446438&4294967295;c=d+(h<<5&4294967295|h>>>27);h=g+(d^f&(c^d))+e[14]+3275163606&4294967295;g=c+(h<<9&4294967295|h>>>23);h=f+(c^d&(g^c))+e[3]+4107603335&4294967295;f=g+(h<<14&4294967295|h>>>18);h=d+(g^c&(f^g))+e[8]+1163531501&4294967295;d=f+(h<<20&4294967295|h>>>12);h=c+(f^g&(d^f))+e[13]+2850285829&4294967295;c=d+(h<<5&4294967295|h>>>27);h=g+(d^f&(c^d))+e[2]+4243563512&4294967295;g=c+(h<<9&4294967295|h>>>23);h=f+(c^d&(g^c))+e[7]+1735328473&4294967295;f=g+(h<<14&4294967295|
h>>>18);h=d+(g^c&(f^g))+e[12]+2368359562&4294967295;d=f+(h<<20&4294967295|h>>>12);h=c+(d^f^g)+e[5]+4294588738&4294967295;c=d+(h<<4&4294967295|h>>>28);h=g+(c^d^f)+e[8]+2272392833&4294967295;g=c+(h<<11&4294967295|h>>>21);h=f+(g^c^d)+e[11]+1839030562&4294967295;f=g+(h<<16&4294967295|h>>>16);h=d+(f^g^c)+e[14]+4259657740&4294967295;d=f+(h<<23&4294967295|h>>>9);h=c+(d^f^g)+e[1]+2763975236&4294967295;c=d+(h<<4&4294967295|h>>>28);h=g+(c^d^f)+e[4]+1272893353&4294967295;g=c+(h<<11&4294967295|h>>>21);h=f+(g^
c^d)+e[7]+4139469664&4294967295;f=g+(h<<16&4294967295|h>>>16);h=d+(f^g^c)+e[10]+3200236656&4294967295;d=f+(h<<23&4294967295|h>>>9);h=c+(d^f^g)+e[13]+681279174&4294967295;c=d+(h<<4&4294967295|h>>>28);h=g+(c^d^f)+e[0]+3936430074&4294967295;g=c+(h<<11&4294967295|h>>>21);h=f+(g^c^d)+e[3]+3572445317&4294967295;f=g+(h<<16&4294967295|h>>>16);h=d+(f^g^c)+e[6]+76029189&4294967295;d=f+(h<<23&4294967295|h>>>9);h=c+(d^f^g)+e[9]+3654602809&4294967295;c=d+(h<<4&4294967295|h>>>28);h=g+(c^d^f)+e[12]+3873151461&4294967295;
g=c+(h<<11&4294967295|h>>>21);h=f+(g^c^d)+e[15]+530742520&4294967295;f=g+(h<<16&4294967295|h>>>16);h=d+(f^g^c)+e[2]+3299628645&4294967295;d=f+(h<<23&4294967295|h>>>9);h=c+(f^(d|~g))+e[0]+4096336452&4294967295;c=d+(h<<6&4294967295|h>>>26);h=g+(d^(c|~f))+e[7]+1126891415&4294967295;g=c+(h<<10&4294967295|h>>>22);h=f+(c^(g|~d))+e[14]+2878612391&4294967295;f=g+(h<<15&4294967295|h>>>17);h=d+(g^(f|~c))+e[5]+4237533241&4294967295;d=f+(h<<21&4294967295|h>>>11);h=c+(f^(d|~g))+e[12]+1700485571&4294967295;c=d+
(h<<6&4294967295|h>>>26);h=g+(d^(c|~f))+e[3]+2399980690&4294967295;g=c+(h<<10&4294967295|h>>>22);h=f+(c^(g|~d))+e[10]+4293915773&4294967295;f=g+(h<<15&4294967295|h>>>17);h=d+(g^(f|~c))+e[1]+2240044497&4294967295;d=f+(h<<21&4294967295|h>>>11);h=c+(f^(d|~g))+e[8]+1873313359&4294967295;c=d+(h<<6&4294967295|h>>>26);h=g+(d^(c|~f))+e[15]+4264355552&4294967295;g=c+(h<<10&4294967295|h>>>22);h=f+(c^(g|~d))+e[6]+2734768916&4294967295;f=g+(h<<15&4294967295|h>>>17);h=d+(g^(f|~c))+e[13]+1309151649&4294967295;
d=f+(h<<21&4294967295|h>>>11);h=c+(f^(d|~g))+e[4]+4149444226&4294967295;c=d+(h<<6&4294967295|h>>>26);h=g+(d^(c|~f))+e[11]+3174756917&4294967295;g=c+(h<<10&4294967295|h>>>22);h=f+(c^(g|~d))+e[2]+718787259&4294967295;f=g+(h<<15&4294967295|h>>>17);h=d+(g^(f|~c))+e[9]+3951481745&4294967295;a.b[0]=a.b[0]+c&4294967295;a.b[1]=a.b[1]+(f+(h<<21&4294967295|h>>>11))&4294967295;a.b[2]=a.b[2]+f&4294967295;a.b[3]=a.b[3]+g&4294967295}
function am(a,c){var d;ca(d)||(d=c.length);for(var e=d-a.a,f=a.g,g=a.c,h=0;h<d;){if(0==g)for(;h<=e;)$l(a,c,h),h+=a.a;if(ia(c))for(;h<d;){if(f[g++]=c.charCodeAt(h++),g==a.a){$l(a,f);g=0;break}}else for(;h<d;)if(f[g++]=c[h++],g==a.a){$l(a,f);g=0;break}}a.c=g;a.f+=d};function bm(a){a=a||{};this.b=void 0!==a.color?a.color:null;this.f=a.lineCap;this.c=void 0!==a.lineDash?a.lineDash:null;this.g=a.lineJoin;this.j=a.miterLimit;this.a=a.width;this.i=void 0}l=bm.prototype;l.zm=function(){return this.b};l.Xi=function(){return this.f};l.Am=function(){return this.c};l.Yi=function(){return this.g};l.cj=function(){return this.j};l.Bm=function(){return this.a};l.Cm=function(a){this.b=a;this.i=void 0};l.Wn=function(a){this.f=a;this.i=void 0};
l.Dm=function(a){this.c=a;this.i=void 0};l.Xn=function(a){this.g=a;this.i=void 0};l.Yn=function(a){this.j=a;this.i=void 0};l.ho=function(a){this.a=a;this.i=void 0};
l.ub=function(){if(void 0===this.i){var a="s"+(this.b?Ag(this.b):"-")+","+(void 0!==this.f?this.f.toString():"-")+","+(this.c?this.c.toString():"-")+","+(void 0!==this.g?this.g:"-")+","+(void 0!==this.j?this.j.toString():"-")+","+(void 0!==this.a?this.a.toString():"-"),c=new Zl;am(c,a);var d=Array((56>c.c?c.a:2*c.a)-c.c);d[0]=128;for(a=1;a<d.length-8;++a)d[a]=0;for(var e=8*c.f,a=d.length-8;a<d.length;++a)d[a]=e&255,e/=256;am(c,d);d=Array(16);for(a=e=0;4>a;++a)for(var f=0;32>f;f+=8)d[e++]=c.b[a]>>>
f&255;if(8192>=d.length)c=String.fromCharCode.apply(null,d);else for(c="",a=0;a<d.length;a+=8192)c+=String.fromCharCode.apply(null,kb(d,a,a+8192));this.i=c}return this.i};function cm(a){a=a||{};this.j=this.b=this.g=null;this.f=void 0!==a.fill?a.fill:null;this.a=void 0!==a.stroke?a.stroke:null;this.c=a.radius;this.v=[0,0];this.l=this.ea=this.i=null;var c=a.atlasManager,d,e=null,f,g=0;this.a&&(f=Ag(this.a.b),g=this.a.a,void 0===g&&(g=1),e=this.a.c,Zi||(e=null));var h=2*(this.c+g)+1;f={strokeStyle:f,ld:g,size:h,lineDash:e};void 0===c?(this.b=Pg("CANVAS"),this.b.height=h,this.b.width=h,d=h=this.b.width,c=this.b.getContext("2d"),this.Lg(f,c,0,0),this.f?this.j=this.b:(c=
this.j=Pg("CANVAS"),c.height=f.size,c.width=f.size,c=c.getContext("2d"),this.Kg(f,c,0,0))):(h=Math.round(h),(e=!this.f)&&(d=qa(this.Kg,this,f)),g=this.ub(),f=c.add(g,h,h,qa(this.Lg,this,f),d),this.b=f.image,this.v=[f.offsetX,f.offsetY],d=f.image.width,this.j=e?f.ig:this.b);this.i=[h/2,h/2];this.ea=[h,h];this.l=[d,d];wk.call(this,{opacity:1,rotateWithView:!1,rotation:0,scale:1,snapToPixel:void 0!==a.snapToPixel?a.snapToPixel:!0})}w(cm,wk);l=cm.prototype;l.Db=function(){return this.i};l.qm=function(){return this.f};
l.fe=function(){return this.j};l.Mb=function(){return this.b};l.gd=function(){return 2};l.Fd=function(){return this.l};l.ua=function(){return this.v};l.rm=function(){return this.c};l.ob=function(){return this.ea};l.sm=function(){return this.a};l.bf=va;l.load=va;l.Bf=va;
l.Lg=function(a,c,d,e){c.setTransform(1,0,0,1,0,0);c.translate(d,e);c.beginPath();c.arc(a.size/2,a.size/2,this.c,0,2*Math.PI,!0);this.f&&(c.fillStyle=Ag(this.f.b),c.fill());this.a&&(c.strokeStyle=a.strokeStyle,c.lineWidth=a.ld,a.lineDash&&c.setLineDash(a.lineDash),c.stroke());c.closePath()};
l.Kg=function(a,c,d,e){c.setTransform(1,0,0,1,0,0);c.translate(d,e);c.beginPath();c.arc(a.size/2,a.size/2,this.c,0,2*Math.PI,!0);c.fillStyle=Ag(Ul);c.fill();this.a&&(c.strokeStyle=a.strokeStyle,c.lineWidth=a.ld,a.lineDash&&c.setLineDash(a.lineDash),c.stroke());c.closePath()};l.ub=function(){var a=this.a?this.a.ub():"-",c=this.f?this.f.ub():"-";this.g&&a==this.g[1]&&c==this.g[2]&&this.c==this.g[3]||(this.g=["c"+a+c+(void 0!==this.c?this.c.toString():"-"),a,c,this.c]);return this.g[0]};function dm(a){a=a||{};this.i=null;this.f=em;void 0!==a.geometry&&this.Og(a.geometry);this.g=void 0!==a.fill?a.fill:null;this.j=void 0!==a.image?a.image:null;this.c=void 0!==a.stroke?a.stroke:null;this.a=void 0!==a.text?a.text:null;this.b=a.zIndex}l=dm.prototype;l.W=function(){return this.i};l.Si=function(){return this.f};l.Em=function(){return this.g};l.Fm=function(){return this.j};l.Gm=function(){return this.c};l.Hm=function(){return this.a};l.Im=function(){return this.b};
l.Og=function(a){ka(a)?this.f=a:ia(a)?this.f=function(c){return c.get(a)}:a?void 0!==a&&(this.f=function(){return a}):this.f=em;this.i=a};l.Jm=function(a){this.b=a};function fm(a){if(!ka(a)){var c;c=ga(a)?a:[a];a=function(){return c}}return a}var gm=null;function hm(){if(!gm){var a=new Xl({color:"rgba(255,255,255,0.4)"}),c=new bm({color:"#3399CC",width:1.25});gm=[new dm({image:new cm({fill:a,stroke:c,radius:5}),fill:a,stroke:c})]}return gm}
function im(){var a={},c=[255,255,255,1],d=[0,153,255,1];a.Polygon=[new dm({fill:new Xl({color:[255,255,255,.5]})})];a.MultiPolygon=a.Polygon;a.LineString=[new dm({stroke:new bm({color:c,width:5})}),new dm({stroke:new bm({color:d,width:3})})];a.MultiLineString=a.LineString;a.Circle=a.Polygon.concat(a.LineString);a.Point=[new dm({image:new cm({radius:6,fill:new Xl({color:d}),stroke:new bm({color:c,width:1.5})}),zIndex:Infinity})];a.MultiPoint=a.Point;a.GeometryCollection=a.Polygon.concat(a.LineString,
a.Point);return a}function em(a){return a.W()};function G(a){a=a?a:{};var c=Tb(a);delete c.style;delete c.renderBuffer;delete c.updateWhileAnimating;delete c.updateWhileInteracting;fk.call(this,c);this.a=void 0!==a.renderBuffer?a.renderBuffer:100;this.B=null;this.c=void 0;this.g(a.style);this.C=void 0!==a.updateWhileAnimating?a.updateWhileAnimating:!1;this.O=void 0!==a.updateWhileInteracting?a.updateWhileInteracting:!1}w(G,fk);G.prototype.U=function(){return this.B};G.prototype.Y=function(){return this.c};
G.prototype.g=function(a){this.B=void 0!==a?a:hm;this.c=null===a?void 0:fm(this.B);this.u()};function jm(a,c,d,e,f){this.v={};this.c=a;this.O=c;this.g=d;this.ka=e;this.Kc=f;this.j=this.b=this.a=this.sa=this.Pa=this.ga=null;this.Qa=this.xa=this.A=this.Y=this.U=this.J=0;this.ib=!1;this.i=this.pb=0;this.qb=!1;this.$=0;this.f="";this.D=this.ea=this.nc=this.sd=0;this.da=this.B=this.l=null;this.C=[];this.oc=Cd()}
function lm(a,c,d){if(a.j){c=$e(c,0,d,2,a.ka,a.C);d=a.c;var e=a.oc,f=d.globalAlpha;1!=a.A&&(d.globalAlpha=f*a.A);var g=a.pb;a.ib&&(g+=a.Kc);var h,k;h=0;for(k=c.length;h<k;h+=2){var m=c[h]-a.J,n=c[h+1]-a.U;a.qb&&(m=m+.5|0,n=n+.5|0);if(0!==g||1!=a.i){var p=m+a.J,q=n+a.U;jk(e,p,q,a.i,a.i,g,-p,-q);d.setTransform(e[0],e[1],e[4],e[5],e[12],e[13])}d.drawImage(a.j,a.xa,a.Qa,a.$,a.Y,m,n,a.$,a.Y)}0===g&&1==a.i||d.setTransform(1,0,0,1,0,0);1!=a.A&&(d.globalAlpha=f)}}
function mm(a,c,d,e){var f=0;if(a.da&&""!==a.f){a.l&&nm(a,a.l);a.B&&om(a,a.B);var g=a.da,h=a.c,k=a.sa;k?(k.font!=g.font&&(k.font=h.font=g.font),k.textAlign!=g.textAlign&&(k.textAlign=h.textAlign=g.textAlign),k.textBaseline!=g.textBaseline&&(k.textBaseline=h.textBaseline=g.textBaseline)):(h.font=g.font,h.textAlign=g.textAlign,h.textBaseline=g.textBaseline,a.sa={font:g.font,textAlign:g.textAlign,textBaseline:g.textBaseline});c=$e(c,f,d,e,a.ka,a.C);for(g=a.c;f<d;f+=e){h=c[f]+a.sd;k=c[f+1]+a.nc;if(0!==
a.ea||1!=a.D){var m=jk(a.oc,h,k,a.D,a.D,a.ea,-h,-k);g.setTransform(m[0],m[1],m[4],m[5],m[12],m[13])}a.B&&g.strokeText(a.f,h,k);a.l&&g.fillText(a.f,h,k)}0===a.ea&&1==a.D||g.setTransform(1,0,0,1,0,0)}}function pm(a,c,d,e,f,g){var h=a.c;a=$e(c,d,e,f,a.ka,a.C);h.moveTo(a[0],a[1]);for(c=2;c<a.length;c+=2)h.lineTo(a[c],a[c+1]);g&&h.lineTo(a[0],a[1]);return e}function qm(a,c,d,e,f){var g=a.c,h,k;h=0;for(k=e.length;h<k;++h)d=pm(a,c,d,e[h],f,!0),g.closePath();return d}l=jm.prototype;
l.Xc=function(a,c){var d=a.toString(),e=this.v[d];void 0!==e?e.push(c):this.v[d]=[c]};l.qc=function(a){if(ke(this.g,a.S())){if(this.a||this.b){this.a&&nm(this,this.a);this.b&&om(this,this.b);var c;c=(c=a.o)?$e(c,0,c.length,a.H,this.ka,this.C):null;var d=c[2]-c[0],e=c[3]-c[1],d=Math.sqrt(d*d+e*e),e=this.c;e.beginPath();e.arc(c[0],c[1],d,0,2*Math.PI);this.a&&e.fill();this.b&&e.stroke()}""!==this.f&&mm(this,a.cd(),2,2)}};
l.Ne=function(a,c){var d=(0,c.f)(a);if(d&&ke(this.g,d.S())){var e=c.b;void 0===e&&(e=0);this.Xc(e,function(a){a.Ma(c.g,c.c);a.fb(c.j);a.Na(c.a);rm[d.X()].call(a,d,null)})}};l.Ad=function(a,c){var d=a.f,e,f;e=0;for(f=d.length;e<f;++e){var g=d[e];rm[g.X()].call(this,g,c)}};l.sb=function(a){var c=a.o;a=a.H;this.j&&lm(this,c,c.length);""!==this.f&&mm(this,c,c.length,a)};l.rb=function(a){var c=a.o;a=a.H;this.j&&lm(this,c,c.length);""!==this.f&&mm(this,c,c.length,a)};
l.Bb=function(a){if(ke(this.g,a.S())){if(this.b){om(this,this.b);var c=this.c,d=a.o;c.beginPath();pm(this,d,0,d.length,a.H,!1);c.stroke()}""!==this.f&&(a=sm(a),mm(this,a,2,2))}};l.rc=function(a){var c=a.S();if(ke(this.g,c)){if(this.b){om(this,this.b);var c=this.c,d=a.o,e=0,f=a.c,g=a.H;c.beginPath();var h,k;h=0;for(k=f.length;h<k;++h)e=pm(this,d,e,f[h],g,!1);c.stroke()}""!==this.f&&(a=tm(a),mm(this,a,a.length,2))}};
l.tc=function(a){if(ke(this.g,a.S())){if(this.b||this.a){this.a&&nm(this,this.a);this.b&&om(this,this.b);var c=this.c;c.beginPath();qm(this,If(a),0,a.c,a.H);this.a&&c.fill();this.b&&c.stroke()}""!==this.f&&(a=Jf(a),mm(this,a,2,2))}};
l.sc=function(a){if(ke(this.g,a.S())){if(this.b||this.a){this.a&&nm(this,this.a);this.b&&om(this,this.b);var c=this.c,d=um(a),e=0,f=a.c,g=a.H,h,k;h=0;for(k=f.length;h<k;++h){var m=f[h];c.beginPath();e=qm(this,d,e,m,g);this.a&&c.fill();this.b&&c.stroke()}}""!==this.f&&(a=vm(a),mm(this,a,a.length,2))}};function wm(a){var c=Object.keys(a.v).map(Number);lb(c);var d,e,f,g,h;d=0;for(e=c.length;d<e;++d)for(f=a.v[c[d].toString()],g=0,h=f.length;g<h;++g)f[g](a)}
function nm(a,c){var d=a.c,e=a.ga;e?e.fillStyle!=c.fillStyle&&(e.fillStyle=d.fillStyle=c.fillStyle):(d.fillStyle=c.fillStyle,a.ga={fillStyle:c.fillStyle})}
function om(a,c){var d=a.c,e=a.Pa;e?(e.lineCap!=c.lineCap&&(e.lineCap=d.lineCap=c.lineCap),Zi&&!pb(e.lineDash,c.lineDash)&&d.setLineDash(e.lineDash=c.lineDash),e.lineJoin!=c.lineJoin&&(e.lineJoin=d.lineJoin=c.lineJoin),e.lineWidth!=c.lineWidth&&(e.lineWidth=d.lineWidth=c.lineWidth),e.miterLimit!=c.miterLimit&&(e.miterLimit=d.miterLimit=c.miterLimit),e.strokeStyle!=c.strokeStyle&&(e.strokeStyle=d.strokeStyle=c.strokeStyle)):(d.lineCap=c.lineCap,Zi&&d.setLineDash(c.lineDash),d.lineJoin=c.lineJoin,d.lineWidth=
c.lineWidth,d.miterLimit=c.miterLimit,d.strokeStyle=c.strokeStyle,a.Pa={lineCap:c.lineCap,lineDash:c.lineDash,lineJoin:c.lineJoin,lineWidth:c.lineWidth,miterLimit:c.miterLimit,strokeStyle:c.strokeStyle})}
l.Ma=function(a,c){if(a){var d=a.b;this.a={fillStyle:Ag(d?d:Ul)}}else this.a=null;if(c){var d=c.b,e=c.f,f=c.c,g=c.g,h=c.a,k=c.j;this.b={lineCap:void 0!==e?e:"round",lineDash:f?f:Vl,lineJoin:void 0!==g?g:"round",lineWidth:this.O*(void 0!==h?h:1),miterLimit:void 0!==k?k:10,strokeStyle:Ag(d?d:Wl)}}else this.b=null};
l.fb=function(a){if(a){var c=a.Db(),d=a.Mb(1),e=a.ua(),f=a.ob();this.J=c[0];this.U=c[1];this.Y=f[1];this.j=d;this.A=a.A;this.xa=e[0];this.Qa=e[1];this.ib=a.C;this.pb=a.D;this.i=a.B;this.qb=a.O;this.$=f[0]}else this.j=null};
l.Na=function(a){if(a){var c=a.b;c?(c=c.b,this.l={fillStyle:Ag(c?c:Ul)}):this.l=null;var d=a.l;if(d){var c=d.b,e=d.f,f=d.c,g=d.g,h=d.a,d=d.j;this.B={lineCap:void 0!==e?e:"round",lineDash:f?f:Vl,lineJoin:void 0!==g?g:"round",lineWidth:void 0!==h?h:1,miterLimit:void 0!==d?d:10,strokeStyle:Ag(c?c:Wl)}}else this.B=null;var c=a.f,e=a.g,f=a.j,g=a.i,h=a.a,d=a.c,k=a.D;a=a.B;this.da={font:void 0!==c?c:"10px sans-serif",textAlign:void 0!==k?k:"center",textBaseline:void 0!==a?a:"middle"};this.f=void 0!==d?d:
"";this.sd=void 0!==e?this.O*e:0;this.nc=void 0!==f?this.O*f:0;this.ea=void 0!==g?g:0;this.D=this.O*(void 0!==h?h:1)}else this.f=""};var rm={Point:jm.prototype.sb,LineString:jm.prototype.Bb,Polygon:jm.prototype.tc,MultiPoint:jm.prototype.rb,MultiLineString:jm.prototype.rc,MultiPolygon:jm.prototype.sc,GeometryCollection:jm.prototype.Ad,Circle:jm.prototype.qc};function xm(a){mk.call(this,a);this.J=Cd()}w(xm,mk);
xm.prototype.A=function(a,c,d){ym(this,"precompose",d,a,void 0);var e=this.fd();if(e){var f=c.extent,g=void 0!==f;if(g){var h=a.pixelRatio,k=fe(f),m=ee(f),n=de(f),f=ce(f);lk(a.coordinateToPixelMatrix,k,k);lk(a.coordinateToPixelMatrix,m,m);lk(a.coordinateToPixelMatrix,n,n);lk(a.coordinateToPixelMatrix,f,f);d.save();d.beginPath();d.moveTo(k[0]*h,k[1]*h);d.lineTo(m[0]*h,m[1]*h);d.lineTo(n[0]*h,n[1]*h);d.lineTo(f[0]*h,f[1]*h);d.clip()}h=this.We();k=d.globalAlpha;d.globalAlpha=c.opacity;0===a.viewState.rotation?
d.drawImage(e,0,0,+e.width,+e.height,Math.round(h[12]),Math.round(h[13]),Math.round(e.width*h[0]),Math.round(e.height*h[5])):(d.setTransform(h[0],h[1],h[4],h[5],h[12],h[13]),d.drawImage(e,0,0),d.setTransform(1,0,0,1,0,0));d.globalAlpha=k;g&&d.restore()}ym(this,"postcompose",d,a,void 0)};function ym(a,c,d,e,f){var g=a.a;dd(g,c)&&(a=void 0!==f?f:zm(a,e,0),a=new jm(d,e.pixelRatio,e.extent,a,e.viewState.rotation),g.s(new ek(c,g,a,e,d,null)),wm(a))}
function zm(a,c,d){var e=c.viewState,f=c.pixelRatio;return jk(a.J,f*c.size[0]/2,f*c.size[1]/2,f/e.resolution,-f/e.resolution,-e.rotation,-e.center[0]+d,-e.center[1])}function Am(a,c){var d=[0,0];lk(c,a,d);return d}
var Bm=function(){var a=null,c=null;return function(d){if(!a){a=Qi(1,1);c=a.createImageData(1,1);var e=c.data;e[0]=42;e[1]=84;e[2]=126;e[3]=255}var e=a.canvas,f=d[0]<=e.width&&d[1]<=e.height;f||(e.width=d[0],e.height=d[1],e=d[0]-1,d=d[1]-1,a.putImageData(c,e,d),d=a.getImageData(e,d,1,1),f=pb(c.data,d.data));return f}}();var Cm=["Polygon","LineString","Image","Text"];function Dm(a,c,d){this.sa=a;this.$=c;this.f=null;this.g=0;this.resolution=d;this.U=this.J=null;this.a=[];this.coordinates=[];this.ga=Cd();this.b=[];this.da=[];this.Pa=Cd()}w(Dm,dk);
function Em(a,c,d,e,f,g){var h=a.coordinates.length,k=a.Re(),m=[c[d],c[d+1]],n=[NaN,NaN],p=!0,q,r,u;for(q=d+f;q<e;q+=f)n[0]=c[q],n[1]=c[q+1],u=Xd(k,n),u!==r?(p&&(a.coordinates[h++]=m[0],a.coordinates[h++]=m[1]),a.coordinates[h++]=n[0],a.coordinates[h++]=n[1],p=!1):1===u?(a.coordinates[h++]=n[0],a.coordinates[h++]=n[1],p=!1):p=!0,m[0]=n[0],m[1]=n[1],r=u;q===d+f&&(a.coordinates[h++]=m[0],a.coordinates[h++]=m[1]);g&&(a.coordinates[h++]=c[d],a.coordinates[h++]=c[d+1]);return h}
function Fm(a,c){a.J=[0,c,0];a.a.push(a.J);a.U=[0,c,0];a.b.push(a.U)}
function Gm(a,c,d,e,f,g,h,k,m){var n;kk(e,a.ga)?n=a.da:(n=$e(a.coordinates,0,a.coordinates.length,2,e,a.da),Fd(a.ga,e));e=0;var p=h.length,q=0,r;for(a=a.Pa;e<p;){var u=h[e],y,A,F,z;switch(u[0]){case 0:q=u[1];r=v(q).toString();void 0===g[r]&&q.W()?void 0===m||ke(m,q.W().S())?++e:e=u[2]:e=u[2];break;case 1:c.beginPath();++e;break;case 2:q=u[1];r=n[q];var x=n[q+1],K=n[q+2]-r,q=n[q+3]-x;c.arc(r,x,Math.sqrt(K*K+q*q),0,2*Math.PI,!0);++e;break;case 3:c.closePath();++e;break;case 4:q=u[1];r=u[2];y=u[3];F=
u[4]*d;var J=u[5]*d,I=u[6];A=u[7];var O=u[8],wa=u[9],x=u[11],K=u[12],Ua=u[13],M=u[14];for(u[10]&&(x+=f);q<r;q+=2){u=n[q]-F;z=n[q+1]-J;Ua&&(u=u+.5|0,z=z+.5|0);if(1!=K||0!==x){var Ma=u+F,qb=z+J;jk(a,Ma,qb,K,K,x,-Ma,-qb);c.setTransform(a[0],a[1],a[4],a[5],a[12],a[13])}Ma=c.globalAlpha;1!=A&&(c.globalAlpha=Ma*A);c.drawImage(y,O,wa,M,I,u,z,M*d,I*d);1!=A&&(c.globalAlpha=Ma);1==K&&0===x||c.setTransform(1,0,0,1,0,0)}++e;break;case 5:q=u[1];r=u[2];F=u[3];J=u[4]*d;I=u[5]*d;x=u[6];K=u[7]*d;y=u[8];for(A=u[9];q<
r;q+=2){u=n[q]+J;z=n[q+1]+I;if(1!=K||0!==x)jk(a,u,z,K,K,x,-u,-z),c.setTransform(a[0],a[1],a[4],a[5],a[12],a[13]);A&&c.strokeText(F,u,z);y&&c.fillText(F,u,z);1==K&&0===x||c.setTransform(1,0,0,1,0,0)}++e;break;case 6:if(void 0!==k&&(q=u[1],q=k(q)))return q;++e;break;case 7:c.fill();++e;break;case 8:q=u[1];r=u[2];c.moveTo(n[q],n[q+1]);for(q+=2;q<r;q+=2)c.lineTo(n[q],n[q+1]);++e;break;case 9:c.fillStyle=u[1];++e;break;case 10:q=void 0!==u[7]?u[7]:!0;r=u[2];c.strokeStyle=u[1];c.lineWidth=q?r*d:r;c.lineCap=
u[3];c.lineJoin=u[4];c.miterLimit=u[5];Zi&&c.setLineDash(u[6]);++e;break;case 11:c.font=u[1];c.textAlign=u[2];c.textBaseline=u[3];++e;break;case 12:c.stroke();++e;break;default:++e}}}function Hm(a){var c=a.b;c.reverse();var d,e=c.length,f,g,h=-1;for(d=0;d<e;++d)if(f=c[d],g=f[0],6==g)h=d;else if(0==g){f[2]=d;f=a.b;for(g=d;h<g;){var k=f[h];f[h]=f[g];f[g]=k;++h;--g}h=-1}}function Im(a,c){a.J[2]=a.a.length;a.J=null;a.U[2]=a.b.length;a.U=null;var d=[6,c];a.a.push(d);a.b.push(d)}Dm.prototype.be=va;
Dm.prototype.Re=function(){return this.$};function Jm(a,c,d){Dm.call(this,a,c,d);this.l=this.Y=null;this.ka=this.ea=this.O=this.C=this.v=this.A=this.B=this.D=this.i=this.j=this.c=void 0}w(Jm,Dm);
Jm.prototype.sb=function(a,c){if(this.l){Fm(this,c);var d=a.o,e=this.coordinates.length,d=Em(this,d,0,d.length,a.H,!1);this.a.push([4,e,d,this.l,this.c,this.j,this.i,this.D,this.B,this.A,this.v,this.C,this.O,this.ea,this.ka]);this.b.push([4,e,d,this.Y,this.c,this.j,this.i,this.D,this.B,this.A,this.v,this.C,this.O,this.ea,this.ka]);Im(this,c)}};
Jm.prototype.rb=function(a,c){if(this.l){Fm(this,c);var d=a.o,e=this.coordinates.length,d=Em(this,d,0,d.length,a.H,!1);this.a.push([4,e,d,this.l,this.c,this.j,this.i,this.D,this.B,this.A,this.v,this.C,this.O,this.ea,this.ka]);this.b.push([4,e,d,this.Y,this.c,this.j,this.i,this.D,this.B,this.A,this.v,this.C,this.O,this.ea,this.ka]);Im(this,c)}};Jm.prototype.be=function(){Hm(this);this.j=this.c=void 0;this.l=this.Y=null;this.ka=this.ea=this.C=this.v=this.A=this.B=this.D=this.O=this.i=void 0};
Jm.prototype.fb=function(a){var c=a.Db(),d=a.ob(),e=a.fe(1),f=a.Mb(1),g=a.ua();this.c=c[0];this.j=c[1];this.Y=e;this.l=f;this.i=d[1];this.D=a.A;this.B=g[0];this.A=g[1];this.v=a.C;this.C=a.D;this.O=a.B;this.ea=a.O;this.ka=d[0]};function Km(a,c,d){Dm.call(this,a,c,d);this.c={Uc:void 0,Pc:void 0,Qc:null,Rc:void 0,Sc:void 0,Tc:void 0,af:0,strokeStyle:void 0,lineCap:void 0,lineDash:null,lineJoin:void 0,lineWidth:void 0,miterLimit:void 0}}w(Km,Dm);
function Lm(a,c,d,e,f){var g=a.coordinates.length;c=Em(a,c,d,e,f,!1);g=[8,g,c];a.a.push(g);a.b.push(g);return e}l=Km.prototype;l.Re=function(){this.f||(this.f=Sd(this.$),0<this.g&&Rd(this.f,this.resolution*(this.g+1)/2,this.f));return this.f};
function Mm(a){var c=a.c,d=c.strokeStyle,e=c.lineCap,f=c.lineDash,g=c.lineJoin,h=c.lineWidth,k=c.miterLimit;c.Uc==d&&c.Pc==e&&pb(c.Qc,f)&&c.Rc==g&&c.Sc==h&&c.Tc==k||(c.af!=a.coordinates.length&&(a.a.push([12]),c.af=a.coordinates.length),a.a.push([10,d,h,e,g,k,f],[1]),c.Uc=d,c.Pc=e,c.Qc=f,c.Rc=g,c.Sc=h,c.Tc=k)}
l.Bb=function(a,c){var d=this.c,e=d.lineWidth;void 0!==d.strokeStyle&&void 0!==e&&(Mm(this),Fm(this,c),this.b.push([10,d.strokeStyle,d.lineWidth,d.lineCap,d.lineJoin,d.miterLimit,d.lineDash],[1]),d=a.o,Lm(this,d,0,d.length,a.H),this.b.push([12]),Im(this,c))};
l.rc=function(a,c){var d=this.c,e=d.lineWidth;if(void 0!==d.strokeStyle&&void 0!==e){Mm(this);Fm(this,c);this.b.push([10,d.strokeStyle,d.lineWidth,d.lineCap,d.lineJoin,d.miterLimit,d.lineDash],[1]);var d=a.c,e=a.o,f=a.H,g=0,h,k;h=0;for(k=d.length;h<k;++h)g=Lm(this,e,g,d[h],f);this.b.push([12]);Im(this,c)}};l.be=function(){this.c.af!=this.coordinates.length&&this.a.push([12]);Hm(this);this.c=null};
l.Ma=function(a,c){var d=c.b;this.c.strokeStyle=Ag(d?d:Wl);d=c.f;this.c.lineCap=void 0!==d?d:"round";d=c.c;this.c.lineDash=d?d:Vl;d=c.g;this.c.lineJoin=void 0!==d?d:"round";d=c.a;this.c.lineWidth=void 0!==d?d:1;d=c.j;this.c.miterLimit=void 0!==d?d:10;this.c.lineWidth>this.g&&(this.g=this.c.lineWidth,this.f=null)};
function Nm(a,c,d){Dm.call(this,a,c,d);this.c={Sf:void 0,Uc:void 0,Pc:void 0,Qc:null,Rc:void 0,Sc:void 0,Tc:void 0,fillStyle:void 0,strokeStyle:void 0,lineCap:void 0,lineDash:null,lineJoin:void 0,lineWidth:void 0,miterLimit:void 0}}w(Nm,Dm);
function Om(a,c,d,e,f){var g=a.c,h=[1];a.a.push(h);a.b.push(h);var k,h=0;for(k=e.length;h<k;++h){var m=e[h],n=a.coordinates.length;d=Em(a,c,d,m,f,!0);d=[8,n,d];n=[3];a.a.push(d,n);a.b.push(d,n);d=m}c=[7];a.b.push(c);void 0!==g.fillStyle&&a.a.push(c);void 0!==g.strokeStyle&&(g=[12],a.a.push(g),a.b.push(g));return d}l=Nm.prototype;
l.qc=function(a,c){var d=this.c,e=d.strokeStyle;if(void 0!==d.fillStyle||void 0!==e){Pm(this);Fm(this,c);this.b.push([9,Ag(Ul)]);void 0!==d.strokeStyle&&this.b.push([10,d.strokeStyle,d.lineWidth,d.lineCap,d.lineJoin,d.miterLimit,d.lineDash]);var f=a.o,e=this.coordinates.length;Em(this,f,0,f.length,a.H,!1);f=[1];e=[2,e];this.a.push(f,e);this.b.push(f,e);e=[7];this.b.push(e);void 0!==d.fillStyle&&this.a.push(e);void 0!==d.strokeStyle&&(d=[12],this.a.push(d),this.b.push(d));Im(this,c)}};
l.tc=function(a,c){var d=this.c,e=d.strokeStyle;if(void 0!==d.fillStyle||void 0!==e)Pm(this),Fm(this,c),this.b.push([9,Ag(Ul)]),void 0!==d.strokeStyle&&this.b.push([10,d.strokeStyle,d.lineWidth,d.lineCap,d.lineJoin,d.miterLimit,d.lineDash]),d=a.c,e=If(a),Om(this,e,0,d,a.H),Im(this,c)};
l.sc=function(a,c){var d=this.c,e=d.strokeStyle;if(void 0!==d.fillStyle||void 0!==e){Pm(this);Fm(this,c);this.b.push([9,Ag(Ul)]);void 0!==d.strokeStyle&&this.b.push([10,d.strokeStyle,d.lineWidth,d.lineCap,d.lineJoin,d.miterLimit,d.lineDash]);var d=a.c,e=um(a),f=a.H,g=0,h,k;h=0;for(k=d.length;h<k;++h)g=Om(this,e,g,d[h],f);Im(this,c)}};l.be=function(){Hm(this);this.c=null;var a=this.sa;if(0!==a){var c=this.coordinates,d,e;d=0;for(e=c.length;d<e;++d)c[d]=a*Math.round(c[d]/a)}};
l.Re=function(){this.f||(this.f=Sd(this.$),0<this.g&&Rd(this.f,this.resolution*(this.g+1)/2,this.f));return this.f};
l.Ma=function(a,c){var d=this.c;if(a){var e=a.b;d.fillStyle=Ag(e?e:Ul)}else d.fillStyle=void 0;c?(e=c.b,d.strokeStyle=Ag(e?e:Wl),e=c.f,d.lineCap=void 0!==e?e:"round",e=c.c,d.lineDash=e?e.slice():Vl,e=c.g,d.lineJoin=void 0!==e?e:"round",e=c.a,d.lineWidth=void 0!==e?e:1,e=c.j,d.miterLimit=void 0!==e?e:10,d.lineWidth>this.g&&(this.g=d.lineWidth,this.f=null)):(d.strokeStyle=void 0,d.lineCap=void 0,d.lineDash=null,d.lineJoin=void 0,d.lineWidth=void 0,d.miterLimit=void 0)};
function Pm(a){var c=a.c,d=c.fillStyle,e=c.strokeStyle,f=c.lineCap,g=c.lineDash,h=c.lineJoin,k=c.lineWidth,m=c.miterLimit;void 0!==d&&c.Sf!=d&&(a.a.push([9,d]),c.Sf=c.fillStyle);void 0===e||c.Uc==e&&c.Pc==f&&c.Qc==g&&c.Rc==h&&c.Sc==k&&c.Tc==m||(a.a.push([10,e,k,f,h,m,g]),c.Uc=e,c.Pc=f,c.Qc=g,c.Rc=h,c.Sc=k,c.Tc=m)}function Qm(a,c,d){Dm.call(this,a,c,d);this.ea=this.O=this.C=null;this.l="";this.v=this.A=this.B=this.D=0;this.i=this.j=this.c=null}w(Qm,Dm);
Qm.prototype.tb=function(a,c,d,e,f,g){if(""!==this.l&&this.i&&(this.c||this.j)){if(this.c){f=this.c;var h=this.C;if(!h||h.fillStyle!=f.fillStyle){var k=[9,f.fillStyle];this.a.push(k);this.b.push(k);h?h.fillStyle=f.fillStyle:this.C={fillStyle:f.fillStyle}}}this.j&&(f=this.j,h=this.O,h&&h.lineCap==f.lineCap&&h.lineDash==f.lineDash&&h.lineJoin==f.lineJoin&&h.lineWidth==f.lineWidth&&h.miterLimit==f.miterLimit&&h.strokeStyle==f.strokeStyle||(k=[10,f.strokeStyle,f.lineWidth,f.lineCap,f.lineJoin,f.miterLimit,
f.lineDash,!1],this.a.push(k),this.b.push(k),h?(h.lineCap=f.lineCap,h.lineDash=f.lineDash,h.lineJoin=f.lineJoin,h.lineWidth=f.lineWidth,h.miterLimit=f.miterLimit,h.strokeStyle=f.strokeStyle):this.O={lineCap:f.lineCap,lineDash:f.lineDash,lineJoin:f.lineJoin,lineWidth:f.lineWidth,miterLimit:f.miterLimit,strokeStyle:f.strokeStyle}));f=this.i;h=this.ea;h&&h.font==f.font&&h.textAlign==f.textAlign&&h.textBaseline==f.textBaseline||(k=[11,f.font,f.textAlign,f.textBaseline],this.a.push(k),this.b.push(k),h?
(h.font=f.font,h.textAlign=f.textAlign,h.textBaseline=f.textBaseline):this.ea={font:f.font,textAlign:f.textAlign,textBaseline:f.textBaseline});Fm(this,g);f=this.coordinates.length;a=Em(this,a,c,d,e,!1);a=[5,f,a,this.l,this.D,this.B,this.A,this.v,!!this.c,!!this.j];this.a.push(a);this.b.push(a);Im(this,g)}};
Qm.prototype.Na=function(a){if(a){var c=a.b;c?(c=c.b,c=Ag(c?c:Ul),this.c?this.c.fillStyle=c:this.c={fillStyle:c}):this.c=null;var d=a.l;if(d){var c=d.b,e=d.f,f=d.c,g=d.g,h=d.a,d=d.j,e=void 0!==e?e:"round",f=f?f.slice():Vl,g=void 0!==g?g:"round",h=void 0!==h?h:1,d=void 0!==d?d:10,c=Ag(c?c:Wl);if(this.j){var k=this.j;k.lineCap=e;k.lineDash=f;k.lineJoin=g;k.lineWidth=h;k.miterLimit=d;k.strokeStyle=c}else this.j={lineCap:e,lineDash:f,lineJoin:g,lineWidth:h,miterLimit:d,strokeStyle:c}}else this.j=null;
var m=a.f,c=a.g,e=a.j,f=a.i,h=a.a,d=a.c,g=a.D,k=a.B;a=void 0!==m?m:"10px sans-serif";g=void 0!==g?g:"center";k=void 0!==k?k:"middle";this.i?(m=this.i,m.font=a,m.textAlign=g,m.textBaseline=k):this.i={font:a,textAlign:g,textBaseline:k};this.l=void 0!==d?d:"";this.D=void 0!==c?c:0;this.B=void 0!==e?e:0;this.A=void 0!==f?f:0;this.v=void 0!==h?h:1}else this.l=""};function Rm(a,c,d,e){this.l=a;this.c=c;this.i=d;this.f=e;this.a={};this.g=Qi(1,1);this.j=Cd()}
function Sm(a){for(var c in a.a){var d=a.a[c],e;for(e in d)d[e].be()}}function Tm(a,c,d,e,f,g){var h=a.j;jk(h,.5,.5,1/d,-1/d,-e,-c[0],-c[1]);var k=a.g;k.clearRect(0,0,1,1);var m;void 0!==a.f&&(m=Nd(),Od(m,c),Rd(m,d*a.f,m));return Um(a,k,h,e,f,function(a){if(0<k.getImageData(0,0,1,1).data[3]){if(a=g(a))return a;k.clearRect(0,0,1,1)}},m)}
Rm.prototype.b=function(a,c){var d=void 0!==a?a.toString():"0",e=this.a[d];void 0===e&&(e={},this.a[d]=e);d=e[c];void 0===d&&(d=new Vm[c](this.l,this.c,this.i),e[c]=d);return d};Rm.prototype.za=function(){return Pb(this.a)};
function Wm(a,c,d,e,f,g){var h=Object.keys(a.a).map(Number);lb(h);var k=a.c,m=k[0],n=k[1],p=k[2],k=k[3],m=[m,n,m,k,p,k,p,n];$e(m,0,8,2,e,m);c.save();c.beginPath();c.moveTo(m[0],m[1]);c.lineTo(m[2],m[3]);c.lineTo(m[4],m[5]);c.lineTo(m[6],m[7]);c.closePath();c.clip();for(var q,r,m=0,n=h.length;m<n;++m)for(q=a.a[h[m].toString()],p=0,k=Cm.length;p<k;++p)r=q[Cm[p]],void 0!==r&&Gm(r,c,d,e,f,g,r.a,void 0);c.restore()}
function Um(a,c,d,e,f,g,h){var k=Object.keys(a.a).map(Number);lb(k,function(a,c){return c-a});var m,n,p,q,r;m=0;for(n=k.length;m<n;++m)for(q=a.a[k[m].toString()],p=Cm.length-1;0<=p;--p)if(r=q[Cm[p]],void 0!==r&&(r=Gm(r,c,1,d,e,f,r.b,g,h)))return r}var Vm={Image:Jm,LineString:Km,Polygon:Nm,Text:Qm};function Xm(a,c,d){af.call(this);this.yf(a,c?c:0,d)}w(Xm,af);l=Xm.prototype;l.clone=function(){var a=new Xm(null);cf(a,this.a,this.o.slice());a.u();return a};l.Ya=function(a,c,d,e){var f=this.o;a-=f[0];var g=c-f[1];c=a*a+g*g;if(c<e){if(0===c)for(e=0;e<this.H;++e)d[e]=f[e];else for(e=this.hf()/Math.sqrt(c),d[0]=f[0]+e*a,d[1]=f[1]+e*g,e=2;e<this.H;++e)d[e]=f[e];d.length=this.H;return c}return e};l.Zb=function(a,c){var d=this.o,e=a-d[0],d=c-d[1];return e*e+d*d<=Ym(this)};
l.cd=function(){return this.o.slice(0,this.H)};l.xd=function(a){var c=this.o,d=c[this.H]-c[0];return Qd(c[0]-d,c[1]-d,c[0]+d,c[1]+d,a)};l.hf=function(){return Math.sqrt(Ym(this))};function Ym(a){var c=a.o[a.H]-a.o[0];a=a.o[a.H+1]-a.o[1];return c*c+a*a}l.X=function(){return"Circle"};l.va=function(a){var c=this.S();return ke(a,c)?(c=this.cd(),a[0]<=c[0]&&a[2]>=c[0]||a[1]<=c[1]&&a[3]>=c[1]?!0:be(a,this.Le,this)):!1};
l.al=function(a){var c=this.H,d=a.slice();d[c]=d[0]+(this.o[c]-this.o[0]);var e;for(e=1;e<c;++e)d[c+e]=a[e];cf(this,this.a,d);this.u()};l.yf=function(a,c,d){if(a){df(this,d,a,0);this.o||(this.o=[]);d=this.o;a=mf(d,a);d[a++]=d[0]+c;var e;c=1;for(e=this.H;c<e;++c)d[a++]=d[c];d.length=a}else cf(this,"XY",null);this.u()};l.bl=function(a){this.o[this.H]=this.o[0]+a;this.u()};function Zm(a){Ze.call(this);this.f=a?a:null;$m(this)}w(Zm,Ze);function an(a){var c=[],d,e;d=0;for(e=a.length;d<e;++d)c.push(a[d].clone());return c}function bn(a){var c,d;if(a.f)for(c=0,d=a.f.length;c<d;++c)Xc(a.f[c],"change",a.u,!1,a)}function $m(a){var c,d;if(a.f)for(c=0,d=a.f.length;c<d;++c)B(a.f[c],"change",a.u,!1,a)}l=Zm.prototype;l.clone=function(){var a=new Zm(null);a.lh(this.f);return a};
l.Ya=function(a,c,d,e){if(e<Td(this.S(),a,c))return e;var f=this.f,g,h;g=0;for(h=f.length;g<h;++g)e=f[g].Ya(a,c,d,e);return e};l.Zb=function(a,c){var d=this.f,e,f;e=0;for(f=d.length;e<f;++e)if(d[e].Zb(a,c))return!0;return!1};l.xd=function(a){Qd(Infinity,Infinity,-Infinity,-Infinity,a);for(var c=this.f,d=0,e=c.length;d<e;++d)$d(a,c[d].S());return a};l.Wf=function(){return an(this.f)};
l.Kd=function(a){this.l!=this.b&&(Qb(this.g),this.j=0,this.l=this.b);if(0>a||0!==this.j&&a<this.j)return this;var c=a.toString();if(this.g.hasOwnProperty(c))return this.g[c];var d=[],e=this.f,f=!1,g,h;g=0;for(h=e.length;g<h;++g){var k=e[g],m=k.Kd(a);d.push(m);m!==k&&(f=!0)}if(f)return a=new Zm(null),bn(a),a.f=d,$m(a),a.u(),this.g[c]=a;this.j=a;return this};l.X=function(){return"GeometryCollection"};l.va=function(a){var c=this.f,d,e;d=0;for(e=c.length;d<e;++d)if(c[d].va(a))return!0;return!1};
l.za=function(){return 0===this.f.length};l.lh=function(a){a=an(a);bn(this);this.f=a;$m(this);this.u()};l.Rb=function(a){var c=this.f,d,e;d=0;for(e=c.length;d<e;++d)c[d].Rb(a);this.u()};l.yc=function(a,c){var d=this.f,e,f;e=0;for(f=d.length;e<f;++e)d[e].yc(a,c);this.u()};l.Z=function(){bn(this);Zm.ca.Z.call(this)};function cn(a,c,d,e,f){var g=NaN,h=NaN,k=(d-c)/e;if(0!==k)if(1==k)g=a[c],h=a[c+1];else if(2==k)g=.5*a[c]+.5*a[c+e],h=.5*a[c+1]+.5*a[c+e+1];else{var h=a[c],k=a[c+1],m=0,g=[0],n;for(n=c+e;n<d;n+=e){var p=a[n],q=a[n+1],m=m+Math.sqrt((p-h)*(p-h)+(q-k)*(q-k));g.push(m);h=p;k=q}d=.5*m;for(var r,h=mb,k=0,m=g.length;k<m;)n=k+m>>1,p=h(d,g[n]),0<p?k=n+1:(m=n,r=!p);r=r?k:~k;0>r?(d=(d-g[-r-2])/(g[-r-1]-g[-r-2]),c+=(-r-2)*e,g=pd(a[c],a[c+e],d),h=pd(a[c+1],a[c+e+1],d)):(g=a[c+r*e],h=a[c+r*e+1])}return f?(f[0]=
g,f[1]=h,f):[g,h]}function dn(a,c,d,e,f,g){if(d==c)return null;if(f<a[c+e-1])return g?(d=a.slice(c,c+e),d[e-1]=f,d):null;if(a[d-1]<f)return g?(d=a.slice(d-e,d),d[e-1]=f,d):null;if(f==a[c+e-1])return a.slice(c,c+e);c/=e;for(d/=e;c<d;)g=c+d>>1,f<a[(g+1)*e-1]?d=g:c=g+1;d=a[c*e-1];if(f==d)return a.slice((c-1)*e,(c-1)*e+e);g=(f-d)/(a[(c+1)*e-1]-d);d=[];var h;for(h=0;h<e-1;++h)d.push(pd(a[(c-1)*e+h],a[c*e+h],g));d.push(f);return d}
function en(a,c,d,e,f,g){var h=0;if(g)return dn(a,h,c[c.length-1],d,e,f);if(e<a[d-1])return f?(a=a.slice(0,d),a[d-1]=e,a):null;if(a[a.length-1]<e)return f?(a=a.slice(a.length-d),a[d-1]=e,a):null;f=0;for(g=c.length;f<g;++f){var k=c[f];if(h!=k){if(e<a[h+d-1])break;if(e<=a[k-1])return dn(a,h,k,d,e,!1);h=k}}return null};function H(a,c){af.call(this);this.c=null;this.v=this.C=this.i=-1;this.ja(a,c)}w(H,af);l=H.prototype;l.ni=function(a){this.o?ib(this.o,a):this.o=a.slice();this.u()};l.clone=function(){var a=new H(null);fn(a,this.a,this.o.slice());return a};l.Ya=function(a,c,d,e){if(e<Td(this.S(),a,c))return e;this.v!=this.b&&(this.C=Math.sqrt(hf(this.o,0,this.o.length,this.H,0)),this.v=this.b);return kf(this.o,0,this.o.length,this.H,this.C,!1,a,c,d,e)};
l.Di=function(a,c){return Af(this.o,0,this.o.length,this.H,a,c)};l.cl=function(a,c){return"XYM"!=this.a&&"XYZM"!=this.a?null:dn(this.o,0,this.o.length,this.H,a,void 0!==c?c:!1)};l.V=function(){return pf(this.o,0,this.o.length,this.H)};l.dl=function(){var a=this.o,c=this.H,d=a[0],e=a[1],f=0,g;for(g=0+c;g<this.o.length;g+=c)var h=a[g],k=a[g+1],f=f+Math.sqrt((h-d)*(h-d)+(k-e)*(k-e)),d=h,e=k;return f};function sm(a){a.i!=a.b&&(a.c=cn(a.o,0,a.o.length,a.H,a.c),a.i=a.b);return a.c}
l.vc=function(a){var c=[];c.length=rf(this.o,0,this.o.length,this.H,a,c,0);a=new H(null);fn(a,"XY",c);return a};l.X=function(){return"LineString"};l.va=function(a){return Bf(this.o,0,this.o.length,this.H,a)};l.ja=function(a,c){a?(df(this,c,a,1),this.o||(this.o=[]),this.o.length=nf(this.o,0,a,this.H),this.u()):fn(this,"XY",null)};function fn(a,c,d){cf(a,c,d);a.u()};function L(a,c){af.call(this);this.c=[];this.i=this.v=-1;this.ja(a,c)}w(L,af);l=L.prototype;l.oi=function(a){this.o?ib(this.o,a.o.slice()):this.o=a.o.slice();this.c.push(this.o.length);this.u()};l.clone=function(){var a=new L(null);gn(a,this.a,this.o.slice(),this.c.slice());return a};l.Ya=function(a,c,d,e){if(e<Td(this.S(),a,c))return e;this.i!=this.b&&(this.v=Math.sqrt(jf(this.o,0,this.c,this.H,0)),this.i=this.b);return lf(this.o,0,this.c,this.H,this.v,!1,a,c,d,e)};
l.fl=function(a,c,d){return"XYM"!=this.a&&"XYZM"!=this.a||0===this.o.length?null:en(this.o,this.c,this.H,a,void 0!==c?c:!1,void 0!==d?d:!1)};l.V=function(){return qf(this.o,0,this.c,this.H)};l.Zi=function(a){if(0>a||this.c.length<=a)return null;var c=new H(null);fn(c,this.a,this.o.slice(0===a?0:this.c[a-1],this.c[a]));return c};l.$c=function(){var a=this.o,c=this.c,d=this.a,e=[],f=0,g,h;g=0;for(h=c.length;g<h;++g){var k=c[g],m=new H(null);fn(m,d,a.slice(f,k));e.push(m);f=k}return e};
function tm(a){var c=[],d=a.o,e=0,f=a.c;a=a.H;var g,h;g=0;for(h=f.length;g<h;++g){var k=f[g],e=cn(d,e,k,a);ib(c,e);e=k}return c}l.vc=function(a){var c=[],d=[],e=this.o,f=this.c,g=this.H,h=0,k=0,m,n;m=0;for(n=f.length;m<n;++m){var p=f[m],k=rf(e,h,p,g,a,c,k);d.push(k);h=p}c.length=k;a=new L(null);gn(a,"XY",c,d);return a};l.X=function(){return"MultiLineString"};l.va=function(a){a:{var c=this.o,d=this.c,e=this.H,f=0,g,h;g=0;for(h=d.length;g<h;++g){if(Bf(c,f,d[g],e,a)){a=!0;break a}f=d[g]}a=!1}return a};
l.ja=function(a,c){if(a){df(this,c,a,2);this.o||(this.o=[]);var d=of(this.o,0,a,this.H,this.c);this.o.length=0===d.length?0:d[d.length-1];this.u()}else gn(this,"XY",null,this.c)};function gn(a,c,d,e){cf(a,c,d);a.c=e;a.u()}function hn(a,c){var d=a.a,e=[],f=[],g,h;g=0;for(h=c.length;g<h;++g){var k=c[g];0===g&&(d=k.a);ib(e,k.o);f.push(e.length)}gn(a,d,e,f)};function jn(a,c){af.call(this);this.ja(a,c)}w(jn,af);l=jn.prototype;l.ri=function(a){this.o?ib(this.o,a.o):this.o=a.o.slice();this.u()};l.clone=function(){var a=new jn(null);cf(a,this.a,this.o.slice());a.u();return a};l.Ya=function(a,c,d,e){if(e<Td(this.S(),a,c))return e;var f=this.o,g=this.H,h,k,m;h=0;for(k=f.length;h<k;h+=g)if(m=Sa(a,c,f[h],f[h+1]),m<e){e=m;for(m=0;m<g;++m)d[m]=f[h+m];d.length=g}return e};l.V=function(){return pf(this.o,0,this.o.length,this.H)};
l.jj=function(a){var c=this.o?this.o.length/this.H:0;if(0>a||c<=a)return null;c=new C(null);vf(c,this.a,this.o.slice(a*this.H,(a+1)*this.H));return c};l.ae=function(){var a=this.o,c=this.a,d=this.H,e=[],f,g;f=0;for(g=a.length;f<g;f+=d){var h=new C(null);vf(h,c,a.slice(f,f+d));e.push(h)}return e};l.X=function(){return"MultiPoint"};l.va=function(a){var c=this.o,d=this.H,e,f,g,h;e=0;for(f=c.length;e<f;e+=d)if(g=c[e],h=c[e+1],Vd(a,g,h))return!0;return!1};
l.ja=function(a,c){a?(df(this,c,a,1),this.o||(this.o=[]),this.o.length=nf(this.o,0,a,this.H)):cf(this,"XY",null);this.u()};function N(a,c){af.call(this);this.c=[];this.v=-1;this.C=null;this.U=this.O=this.J=-1;this.i=null;this.ja(a,c)}w(N,af);l=N.prototype;l.si=function(a){if(this.o){var c=this.o.length;ib(this.o,a.o);a=a.c.slice();var d,e;d=0;for(e=a.length;d<e;++d)a[d]+=c}else this.o=a.o.slice(),a=a.c.slice(),this.c.push();this.c.push(a);this.u()};l.clone=function(){var a=new N(null),c=Ub(this.c);kn(a,this.a,this.o.slice(),c);return a};
l.Ya=function(a,c,d,e){if(e<Td(this.S(),a,c))return e;if(this.O!=this.b){var f=this.c,g=0,h=0,k,m;k=0;for(m=f.length;k<m;++k)var n=f[k],h=jf(this.o,g,n,this.H,h),g=n[n.length-1];this.J=Math.sqrt(h);this.O=this.b}f=um(this);g=this.c;h=this.H;k=this.J;m=0;var n=[NaN,NaN],p,q;p=0;for(q=g.length;p<q;++p){var r=g[p];e=lf(f,m,r,h,k,!0,a,c,d,e,n);m=r[r.length-1]}return e};
l.Zb=function(a,c){var d;a:{d=um(this);var e=this.c,f=0;if(0!==e.length){var g,h;g=0;for(h=e.length;g<h;++g){var k=e[g];if(yf(d,f,k,this.H,a,c)){d=!0;break a}f=k[k.length-1]}}d=!1}return d};l.gl=function(){var a=um(this),c=this.c,d=0,e=0,f,g;f=0;for(g=c.length;f<g;++f)var h=c[f],e=e+ff(a,d,h,this.H),d=h[h.length-1];return e};
l.V=function(a){var c;void 0!==a?(c=um(this).slice(),Gf(c,this.c,this.H,a)):c=this.o;a=c;c=this.c;var d=this.H,e=0,f=[],g=0,h,k;h=0;for(k=c.length;h<k;++h){var m=c[h];f[g++]=qf(a,e,m,d,f[g]);e=m[m.length-1]}f.length=g;return f};
function vm(a){if(a.v!=a.b){var c=a.o,d=a.c,e=a.H,f=0,g=[],h,k,m=Nd();h=0;for(k=d.length;h<k;++h){var n=d[h],m=ae(Qd(Infinity,Infinity,-Infinity,-Infinity,void 0),c,f,n[0],e);g.push((m[0]+m[2])/2,(m[1]+m[3])/2);f=n[n.length-1]}c=um(a);d=a.c;e=a.H;f=0;h=[];k=0;for(m=d.length;k<m;++k)n=d[k],h=zf(c,f,n,e,g,2*k,h),f=n[n.length-1];a.C=h;a.v=a.b}return a.C}l.Wi=function(){var a=new jn(null),c=vm(this).slice();cf(a,"XY",c);a.u();return a};
function um(a){if(a.U!=a.b){var c=a.o,d;a:{d=a.c;var e,f;e=0;for(f=d.length;e<f;++e)if(!Ef(c,d[e],a.H,void 0)){d=!1;break a}d=!0}d?a.i=c:(a.i=c.slice(),a.i.length=Gf(a.i,a.c,a.H));a.U=a.b}return a.i}l.vc=function(a){var c=[],d=[],e=this.o,f=this.c,g=this.H;a=Math.sqrt(a);var h=0,k=0,m,n;m=0;for(n=f.length;m<n;++m){var p=f[m],q=[],k=sf(e,h,p,g,a,c,k,q);d.push(q);h=p[p.length-1]}c.length=k;e=new N(null);kn(e,"XY",c,d);return e};
l.lj=function(a){if(0>a||this.c.length<=a)return null;var c;0===a?c=0:(c=this.c[a-1],c=c[c.length-1]);a=this.c[a].slice();var d=a[a.length-1];if(0!==c){var e,f;e=0;for(f=a.length;e<f;++e)a[e]-=c}e=new D(null);Hf(e,this.a,this.o.slice(c,d),a);return e};l.Id=function(){var a=this.a,c=this.o,d=this.c,e=[],f=0,g,h,k,m;g=0;for(h=d.length;g<h;++g){var n=d[g].slice(),p=n[n.length-1];if(0!==f)for(k=0,m=n.length;k<m;++k)n[k]-=f;k=new D(null);Hf(k,a,c.slice(f,p),n);e.push(k);f=p}return e};l.X=function(){return"MultiPolygon"};
l.va=function(a){a:{var c=um(this),d=this.c,e=this.H,f=0,g,h;g=0;for(h=d.length;g<h;++g){var k=d[g];if(Cf(c,f,k,e,a)){a=!0;break a}f=k[k.length-1]}a=!1}return a};l.ja=function(a,c){if(a){df(this,c,a,3);this.o||(this.o=[]);var d=this.o,e=this.H,f=this.c,g=0,f=f?f:[],h=0,k,m;k=0;for(m=a.length;k<m;++k)g=of(d,g,a[k],e,f[h]),f[h++]=g,g=g[g.length-1];f.length=h;0===f.length?this.o.length=0:(d=f[f.length-1],this.o.length=0===d.length?0:d[d.length-1]);this.u()}else kn(this,"XY",null,this.c)};
function kn(a,c,d,e){cf(a,c,d);a.c=e;a.u()}function ln(a,c){var d=a.a,e=[],f=[],g,h,k;g=0;for(h=c.length;g<h;++g){var m=c[g];0===g&&(d=m.a);var n=e.length;k=m.c;var p,q;p=0;for(q=k.length;p<q;++p)k[p]+=n;ib(e,m.o);f.push(k)}kn(a,d,e,f)};function mn(a,c){return v(a)-v(c)}function nn(a,c){var d=.5*a/c;return d*d}function on(a,c,d,e,f,g){var h=!1,k,m;if(k=d.j)m=k.gd(),2==m||3==m?k.Bf(f,g):(0==m&&k.load(),k.bf(f,g),h=!0);if(f=(0,d.f)(c))e=f.Kd(e),(0,pn[e.X()])(a,e,d,c);return h}
var pn={Point:function(a,c,d,e){var f=d.j;if(f){if(2!=f.gd())return;var g=a.b(d.b,"Image");g.fb(f);g.sb(c,e)}if(f=d.a)a=a.b(d.b,"Text"),a.Na(f),a.tb(c.V(),0,2,2,c,e)},LineString:function(a,c,d,e){var f=d.c;if(f){var g=a.b(d.b,"LineString");g.Ma(null,f);g.Bb(c,e)}if(f=d.a)a=a.b(d.b,"Text"),a.Na(f),a.tb(sm(c),0,2,2,c,e)},Polygon:function(a,c,d,e){var f=d.g,g=d.c;if(f||g){var h=a.b(d.b,"Polygon");h.Ma(f,g);h.tc(c,e)}if(f=d.a)a=a.b(d.b,"Text"),a.Na(f),a.tb(Jf(c),0,2,2,c,e)},MultiPoint:function(a,c,d,
e){var f=d.j;if(f){if(2!=f.gd())return;var g=a.b(d.b,"Image");g.fb(f);g.rb(c,e)}if(f=d.a)a=a.b(d.b,"Text"),a.Na(f),d=c.o,a.tb(d,0,d.length,c.H,c,e)},MultiLineString:function(a,c,d,e){var f=d.c;if(f){var g=a.b(d.b,"LineString");g.Ma(null,f);g.rc(c,e)}if(f=d.a)a=a.b(d.b,"Text"),a.Na(f),d=tm(c),a.tb(d,0,d.length,2,c,e)},MultiPolygon:function(a,c,d,e){var f=d.g,g=d.c;if(g||f){var h=a.b(d.b,"Polygon");h.Ma(f,g);h.sc(c,e)}if(f=d.a)a=a.b(d.b,"Text"),a.Na(f),d=vm(c),a.tb(d,0,d.length,2,c,e)},GeometryCollection:function(a,
c,d,e){c=c.f;var f,g;f=0;for(g=c.length;f<g;++f)(0,pn[c[f].X()])(a,c[f],d,e)},Circle:function(a,c,d,e){var f=d.g,g=d.c;if(f||g){var h=a.b(d.b,"Polygon");h.Ma(f,g);h.qc(c,e)}if(f=d.a)a=a.b(d.b,"Text"),a.Na(f),a.tb(c.cd(),0,2,2,c,e)}};function qn(a,c,d,e,f,g){this.f=void 0!==g?g:null;hk.call(this,a,c,d,void 0!==g?0:2,e);this.c=f;this.a=null}w(qn,hk);qn.prototype.getError=function(){return this.a};qn.prototype.i=function(a){a?(this.a=a,this.state=3):this.state=2;ik(this)};qn.prototype.load=function(){0==this.state&&(this.state=1,ik(this),this.f(qa(this.i,this)))};qn.prototype.b=function(){return this.c};function rn(a){Ch.call(this,{attributions:a.attributions,extent:a.extent,logo:a.logo,projection:a.projection,state:a.state});this.B=void 0!==a.resolutions?a.resolutions:null}w(rn,Ch);function sn(a,c){if(a.B){var d=ub(a.B,c,0);c=a.B[d]}return c}rn.prototype.l=function(a){a=a.target;switch(a.state){case 1:this.s(new tn(un,a));break;case 2:this.s(new tn(vn,a));break;case 3:this.s(new tn(wn,a))}};function xn(a,c){a.b().src=c}function tn(a,c){uc.call(this,a);this.image=c}w(tn,uc);
var un="imageloadstart",vn="imageloadend",wn="imageloaderror";function yn(a){rn.call(this,{attributions:a.attributions,logo:a.logo,projection:a.projection,resolutions:a.resolutions,state:void 0!==a.state?a.state:void 0});this.$=a.canvasFunction;this.J=null;this.Y=0;this.da=void 0!==a.ratio?a.ratio:1.5}w(yn,rn);yn.prototype.ec=function(a,c,d,e){c=sn(this,c);var f=this.J;if(f&&this.Y==this.b&&f.ba()==c&&f.g==d&&Wd(f.S(),a))return f;a=a.slice();ne(a,this.da);(e=this.$(a,c,d,[le(a)/c*d,ie(a)/c*d],e))&&(f=new qn(a,c,d,this.j,e));this.J=f;this.Y=this.b;return f};function P(a){hd.call(this);this.qa=void 0;this.a="geometry";this.g=null;this.c=void 0;this.f=null;B(this,jd(this.a),this.Nd,!1,this);void 0!==a&&(a instanceof Ze||!a?this.Aa(a):this.I(a))}w(P,hd);l=P.prototype;l.clone=function(){var a=new P(this.R());a.Fc(this.a);var c=this.W();c&&a.Aa(c.clone());(c=this.g)&&a.ef(c);return a};l.W=function(){return this.get(this.a)};l.Ca=function(){return this.qa};l.Ti=function(){return this.a};l.Bk=function(){return this.g};l.Ck=function(){return this.c};l.Dk=function(){this.u()};
l.Nd=function(){this.f&&(Yc(this.f),this.f=null);var a=this.W();a&&(this.f=B(a,"change",this.Dk,!1,this));this.u()};l.Aa=function(a){this.set(this.a,a)};l.ef=function(a){this.c=(this.g=a)?zn(a):void 0;this.u()};l.Pb=function(a){this.qa=a;this.u()};l.Fc=function(a){Xc(this,jd(this.a),this.Nd,!1,this);this.a=a;B(this,jd(this.a),this.Nd,!1,this);this.Nd()};function zn(a){if(!ka(a)){var c;c=ga(a)?a:[a];a=function(){return c}}return a};function An(a){a.prototype.then=a.prototype.then;a.prototype.$goog_Thenable=!0}function Bn(a){if(!a)return!1;try{return!!a.$goog_Thenable}catch(c){return!1}};function Cn(a,c,d){this.f=d;this.c=a;this.g=c;this.a=0;this.b=null}Cn.prototype.get=function(){var a;0<this.a?(this.a--,a=this.b,this.b=a.next,a.next=null):a=this.c();return a};function Dn(a,c){a.g(c);a.a<a.f&&(a.a++,c.next=a.b,a.b=c)};function En(){this.a=this.b=null}var Gn=new Cn(function(){return new Fn},function(a){a.reset()},100);En.prototype.add=function(a,c){var d=Gn.get();d.set(a,c);this.a?this.a.next=d:this.b=d;this.a=d};En.prototype.remove=function(){var a=null;this.b&&(a=this.b,this.b=this.b.next,this.b||(this.a=null),a.next=null);return a};function Fn(){this.next=this.a=this.b=null}Fn.prototype.set=function(a,c){this.b=a;this.a=c;this.next=null};Fn.prototype.reset=function(){this.next=this.a=this.b=null};function Hn(a,c){In||Jn();Kn||(In(),Kn=!0);Ln.add(a,c)}var In;function Jn(){if(ba.Promise&&ba.Promise.resolve){var a=ba.Promise.resolve(void 0);In=function(){a.then(Mn)}}else In=function(){oi(Mn)}}var Kn=!1,Ln=new En;function Mn(){for(var a=null;a=Ln.remove();){try{a.b.call(a.a)}catch(c){ni(c)}Dn(Gn,a)}Kn=!1};function Nn(a,c){this.b=On;this.i=void 0;this.f=this.a=this.c=null;this.g=this.j=!1;if(a!=da)try{var d=this;a.call(c,function(a){Pn(d,Qn,a)},function(a){Pn(d,Rn,a)})}catch(e){Pn(this,Rn,e)}}var On=0,Qn=2,Rn=3;function Sn(){this.next=this.c=this.a=this.f=this.b=null;this.g=!1}Sn.prototype.reset=function(){this.c=this.a=this.f=this.b=null;this.g=!1};var Tn=new Cn(function(){return new Sn},function(a){a.reset()},100);function Un(a,c,d){var e=Tn.get();e.f=a;e.a=c;e.c=d;return e}
Nn.prototype.then=function(a,c,d){return Vn(this,ka(a)?a:null,ka(c)?c:null,d)};An(Nn);Nn.prototype.cancel=function(a){this.b==On&&Hn(function(){var c=new Wn(a);Xn(this,c)},this)};function Xn(a,c){if(a.b==On)if(a.c){var d=a.c;if(d.a){for(var e=0,f=null,g=null,h=d.a;h&&(h.g||(e++,h.b==a&&(f=h),!(f&&1<e)));h=h.next)f||(g=h);f&&(d.b==On&&1==e?Xn(d,c):(g?(e=g,e.next==d.f&&(d.f=e),e.next=e.next.next):Yn(d),Zn(d,f,Rn,c)))}a.c=null}else Pn(a,Rn,c)}
function $n(a,c){a.a||a.b!=Qn&&a.b!=Rn||ao(a);a.f?a.f.next=c:a.a=c;a.f=c}function Vn(a,c,d,e){var f=Un(null,null,null);f.b=new Nn(function(a,h){f.f=c?function(d){try{var f=c.call(e,d);a(f)}catch(n){h(n)}}:a;f.a=d?function(c){try{var f=d.call(e,c);!ca(f)&&c instanceof Wn?h(c):a(f)}catch(n){h(n)}}:h});f.b.c=a;$n(a,f);return f.b}Nn.prototype.D=function(a){this.b=On;Pn(this,Qn,a)};Nn.prototype.B=function(a){this.b=On;Pn(this,Rn,a)};
function Pn(a,c,d){if(a.b==On){a==d&&(c=Rn,d=new TypeError("Promise cannot resolve to itself"));a.b=1;var e;a:{var f=d,g=a.D,h=a.B;if(f instanceof Nn)$n(f,Un(g||da,h||null,a)),e=!0;else if(Bn(f))f.then(g,h,a),e=!0;else{if(la(f))try{var k=f.then;if(ka(k)){bo(f,k,g,h,a);e=!0;break a}}catch(m){h.call(a,m);e=!0;break a}e=!1}}e||(a.i=d,a.b=c,a.c=null,ao(a),c!=Rn||d instanceof Wn||co(a,d))}}
function bo(a,c,d,e,f){function g(a){k||(k=!0,e.call(f,a))}function h(a){k||(k=!0,d.call(f,a))}var k=!1;try{c.call(a,h,g)}catch(m){g(m)}}function ao(a){a.j||(a.j=!0,Hn(a.l,a))}function Yn(a){var c=null;a.a&&(c=a.a,a.a=c.next,c.next=null);a.a||(a.f=null);return c}Nn.prototype.l=function(){for(var a=null;a=Yn(this);)Zn(this,a,this.b,this.i);this.j=!1};
function Zn(a,c,d,e){if(d==Rn&&c.a&&!c.g)for(;a&&a.g;a=a.c)a.g=!1;if(c.b)c.b.c=null,eo(c,d,e);else try{c.g?c.f.call(c.c):eo(c,d,e)}catch(f){fo.call(null,f)}Dn(Tn,c)}function eo(a,c,d){c==Qn?a.f.call(a.c,d):a.a&&a.a.call(a.c,d)}function co(a,c){a.g=!0;Hn(function(){a.g&&fo.call(null,c)})}var fo=ni;function Wn(a){xa.call(this,a)}w(Wn,xa);Wn.prototype.name="cancel";function go(a,c,d){if(ka(a))d&&(a=qa(a,d));else if(a&&"function"==typeof a.handleEvent)a=qa(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<c?-1:ba.setTimeout(a,c||0)};var ho=ba.JSON.parse,io=ba.JSON.stringify;function jo(){}jo.prototype.b=null;function ko(a){var c;(c=a.b)||(c={},lo(a)&&(c[0]=!0,c[1]=!0),c=a.b=c);return c};var mo;function no(){}w(no,jo);function oo(a){return(a=lo(a))?new ActiveXObject(a):new XMLHttpRequest}function lo(a){if(!a.a&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var c=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],d=0;d<c.length;d++){var e=c[d];try{return new ActiveXObject(e),a.a=e}catch(f){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed");}return a.a}mo=new no;var po=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/;function qo(a,c){if(a)for(var d=a.split("&"),e=0;e<d.length;e++){var f=d[e].indexOf("="),g=null,h=null;0<=f?(g=d[e].substring(0,f),h=d[e].substring(f+1)):g=d[e];c(g,h?decodeURIComponent(h.replace(/\+/g," ")):"")}}
function ro(a){if(a[1]){var c=a[0],d=c.indexOf("#");0<=d&&(a.push(c.substr(d)),a[0]=c=c.substr(0,d));d=c.indexOf("?");0>d?a[1]="?":d==c.length-1&&(a[1]=void 0)}return a.join("")}function so(a,c,d){if(ga(c))for(var e=0;e<c.length;e++)so(a,String(c[e]),d);else null!=c&&d.push("&",a,""===c?"":"=",encodeURIComponent(String(c)))}function to(a,c){for(var d in c)so(d,c[d],a);return a};function uo(a){bd.call(this);this.J=new si;this.l=a||null;this.b=!1;this.i=this.ha=null;this.g=this.U=this.A="";this.a=this.B=this.f=this.D=!1;this.j=0;this.c=null;this.v=vo;this.C=this.$=!1}w(uo,bd);var vo="",wo=/^https?$/i,xo=["POST","PUT"];
function yo(a,c){if(a.ha)throw Error("[goog.net.XhrIo] Object is active with another request="+a.A+"; newUri="+c);a.A=c;a.g="";a.U="GET";a.D=!1;a.b=!0;a.ha=a.l?oo(a.l):oo(mo);a.i=a.l?ko(a.l):ko(mo);a.ha.onreadystatechange=qa(a.O,a);try{a.B=!0,a.ha.open("GET",String(c),!0),a.B=!1}catch(g){zo(a,g);return}var d=a.J.clone(),e=cb(d.P(),Ao),f=ba.FormData&&!1;!(0<=Ya(xo,"GET"))||e||f||d.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");d.forEach(function(a,c){this.ha.setRequestHeader(c,
a)},a);a.v&&(a.ha.responseType=a.v);"withCredentials"in a.ha&&(a.ha.withCredentials=a.$);try{Bo(a),0<a.j&&(a.C=Co(a.ha),a.C?(a.ha.timeout=a.j,a.ha.ontimeout=qa(a.lc,a)):a.c=go(a.lc,a.j,a)),a.f=!0,a.ha.send(""),a.f=!1}catch(g){zo(a,g)}}function Co(a){return Yb&&ic(9)&&ja(a.timeout)&&ca(a.ontimeout)}function Ao(a){return"content-type"==a.toLowerCase()}
uo.prototype.lc=function(){"undefined"!=typeof aa&&this.ha&&(this.g="Timed out after "+this.j+"ms, aborting",this.s("timeout"),this.ha&&this.b&&(this.b=!1,this.a=!0,this.ha.abort(),this.a=!1,this.s("complete"),this.s("abort"),Do(this)))};function zo(a,c){a.b=!1;a.ha&&(a.a=!0,a.ha.abort(),a.a=!1);a.g=c;Eo(a);Do(a)}function Eo(a){a.D||(a.D=!0,a.s("complete"),a.s("error"))}uo.prototype.Z=function(){this.ha&&(this.b&&(this.b=!1,this.a=!0,this.ha.abort(),this.a=!1),Do(this,!0));uo.ca.Z.call(this)};
uo.prototype.O=function(){this.ea||(this.B||this.f||this.a?Fo(this):this.Y())};uo.prototype.Y=function(){Fo(this)};function Fo(a){if(a.b&&"undefined"!=typeof aa&&(!a.i[1]||4!=Go(a)||2!=Ho(a)))if(a.f&&4==Go(a))go(a.O,0,a);else if(a.s("readystatechange"),4==Go(a)){a.b=!1;try{if(Io(a))a.s("complete"),a.s("success");else{var c;try{c=2<Go(a)?a.ha.statusText:""}catch(d){c=""}a.g=c+" ["+Ho(a)+"]";Eo(a)}}finally{Do(a)}}}
function Do(a,c){if(a.ha){Bo(a);var d=a.ha,e=a.i[0]?da:null;a.ha=null;a.i=null;c||a.s("ready");try{d.onreadystatechange=e}catch(f){}}}function Bo(a){a.ha&&a.C&&(a.ha.ontimeout=null);ja(a.c)&&(ba.clearTimeout(a.c),a.c=null)}
function Io(a){var c=Ho(a),d;a:switch(c){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:d=!0;break a;default:d=!1}if(!d){if(c=0===c)a=String(a.A).match(po)[1]||null,!a&&ba.self&&ba.self.location&&(a=ba.self.location.protocol,a=a.substr(0,a.length-1)),c=!wo.test(a?a.toLowerCase():"");d=c}return d}function Go(a){return a.ha?a.ha.readyState:0}function Ho(a){try{return 2<Go(a)?a.ha.status:-1}catch(c){return-1}}function Jo(a){try{return a.ha?a.ha.responseText:""}catch(c){return""}};function Ko(){if(!Yb)return!1;try{return new ActiveXObject("MSXML2.DOMDocument"),!0}catch(a){return!1}}var Lo=Yb&&Ko();function Mo(a){var c=a.xml;if(c)return c;if("undefined"!=typeof XMLSerializer)return(new XMLSerializer).serializeToString(a);throw Error("Your browser does not support serializing XML documents");};var No;a:if(document.implementation&&document.implementation.createDocument)No=document.implementation.createDocument("","",null);else{if(Lo){var Oo=new ActiveXObject("MSXML2.DOMDocument");if(Oo){Oo.resolveExternals=!1;Oo.validateOnParse=!1;try{Oo.setProperty("ProhibitDTD",!0),Oo.setProperty("MaxXMLSize",2048),Oo.setProperty("MaxElementDepth",256)}catch(a){}}if(Oo){No=Oo;break a}}throw Error("Your browser does not support creating new documents");}var Po=No;
function Qo(a,c){return Po.createElementNS(a,c)}function Ro(a,c){a||(a="");return Po.createNode(1,c,a)}var So=document.implementation&&document.implementation.createDocument?Qo:Ro;function To(a,c){return Uo(a,c,[]).join("")}function Uo(a,c,d){if(4==a.nodeType||3==a.nodeType)c?d.push(String(a.nodeValue).replace(/(\r\n|\r|\n)/g,"")):d.push(a.nodeValue);else for(a=a.firstChild;a;a=a.nextSibling)Uo(a,c,d);return d}function Vo(a){return a.localName}
function Wo(a){var c=a.localName;return void 0!==c?c:a.baseName}var Xo=Yb?Wo:Vo;function Yo(a){return a instanceof Document}function Zo(a){return la(a)&&9==a.nodeType}var $o=Yb?Zo:Yo;function ap(a){return a instanceof Node}function bp(a){return la(a)&&void 0!==a.nodeType}var cp=Yb?bp:ap;function dp(a,c,d){return a.getAttributeNS(c,d)||""}function ep(a,c,d){var e="";a=fp(a,c,d);void 0!==a&&(e=a.nodeValue);return e}var gp=document.implementation&&document.implementation.createDocument?dp:ep;
function hp(a,c,d){return a.getAttributeNodeNS(c,d)}function ip(a,c,d){var e=null;a=a.attributes;for(var f,g,h=0,k=a.length;h<k;++h)if(f=a[h],f.namespaceURI==c&&(g=f.prefix?f.prefix+":"+d:d,g==f.nodeName)){e=f;break}return e}var fp=document.implementation&&document.implementation.createDocument?hp:ip;function jp(a,c,d,e){a.setAttributeNS(c,d,e)}function kp(a,c,d,e){c?(c=a.ownerDocument.createNode(2,d,c),c.nodeValue=e,a.setAttributeNode(c)):a.setAttribute(d,e)}
var lp=document.implementation&&document.implementation.createDocument?jp:kp;function mp(a){return(new DOMParser).parseFromString(a,"application/xml")}function np(a,c){return function(d,e){var f=a.call(c,d,e);void 0!==f&&ib(e[e.length-1],f)}}function op(a,c){return function(d,e){var f=a.call(void 0!==c?c:this,d,e);void 0!==f&&e[e.length-1].push(f)}}function pp(a,c){return function(d,e){var f=a.call(void 0!==c?c:this,d,e);void 0!==f&&(e[e.length-1]=f)}}
function qp(a){return function(c,d){var e=a.call(this,c,d);void 0!==e&&Sb(d[d.length-1],c.localName).push(e)}}function Q(a,c){return function(d,e){var f=a.call(this,d,e);void 0!==f&&(e[e.length-1][void 0!==c?c:d.localName]=f)}}function R(a,c){return function(d,e,f){a.call(void 0!==c?c:this,d,e,f);f[f.length-1].node.appendChild(d)}}function rp(a){var c,d;return function(e,f,g){if(void 0===c){c={};var h={};h[e.localName]=a;c[e.namespaceURI]=h;d=sp(e.localName)}tp(c,d,f,g)}}
function sp(a,c){return function(d,e,f){d=e[e.length-1].node;e=a;void 0===e&&(e=f);f=c;void 0===c&&(f=d.namespaceURI);return So(f,e)}}var up=sp();function vp(a,c){for(var d=c.length,e=Array(d),f=0;f<d;++f)e[f]=a[c[f]];return e}function S(a,c,d){d=void 0!==d?d:{};var e,f;e=0;for(f=a.length;e<f;++e)d[a[e]]=c;return d}function wp(a,c,d,e){for(c=c.firstElementChild;c;c=c.nextElementSibling){var f=a[c.namespaceURI];void 0!==f&&(f=f[c.localName],void 0!==f&&f.call(e,c,d))}}
function T(a,c,d,e,f){e.push(a);wp(c,d,e,f);return e.pop()}function tp(a,c,d,e,f,g){for(var h=(void 0!==f?f:d).length,k,m,n=0;n<h;++n)k=d[n],void 0!==k&&(m=c.call(g,k,e,void 0!==f?f[n]:void 0),void 0!==m&&a[m.namespaceURI][m.localName].call(g,m,k,e))}function xp(a,c,d,e,f,g,h){f.push(a);tp(c,d,e,f,g,h);f.pop()};function yp(a,c,d){return function(e,f,g){var h=new uo;h.v="text";B(h,"complete",function(a){a=a.target;if(Io(a)){var e=c.X(),f;if("json"==e)f=Jo(a);else if("text"==e)f=Jo(a);else if("xml"==e){if(!Yb)try{f=a.ha?a.ha.responseXML:null}catch(h){f=null}f||(f=mp(Jo(a)))}f&&(f=c.ta(f,{featureProjection:g}),d.call(this,f))}tc(a)},!1,this);ka(a)?yo(h,a(e,f,g)):yo(h,a)}}function zp(a,c){return yp(a,c,function(a){this.Qb(a)})};function Ap(){return[[-Infinity,-Infinity,Infinity,Infinity]]};var Bp,Cp;
(function(){var a={kb:{}};(function(){function c(a,d){if(!(this instanceof c))return new c(a,d);this.Ge=Math.max(4,a||9);this.Lf=Math.max(2,Math.ceil(.4*this.Ge));d&&this.gi(d);this.clear()}function d(a,c){a.bbox=e(a,0,a.children.length,c)}function e(a,c,d,e){for(var g=[Infinity,Infinity,-Infinity,-Infinity],h;c<d;c++)h=a.children[c],f(g,a.Ga?e(h):h.bbox);return g}function f(a,c){a[0]=Math.min(a[0],c[0]);a[1]=Math.min(a[1],c[1]);a[2]=Math.max(a[2],c[2]);a[3]=Math.max(a[3],c[3])}function g(a,c){return a.bbox[0]-
c.bbox[0]}function h(a,c){return a.bbox[1]-c.bbox[1]}function k(a){return(a[2]-a[0])*(a[3]-a[1])}function m(a){return a[2]-a[0]+(a[3]-a[1])}function n(a,c){return a[0]<=c[0]&&a[1]<=c[1]&&c[2]<=a[2]&&c[3]<=a[3]}function p(a,c){return c[0]<=a[2]&&c[1]<=a[3]&&c[2]>=a[0]&&c[3]>=a[1]}function q(a,c,d,e,f){for(var g=[c,d],h;g.length;)d=g.pop(),c=g.pop(),d-c<=e||(h=c+Math.ceil((d-c)/e/2)*e,r(a,c,d,h,f),g.push(c,h,h,d))}function r(a,c,d,e,f){for(var g,h,k,m,n;d>c;){600<d-c&&(g=d-c+1,h=e-c+1,k=Math.log(g),
m=.5*Math.exp(2*k/3),n=.5*Math.sqrt(k*m*(g-m)/g)*(0>h-g/2?-1:1),k=Math.max(c,Math.floor(e-h*m/g+n)),h=Math.min(d,Math.floor(e+(g-h)*m/g+n)),r(a,k,h,e,f));g=a[e];h=c;m=d;u(a,c,e);for(0<f(a[d],g)&&u(a,c,d);h<m;){u(a,h,m);h++;for(m--;0>f(a[h],g);)h++;for(;0<f(a[m],g);)m--}0===f(a[c],g)?u(a,c,m):(m++,u(a,m,d));m<=e&&(c=m+1);e<=m&&(d=m-1)}}function u(a,c,d){var e=a[c];a[c]=a[d];a[d]=e}c.prototype={all:function(){return this.Gf(this.data,[])},search:function(a){var c=this.data,d=[],e=this.Oa;if(!p(a,c.bbox))return d;
for(var f=[],g,h,k,m;c;){g=0;for(h=c.children.length;g<h;g++)k=c.children[g],m=c.Ga?e(k):k.bbox,p(a,m)&&(c.Ga?d.push(k):n(a,m)?this.Gf(k,d):f.push(k));c=f.pop()}return d},load:function(a){if(!a||!a.length)return this;if(a.length<this.Lf){for(var c=0,d=a.length;c<d;c++)this.ra(a[c]);return this}a=this.If(a.slice(),0,a.length-1,0);this.data.children.length?this.data.height===a.height?this.Nf(this.data,a):(this.data.height<a.height&&(c=this.data,this.data=a,a=c),this.Kf(a,this.data.height-a.height-1,
!0)):this.data=a;return this},ra:function(a){a&&this.Kf(a,this.data.height-1);return this},clear:function(){this.data={children:[],height:1,bbox:[Infinity,Infinity,-Infinity,-Infinity],Ga:!0};return this},remove:function(a){if(!a)return this;for(var c=this.data,d=this.Oa(a),e=[],f=[],g,h,k,m;c||e.length;){c||(c=e.pop(),h=e[e.length-1],g=f.pop(),m=!0);if(c.Ga&&(k=c.children.indexOf(a),-1!==k)){c.children.splice(k,1);e.push(c);this.ei(e);break}m||c.Ga||!n(c.bbox,d)?h?(g++,c=h.children[g],m=!1):c=null:
(e.push(c),f.push(g),g=0,h=c,c=c.children[0])}return this},Oa:function(a){return a},Je:function(a,c){return a[0]-c[0]},Ke:function(a,c){return a[1]-c[1]},toJSON:function(){return this.data},Gf:function(a,c){for(var d=[];a;)a.Ga?c.push.apply(c,a.children):d.push.apply(d,a.children),a=d.pop();return c},If:function(a,c,e,f){var g=e-c+1,h=this.Ge,k;if(g<=h)return k={children:a.slice(c,e+1),height:1,bbox:null,Ga:!0},d(k,this.Oa),k;f||(f=Math.ceil(Math.log(g)/Math.log(h)),h=Math.ceil(g/Math.pow(h,f-1)));
k={children:[],height:f,bbox:null};var g=Math.ceil(g/h),h=g*Math.ceil(Math.sqrt(h)),m,n,p;for(q(a,c,e,h,this.Je);c<=e;c+=h)for(n=Math.min(c+h-1,e),q(a,c,n,g,this.Ke),m=c;m<=n;m+=g)p=Math.min(m+g-1,n),k.children.push(this.If(a,m,p,f-1));d(k,this.Oa);return k},di:function(a,c,d,e){for(var f,g,h,m,n,p,q,r;;){e.push(c);if(c.Ga||e.length-1===d)break;q=r=Infinity;f=0;for(g=c.children.length;f<g;f++)h=c.children[f],n=k(h.bbox),p=h.bbox,p=(Math.max(p[2],a[2])-Math.min(p[0],a[0]))*(Math.max(p[3],a[3])-Math.min(p[1],
a[1]))-n,p<r?(r=p,q=n<q?n:q,m=h):p===r&&n<q&&(q=n,m=h);c=m}return c},Kf:function(a,c,d){var e=this.Oa;d=d?a.bbox:e(a);var e=[],g=this.di(d,this.data,c,e);g.children.push(a);for(f(g.bbox,d);0<=c;)if(e[c].children.length>this.Ge)this.ji(e,c),c--;else break;this.ai(d,e,c)},ji:function(a,c){var e=a[c],f=e.children.length,g=this.Lf;this.bi(e,g,f);f={children:e.children.splice(this.ci(e,g,f)),height:e.height};e.Ga&&(f.Ga=!0);d(e,this.Oa);d(f,this.Oa);c?a[c-1].children.push(f):this.Nf(e,f)},Nf:function(a,
c){this.data={children:[a,c],height:a.height+1};d(this.data,this.Oa)},ci:function(a,c,d){var f,g,h,m,n,p,q;n=p=Infinity;for(f=c;f<=d-c;f++)g=e(a,0,f,this.Oa),h=e(a,f,d,this.Oa),m=Math.max(0,Math.min(g[2],h[2])-Math.max(g[0],h[0]))*Math.max(0,Math.min(g[3],h[3])-Math.max(g[1],h[1])),g=k(g)+k(h),m<n?(n=m,q=f,p=g<p?g:p):m===n&&g<p&&(p=g,q=f);return q},bi:function(a,c,d){var e=a.Ga?this.Je:g,f=a.Ga?this.Ke:h,k=this.Hf(a,c,d,e);c=this.Hf(a,c,d,f);k<c&&a.children.sort(e)},Hf:function(a,c,d,g){a.children.sort(g);
g=this.Oa;var h=e(a,0,c,g),k=e(a,d-c,d,g),n=m(h)+m(k),p,q;for(p=c;p<d-c;p++)q=a.children[p],f(h,a.Ga?g(q):q.bbox),n+=m(h);for(p=d-c-1;p>=c;p--)q=a.children[p],f(k,a.Ga?g(q):q.bbox),n+=m(k);return n},ai:function(a,c,d){for(;0<=d;d--)f(c[d].bbox,a)},ei:function(a){for(var c=a.length-1,e;0<=c;c--)0===a[c].children.length?0<c?(e=a[c-1].children,e.splice(e.indexOf(a[c]),1)):this.clear():d(a[c],this.Oa)},gi:function(a){var c=["return a"," - b",";"];this.Je=new Function("a","b",c.join(a[0]));this.Ke=new Function("a",
"b",c.join(a[1]));this.Oa=new Function("a","return [a"+a.join(", a")+"];")}};"undefined"!==typeof a?a.kb=c:"undefined"!==typeof self?self.b=c:window.b=c})();Bp=a.kb})();function Dp(a){this.a=Bp(a);this.b={}}l=Dp.prototype;l.ra=function(a,c){var d=[a[0],a[1],a[2],a[3],c];this.a.ra(d);this.b[v(c)]=d};l.load=function(a,c){for(var d=Array(c.length),e=0,f=c.length;e<f;e++){var g=a[e],h=c[e],g=[g[0],g[1],g[2],g[3],h];d[e]=g;this.b[v(h)]=g}this.a.load(d)};l.remove=function(a){a=v(a);var c=this.b[a];delete this.b[a];return null!==this.a.remove(c)};function Ep(a,c,d){var e=v(d);Zd(a.b[e].slice(0,4),c)||(a.remove(d),a.ra(c,d))}
function Fp(a){return a.a.all().map(function(a){return a[4]})}function Gp(a,c){return a.a.search(c).map(function(a){return a[4]})}l.forEach=function(a,c){return Hp(Fp(this),a,c)};function Ip(a,c,d,e){return Hp(Gp(a,c),d,e)}function Hp(a,c,d){for(var e,f=0,g=a.length;f<g&&!(e=c.call(d,a[f]));f++);return e}l.za=function(){return Pb(this.b)};l.clear=function(){this.a.clear();this.b={}};l.S=function(){return this.a.data.bbox};function U(a){a=a||{};Ch.call(this,{attributions:a.attributions,logo:a.logo,projection:void 0,state:"ready",wrapX:void 0!==a.wrapX?a.wrapX:!0});this.Y=va;void 0!==a.loader?this.Y=a.loader:void 0!==a.url&&(this.Y=zp(a.url,a.format));this.xa=void 0!==a.strategy?a.strategy:Ap;var c=void 0!==a.useSpatialIndex?a.useSpatialIndex:!0;this.a=c?new Dp:null;this.$=new Dp;this.f={};this.g={};this.l={};this.B={};this.c=null;var d,e;a.features instanceof tg?(d=a.features,e=d.a):ga(a.features)&&(e=a.features);c||
void 0!==d||(d=new tg(e));void 0!==e&&Jp(this,e);void 0!==d&&Kp(this,d)}w(U,Ch);l=U.prototype;l.Ac=function(a){var c=v(a).toString();if(Lp(this,c,a)){Mp(this,c,a);var d=a.W();d?(c=d.S(),this.a&&this.a.ra(c,a)):this.f[c]=a;this.s(new Np("addfeature",a))}this.u()};function Mp(a,c,d){a.B[c]=[B(d,"change",a.Jg,!1,a),B(d,"propertychange",a.Jg,!1,a)]}function Lp(a,c,d){var e=!0,f=d.Ca();void 0!==f?f.toString()in a.g?e=!1:a.g[f.toString()]=d:a.l[c]=d;return e}l.Qb=function(a){Jp(this,a);this.u()};
function Jp(a,c){var d,e,f,g,h=[],k=[],m=[];e=0;for(f=c.length;e<f;e++)g=c[e],d=v(g).toString(),Lp(a,d,g)&&k.push(g);e=0;for(f=k.length;e<f;e++){g=k[e];d=v(g).toString();Mp(a,d,g);var n=g.W();n?(d=n.S(),h.push(d),m.push(g)):a.f[d]=g}a.a&&a.a.load(h,m);e=0;for(f=k.length;e<f;e++)a.s(new Np("addfeature",k[e]))}
function Kp(a,c){var d=!1;B(a,"addfeature",function(a){d||(d=!0,c.push(a.feature),d=!1)});B(a,"removefeature",function(a){d||(d=!0,c.remove(a.feature),d=!1)});B(c,"add",function(a){d||(a=a.element,d=!0,this.Ac(a),d=!1)},!1,a);B(c,"remove",function(a){d||(a=a.element,d=!0,this.fc(a),d=!1)},!1,a);a.c=c}
l.clear=function(a){if(a){for(var c in this.B)this.B[c].forEach(Yc);this.c||(this.B={},this.g={},this.l={})}else a=this.eh,this.a&&(this.a.forEach(a,this),Gb(this.f,a,this));this.c&&this.c.clear();this.a&&this.a.clear();this.$.clear();this.f={};this.s(new Np("clear"));this.u()};l.Pe=function(a,c){if(this.a)return this.a.forEach(a,c);if(this.c)return this.c.forEach(a,c)};function Op(a,c,d){a.uc([c[0],c[1],c[0],c[1]],function(a){if(a.W().Le(c))return d.call(void 0,a)})}
l.uc=function(a,c,d){if(this.a)return Ip(this.a,a,c,d);if(this.c)return this.c.forEach(c,d)};l.Cb=function(a,c,d,e){return this.uc(a,d,e)};l.Qe=function(a,c,d){return this.uc(a,function(e){if(e.W().va(a)&&(e=c.call(d,e)))return e})};l.Ve=function(){return this.c};l.Bc=function(){var a;this.c?a=this.c.a:this.a&&(a=Fp(this.a),Pb(this.f)||ib(a,Kb(this.f)));return a};l.Ue=function(a){var c=[];Op(this,a,function(a){c.push(a)});return c};l.Dd=function(a){return Gp(this.a,a)};
l.Se=function(a){var c=a[0],d=a[1],e=null,f=[NaN,NaN],g=Infinity,h=[-Infinity,-Infinity,Infinity,Infinity];Ip(this.a,h,function(a){var m=a.W(),n=g;g=m.Ya(c,d,f,g);g<n&&(e=a,a=Math.sqrt(g),h[0]=c-a,h[1]=d-a,h[2]=c+a,h[3]=d+a)});return e};l.S=function(){return this.a.S()};l.Te=function(a){a=this.g[a.toString()];return void 0!==a?a:null};
l.Jg=function(a){a=a.target;var c=v(a).toString(),d=a.W();d?(d=d.S(),c in this.f?(delete this.f[c],this.a&&this.a.ra(d,a)):this.a&&Ep(this.a,d,a)):c in this.f||(this.a&&this.a.remove(a),this.f[c]=a);d=a.Ca();void 0!==d?(d=d.toString(),c in this.l?(delete this.l[c],this.g[d]=a):this.g[d]!==a&&(Pp(this,a),this.g[d]=a)):c in this.l||(Pp(this,a),this.l[c]=a);this.u();this.s(new Np("changefeature",a))};l.za=function(){return this.a.za()&&Pb(this.f)};
l.Yb=function(a,c,d){var e=this.$;a=this.xa(a,c);var f,g;f=0;for(g=a.length;f<g;++f){var h=a[f];Ip(e,h,function(a){return Wd(a.extent,h)})||(this.Y.call(this,h,c,d),e.ra(h,{extent:h.slice()}))}};l.fc=function(a){var c=v(a).toString();c in this.f?delete this.f[c]:this.a&&this.a.remove(a);this.eh(a);this.u()};l.eh=function(a){var c=v(a).toString();this.B[c].forEach(Yc);delete this.B[c];var d=a.Ca();void 0!==d?delete this.g[d.toString()]:delete this.l[c];this.s(new Np("removefeature",a))};
function Pp(a,c){for(var d in a.g)if(a.g[d]===c){delete a.g[d];break}}function Np(a,c){uc.call(this,a);this.feature=c}w(Np,uc);function Qp(a){this.a=a.source;this.ga=Cd();this.c=Qi();this.f=[0,0];this.v=null;yn.call(this,{attributions:a.attributions,canvasFunction:qa(this.ui,this),logo:a.logo,projection:a.projection,ratio:a.ratio,resolutions:a.resolutions,state:this.a.A});this.C=null;this.g=void 0;this.Gg(a.style);B(this.a,"change",this.Sl,void 0,this)}w(Qp,yn);l=Qp.prototype;
l.ui=function(a,c,d,e,f){var g=new Rm(.5*c/d,a,c);this.a.Yb(a,c,f);var h=!1;this.a.Cb(a,c,function(a){var e;if(!(e=h)){var f;(e=a.c)?f=e.call(a,c):this.g&&(f=this.g(a,c));if(f){var p,q=!1;e=0;for(p=f.length;e<p;++e)q=on(g,a,f[e],nn(c,d),this.Rl,this)||q;e=q}else e=!1}h=e},this);Sm(g);if(h)return null;this.f[0]!=e[0]||this.f[1]!=e[1]?(this.c.canvas.width=e[0],this.c.canvas.height=e[1],this.f[0]=e[0],this.f[1]=e[1]):this.c.clearRect(0,0,e[0],e[1]);a=Rp(this,ge(a),c,d,e);Wm(g,this.c,d,a,0,{});this.v=
g;return this.c.canvas};l.ee=function(a,c,d,e,f){if(this.v){var g={};return Tm(this.v,a,c,0,e,function(a){var c=v(a).toString();if(!(c in g))return g[c]=!0,f(a)})}};l.Ol=function(){return this.a};l.Pl=function(){return this.C};l.Ql=function(){return this.g};function Rp(a,c,d,e,f){return jk(a.ga,f[0]/2,f[1]/2,e/d,-e/d,0,-c[0],-c[1])}l.Rl=function(){this.u()};l.Sl=function(){Eh(this,this.a.A)};l.Gg=function(a){this.C=void 0!==a?a:hm;this.g=a?fm(this.C):void 0;this.u()};function Sp(a){xm.call(this,a);this.g=null;this.j=Cd();this.c=this.f=null}w(Sp,xm);l=Sp.prototype;l.Wa=function(a,c,d,e){var f=this.a;return f.fa().ee(a,c.viewState.resolution,c.viewState.rotation,c.skippedFeatureUids,function(a){return d.call(e,a,f)})};
l.dc=function(a,c,d,e){if(this.fd())if(this.a.fa()instanceof Qp){if(a=a.slice(),lk(c.pixelToCoordinateMatrix,a,a),this.Wa(a,c,re,this))return d.call(e,this.a)}else if(this.f||(this.f=Cd(),Id(this.j,this.f)),c=Am(a,this.f),this.c||(this.c=Qi(1,1)),this.c.clearRect(0,0,1,1),this.c.drawImage(this.fd(),c[0],c[1],1,1,0,0,1,1),0<this.c.getImageData(0,0,1,1).data[3])return d.call(e,this.a)};l.fd=function(){return this.g?this.g.b():null};l.We=function(){return this.j};
l.de=function(a,c){var d=a.pixelRatio,e=a.viewState,f=e.center,g=e.resolution,h=e.rotation,k,m=this.a.fa(),n=a.viewHints;k=a.extent;void 0!==c.extent&&(k=je(k,c.extent));n[0]||n[1]||me(k)||(e=e.projection,(n=m.i)&&(e=n),(k=m.ec(k,g,d,e))&&ok(this,k)&&(this.g=k));if(this.g){k=this.g;var e=k.S(),n=k.ba(),p=k.g,g=d*n/(g*p);jk(this.j,d*a.size[0]/2,d*a.size[1]/2,g,g,h,p*(e[0]-f[0])/n,p*(f[1]-e[3])/n);this.f=null;qk(a.attributions,k.j);rk(a,m)}return!0};function Tp(a){xm.call(this,a);this.c=this.j=null;this.D=!1;this.i=null;this.B=Cd();this.g=null;this.C=this.O=this.v=NaN;this.l=this.f=null;this.U=[0,0]}w(Tp,xm);Tp.prototype.fd=function(){return this.j};Tp.prototype.We=function(){return this.B};
Tp.prototype.de=function(a,c){var d=a.pixelRatio,e=a.viewState,f=e.projection,g=this.a,h=g.fa(),k=Sh(h,f),m=h.Ed(),n=Mh(k,e.resolution),p=h.Vb(n,a.pixelRatio,f),q=p[0]/nd(k.La(n),this.U)[0],r=k.ba(n),q=r/q,u=e.center,y;r==e.resolution?(u=tk(u,r,a.size),y=he(u,r,e.rotation,a.size)):y=a.extent;void 0!==c.extent&&(y=je(y,c.extent));if(me(y))return!1;var A=Kh(k,y,r),F=p[0]*pg(A),z=p[1]*og(A),x,K;this.j?(x=this.j,K=this.i,this.c[0]<F||this.c[1]<z||this.O!==p[0]||this.C!==p[1]||this.D&&(this.c[0]>F||this.c[1]>
z)?(x.width=F,x.height=z,this.c=[F,z],this.D=!Bm(this.c),this.f=null):(F=this.c[0],z=this.c[1],(x=n!=this.v)||(x=this.f,x=!(x.b<=A.b&&A.f<=x.f&&x.a<=A.a&&A.c<=x.c)),x&&(this.f=null))):(K=Qi(F,z),this.j=K.canvas,this.c=[F,z],this.i=K,this.D=!Bm(this.c));var J,I;this.f?(z=this.f,F=pg(z)):(F/=p[0],z/=p[1],J=A.b-Math.floor((F-pg(A))/2),I=A.a-Math.floor((z-og(A))/2),this.v=n,this.O=p[0],this.C=p[1],this.f=new mg(J,J+F-1,I,I+z-1),this.l=Array(F*z),z=this.f);x={};x[n]={};var O=[],wa=this.zd(h,x),Ua=g.c(),
M=Nd(),Ma=new mg(0,0,0,0),qb,Oa,Ib;for(I=A.b;I<=A.f;++I)for(Ib=A.a;Ib<=A.c;++Ib)Oa=h.Ub(n,I,Ib,d,f),J=Oa.state,2==J||4==J||3==J&&!Ua?x[n][fg(Oa.b)]=Oa:(qb=Ih(k,Oa.b,wa,Ma,M),qb||(O.push(Oa),(qb=Jh(k,Oa.b,Ma,M))&&wa(n+1,qb)));wa=0;for(qb=O.length;wa<qb;++wa)Oa=O[wa],I=p[0]*(Oa.b[1]-z.b),Ib=p[1]*(z.c-Oa.b[2]),K.clearRect(I,Ib,p[0],p[1]);O=Object.keys(x).map(Number);lb(O);var eb=h.da,Ic=fe(k.Ea([n,z.b,z.c],M)),lc,Ie,pj,Qh,Pf,km,wa=0;for(qb=O.length;wa<qb;++wa)if(lc=O[wa],p=h.Vb(lc,d,f),Qh=x[lc],lc==
n)for(pj in Qh)Oa=Qh[pj],Ie=(Oa.b[2]-z.a)*F+(Oa.b[1]-z.b),this.l[Ie]!=Oa&&(I=p[0]*(Oa.b[1]-z.b),Ib=p[1]*(z.c-Oa.b[2]),J=Oa.state,4!=J&&(3!=J||Ua)&&eb||K.clearRect(I,Ib,p[0],p[1]),2==J&&K.drawImage(Oa.Ta(),m,m,p[0],p[1],I,Ib,p[0],p[1]),this.l[Ie]=Oa);else for(pj in lc=k.ba(lc)/r,Qh)for(Oa=Qh[pj],Ie=k.Ea(Oa.b,M),I=(Ie[0]-Ic[0])/q,Ib=(Ic[1]-Ie[3])/q,km=lc*p[0],Pf=lc*p[1],J=Oa.state,4!=J&&eb||K.clearRect(I,Ib,km,Pf),2==J&&K.drawImage(Oa.Ta(),m,m,p[0],p[1],I,Ib,km,Pf),Oa=kg(k,Ie,n,Ma),J=Math.max(Oa.b,
z.b),Ib=Math.min(Oa.f,z.f),I=Math.max(Oa.a,z.a),Oa=Math.min(Oa.c,z.c);J<=Ib;++J)for(Pf=I;Pf<=Oa;++Pf)Ie=(Pf-z.a)*F+(J-z.b),this.l[Ie]=void 0;sk(a.usedTiles,h,n,A);uk(a,h,k,d,f,y,n,g.a());pk(a,h);rk(a,h);jk(this.B,d*a.size[0]/2,d*a.size[1]/2,d*q/e.resolution,d*q/e.resolution,e.rotation,(Ic[0]-u[0])/q,(u[1]-Ic[1])/q);this.g=null;return!0};
Tp.prototype.dc=function(a,c,d,e){if(this.i&&(this.g||(this.g=Cd(),Id(this.B,this.g)),a=Am(a,this.g),0<this.i.getImageData(a[0],a[1],1,1).data[3]))return d.call(e,this.a)};function Up(a){xm.call(this,a);this.f=!1;this.D=-1;this.l=NaN;this.j=Nd();this.c=this.i=null;this.g=Qi()}w(Up,xm);
Up.prototype.A=function(a,c,d){var e=a.extent,f=a.pixelRatio,g=c.Ib?a.skippedFeatureUids:{},h=a.viewState,k=h.projection,h=h.rotation,m=k.S(),n=this.a.fa(),p=zm(this,a,0);ym(this,"precompose",d,a,p);var q=this.c;if(q&&!q.za()){var r;dd(this.a,"render")?(this.g.canvas.width=d.canvas.width,this.g.canvas.height=d.canvas.height,r=this.g):r=d;var u=r.globalAlpha;r.globalAlpha=c.opacity;Wm(q,r,f,p,h,g);if(n.O&&k.c&&!Wd(m,e)){c=e[0];k=le(m);for(n=0;c<m[0];)--n,p=k*n,p=zm(this,a,p),Wm(q,r,f,p,h,g),c+=k;n=
0;for(c=e[2];c>m[2];)++n,p=k*n,p=zm(this,a,p),Wm(q,r,f,p,h,g),c-=k;p=zm(this,a,0)}r!=d&&(ym(this,"render",r,a,p),d.drawImage(r.canvas,0,0));r.globalAlpha=u}ym(this,"postcompose",d,a,p)};Up.prototype.Wa=function(a,c,d,e){if(this.c){var f=c.viewState.resolution,g=c.viewState.rotation,h=this.a,k=c.layerStates[v(h)],m={};return Tm(this.c,a,f,g,k.Ib?c.skippedFeatureUids:{},function(a){var c=v(a).toString();if(!(c in m))return m[c]=!0,d.call(e,a,h)})}};Up.prototype.B=function(){nk(this)};
Up.prototype.de=function(a){function c(a){var c,e=a.c;e?c=e.call(a,n):(e=d.c)&&(c=e(a,n));if(c){if(c){var f,g=!1,e=0;for(f=c.length;e<f;++e)g=on(r,a,c[e],nn(n,p),this.B,this)||g;a=g}else a=!1;this.f=this.f||a}}var d=this.a,e=d.fa();qk(a.attributions,e.j);rk(a,e);var f=a.viewHints[0],g=a.viewHints[1],h=d.C,k=d.O;if(!this.f&&!h&&f||!k&&g)return!0;var m=a.extent,k=a.viewState,f=k.projection,n=k.resolution,p=a.pixelRatio,g=d.b,q=d.a,h=d.get("renderOrder");void 0===h&&(h=mn);m=Rd(m,q*n);q=k.projection.S();
e.O&&k.projection.c&&!Wd(q,a.extent)&&(a=Math.max(le(m)/2,le(q)),m[0]=q[0]-a,m[2]=q[2]+a);if(!this.f&&this.l==n&&this.D==g&&this.i==h&&Wd(this.j,m))return!0;tc(this.c);this.c=null;this.f=!1;var r=new Rm(.5*n/p,m,n,d.a);e.Yb(m,n,f);if(h){var u=[];e.Cb(m,n,function(a){u.push(a)},this);lb(u,h);u.forEach(c,this)}else e.Cb(m,n,c,this);Sm(r);this.l=n;this.D=g;this.i=h;this.j=m;this.c=r;return!0};function Vp(a,c){Bk.call(this,0,c);this.c=Qi();this.b=this.c.canvas;this.b.style.width="100%";this.b.style.height="100%";this.b.className="ol-unselectable";Sg(a,this.b,0);this.a=!0;this.g=Cd()}w(Vp,Bk);Vp.prototype.Me=function(a){return a instanceof Tl?new Sp(a):a instanceof E?new Tp(a):a instanceof G?new Up(a):null};
function Wp(a,c,d){var e=a.j,f=a.c;if(dd(e,c)){var g=d.extent,h=d.pixelRatio,k=d.viewState.rotation,m=d.pixelRatio,n=d.viewState,p=n.resolution;a=jk(a.g,a.b.width/2,a.b.height/2,m/p,-m/p,-n.rotation,-n.center[0],-n.center[1]);g=new jm(f,h,g,a,k);e.s(new ek(c,e,g,d,f,null));wm(g)}}Vp.prototype.X=function(){return"canvas"};
Vp.prototype.se=function(a){if(a){var c=this.c,d=a.size[0]*a.pixelRatio,e=a.size[1]*a.pixelRatio;this.b.width!=d||this.b.height!=e?(this.b.width=d,this.b.height=e):c.clearRect(0,0,this.b.width,this.b.height);Ck(a);Wp(this,"precompose",a);d=a.layerStatesArray;nb(d);var e=a.viewState.resolution,f,g,h,k;f=0;for(g=d.length;f<g;++f)k=d[f],h=k.layer,h=Ek(this,h),gk(k,e)&&"ready"==k.A&&h.de(a,k)&&h.A(a,k,c);Wp(this,"postcompose",a);this.a||(nh(this.b,!0),this.a=!0);Fk(this,a);a.postRenderFunctions.push(Dk)}else this.a&&
(nh(this.b,!1),this.a=!1)};function Xp(a,c){mk.call(this,a);this.target=c}w(Xp,mk);Xp.prototype.g=va;Xp.prototype.l=va;function Yp(a){var c=Pg("DIV");c.style.position="absolute";Xp.call(this,a,c);this.c=null;this.f=Ed()}w(Yp,Xp);Yp.prototype.Wa=function(a,c,d,e){var f=this.a;return f.fa().ee(a,c.viewState.resolution,c.viewState.rotation,c.skippedFeatureUids,function(a){return d.call(e,a,f)})};Yp.prototype.g=function(){Rg(this.target);this.c=null};
Yp.prototype.j=function(a,c){var d=a.viewState,e=d.center,f=d.resolution,g=d.rotation,h=this.c,k=this.a.fa(),m=a.viewHints,n=a.extent;void 0!==c.extent&&(n=je(n,c.extent));m[0]||m[1]||me(n)||(d=d.projection,(m=k.i)&&(d=m),(n=k.ec(n,f,a.pixelRatio,d))&&ok(this,n)&&(h=n));h&&(d=h.S(),m=h.ba(),n=Cd(),jk(n,a.size[0]/2,a.size[1]/2,m/f,m/f,g,(d[0]-e[0])/m,(e[1]-d[3])/m),h!=this.c&&(e=h.b(this),e.style.maxWidth="none",e.style.position="absolute",Rg(this.target),this.target.appendChild(e),this.c=h),kk(n,
this.f)||(Ui(this.target,n),Fd(this.f,n)),qk(a.attributions,h.j),rk(a,k));return!0};function Zp(a){var c=Pg("DIV");c.style.position="absolute";Xp.call(this,a,c);this.f=!0;this.D=1;this.i=0;this.c={}}w(Zp,Xp);Zp.prototype.g=function(){Rg(this.target);this.i=0};
Zp.prototype.j=function(a,c){if(!c.visible)return this.f&&(nh(this.target,!1),this.f=!1),!0;var d=a.pixelRatio,e=a.viewState,f=e.projection,g=this.a,h=g.fa(),k=Sh(h,f),m=h.Ed(),n=Mh(k,e.resolution),p=k.ba(n),q=e.center,r;p==e.resolution?(q=tk(q,p,a.size),r=he(q,p,e.rotation,a.size)):r=a.extent;void 0!==c.extent&&(r=je(r,c.extent));var p=Kh(k,r,p),u={};u[n]={};var y=this.zd(h,u),A=g.c(),F=Nd(),z=new mg(0,0,0,0),x,K,J,I;for(J=p.b;J<=p.f;++J)for(I=p.a;I<=p.c;++I)x=h.Ub(n,J,I,d,f),K=x.state,2==K?u[n][fg(x.b)]=
x:4==K||3==K&&!A||(K=Ih(k,x.b,y,z,F),K||(x=Jh(k,x.b,z,F))&&y(n+1,x));var O;if(this.i!=h.b){for(O in this.c)A=this.c[+O],Tg(A.target);this.c={};this.i=h.b}F=Object.keys(u).map(Number);lb(F);var y={},wa;J=0;for(I=F.length;J<I;++J){O=F[J];O in this.c?A=this.c[O]:(A=k.Md(q,O),A=new $p(k,A),y[O]=!0,this.c[O]=A);O=u[O];for(wa in O){x=A;K=O[wa];var Ua=m,M=K.b,Ma=M[0],qb=M[1],Oa=M[2],M=fg(M);if(!(M in x.a)){var Ma=nd(x.f.La(Ma),x.l),Ib=K.Ta(x),eb=Ib.style;eb.maxWidth="none";var Ic=void 0,lc=void 0;0<Ua?(Ic=
Pg("DIV"),lc=Ic.style,lc.overflow="hidden",lc.width=Ma[0]+"px",lc.height=Ma[1]+"px",eb.position="absolute",eb.left=-Ua+"px",eb.top=-Ua+"px",eb.width=Ma[0]+2*Ua+"px",eb.height=Ma[1]+2*Ua+"px",Ic.appendChild(Ib)):(eb.width=Ma[0]+"px",eb.height=Ma[1]+"px",Ic=Ib,lc=eb);lc.position="absolute";lc.left=(qb-x.c[1])*Ma[0]+"px";lc.top=(x.c[2]-Oa)*Ma[1]+"px";x.b||(x.b=document.createDocumentFragment());x.b.appendChild(Ic);x.a[M]=K}}A.b&&(A.target.appendChild(A.b),A.b=null)}m=Object.keys(this.c).map(Number);
lb(m);J=Cd();wa=0;for(F=m.length;wa<F;++wa)if(O=m[wa],A=this.c[O],O in u)if(x=A.ba(),I=A.ua(),jk(J,a.size[0]/2,a.size[1]/2,x/e.resolution,x/e.resolution,e.rotation,(I[0]-q[0])/x,(q[1]-I[1])/x),A.setTransform(J),O in y){for(--O;0<=O;--O)if(O in this.c){I=this.c[O].target;I.parentNode&&I.parentNode.insertBefore(A.target,I.nextSibling);break}0>O&&Sg(this.target,A.target,0)}else{if(!a.viewHints[0]&&!a.viewHints[1]){K=kg(A.f,r,A.c[0],z);O=[];x=I=void 0;for(x in A.a)I=A.a[x],K.contains(I.b)||O.push(I);
Ua=K=void 0;K=0;for(Ua=O.length;K<Ua;++K)I=O[K],x=fg(I.b),Tg(I.Ta(A)),delete A.a[x]}}else Tg(A.target),delete this.c[O];c.opacity!=this.D&&(this.D=this.target.style.opacity=c.opacity);c.visible&&!this.f&&(nh(this.target,!0),this.f=!0);sk(a.usedTiles,h,n,p);uk(a,h,k,d,f,r,n,g.a());pk(a,h);rk(a,h);return!0};
function $p(a,c){this.target=Pg("DIV");this.target.style.position="absolute";this.target.style.width="100%";this.target.style.height="100%";this.f=a;this.c=c;this.j=fe(a.Ea(c));this.i=a.ba(c[0]);this.a={};this.b=null;this.g=Ed();this.l=[0,0]}$p.prototype.ua=function(){return this.j};$p.prototype.ba=function(){return this.i};$p.prototype.setTransform=function(a){kk(a,this.g)||(Ui(this.target,a),Fd(this.g,a))};function aq(a){this.i=Qi();var c=this.i.canvas;c.style.maxWidth="none";c.style.position="absolute";Xp.call(this,a,c);this.f=!1;this.v=-1;this.A=NaN;this.D=Nd();this.c=this.B=null;this.O=Cd();this.C=Cd()}w(aq,Xp);
aq.prototype.l=function(a,c){var d=a.viewState,e=d.center,f=d.rotation,g=d.resolution,d=a.pixelRatio,h=a.size[0],k=a.size[1],m=h*d,n=k*d,e=jk(this.O,d*h/2,d*k/2,d/g,-d/g,-f,-e[0],-e[1]),g=this.i;g.canvas.width=m;g.canvas.height=n;h=jk(this.C,0,0,1/d,1/d,0,-(m-h)/2*d,-(n-k)/2*d);Ui(g.canvas,h);bq(this,"precompose",a,e);(h=this.c)&&!h.za()&&(g.globalAlpha=c.opacity,Wm(h,g,d,e,f,c.Ib?a.skippedFeatureUids:{}),bq(this,"render",a,e));bq(this,"postcompose",a,e)};
function bq(a,c,d,e){var f=a.i;a=a.a;dd(a,c)&&(e=new jm(f,d.pixelRatio,d.extent,e,d.viewState.rotation),a.s(new ek(c,a,e,d,f,null)),wm(e))}aq.prototype.Wa=function(a,c,d,e){if(this.c){var f=c.viewState.resolution,g=c.viewState.rotation,h=this.a,k=c.layerStates[v(h)],m={};return Tm(this.c,a,f,g,k.Ib?c.skippedFeatureUids:{},function(a){var c=v(a).toString();if(!(c in m))return m[c]=!0,d.call(e,a,h)})}};aq.prototype.J=function(){nk(this)};
aq.prototype.j=function(a){function c(a){var c,e=a.c;e?c=e.call(a,m):(e=d.c)&&(c=e(a,m));if(c){if(c){var f,g=!1,e=0;for(f=c.length;e<f;++e)g=on(p,a,c[e],nn(m,n),this.J,this)||g;a=g}else a=!1;this.f=this.f||a}}var d=this.a,e=d.fa();qk(a.attributions,e.j);rk(a,e);var f=a.viewHints[0],g=a.viewHints[1],h=d.C,k=d.O;if(!this.f&&!h&&f||!k&&g)return!0;var g=a.extent,h=a.viewState,f=h.projection,m=h.resolution,n=a.pixelRatio;a=d.b;k=d.a;h=d.get("renderOrder");void 0===h&&(h=mn);g=Rd(g,k*m);if(!this.f&&this.A==
m&&this.v==a&&this.B==h&&Wd(this.D,g))return!0;tc(this.c);this.c=null;this.f=!1;var p=new Rm(.5*m/n,g,m,d.a);e.Yb(g,m,f);if(h){var q=[];e.Cb(g,m,function(a){q.push(a)},this);lb(q,h);q.forEach(c,this)}else e.Cb(g,m,c,this);Sm(p);this.A=m;this.v=a;this.B=h;this.D=g;this.c=p;return!0};function cq(a,c){Bk.call(this,0,c);this.c=Qi();var d=this.c.canvas;d.style.position="absolute";d.style.width="100%";d.style.height="100%";d.className="ol-unselectable";Sg(a,d,0);this.g=Cd();this.b=Pg("DIV");this.b.className="ol-unselectable";d=this.b.style;d.position="absolute";d.width="100%";d.height="100%";B(this.b,"touchstart",wc);Sg(a,this.b,0);this.a=!0}w(cq,Bk);cq.prototype.Z=function(){Tg(this.b);cq.ca.Z.call(this)};
cq.prototype.Me=function(a){if(a instanceof Tl)a=new Yp(a);else if(a instanceof E)a=new Zp(a);else if(a instanceof G)a=new aq(a);else return null;return a};function dq(a,c,d){var e=a.j;if(dd(e,c)){var f=d.extent,g=d.pixelRatio,h=d.viewState,k=h.rotation,m=a.c,n=m.canvas;jk(a.g,n.width/2,n.height/2,g/h.resolution,-g/h.resolution,-h.rotation,-h.center[0],-h.center[1]);a=new jm(m,g,f,a.g,k);e.s(new ek(c,e,a,d,m,null));wm(a)}}cq.prototype.X=function(){return"dom"};
cq.prototype.se=function(a){if(a){var c=this.j;if(dd(c,"precompose")||dd(c,"postcompose")){var c=this.c.canvas,d=a.pixelRatio;c.width=a.size[0]*d;c.height=a.size[1]*d}dq(this,"precompose",a);c=a.layerStatesArray;nb(c);var d=a.viewState.resolution,e,f,g,h;e=0;for(f=c.length;e<f;++e)h=c[e],g=h.layer,g=Ek(this,g),Sg(this.b,g.target,e),gk(h,d)&&"ready"==h.A?g.j(a,h)&&g.l(a,h):g.g();var c=a.layerStates,k;for(k in this.f)k in c||(g=this.f[k],Tg(g.target));this.a||(nh(this.b,!0),this.a=!0);Ck(a);Fk(this,
a);a.postRenderFunctions.push(Dk);dq(this,"postcompose",a)}else this.a&&(nh(this.b,!1),this.a=!1)};function eq(a){this.b=a}function fq(a){this.b=a}w(fq,eq);fq.prototype.X=function(){return 35632};function gq(a){this.b=a}w(gq,eq);gq.prototype.X=function(){return 35633};function hq(){this.b="precision mediump float;varying vec2 a;varying float b;uniform float k;uniform sampler2D l;void main(void){vec4 texColor=texture2D(l,a);gl_FragColor.rgb=texColor.rgb;float alpha=texColor.a*b*k;if(alpha==0.0){discard;}gl_FragColor.a=alpha;}"}w(hq,fq);ea(hq);
function iq(){this.b="varying vec2 a;varying float b;attribute vec2 c;attribute vec2 d;attribute vec2 e;attribute float f;attribute float g;uniform mat4 h;uniform mat4 i;uniform mat4 j;void main(void){mat4 offsetMatrix=i;if(g==1.0){offsetMatrix=i*j;}vec4 offsets=offsetMatrix*vec4(e,0.,0.);gl_Position=h*vec4(c,0.,1.)+offsets;a=d;b=f;}"}w(iq,gq);ea(iq);
function jq(a,c){this.l=a.getUniformLocation(c,"j");this.D=a.getUniformLocation(c,"i");this.j=a.getUniformLocation(c,"k");this.i=a.getUniformLocation(c,"h");this.b=a.getAttribLocation(c,"e");this.a=a.getAttribLocation(c,"f");this.f=a.getAttribLocation(c,"c");this.c=a.getAttribLocation(c,"g");this.g=a.getAttribLocation(c,"d")};function kq(a){this.b=void 0!==a?a:[]};function lq(a,c){this.B=a;this.b=c;this.a={};this.j={};this.g={};this.l=this.D=this.f=this.i=null;(this.c=tb(ua,"OES_element_index_uint"))&&c.getExtension("OES_element_index_uint");B(this.B,"webglcontextlost",this.Sm,!1,this);B(this.B,"webglcontextrestored",this.Tm,!1,this)}
function mq(a,c,d){var e=a.b,f=d.b,g=v(d);if(g in a.a)e.bindBuffer(c,a.a[g].buffer);else{var h=e.createBuffer();e.bindBuffer(c,h);var k;34962==c?k=new Float32Array(f):34963==c&&(k=a.c?new Uint32Array(f):new Uint16Array(f));e.bufferData(c,k,35044);a.a[g]={a:d,buffer:h}}}function nq(a,c){var d=a.b,e=v(c),f=a.a[e];d.isContextLost()||d.deleteBuffer(f.buffer);delete a.a[e]}l=lq.prototype;
l.Z=function(){var a=this.b;a.isContextLost()||(Gb(this.a,function(c){a.deleteBuffer(c.buffer)}),Gb(this.g,function(c){a.deleteProgram(c)}),Gb(this.j,function(c){a.deleteShader(c)}),a.deleteFramebuffer(this.f),a.deleteRenderbuffer(this.l),a.deleteTexture(this.D))};l.Rm=function(){return this.b};
function oq(a){if(!a.f){var c=a.b,d=c.createFramebuffer();c.bindFramebuffer(c.FRAMEBUFFER,d);var e=pq(c,1,1),f=c.createRenderbuffer();c.bindRenderbuffer(c.RENDERBUFFER,f);c.renderbufferStorage(c.RENDERBUFFER,c.DEPTH_COMPONENT16,1,1);c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,e,0);c.framebufferRenderbuffer(c.FRAMEBUFFER,c.DEPTH_ATTACHMENT,c.RENDERBUFFER,f);c.bindTexture(c.TEXTURE_2D,null);c.bindRenderbuffer(c.RENDERBUFFER,null);c.bindFramebuffer(c.FRAMEBUFFER,null);a.f=d;
a.D=e;a.l=f}return a.f}function qq(a,c){var d=v(c);if(d in a.j)return a.j[d];var e=a.b,f=e.createShader(c.X());e.shaderSource(f,c.b);e.compileShader(f);return a.j[d]=f}function rq(a,c,d){var e=v(c)+"/"+v(d);if(e in a.g)return a.g[e];var f=a.b,g=f.createProgram();f.attachShader(g,qq(a,c));f.attachShader(g,qq(a,d));f.linkProgram(g);return a.g[e]=g}l.Sm=function(){Qb(this.a);Qb(this.j);Qb(this.g);this.l=this.D=this.f=this.i=null};l.Tm=function(){};
l.me=function(a){if(a==this.i)return!1;this.b.useProgram(a);this.i=a;return!0};function sq(a,c,d){var e=a.createTexture();a.bindTexture(a.TEXTURE_2D,e);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR);void 0!==c&&a.texParameteri(3553,10242,c);void 0!==d&&a.texParameteri(3553,10243,d);return e}function pq(a,c,d){var e=sq(a,void 0,void 0);a.texImage2D(a.TEXTURE_2D,0,a.RGBA,c,d,0,a.RGBA,a.UNSIGNED_BYTE,null);return e}
function tq(a,c){var d=sq(a,33071,33071);a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,c);return d};function uq(a,c){this.O=this.C=void 0;this.D=ge(c);this.v=[];this.j=[];this.ka=void 0;this.g=[];this.f=[];this.U=this.J=void 0;this.a=[];this.ea=this.l=null;this.Y=void 0;this.ib=Ed();this.pb=Ed();this.da=this.$=void 0;this.qb=Ed();this.sa=this.Pa=this.ga=void 0;this.Qa=[];this.i=[];this.b=[];this.A=null;this.c=[];this.B=[];this.xa=void 0}w(uq,dk);
function vq(a,c){var d=a.A,e=a.l,f=a.Qa,g=a.i,h=c.b;return function(){if(!h.isContextLost()){var a,m;a=0;for(m=f.length;a<m;++a)h.deleteTexture(f[a]);a=0;for(m=g.length;a<m;++a)h.deleteTexture(g[a])}nq(c,d);nq(c,e)}}
function wq(a,c,d,e){var f=a.C,g=a.O,h=a.ka,k=a.J,m=a.U,n=a.Y,p=a.$,q=a.da,r=a.ga?1:0,u=a.Pa,y=a.sa,A=a.xa,F=Math.cos(u),u=Math.sin(u),z=a.a.length,x=a.b.length,K,J,I,O,wa,Ua;for(K=0;K<d;K+=e)wa=c[K]-a.D[0],Ua=c[K+1]-a.D[1],J=x/8,I=-y*f,O=-y*(h-g),a.b[x++]=wa,a.b[x++]=Ua,a.b[x++]=I*F-O*u,a.b[x++]=I*u+O*F,a.b[x++]=p/m,a.b[x++]=(q+h)/k,a.b[x++]=n,a.b[x++]=r,I=y*(A-f),O=-y*(h-g),a.b[x++]=wa,a.b[x++]=Ua,a.b[x++]=I*F-O*u,a.b[x++]=I*u+O*F,a.b[x++]=(p+A)/m,a.b[x++]=(q+h)/k,a.b[x++]=n,a.b[x++]=r,I=y*(A-f),
O=y*g,a.b[x++]=wa,a.b[x++]=Ua,a.b[x++]=I*F-O*u,a.b[x++]=I*u+O*F,a.b[x++]=(p+A)/m,a.b[x++]=q/k,a.b[x++]=n,a.b[x++]=r,I=-y*f,O=y*g,a.b[x++]=wa,a.b[x++]=Ua,a.b[x++]=I*F-O*u,a.b[x++]=I*u+O*F,a.b[x++]=p/m,a.b[x++]=q/k,a.b[x++]=n,a.b[x++]=r,a.a[z++]=J,a.a[z++]=J+1,a.a[z++]=J+2,a.a[z++]=J,a.a[z++]=J+2,a.a[z++]=J+3}uq.prototype.rb=function(a,c){this.c.push(this.a.length);this.B.push(c);var d=a.o;wq(this,d,d.length,a.H)};
uq.prototype.sb=function(a,c){this.c.push(this.a.length);this.B.push(c);var d=a.o;wq(this,d,d.length,a.H)};function xq(a,c){var d=c.b;a.v.push(a.a.length);a.j.push(a.a.length);a.A=new kq(a.b);mq(c,34962,a.A);a.l=new kq(a.a);mq(c,34963,a.l);var e={};yq(a.Qa,a.g,e,d);yq(a.i,a.f,e,d);a.C=void 0;a.O=void 0;a.ka=void 0;a.g=null;a.f=null;a.J=void 0;a.U=void 0;a.a=null;a.Y=void 0;a.$=void 0;a.da=void 0;a.ga=void 0;a.Pa=void 0;a.sa=void 0;a.b=null;a.xa=void 0}
function yq(a,c,d,e){var f,g,h,k=c.length;for(h=0;h<k;++h)f=c[h],g=v(f).toString(),g in d?f=d[g]:(f=tq(e,f),d[g]=f),a[h]=f}
function zq(a,c,d,e,f,g,h,k,m,n,p){var q=c.b;mq(c,34962,a.A);mq(c,34963,a.l);var r=hq.Eb(),u=iq.Eb(),u=rq(c,r,u);a.ea?r=a.ea:(r=new jq(q,u),a.ea=r);c.me(u);q.enableVertexAttribArray(r.f);q.vertexAttribPointer(r.f,2,5126,!1,32,0);q.enableVertexAttribArray(r.b);q.vertexAttribPointer(r.b,2,5126,!1,32,8);q.enableVertexAttribArray(r.g);q.vertexAttribPointer(r.g,2,5126,!1,32,16);q.enableVertexAttribArray(r.a);q.vertexAttribPointer(r.a,1,5126,!1,32,24);q.enableVertexAttribArray(r.c);q.vertexAttribPointer(r.c,
1,5126,!1,32,28);u=a.qb;jk(u,0,0,2/(e*g[0]),2/(e*g[1]),-f,-(d[0]-a.D[0]),-(d[1]-a.D[1]));d=a.pb;e=2/g[0];g=2/g[1];Gd(d);d[0]=e;d[5]=g;d[10]=1;d[15]=1;g=a.ib;Gd(g);0!==f&&Ld(g,-f);q.uniformMatrix4fv(r.i,!1,u);q.uniformMatrix4fv(r.D,!1,d);q.uniformMatrix4fv(r.l,!1,g);q.uniform1f(r.j,h);var y;if(void 0===m)Aq(a,q,c,k,a.Qa,a.v);else{if(n)a:{f=c.c?5125:5123;c=c.c?4:2;g=a.c.length-1;for(h=a.i.length-1;0<=h;--h)for(q.bindTexture(3553,a.i[h]),n=0<h?a.j[h-1]:0,u=a.j[h];0<=g&&a.c[g]>=n;){y=a.c[g];d=a.B[g];
e=v(d).toString();if(void 0===k[e]&&d.W()&&(void 0===p||ke(p,d.W().S()))&&(q.clear(q.COLOR_BUFFER_BIT|q.DEPTH_BUFFER_BIT),q.drawElements(4,u-y,f,y*c),u=m(d))){a=u;break a}u=y;g--}a=void 0}else q.clear(q.COLOR_BUFFER_BIT|q.DEPTH_BUFFER_BIT),Aq(a,q,c,k,a.i,a.j),a=(a=m(null))?a:void 0;y=a}q.disableVertexAttribArray(r.f);q.disableVertexAttribArray(r.b);q.disableVertexAttribArray(r.g);q.disableVertexAttribArray(r.a);q.disableVertexAttribArray(r.c);return y}
function Aq(a,c,d,e,f,g){var h=d.c?5125:5123;d=d.c?4:2;if(Pb(e)){var k;a=0;e=f.length;for(k=0;a<e;++a){c.bindTexture(3553,f[a]);var m=g[a];c.drawElements(4,m-k,h,k*d);k=m}}else{k=0;var n,m=0;for(n=f.length;m<n;++m){c.bindTexture(3553,f[m]);for(var p=0<m?g[m-1]:0,q=g[m],r=p;k<a.c.length&&a.c[k]<=q;){var u=v(a.B[k]).toString();void 0!==e[u]?(r!==p&&c.drawElements(4,p-r,h,r*d),p=r=k===a.c.length-1?q:a.c[k+1]):p=k===a.c.length-1?q:a.c[k+1];k++}r!==p&&c.drawElements(4,p-r,h,r*d)}}}
uq.prototype.fb=function(a){var c=a.Db(),d=a.Mb(1),e=a.Fd(),f=a.fe(1),g=a.A,h=a.ua(),k=a.C,m=a.D,n=a.ob();a=a.B;var p;0===this.g.length?this.g.push(d):(p=this.g[this.g.length-1],v(p)!=v(d)&&(this.v.push(this.a.length),this.g.push(d)));0===this.f.length?this.f.push(f):(p=this.f[this.f.length-1],v(p)!=v(f)&&(this.j.push(this.a.length),this.f.push(f)));this.C=c[0];this.O=c[1];this.ka=n[1];this.J=e[1];this.U=e[0];this.Y=g;this.$=h[0];this.da=h[1];this.Pa=m;this.ga=k;this.sa=a;this.xa=n[0]};
function Bq(a,c,d){this.f=c;this.g=a;this.c=d;this.a={}}function Cq(a,c){var d=[],e;for(e in a.a)d.push(vq(a.a[e],c));return ve.apply(null,d)}function Dq(a,c){for(var d in a.a)xq(a.a[d],c)}Bq.prototype.b=function(a,c){var d=this.a[c];void 0===d&&(d=new Eq[c](this.g,this.f),this.a[c]=d);return d};Bq.prototype.za=function(){return Pb(this.a)};function Fq(a,c,d,e,f,g,h,k,m,n){var p=Gq,q,r;for(q=Cm.length-1;0<=q;--q)if(r=a.a[Cm[q]],void 0!==r&&(r=zq(r,c,d,e,f,p,g,h,k,m,n)))return r}
function Hq(a,c,d,e,f,g,h,k){var m=d.b;m.bindFramebuffer(m.FRAMEBUFFER,oq(d));var n;void 0!==a.c&&(n=Rd(Yd(c),e*a.c));return Fq(a,d,c,e,f,g,h,function(a){var c=new Uint8Array(4);m.readPixels(0,0,1,1,m.RGBA,m.UNSIGNED_BYTE,c);if(0<c[3]&&(a=k(a)))return a},!0,n)}function Iq(a,c,d,e,f,g,h){var k=d.b;k.bindFramebuffer(k.FRAMEBUFFER,oq(d));return void 0!==Fq(a,d,c,e,f,g,h,function(){var a=new Uint8Array(4);k.readPixels(0,0,1,1,k.RGBA,k.UNSIGNED_BYTE,a);return 0<a[3]},!1)}var Eq={Image:uq},Gq=[1,1];function Jq(a,c,d,e,f,g){this.a=a;this.g=c;this.f=g;this.l=f;this.i=e;this.j=d;this.c=null;this.b={}}w(Jq,dk);l=Jq.prototype;l.Xc=function(a,c){var d=a.toString(),e=this.b[d];void 0!==e?e.push(c):this.b[d]=[c]};l.qc=function(){};l.Ne=function(a,c){var d=(0,c.f)(a);if(d&&ke(this.f,d.S())){var e=c.b;void 0===e&&(e=0);this.Xc(e,function(a){a.Ma(c.g,c.c);a.fb(c.j);a.Na(c.a);var e=Kq[d.X()];e&&e.call(a,d,null)})}};
l.Ad=function(a,c){var d=a.f,e,f;e=0;for(f=d.length;e<f;++e){var g=d[e],h=Kq[g.X()];h&&h.call(this,g,c)}};l.sb=function(a,c){var d=this.a,e=(new Bq(1,this.f)).b(0,"Image");e.fb(this.c);e.sb(a,c);xq(e,d);zq(e,this.a,this.g,this.j,this.i,this.l,1,{},void 0,!1);vq(e,d)()};l.Bb=function(){};l.rc=function(){};l.rb=function(a,c){var d=this.a,e=(new Bq(1,this.f)).b(0,"Image");e.fb(this.c);e.rb(a,c);xq(e,d);zq(e,this.a,this.g,this.j,this.i,this.l,1,{},void 0,!1);vq(e,d)()};l.sc=function(){};l.tc=function(){};
l.tb=function(){};l.Ma=function(){};l.fb=function(a){this.c=a};l.Na=function(){};var Kq={Point:Jq.prototype.sb,MultiPoint:Jq.prototype.rb,GeometryCollection:Jq.prototype.Ad};function Lq(){this.b="precision mediump float;varying vec2 a;uniform float f;uniform sampler2D g;void main(void){vec4 texColor=texture2D(g,a);gl_FragColor.rgb=texColor.rgb;gl_FragColor.a=texColor.a*f;}"}w(Lq,fq);ea(Lq);function Mq(){this.b="varying vec2 a;attribute vec2 b;attribute vec2 c;uniform mat4 d;uniform mat4 e;void main(void){gl_Position=e*vec4(b,0.,1.);a=(d*vec4(c,0.,1.)).st;}"}w(Mq,gq);ea(Mq);
function Nq(a,c){this.c=a.getUniformLocation(c,"f");this.f=a.getUniformLocation(c,"e");this.j=a.getUniformLocation(c,"d");this.g=a.getUniformLocation(c,"g");this.b=a.getAttribLocation(c,"b");this.a=a.getAttribLocation(c,"c")};function Oq(a,c){mk.call(this,c);this.c=a;this.U=new kq([-1,-1,0,0,1,-1,1,0,-1,1,0,1,1,1,1,1]);this.g=this.Xa=null;this.j=void 0;this.D=Cd();this.A=Ed();this.B=null}w(Oq,mk);
function Pq(a,c,d){var e=a.c.c;if(void 0===a.j||a.j!=d){c.postRenderFunctions.push(ra(function(a,c,d){a.isContextLost()||(a.deleteFramebuffer(c),a.deleteTexture(d))},e,a.g,a.Xa));c=pq(e,d,d);var f=e.createFramebuffer();e.bindFramebuffer(36160,f);e.framebufferTexture2D(36160,36064,3553,c,0);a.Xa=c;a.g=f;a.j=d}else e.bindFramebuffer(36160,a.g)}
Oq.prototype.Fg=function(a,c,d){Qq(this,"precompose",d,a);mq(d,34962,this.U);var e=d.b,f=Lq.Eb(),g=Mq.Eb(),f=rq(d,f,g);this.B?g=this.B:this.B=g=new Nq(e,f);d.me(f)&&(e.enableVertexAttribArray(g.b),e.vertexAttribPointer(g.b,2,5126,!1,16,0),e.enableVertexAttribArray(g.a),e.vertexAttribPointer(g.a,2,5126,!1,16,8),e.uniform1i(g.g,0));e.uniformMatrix4fv(g.j,!1,this.D);e.uniformMatrix4fv(g.f,!1,this.A);e.uniform1f(g.c,c.opacity);e.bindTexture(3553,this.Xa);e.drawArrays(5,0,4);Qq(this,"postcompose",d,a)};
function Qq(a,c,d,e){a=a.a;if(dd(a,c)){var f=e.viewState;a.s(new ek(c,a,new Jq(d,f.center,f.resolution,f.rotation,e.size,e.extent),e,null,d))}}Oq.prototype.lf=function(){this.g=this.Xa=null;this.j=void 0};function Rq(a,c){Oq.call(this,a,c);this.l=this.i=this.f=null}w(Rq,Oq);function Sq(a,c){var d=c.b();return tq(a.c.c,d)}Rq.prototype.Wa=function(a,c,d,e){var f=this.a;return f.fa().ee(a,c.viewState.resolution,c.viewState.rotation,c.skippedFeatureUids,function(a){return d.call(e,a,f)})};
Rq.prototype.mf=function(a,c){var d=this.c.c,e=a.pixelRatio,f=a.viewState,g=f.center,h=f.resolution,k=f.rotation,m=this.f,n=this.Xa,p=this.a.fa(),q=a.viewHints,r=a.extent;void 0!==c.extent&&(r=je(r,c.extent));q[0]||q[1]||me(r)||(f=f.projection,(q=p.i)&&(f=q),(r=p.ec(r,h,e,f))&&ok(this,r)&&(m=r,n=Sq(this,r),this.Xa&&a.postRenderFunctions.push(ra(function(a,c){a.isContextLost()||a.deleteTexture(c)},d,this.Xa))));m&&(d=this.c.g.B,Tq(this,d.width,d.height,e,g,h,k,m.S()),this.l=null,e=this.D,Gd(e),Kd(e,
1,-1),Jd(e,0,-1),this.f=m,this.Xa=n,qk(a.attributions,m.j),rk(a,p));return!0};function Tq(a,c,d,e,f,g,h,k){c*=g;d*=g;a=a.A;Gd(a);Kd(a,2*e/c,2*e/d);Ld(a,-h);Jd(a,k[0]-f[0],k[1]-f[1]);Kd(a,(k[2]-k[0])/2,(k[3]-k[1])/2);Jd(a,1,1)}Rq.prototype.ce=function(a,c){return void 0!==this.Wa(a,c,re,this)};
Rq.prototype.dc=function(a,c,d,e){if(this.f&&this.f.b())if(this.a.fa()instanceof Qp){if(a=a.slice(),lk(c.pixelToCoordinateMatrix,a,a),this.Wa(a,c,re,this))return d.call(e,this.a)}else{var f=[this.f.b().width,this.f.b().height];if(!this.l){var g=c.size;c=Cd();Gd(c);Jd(c,-1,-1);Kd(c,2/g[0],2/g[1]);Jd(c,0,g[1]);Kd(c,1,-1);g=Cd();Id(this.A,g);var h=Cd();Gd(h);Jd(h,0,f[1]);Kd(h,1,-1);Kd(h,f[0]/2,f[1]/2);Jd(h,1,1);var k=Cd();Hd(h,g,k);Hd(k,c,k);this.l=k}c=[0,0];lk(this.l,a,c);if(!(0>c[0]||c[0]>f[0]||0>
c[1]||c[1]>f[1])&&(this.i||(this.i=Qi(1,1)),this.i.clearRect(0,0,1,1),this.i.drawImage(this.f.b(),c[0],c[1],1,1,0,0,1,1),0<this.i.getImageData(0,0,1,1).data[3]))return d.call(e,this.a)}};function Uq(){this.b="precision mediump float;varying vec2 a;uniform sampler2D e;void main(void){gl_FragColor=texture2D(e,a);}"}w(Uq,fq);ea(Uq);function Vq(){this.b="varying vec2 a;attribute vec2 b;attribute vec2 c;uniform vec4 d;void main(void){gl_Position=vec4(b*d.xy+d.zw,0.,1.);a=c;}"}w(Vq,gq);ea(Vq);function Wq(a,c){this.c=a.getUniformLocation(c,"e");this.f=a.getUniformLocation(c,"d");this.b=a.getAttribLocation(c,"b");this.a=a.getAttribLocation(c,"c")};function Xq(a,c){Oq.call(this,a,c);this.O=Uq.Eb();this.Y=Vq.Eb();this.f=null;this.C=new kq([0,0,0,1,1,0,1,1,0,1,0,0,1,1,1,0]);this.v=this.i=null;this.l=-1;this.J=[0,0]}w(Xq,Oq);l=Xq.prototype;l.Z=function(){nq(this.c.g,this.C);Xq.ca.Z.call(this)};l.zd=function(a,c){var d=this.c;return function(e,f){return Rh(a,e,f,function(a){var f=xh(d.a,a.nb());f&&(c[e]||(c[e]={}),c[e][a.b.toString()]=a);return f})}};l.lf=function(){Xq.ca.lf.call(this);this.f=null};
l.mf=function(a,c,d){var e=this.c,f=d.b,g=a.viewState,h=g.projection,k=this.a,m=k.fa(),n=Sh(m,h),p=Mh(n,g.resolution),q=n.ba(p),r=m.Vb(p,a.pixelRatio,h),u=r[0]/nd(n.La(p),this.J)[0],y=q/u,A=m.Ed(),F=g.center,z;q==g.resolution?(F=tk(F,q,a.size),z=he(F,q,g.rotation,a.size)):z=a.extent;q=Kh(n,z,q);if(this.i&&ng(this.i,q)&&this.l==m.b)y=this.v;else{var x=[pg(q),og(q)],K=Math.pow(2,Math.ceil(Math.log(Math.max(x[0]*r[0],x[1]*r[1]))/Math.LN2)),x=y*K,J=n.ua(p),I=J[0]+q.b*r[0]*y,y=J[1]+q.a*r[1]*y,y=[I,y,I+
x,y+x];Pq(this,a,K);f.viewport(0,0,K,K);f.clearColor(0,0,0,0);f.clear(16384);f.disable(3042);K=rq(d,this.O,this.Y);d.me(K);this.f||(this.f=new Wq(f,K));mq(d,34962,this.C);f.enableVertexAttribArray(this.f.b);f.vertexAttribPointer(this.f.b,2,5126,!1,16,0);f.enableVertexAttribArray(this.f.a);f.vertexAttribPointer(this.f.a,2,5126,!1,16,8);f.uniform1i(this.f.c,0);d={};d[p]={};var O=this.zd(m,d),wa=k.c(),K=!0,I=Nd(),Ua=new mg(0,0,0,0),M,Ma,qb;for(Ma=q.b;Ma<=q.f;++Ma)for(qb=q.a;qb<=q.c;++qb){J=m.Ub(p,Ma,
qb,u,h);if(void 0!==c.extent&&(M=n.Ea(J.b,I),!ke(M,c.extent)))continue;M=J.state;if(2==M){if(xh(e.a,J.nb())){d[p][fg(J.b)]=J;continue}}else if(4==M||3==M&&!wa)continue;K=!1;M=Ih(n,J.b,O,Ua,I);M||(J=Jh(n,J.b,Ua,I))&&O(p+1,J)}c=Object.keys(d).map(Number);lb(c);for(var O=new Float32Array(4),Oa,Ib,eb,wa=0,Ua=c.length;wa<Ua;++wa)for(Oa in Ib=d[c[wa]],Ib)J=Ib[Oa],M=n.Ea(J.b,I),Ma=2*(M[2]-M[0])/x,qb=2*(M[3]-M[1])/x,eb=2*(M[0]-y[0])/x-1,M=2*(M[1]-y[1])/x-1,Bd(O,Ma,qb,eb,M),f.uniform4fv(this.f.f,O),Yq(e,J,
r,A*u),f.drawArrays(5,0,4);K?(this.i=q,this.v=y,this.l=m.b):(this.v=this.i=null,this.l=-1,a.animate=!0)}sk(a.usedTiles,m,p,q);var Ic=e.l;uk(a,m,n,u,h,z,p,k.a(),function(a){var c;(c=2!=a.state||xh(e.a,a.nb()))||(c=a.nb()in Ic.c);c||vk(Ic,[a,hg(n,a.b),n.ba(a.b[0]),r,A*u])},this);pk(a,m);rk(a,m);f=this.D;Gd(f);Jd(f,(F[0]-y[0])/(y[2]-y[0]),(F[1]-y[1])/(y[3]-y[1]));0!==g.rotation&&Ld(f,g.rotation);Kd(f,a.size[0]*g.resolution/(y[2]-y[0]),a.size[1]*g.resolution/(y[3]-y[1]));Jd(f,-.5,-.5);return!0};
l.dc=function(a,c,d,e){if(this.g){var f=[0,0];lk(this.D,[a[0]/c.size[0],(c.size[1]-a[1])/c.size[1]],f);a=[f[0]*this.j,f[1]*this.j];c=this.c.g.b;c.bindFramebuffer(c.FRAMEBUFFER,this.g);f=new Uint8Array(4);c.readPixels(a[0],a[1],1,1,c.RGBA,c.UNSIGNED_BYTE,f);if(0<f[3])return d.call(e,this.a)}};function Zq(a,c){Oq.call(this,a,c);this.l=!1;this.J=-1;this.O=NaN;this.v=Nd();this.i=this.f=this.C=null}w(Zq,Oq);l=Zq.prototype;l.Fg=function(a,c,d){this.i=c;var e=a.viewState,f=this.f;if(f&&!f.za()){var g=e.center,h=e.resolution,e=e.rotation,k=a.size,m=c.opacity;a=c.Ib?a.skippedFeatureUids:{};var n,p;c=0;for(n=Cm.length;c<n;++c)p=f.a[Cm[c]],void 0!==p&&zq(p,d,g,h,e,k,m,a,void 0,!1)}};l.Z=function(){var a=this.f;a&&(Cq(a,this.c.g)(),this.f=null);Zq.ca.Z.call(this)};
l.Wa=function(a,c,d,e){if(this.f&&this.i){var f=c.viewState,g=this.a,h=this.i,k={};return Hq(this.f,a,this.c.g,f.resolution,f.rotation,h.opacity,h.Ib?c.skippedFeatureUids:{},function(a){var c=v(a).toString();if(!(c in k))return k[c]=!0,d.call(e,a,g)})}};l.ce=function(a,c){if(this.f&&this.i){var d=c.viewState;return Iq(this.f,a,this.c.g,d.resolution,d.rotation,this.i.opacity,c.skippedFeatureUids)}return!1};
l.dc=function(a,c,d,e){a=a.slice();lk(c.pixelToCoordinateMatrix,a,a);if(this.ce(a,c))return d.call(e,this.a)};l.Il=function(){nk(this)};
l.mf=function(a,c,d){function e(a){var c,d=a.c;d?c=d.call(a,n):(d=f.c)&&(c=d(a,n));if(c){if(c){var e,g=!1,d=0;for(e=c.length;d<e;++d)g=on(r,a,c[d],nn(n,p),this.Il,this)||g;a=g}else a=!1;this.l=this.l||a}}var f=this.a;c=f.fa();qk(a.attributions,c.j);rk(a,c);var g=a.viewHints[0],h=a.viewHints[1],k=f.C,m=f.O;if(!this.l&&!k&&g||!m&&h)return!0;var h=a.extent,k=a.viewState,g=k.projection,n=k.resolution,p=a.pixelRatio,k=f.b,q=f.a,m=f.get("renderOrder");void 0===m&&(m=mn);h=Rd(h,q*n);if(!this.l&&this.O==
n&&this.J==k&&this.C==m&&Wd(this.v,h))return!0;this.f&&a.postRenderFunctions.push(Cq(this.f,d));this.l=!1;var r=new Bq(.5*n/p,h,f.a);c.Yb(h,n,g);if(m){var u=[];c.Cb(h,n,function(a){u.push(a)},this);lb(u,m);u.forEach(e,this)}else c.Cb(h,n,e,this);Dq(r,d);this.O=n;this.J=k;this.C=m;this.v=h;this.f=r;return!0};function $q(a,c){Bk.call(this,0,c);this.b=Pg("CANVAS");this.b.style.width="100%";this.b.style.height="100%";this.b.className="ol-unselectable";Sg(a,this.b,0);this.v=this.C=0;this.O=Qi();this.D=!0;this.c=Wi(this.b,{antialias:!0,depth:!1,failIfMajorPerformanceCaveat:!0,preserveDrawingBuffer:!1,stencil:!0});this.g=new lq(this.b,this.c);B(this.b,"webglcontextlost",this.Gl,!1,this);B(this.b,"webglcontextrestored",this.Hl,!1,this);this.a=new wh;this.A=null;this.l=new Gk(qa(function(a){var c=a[1];a=a[2];
var f=c[0]-this.A[0],c=c[1]-this.A[1];return 65536*Math.log(a)+Math.sqrt(f*f+c*c)/a},this),function(a){return a[0].nb()});this.J=qa(function(){if(!this.l.za()){Kk(this.l);var a=Hk(this.l);Yq(this,a[0],a[3],a[4])}},this);this.i=0;ar(this)}w($q,Bk);
function Yq(a,c,d,e){var f=a.c,g=c.nb();if(xh(a.a,g))a=a.a.get(g),f.bindTexture(3553,a.Xa),9729!=a.lg&&(f.texParameteri(3553,10240,9729),a.lg=9729),9729!=a.mg&&(f.texParameteri(3553,10240,9729),a.mg=9729);else{var h=f.createTexture();f.bindTexture(3553,h);if(0<e){var k=a.O.canvas,m=a.O;a.C!==d[0]||a.v!==d[1]?(k.width=d[0],k.height=d[1],a.C=d[0],a.v=d[1]):m.clearRect(0,0,d[0],d[1]);m.drawImage(c.Ta(),e,e,d[0],d[1],0,0,d[0],d[1]);f.texImage2D(3553,0,6408,6408,5121,k)}else f.texImage2D(3553,0,6408,6408,
5121,c.Ta());f.texParameteri(3553,10240,9729);f.texParameteri(3553,10241,9729);f.texParameteri(3553,10242,33071);f.texParameteri(3553,10243,33071);a.a.set(g,{Xa:h,lg:9729,mg:9729})}}l=$q.prototype;l.Me=function(a){return a instanceof Tl?new Rq(this,a):a instanceof E?new Xq(this,a):a instanceof G?new Zq(this,a):null};
function br(a,c,d){var e=a.j;if(dd(e,c)){var f=a.g;a=d.viewState;a=new Jq(f,a.center,a.resolution,a.rotation,d.size,d.extent);e.s(new ek(c,e,a,d,null,f));c=Object.keys(a.b).map(Number);lb(c);var g,h;d=0;for(e=c.length;d<e;++d)for(f=a.b[c[d].toString()],g=0,h=f.length;g<h;++g)f[g](a)}}l.Z=function(){var a=this.c;a.isContextLost()||this.a.forEach(function(c){c&&a.deleteTexture(c.Xa)});tc(this.g);$q.ca.Z.call(this)};
l.yi=function(a,c){for(var d=this.c,e;1024<this.a.Sb()-this.i;){if(e=this.a.b.mc)d.deleteTexture(e.Xa);else if(+this.a.b.Ud==c.index)break;else--this.i;this.a.pop()}};l.X=function(){return"webgl"};l.Gl=function(a){a.preventDefault();this.a.clear();this.i=0;Gb(this.f,function(a){a.lf()})};l.Hl=function(){ar(this);this.j.render()};function ar(a){a=a.c;a.activeTexture(33984);a.blendFuncSeparate(770,771,1,771);a.disable(2884);a.disable(2929);a.disable(3089);a.disable(2960)}
l.se=function(a){var c=this.g,d=this.c;if(d.isContextLost())return!1;if(!a)return this.D&&(nh(this.b,!1),this.D=!1),!1;this.A=a.focus;this.a.set((-a.index).toString(),null);++this.i;br(this,"precompose",a);var e=[],f=a.layerStatesArray;nb(f);var g=a.viewState.resolution,h,k,m,n;h=0;for(k=f.length;h<k;++h)n=f[h],gk(n,g)&&"ready"==n.A&&(m=Ek(this,n.layer),m.mf(a,n,c)&&e.push(n));f=a.size[0]*a.pixelRatio;g=a.size[1]*a.pixelRatio;if(this.b.width!=f||this.b.height!=g)this.b.width=f,this.b.height=g;d.bindFramebuffer(36160,
null);d.clearColor(0,0,0,0);d.clear(16384);d.enable(3042);d.viewport(0,0,this.b.width,this.b.height);h=0;for(k=e.length;h<k;++h)n=e[h],m=Ek(this,n.layer),m.Fg(a,n,c);this.D||(nh(this.b,!0),this.D=!0);Ck(a);1024<this.a.Sb()-this.i&&a.postRenderFunctions.push(qa(this.yi,this));this.l.za()||(a.postRenderFunctions.push(this.J),a.animate=!0);br(this,"postcompose",a);Fk(this,a);a.postRenderFunctions.push(Dk)};
l.kf=function(a,c,d,e,f,g){var h;if(this.c.isContextLost())return!1;var k=c.viewState,m=c.layerStatesArray,n;for(n=m.length-1;0<=n;--n){h=m[n];var p=h.layer;if(gk(h,k.resolution)&&f.call(g,p)&&(h=Ek(this,p).Wa(a,c,d,e)))return h}};l.Eg=function(a,c,d,e){var f=!1;if(this.c.isContextLost())return!1;var g=c.viewState,h=c.layerStatesArray,k;for(k=h.length-1;0<=k;--k){var m=h[k],n=m.layer;if(gk(m,g.resolution)&&d.call(e,n)&&(f=Ek(this,n).ce(a,c)))return!0}return f};
l.Dg=function(a,c,d,e,f){if(this.c.isContextLost())return!1;var g=c.viewState,h,k=c.layerStatesArray,m;for(m=k.length-1;0<=m;--m){h=k[m];var n=h.layer;if(gk(h,g.resolution)&&f.call(e,n)&&(h=Ek(this,n).dc(a,c,d,e)))return h}};var cr=["canvas","webgl","dom"];
function V(a){hd.call(this);var c=dr(a);this.nc=void 0!==a.loadTilesWhileAnimating?a.loadTilesWhileAnimating:!1;this.oc=void 0!==a.loadTilesWhileInteracting?a.loadTilesWhileInteracting:!1;this.Ce=void 0!==a.pixelRatio?a.pixelRatio:Yi;this.Kc=c.logos;this.B=new ji(this.Mn,void 0,this);sc(this,this.B);this.pb=Cd();this.De=Cd();this.qb=0;this.c=null;this.Qa=Nd();this.v=this.U=null;this.a=Mg("DIV","ol-viewport");this.a.style.position="relative";this.a.style.overflow="hidden";this.a.style.width="100%";
this.a.style.height="100%";this.a.style.msTouchAction="none";this.a.style.touchAction="none";cj&&ah(this.a,"ol-touch");this.O=Mg("DIV","ol-overlaycontainer");this.a.appendChild(this.O);this.C=Mg("DIV","ol-overlaycontainer-stopevent");B(this.C,["click","dblclick","mousedown","touchstart","MSPointerDown",Xj,$b?"DOMMouseScroll":"mousewheel"],vc);this.a.appendChild(this.C);a=new Pj(this);B(a,Kb(ak),this.eg,!1,this);sc(this,a);this.ga=c.keyboardEventTarget;this.A=new Bi;B(this.A,"key",this.dg,!1,this);
sc(this,this.A);a=new Ji(this.a);B(a,"mousewheel",this.dg,!1,this);sc(this,a);this.g=c.controls;this.f=c.interactions;this.j=c.overlays;this.$={};this.i=new c.On(this.a,this);sc(this,this.i);this.ib=new wi;sc(this,this.ib);this.Y=this.l=null;this.J=[];this.xa=[];this.sa=new Lk(qa(this.sj,this),qa(this.Nk,this));this.da={};B(this,jd("layergroup"),this.Gj,!1,this);B(this,jd("view"),this.ak,!1,this);B(this,jd("size"),this.Yj,!1,this);B(this,jd("target"),this.$j,!1,this);this.I(c.values);this.g.forEach(function(a){a.setMap(this)},
this);B(this.g,"add",function(a){a.element.setMap(this)},!1,this);B(this.g,"remove",function(a){a.element.setMap(null)},!1,this);this.f.forEach(function(a){a.setMap(this)},this);B(this.f,"add",function(a){a.element.setMap(this)},!1,this);B(this.f,"remove",function(a){a.element.setMap(null)},!1,this);this.j.forEach(this.Qf,this);B(this.j,"add",function(a){this.Qf(a.element)},!1,this);B(this.j,"remove",function(a){var c=a.element.Ca();void 0!==c&&delete this.$[c.toString()];a.element.setMap(null)},
!1,this)}w(V,hd);l=V.prototype;l.li=function(a){this.g.push(a)};l.mi=function(a){this.f.push(a)};l.Of=function(a){this.Tb().zc().push(a)};l.Pf=function(a){this.j.push(a)};l.Qf=function(a){var c=a.Ca();void 0!==c&&(this.$[c.toString()]=a);a.setMap(this)};l.Ba=function(a){this.render();Array.prototype.push.apply(this.J,arguments)};l.Z=function(){Tg(this.a);V.ca.Z.call(this)};l.Zc=function(a,c,d,e,f){if(this.c)return a=this.ya(a),this.i.kf(a,this.c,c,void 0!==d?d:null,void 0!==e?e:re,void 0!==f?f:null)};
l.Mk=function(a,c,d,e,f){if(this.c)return this.i.Dg(a,this.c,c,void 0!==d?d:null,void 0!==e?e:re,void 0!==f?f:null)};l.ck=function(a,c,d){if(!this.c)return!1;a=this.ya(a);return this.i.Eg(a,this.c,void 0!==c?c:re,void 0!==d?d:null)};l.Ni=function(a){return this.ya(this.Cd(a))};l.Cd=function(a){var c;c=this.a;a=kh(a);c=kh(c);c=new Dg(a.x-c.x,a.y-c.y);return[c.x,c.y]};l.ff=function(){return this.get("target")};l.wc=function(){var a=this.ff();return void 0!==a?Ig(a):null};
l.ya=function(a){var c=this.c;return c?(a=a.slice(),lk(c.pixelToCoordinateMatrix,a,a)):null};l.Li=function(){return this.g};l.gj=function(){return this.j};l.fj=function(a){a=this.$[a.toString()];return void 0!==a?a:null};l.Ui=function(){return this.f};l.Tb=function(){return this.get("layergroup")};l.sg=function(){return this.Tb().zc()};l.Da=function(a){var c=this.c;return c?(a=a.slice(0,2),lk(c.coordinateToPixelMatrix,a,a)):null};l.Ha=function(){return this.get("size")};l.aa=function(){return this.get("view")};
l.uj=function(){return this.a};l.sj=function(a,c,d,e){var f=this.c;if(!(f&&c in f.wantedTiles&&f.wantedTiles[c][fg(a.b)]))return Infinity;a=d[0]-f.focus[0];d=d[1]-f.focus[1];return 65536*Math.log(e)+Math.sqrt(a*a+d*d)/e};l.dg=function(a,c){var d=new Nj(c||a.type,this,a);this.eg(d)};l.eg=function(a){if(this.c){this.Y=a.coordinate;a.frameState=this.c;var c=this.f.a,d;if(!1!==this.s(a))for(d=c.length-1;0<=d;d--){var e=c[d];if(e.c()&&!e.handleEvent(a))break}}};
l.Wj=function(){var a=this.c,c=this.sa;if(!c.za()){var d=16,e=d,f=0;a&&(f=a.viewHints,f[0]&&(d=this.nc?8:0,e=2),f[1]&&(d=this.oc?8:0,e=2),f=Jb(a.wantedTiles));d*=f;e*=f;c.f<d&&(Kk(c),Mk(c,d,e))}c=this.xa;d=0;for(e=c.length;d<e;++d)c[d](this,a);c.length=0};l.Yj=function(){this.render()};l.$j=function(){var a=this.wc();Ii(this.A);a?(a.appendChild(this.a),Ci(this.A,this.ga?this.ga:a),this.l||(this.l=B(this.ib,"resize",this.Hc,!1,this))):(Tg(this.a),this.l&&(Yc(this.l),this.l=null));this.Hc()};l.Nk=function(){this.render()};
l.bk=function(){this.render()};l.ak=function(){this.U&&(Yc(this.U),this.U=null);var a=this.aa();a&&(this.U=B(a,"propertychange",this.bk,!1,this));this.render()};l.Hj=function(){this.render()};l.Ij=function(){this.render()};l.Gj=function(){this.v&&(this.v.forEach(Yc),this.v=null);var a=this.Tb();a&&(this.v=[B(a,"propertychange",this.Ij,!1,this),B(a,"change",this.Hj,!1,this)]);this.render()};l.Nn=function(){var a=this.B;ki(a);a.f()};l.render=function(){null!=this.B.qa||this.B.start()};l.Gn=function(a){return this.g.remove(a)};
l.Hn=function(a){return this.f.remove(a)};l.Jn=function(a){return this.Tb().zc().remove(a)};l.Kn=function(a){return this.j.remove(a)};
l.Mn=function(a){var c,d,e,f=this.Ha(),g=this.aa(),h=null;if(void 0!==f&&0<f[0]&&0<f[1]&&g&&Tf(g)){var h=g.c.slice(),k=this.Tb().Xe(),m={};c=0;for(d=k.length;c<d;++c)m[v(k[c].layer)]=k[c];e=Sf(g);h={animate:!1,attributions:{},coordinateToPixelMatrix:this.pb,extent:null,focus:this.Y?this.Y:e.center,index:this.qb++,layerStates:m,layerStatesArray:k,logos:Tb(this.Kc),pixelRatio:this.Ce,pixelToCoordinateMatrix:this.De,postRenderFunctions:[],size:f,skippedFeatureUids:this.da,tileQueue:this.sa,time:a,usedTiles:{},
viewState:e,viewHints:h,wantedTiles:{}}}if(h){a=this.J;c=f=0;for(d=a.length;c<d;++c)g=a[c],g(this,h)&&(a[f++]=g);a.length=f;h.extent=he(e.center,e.resolution,e.rotation,h.size)}this.c=h;this.i.se(h);h&&(h.animate&&this.render(),Array.prototype.push.apply(this.xa,h.postRenderFunctions),0!==this.J.length||h.viewHints[0]||h.viewHints[1]||Zd(h.extent,this.Qa)||(this.s(new uh("moveend",this,h)),Sd(h.extent,this.Qa)));this.s(new uh("postrender",this,h));oi(this.Wj,this)};
l.nh=function(a){this.set("layergroup",a)};l.zf=function(a){this.set("size",a)};l.Ok=function(a){this.set("target",a)};l.fo=function(a){this.set("view",a)};l.sh=function(a){a=v(a).toString();this.da[a]=!0;this.render()};
l.Hc=function(){var a=this.wc();if(a){var c=Hg(a),d=Yb&&a.currentStyle;d&&Xg(Fg(c))&&"auto"!=d.width&&"auto"!=d.height&&!d.boxSizing?(c=oh(a,d.width,"width","pixelWidth"),a=oh(a,d.height,"height","pixelHeight"),a=new Eg(c,a)):(d=new Eg(a.offsetWidth,a.offsetHeight),c=qh(a,"padding"),a=th(a),a=new Eg(d.width-a.left-c.left-c.right-a.right,d.height-a.top-c.top-c.bottom-a.bottom));this.zf([a.width,a.height])}else this.zf(void 0)};l.vh=function(a){a=v(a).toString();delete this.da[a];this.render()};
function dr(a){var c=null;void 0!==a.keyboardEventTarget&&(c=ia(a.keyboardEventTarget)?document.getElementById(a.keyboardEventTarget):a.keyboardEventTarget);var d={},e={};if(void 0===a.logo||"boolean"==typeof a.logo&&a.logo)e["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAA3NCSVQICAjb4U/gAAAACXBIWXMAAAHGAAABxgEXwfpGAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAhNQTFRF////AP//AICAgP//AFVVQECA////K1VVSbbbYL/fJ05idsTYJFtbbcjbJllmZszWWMTOIFhoHlNiZszTa9DdUcHNHlNlV8XRIVdiasrUHlZjIVZjaMnVH1RlIFRkH1RkH1ZlasvYasvXVsPQH1VkacnVa8vWIVZjIFRjVMPQa8rXIVVkXsXRsNveIFVkIFZlIVVj3eDeh6GmbMvXH1ZkIFRka8rWbMvXIFVkIFVjIFVkbMvWH1VjbMvWIFVlbcvWIFVla8vVIFVkbMvWbMvVH1VkbMvWIFVlbcvWIFVkbcvVbMvWjNPbIFVkU8LPwMzNIFVkbczWIFVkbsvWbMvXIFVkRnB8bcvW2+TkW8XRIFVkIlZlJVloJlpoKlxrLl9tMmJwOWd0Omh1RXF8TneCT3iDUHiDU8LPVMLPVcLPVcPQVsPPVsPQV8PQWMTQWsTQW8TQXMXSXsXRX4SNX8bSYMfTYcfTYsfTY8jUZcfSZsnUaIqTacrVasrVa8jTa8rWbI2VbMvWbcvWdJObdcvUdszUd8vVeJaee87Yfc3WgJyjhqGnitDYjaarldPZnrK2oNbborW5o9bbo9fbpLa6q9ndrL3ArtndscDDutzfu8fJwN7gwt7gxc/QyuHhy+HizeHi0NfX0+Pj19zb1+Tj2uXk29/e3uLg3+Lh3+bl4uXj4ufl4+fl5Ofl5ufl5ujm5+jmySDnBAAAAFp0Uk5TAAECAgMEBAYHCA0NDg4UGRogIiMmKSssLzU7PkJJT1JTVFliY2hrdHZ3foSFhYeJjY2QkpugqbG1tre5w8zQ09XY3uXn6+zx8vT09vf4+Pj5+fr6/P39/f3+gz7SsAAAAVVJREFUOMtjYKA7EBDnwCPLrObS1BRiLoJLnte6CQy8FLHLCzs2QUG4FjZ5GbcmBDDjxJBXDWxCBrb8aM4zbkIDzpLYnAcE9VXlJSWlZRU13koIeW57mGx5XjoMZEUqwxWYQaQbSzLSkYGfKFSe0QMsX5WbjgY0YS4MBplemI4BdGBW+DQ11eZiymfqQuXZIjqwyadPNoSZ4L+0FVM6e+oGI6g8a9iKNT3o8kVzNkzRg5lgl7p4wyRUL9Yt2jAxVh6mQCogae6GmflI8p0r13VFWTHBQ0rWPW7ahgWVcPm+9cuLoyy4kCJDzCm6d8PSFoh0zvQNC5OjDJhQopPPJqph1doJBUD5tnkbZiUEqaCnB3bTqLTFG1bPn71kw4b+GFdpLElKIzRxxgYgWNYc5SCENVHKeUaltHdXx0dZ8uBI1hJ2UUDgq82CM2MwKeibqAvSO7MCABq0wXEPiqWEAAAAAElFTkSuQmCC"]=
"http://openlayers.org/";else{var f=a.logo;ia(f)?e[f]="":f instanceof HTMLElement?e[v(f).toString()]=f:la(f)&&(e[f.src]=f.href)}f=a.layers instanceof Ll?a.layers:new Ll({layers:a.layers});d.layergroup=f;d.target=a.target;d.view=void 0!==a.view?a.view:new Of;var f=Bk,g;void 0!==a.renderer?ga(a.renderer)?g=a.renderer:ia(a.renderer)&&(g=[a.renderer]):g=cr;var h,k;h=0;for(k=g.length;h<k;++h){var m=g[h];if("canvas"==m){if($i){f=Vp;break}}else if("dom"==m){f=cq;break}else if("webgl"==m&&Xi){f=$q;break}}var n;
void 0!==a.controls?n=ga(a.controls)?new tg(a.controls.slice()):a.controls:n=ai();var p;void 0!==a.interactions?p=ga(a.interactions)?new tg(a.interactions.slice()):a.interactions:p=Kl();a=void 0!==a.overlays?ga(a.overlays)?new tg(a.overlays.slice()):a.overlays:new tg;return{controls:n,interactions:p,keyboardEventTarget:c,logos:e,overlays:a,On:f,values:d}}Sl();function er(a){hd.call(this);this.qa=a.id;this.i=void 0!==a.insertFirst?a.insertFirst:!0;this.l=void 0!==a.stopEvent?a.stopEvent:!0;this.c=Mg("DIV",{"class":"ol-overlay-container"});this.c.style.position="absolute";this.autoPan=void 0!==a.autoPan?a.autoPan:!1;this.g=void 0!==a.autoPanAnimation?a.autoPanAnimation:{};this.j=void 0!==a.autoPanMargin?a.autoPanMargin:20;this.a={vd:"",Vd:"",te:"",ue:"",visible:!0};this.f=null;B(this,jd("element"),this.Cj,!1,this);B(this,jd("map"),this.Nj,!1,this);B(this,
jd("offset"),this.Sj,!1,this);B(this,jd("position"),this.Uj,!1,this);B(this,jd("positioning"),this.Vj,!1,this);void 0!==a.element&&this.kh(a.element);this.ph(void 0!==a.offset?a.offset:[0,0]);this.qh(void 0!==a.positioning?a.positioning:"top-left");void 0!==a.position&&this.gf(a.position)}w(er,hd);l=er.prototype;l.Yd=function(){return this.get("element")};l.Ca=function(){return this.qa};l.Zd=function(){return this.get("map")};l.ag=function(){return this.get("offset")};l.tg=function(){return this.get("position")};
l.bg=function(){return this.get("positioning")};l.Cj=function(){Rg(this.c);var a=this.Yd();a&&Qg(this.c,a)};l.Nj=function(){this.f&&(Tg(this.c),Yc(this.f),this.f=null);var a=this.Zd();a&&(this.f=B(a,"postrender",this.render,!1,this),fr(this),a=this.l?a.C:a.O,this.i?Sg(a,this.c,0):Qg(a,this.c))};l.render=function(){fr(this)};l.Sj=function(){fr(this)};
l.Uj=function(){fr(this);if(void 0!==this.get("position")&&this.autoPan){var a=this.Zd();if(void 0!==a&&a.wc()){var c=gr(a.wc(),a.Ha()),d=this.Yd(),e=d.offsetWidth,f=d.currentStyle||window.getComputedStyle(d),e=e+(parseInt(f.marginLeft,10)+parseInt(f.marginRight,10)),f=d.offsetHeight,g=d.currentStyle||window.getComputedStyle(d),f=f+(parseInt(g.marginTop,10)+parseInt(g.marginBottom,10)),h=gr(d,[e,f]),d=this.j;Wd(c,h)||(e=h[0]-c[0],f=c[2]-h[2],g=h[1]-c[1],h=c[3]-h[3],c=[0,0],0>e?c[0]=e-d:0>f&&(c[0]=
Math.abs(f)+d),0>g?c[1]=g-d:0>h&&(c[1]=Math.abs(h)+d),0===c[0]&&0===c[1])||(d=a.aa().Ia(),e=a.Da(d),c=[e[0]+c[0],e[1]+c[1]],this.g&&(this.g.source=d,a.Ba($f(this.g))),a.aa().Ua(a.ya(c)))}}};l.Vj=function(){fr(this)};l.kh=function(a){this.set("element",a)};l.setMap=function(a){this.set("map",a)};l.ph=function(a){this.set("offset",a)};l.gf=function(a){this.set("position",a)};
function gr(a,c){var d=Hg(a),e=new Dg(0,0),f;f=d?Hg(d):document;f=!Yb||9<=kc||Xg(Fg(f))?f.documentElement:f.body;a!=f&&(f=jh(a),d=Yg(Fg(d)),e.x=f.left+d.x,e.y=f.top+d.y);return[e.x,e.y,e.x+c[0],e.y+c[1]]}l.qh=function(a){this.set("positioning",a)};function hr(a,c){a.a.visible!==c&&(nh(a.c,c),a.a.visible=c)}
function fr(a){var c=a.Zd(),d=a.tg();if(void 0!==c&&c.c&&void 0!==d){var d=c.Da(d),e=c.Ha(),c=a.c.style,f=a.ag(),g=a.bg(),h=f[0],f=f[1];if("bottom-right"==g||"center-right"==g||"top-right"==g)""!==a.a.Vd&&(a.a.Vd=c.left=""),h=Math.round(e[0]-d[0]-h)+"px",a.a.te!=h&&(a.a.te=c.right=h);else{""!==a.a.te&&(a.a.te=c.right="");if("bottom-center"==g||"center-center"==g||"top-center"==g)h-=lh(a.c).width/2;h=Math.round(d[0]+h)+"px";a.a.Vd!=h&&(a.a.Vd=c.left=h)}if("bottom-left"==g||"bottom-center"==g||"bottom-right"==
g)""!==a.a.ue&&(a.a.ue=c.top=""),d=Math.round(e[1]-d[1]-f)+"px",a.a.vd!=d&&(a.a.vd=c.bottom=d);else{""!==a.a.vd&&(a.a.vd=c.bottom="");if("center-left"==g||"center-center"==g||"center-right"==g)f-=lh(a.c).height/2;d=Math.round(d[1]+f)+"px";a.a.ue!=d&&(a.a.ue=c.top=d)}hr(a,!0)}else hr(a,!1)};function ir(a){a=a?a:{};this.j=void 0!==a.collapsed?a.collapsed:!0;this.i=void 0!==a.collapsible?a.collapsible:!0;this.i||(this.j=!1);var c=a.className?a.className:"ol-overviewmap",d=a.tipLabel?a.tipLabel:"Overview map",e=a.collapseLabel?a.collapseLabel:"\u00ab";this.A=ia(e)?Mg("SPAN",{},e):e;e=a.label?a.label:"\u00bb";this.v=ia(e)?Mg("SPAN",{},e):e;d=Mg("BUTTON",{type:"button",title:d},this.i&&!this.j?this.A:this.v);B(d,"click",this.Yk,!1,this);var e=Mg("DIV","ol-overviewmap-map"),f=this.c=new V({controls:new tg,
interactions:new tg,target:e,view:a.view});a.layers&&a.layers.forEach(function(a){f.Of(a)},this);var g=Mg("DIV","ol-overviewmap-box");this.l=new er({position:[0,0],positioning:"bottom-left",element:g});this.c.Pf(this.l);c=Mg("DIV",c+" ol-unselectable ol-control"+(this.j&&this.i?" ol-collapsed":"")+(this.i?"":" ol-uncollapsible"),e,d);vh.call(this,{element:c,render:a.render?a.render:jr,target:a.target})}w(ir,vh);l=ir.prototype;
l.setMap=function(a){var c=this.a;a!==c&&(c&&(c=c.aa())&&Xc(c,jd("rotation"),this.Pd,!1,this),ir.ca.setMap.call(this,a),a&&(this.B.push(B(a,"propertychange",this.Oj,!1,this)),0===this.c.sg().Jb()&&this.c.nh(a.Tb()),a=a.aa()))&&(B(a,jd("rotation"),this.Pd,!1,this),Tf(a)&&(this.c.Hc(),kr(this)))};l.Oj=function(a){"view"===a.key&&((a=a.oldValue)&&Xc(a,jd("rotation"),this.Pd,!1,this),a=this.a.aa(),B(a,jd("rotation"),this.Pd,!1,this))};l.Pd=function(){this.c.aa().$d(this.a.aa().wa())};
function jr(){var a=this.a,c=this.c;if(a.c&&c.c){var d=a.Ha(),a=a.aa().Mc(d),e=c.Ha(),d=c.aa().Mc(e),f=c.Da(fe(a)),c=c.Da(de(a)),c=new Eg(Math.abs(f[0]-c[0]),Math.abs(f[1]-c[1])),f=e[0],e=e[1];c.width<.1*f||c.height<.1*e||c.width>.75*f||c.height>.75*e?kr(this):Wd(d,a)||(a=this.c,d=this.a.aa(),a.aa().Ua(d.Ia()))}lr(this)}function kr(a){var c=a.a;a=a.c;var d=c.Ha(),c=c.aa().Mc(d),d=a.Ha();a=a.aa();ne(c,1/(.1*Math.pow(2,Math.log(7.5)/Math.LN2/2)));a.Oe(c,d)}
function lr(a){var c=a.a,d=a.c;if(c.c&&d.c){var e=c.Ha(),f=c.aa(),g=d.aa();d.Ha();var c=f.wa(),h=a.l,d=a.l.Yd(),f=f.Mc(e),e=g.ba(),g=ce(f),f=ee(f),k;if(a=a.a.aa().Ia())k=[g[0]-a[0],g[1]-a[1]],vd(k,c),qd(k,a);h.gf(k);d&&(k=new Eg(Math.abs((g[0]-f[0])/e),Math.abs((f[1]-g[1])/e)),c=Xg(Fg(Hg(d))),!Yb||ic("10")||c&&ic("8")?(d=d.style,$b?d.MozBoxSizing="border-box":ac?d.WebkitBoxSizing="border-box":d.boxSizing="border-box",d.width=Math.max(k.width,0)+"px",d.height=Math.max(k.height,0)+"px"):(a=d.style,
c?(c=qh(d,"padding"),d=th(d),a.pixelWidth=k.width-d.left-c.left-c.right-d.right,a.pixelHeight=k.height-d.top-c.top-c.bottom-d.bottom):(a.pixelWidth=k.width,a.pixelHeight=k.height)))}}l.Yk=function(a){a.preventDefault();mr(this)};function mr(a){ch(a.element,"ol-collapsed");a.j?Ug(a.A,a.v):Ug(a.v,a.A);a.j=!a.j;var c=a.c;a.j||c.c||(c.Hc(),kr(a),Wc(c,"postrender",function(){lr(this)},!1,a))}l.Xk=function(){return this.i};
l.$k=function(a){this.i!==a&&(this.i=a,ch(this.element,"ol-uncollapsible"),!a&&this.j&&mr(this))};l.Zk=function(a){this.i&&this.j!==a&&mr(this)};l.Wk=function(){return this.j};l.hj=function(){return this.c};function nr(a){a=a?a:{};var c=a.className?a.className:"ol-scale-line";this.l=Mg("DIV",c+"-inner");this.i=Mg("DIV",c+" ol-unselectable",this.l);this.v=null;this.A=void 0!==a.minWidth?a.minWidth:64;this.c=!1;this.J=void 0;this.C="";this.j=null;vh.call(this,{element:this.i,render:a.render?a.render:or,target:a.target});B(this,jd("units"),this.$,!1,this);this.Y(a.units||"metric")}w(nr,vh);var pr=[1,2,5];nr.prototype.O=function(){return this.get("units")};
function or(a){(a=a.frameState)?this.v=a.viewState:this.v=null;qr(this)}nr.prototype.$=function(){qr(this)};nr.prototype.Y=function(a){this.set("units",a)};
function qr(a){var c=a.v;if(c){var d=c.center,e=c.projection,c=e.getPointResolution(c.resolution,d),f=e.a,g=a.O();"degrees"!=f||"metric"!=g&&"imperial"!=g&&"us"!=g&&"nautical"!=g?"degrees"!=f&&"degrees"==g?(a.j||(a.j=Ge(e,Ce("EPSG:4326"))),d=Math.cos(Ta(a.j(d)[1])),e=ye.radius,e/=ze[f],c*=180/(Math.PI*d*e)):a.j=null:(a.j=null,d=Math.cos(Ta(d[1])),c*=Math.PI*d*ye.radius/180);d=a.A*c;f="";"degrees"==g?d<1/60?(f="\u2033",c*=3600):1>d?(f="\u2032",c*=60):f="\u00b0":"imperial"==g?.9144>d?(f="in",c/=.0254):
1609.344>d?(f="ft",c/=.3048):(f="mi",c/=1609.344):"nautical"==g?(c/=1852,f="nm"):"metric"==g?1>d?(f="mm",c*=1E3):1E3>d?f="m":(f="km",c/=1E3):"us"==g&&(.9144>d?(f="in",c*=39.37):1609.344>d?(f="ft",c/=.30480061):(f="mi",c/=1609.3472));for(d=3*Math.floor(Math.log(a.A*c)/Math.log(10));;){e=pr[d%3]*Math.pow(10,Math.floor(d/3));g=Math.round(e/c);if(isNaN(g)){nh(a.i,!1);a.c=!1;return}if(g>=a.A)break;++d}c=e+" "+f;a.C!=c&&(a.l.innerHTML=c,a.C=c);a.J!=g&&(a.l.style.width=g+"px",a.J=g);a.c||(nh(a.i,!0),a.c=
!0)}else a.c&&(nh(a.i,!1),a.c=!1)};function rr(a){pc.call(this);this.a=a;this.b={}}w(rr,pc);var sr=[];rr.prototype.Sa=function(a,c,d,e){ga(c)||(c&&(sr[0]=c.toString()),c=sr);for(var f=0;f<c.length;f++){var g=B(a,c[f],d||this.handleEvent,e||!1,this.a||this);if(!g)break;this.b[g.key]=g}return this};
rr.prototype.Af=function(a,c,d,e,f){if(ga(c))for(var g=0;g<c.length;g++)this.Af(a,c[g],d,e,f);else d=d||this.handleEvent,f=f||this.a||this,d=Qc(d),e=!!e,c=Dc(a)?Lc(a.jb,String(c),d,e,f):a?(a=Sc(a))?Lc(a,c,d,e,f):null:null,c&&(Yc(c),delete this.b[c.key]);return this};function tr(a){Gb(a.b,function(a,d){this.b.hasOwnProperty(d)&&Yc(a)},a);a.b={}}rr.prototype.Z=function(){rr.ca.Z.call(this);tr(this)};rr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented");};function ur(a,c,d){bd.call(this);this.target=a;this.handle=c||a;this.b=d||new eh(NaN,NaN,NaN,NaN);this.j=Hg(a);this.a=new rr(this);sc(this,this.a);this.g=this.f=this.D=this.l=this.screenY=this.screenX=this.clientY=this.clientX=0;this.c=!1;B(this.handle,["touchstart","mousedown"],this.th,!1,this)}w(ur,bd);var vr=Yb||$b&&ic("1.9.3");l=ur.prototype;
l.Z=function(){ur.ca.Z.call(this);Xc(this.handle,["touchstart","mousedown"],this.th,!1,this);tr(this.a);vr&&this.j.releaseCapture();this.handle=this.target=null};
l.th=function(a){var c="mousedown"==a.type;if(this.c||c&&!Bc(a))this.s("earlycancel");else if(this.s(new wr("start",this,a.clientX,a.clientY))){this.c=!0;a.preventDefault();var c=this.j,d=c.documentElement,e=!vr;this.a.Sa(c,["touchmove","mousemove"],this.Rj,e);this.a.Sa(c,["touchend","mouseup"],this.Bd,e);vr?(d.setCapture(!1),this.a.Sa(d,"losecapture",this.Bd)):this.a.Sa(c?c.parentWindow||c.defaultView:window,"blur",this.Bd);this.B&&this.a.Sa(this.B,"scroll",this.Ym,e);this.clientX=this.l=a.clientX;
this.clientY=this.D=a.clientY;this.screenX=a.screenX;this.screenY=a.screenY;this.f=this.target.offsetLeft;this.g=this.target.offsetTop;this.i=Yg(Fg(this.j))}};l.Bd=function(a){tr(this.a);vr&&this.j.releaseCapture();this.c?(this.c=!1,this.s(new wr("end",this,a.clientX,a.clientY,0,xr(this,this.f),yr(this,this.g)))):this.s("earlycancel")};
l.Rj=function(a){var c=1*(a.clientX-this.clientX),d=a.clientY-this.clientY;this.clientX=a.clientX;this.clientY=a.clientY;this.screenX=a.screenX;this.screenY=a.screenY;if(!this.c){var e=this.l-this.clientX,f=this.D-this.clientY;if(0<e*e+f*f)if(this.s(new wr("start",this,a.clientX,a.clientY)))this.c=!0;else{this.ea||this.Bd(a);return}}d=zr(this,c,d);c=d.x;d=d.y;this.c&&this.s(new wr("beforedrag",this,a.clientX,a.clientY,0,c,d))&&(Ar(this,a,c,d),a.preventDefault())};
function zr(a,c,d){var e=Yg(Fg(a.j));c+=e.x-a.i.x;d+=e.y-a.i.y;a.i=e;a.f+=c;a.g+=d;return new Dg(xr(a,a.f),yr(a,a.g))}l.Ym=function(a){var c=zr(this,0,0);a.clientX=this.clientX;a.clientY=this.clientY;Ar(this,a,c.x,c.y)};function Ar(a,c,d,e){a.target.style.left=d+"px";a.target.style.top=e+"px";a.s(new wr("drag",a,c.clientX,c.clientY,0,d,e))}function xr(a,c){var d=a.b,e=isNaN(d.left)?null:d.left,d=isNaN(d.width)?0:d.width;return Math.min(null!=e?e+d:Infinity,Math.max(null!=e?e:-Infinity,c))}
function yr(a,c){var d=a.b,e=isNaN(d.top)?null:d.top,d=isNaN(d.height)?0:d.height;return Math.min(null!=e?e+d:Infinity,Math.max(null!=e?e:-Infinity,c))}function wr(a,c,d,e,f,g,h){uc.call(this,a);this.clientX=d;this.clientY=e;this.left=ca(g)?g:c.f;this.top=ca(h)?h:c.g}w(wr,uc);function Br(a){a=a?a:{};this.j=void 0;this.i=Cr;this.l=null;this.v=!1;this.A=a.duration?a.duration:200;var c=a.className?a.className:"ol-zoomslider",d=Mg("BUTTON",{type:"button","class":c+"-thumb ol-unselectable"}),c=Mg("DIV",[c,"ol-unselectable","ol-control"],d);this.c=new ur(d);sc(this,this.c);B(this.c,"start",this.Bj,!1,this);B(this.c,"drag",this.zj,!1,this);B(this.c,"end",this.Aj,!1,this);B(c,"click",this.yj,!1,this);B(d,"click",vc);vh.call(this,{element:c,render:a.render?a.render:Dr})}w(Br,vh);
var Cr=0;l=Br.prototype;l.setMap=function(a){Br.ca.setMap.call(this,a);a&&a.render()};
function Dr(a){if(a.frameState){if(!this.v){var c=this.element,d=lh(c),e=Vg(c),c=qh(e,"margin"),f=new Eg(e.offsetWidth,e.offsetHeight),e=f.width+c.right+c.left,c=f.height+c.top+c.bottom;this.l=[e,c];e=d.width-e;c=d.height-c;d.width>d.height?(this.i=1,d=new eh(0,0,e,0)):(this.i=Cr,d=new eh(0,0,0,c));this.c.b=d||new eh(NaN,NaN,NaN,NaN);this.v=!0}a=a.frameState.viewState.resolution;a!==this.j&&(this.j=a,a=1-Rf(this.a.aa())(a),d=this.c,c=Vg(this.element),1==this.i?hh(c,d.b.left+d.b.width*a):hh(c,d.b.left,
d.b.top+d.b.height*a))}}l.yj=function(a){var c=this.a,d=c.aa(),e=d.ba();c.Ba(bg({resolution:e,duration:this.A,easing:Wf}));a=Er(this,Fr(this,a.offsetX-this.l[0]/2,a.offsetY-this.l[1]/2));d.zb(d.constrainResolution(a))};l.Bj=function(){Uf(this.a.aa(),1)};l.zj=function(a){this.j=Er(this,Fr(this,a.left,a.top));this.a.aa().zb(this.j)};l.Aj=function(){var a=this.a,c=a.aa();Uf(c,-1);a.Ba(bg({resolution:this.j,duration:this.A,easing:Wf}));a=c.constrainResolution(this.j);c.zb(a)};
function Fr(a,c,d){var e=a.c.b;return Qa(1===a.i?(c-e.left)/e.width:(d-e.top)/e.height,0,1)}function Er(a,c){return Qf(a.a.aa())(1-c)};function Gr(a){a=a?a:{};this.c=a.extent?a.extent:null;var c=a.className?a.className:"ol-zoom-extent",d=Mg("BUTTON",{type:"button",title:a.tipLabel?a.tipLabel:"Fit to extent"},a.label?a.label:"E");B(d,"click",this.j,!1,this);c=Mg("DIV",c+" ol-unselectable ol-control",d);vh.call(this,{element:c,target:a.target})}w(Gr,vh);Gr.prototype.j=function(a){a.preventDefault();var c=this.a;a=c.aa();var d=this.c?this.c:a.g.S(),c=c.Ha();a.Oe(d,c)};function Hr(a){hd.call(this);a=a?a:{};this.a=null;B(this,jd("tracking"),this.Ak,!1,this);this.df(void 0!==a.tracking?a.tracking:!1)}w(Hr,hd);l=Hr.prototype;l.Z=function(){this.df(!1);Hr.ca.Z.call(this)};
l.Zm=function(a){a=a.b;if(null!==a.alpha){var c=Ta(a.alpha);this.set("alpha",c);"boolean"==typeof a.absolute&&a.absolute?this.set("heading",c):ja(a.webkitCompassHeading)&&-1!=a.webkitCompassAccuracy&&this.set("heading",Ta(a.webkitCompassHeading))}null!==a.beta&&this.set("beta",Ta(a.beta));null!==a.gamma&&this.set("gamma",Ta(a.gamma));this.u()};l.Gi=function(){return this.get("alpha")};l.Ji=function(){return this.get("beta")};l.Ri=function(){return this.get("gamma")};l.zk=function(){return this.get("heading")};
l.og=function(){return this.get("tracking")};l.Ak=function(){if(aj){var a=this.og();a&&!this.a?this.a=B(ba,"deviceorientation",this.Zm,!1,this):!a&&this.a&&(Yc(this.a),this.a=null)}};l.df=function(a){this.set("tracking",a)};function Ir(){this.defaultDataProjection=null}function Jr(a,c,d){var e;d&&(e={dataProjection:d.dataProjection?d.dataProjection:a.Ka(c),featureProjection:d.featureProjection});return Kr(a,e)}function Kr(a,c){var d;c&&(d={featureProjection:c.featureProjection,dataProjection:c.dataProjection?c.dataProjection:a.defaultDataProjection,rightHanded:c.rightHanded});return d}
function Lr(a,c,d){var e=d?Ce(d.featureProjection):null;d=d?Ce(d.dataProjection):null;return e&&d&&!Ue(e,d)?a instanceof Ze?(c?a.clone():a).Va(c?e:d,c?d:e):Ye(c?a.slice():a,c?e:d,c?d:e):a};function Mr(){this.defaultDataProjection=null}w(Mr,Ir);function Nr(a){return la(a)?a:ia(a)?(a=ho(a))?a:null:null}l=Mr.prototype;l.X=function(){return"json"};l.yb=function(a,c){return this.Cc(Nr(a),Jr(this,a,c))};l.ta=function(a,c){return this.sf(Nr(a),Jr(this,a,c))};l.Dc=function(a,c){return this.Wg(Nr(a),Jr(this,a,c))};l.Ka=function(a){return this.bh(Nr(a))};l.od=function(a,c){return io(this.Ic(a,c))};l.Ab=function(a,c){return io(this.xe(a,c))};l.Jc=function(a,c){return io(this.ze(a,c))};function Or(a){a=a?a:{};this.defaultDataProjection=null;this.b=a.geometryName}w(Or,Mr);
function Pr(a,c){if(!a)return null;var d;if(ja(a.x)&&ja(a.y))d="Point";else if(a.points)d="MultiPoint";else if(a.paths)d=1===a.paths.length?"LineString":"MultiLineString";else if(a.rings){var e=a.rings,f=Qr(a),g=[];d=[];var h,k;h=0;for(k=e.length;h<k;++h){var m=sb(e[h]);Df(m,0,m.length,f.length)?g.push([e[h]]):d.push(e[h])}for(;d.length;){e=d.shift();f=!1;for(h=g.length-1;0<=h;h--)if(Wd((new tf(g[h][0])).S(),(new tf(e)).S())){g[h].push(e);f=!0;break}f||g.push([e.reverse()])}a=Tb(a);1===g.length?(d=
"Polygon",a.rings=g[0]):(d="MultiPolygon",a.rings=g)}return Lr((0,Rr[d])(a),!1,c)}function Qr(a){var c="XY";!0===a.hasZ&&!0===a.hasM?c="XYZM":!0===a.hasZ?c="XYZ":!0===a.hasM&&(c="XYM");return c}function Sr(a){a=a.a;return{hasZ:"XYZ"===a||"XYZM"===a,hasM:"XYM"===a||"XYZM"===a}}
var Rr={Point:function(a){return void 0!==a.m&&void 0!==a.z?new C([a.x,a.y,a.z,a.m],"XYZM"):void 0!==a.z?new C([a.x,a.y,a.z],"XYZ"):void 0!==a.m?new C([a.x,a.y,a.m],"XYM"):new C([a.x,a.y])},LineString:function(a){return new H(a.paths[0],Qr(a))},Polygon:function(a){return new D(a.rings,Qr(a))},MultiPoint:function(a){return new jn(a.points,Qr(a))},MultiLineString:function(a){return new L(a.paths,Qr(a))},MultiPolygon:function(a){return new N(a.rings,Qr(a))}},Tr={Point:function(a){var c=a.V();a=a.a;if("XYZ"===
a)return{x:c[0],y:c[1],z:c[2]};if("XYM"===a)return{x:c[0],y:c[1],m:c[2]};if("XYZM"===a)return{x:c[0],y:c[1],z:c[2],m:c[3]};if("XY"===a)return{x:c[0],y:c[1]}},LineString:function(a){var c=Sr(a);return{hasZ:c.hasZ,hasM:c.hasM,paths:[a.V()]}},Polygon:function(a){var c=Sr(a);return{hasZ:c.hasZ,hasM:c.hasM,rings:a.V(!1)}},MultiPoint:function(a){var c=Sr(a);return{hasZ:c.hasZ,hasM:c.hasM,points:a.V()}},MultiLineString:function(a){var c=Sr(a);return{hasZ:c.hasZ,hasM:c.hasM,paths:a.V()}},MultiPolygon:function(a){var c=
Sr(a);a=a.V(!1);for(var d=[],e=0;e<a.length;e++)for(var f=a[e].length-1;0<=f;f--)d.push(a[e][f]);return{hasZ:c.hasZ,hasM:c.hasM,rings:d}}};l=Or.prototype;l.Cc=function(a,c){var d=Pr(a.geometry,c),e=new P;this.b&&e.Fc(this.b);e.Aa(d);c&&c.Ze&&a.attributes[c.Ze]&&e.Pb(a.attributes[c.Ze]);a.attributes&&e.I(a.attributes);return e};
l.sf=function(a,c){var d=c?c:{};if(a.features){var e=[],f=a.features,g,h;d.Ze=a.objectIdFieldName;g=0;for(h=f.length;g<h;++g)e.push(this.Cc(f[g],d));return e}return[this.Cc(a,d)]};l.Wg=function(a,c){return Pr(a,c)};l.bh=function(a){return a.spatialReference&&a.spatialReference.wkid?Ce("EPSG:"+a.spatialReference.wkid):null};function Ur(a,c){return(0,Tr[a.X()])(Lr(a,!0,c),c)}l.ze=function(a,c){return Ur(a,Kr(this,c))};
l.Ic=function(a,c){c=Kr(this,c);var d={},e=a.W();e&&(d.geometry=Ur(e,c));e=a.R();delete e[a.a];d.attributes=Pb(e)?{}:e;c&&c.featureProjection&&(d.spatialReference={wkid:Ce(c.featureProjection).b.split(":").pop()});return d};l.xe=function(a,c){c=Kr(this,c);var d=[],e,f;e=0;for(f=a.length;e<f;++e)d.push(this.Ic(a[e],c));return{features:d}};function Vr(a){a=a?a:{};this.defaultDataProjection=null;this.defaultDataProjection=Ce(a.defaultDataProjection?a.defaultDataProjection:"EPSG:4326");this.b=a.geometryName}w(Vr,Mr);function Wr(a,c){return a?Lr((0,Xr[a.type])(a),!1,c):null}function Yr(a,c){return(0,Zr[a.X()])(Lr(a,!0,c),c)}
var Xr={Point:function(a){return new C(a.coordinates)},LineString:function(a){return new H(a.coordinates)},Polygon:function(a){return new D(a.coordinates)},MultiPoint:function(a){return new jn(a.coordinates)},MultiLineString:function(a){return new L(a.coordinates)},MultiPolygon:function(a){return new N(a.coordinates)},GeometryCollection:function(a,c){var d=a.geometries.map(function(a){return Wr(a,c)});return new Zm(d)}},Zr={Point:function(a){return{type:"Point",coordinates:a.V()}},LineString:function(a){return{type:"LineString",
coordinates:a.V()}},Polygon:function(a,c){var d;c&&(d=c.rightHanded);return{type:"Polygon",coordinates:a.V(d)}},MultiPoint:function(a){return{type:"MultiPoint",coordinates:a.V()}},MultiLineString:function(a){return{type:"MultiLineString",coordinates:a.V()}},MultiPolygon:function(a,c){var d;c&&(d=c.rightHanded);return{type:"MultiPolygon",coordinates:a.V(d)}},GeometryCollection:function(a,c){return{type:"GeometryCollection",geometries:a.f.map(function(a){return Yr(a,c)})}},Circle:function(){return{type:"GeometryCollection",
geometries:[]}}};l=Vr.prototype;l.Cc=function(a,c){var d=Wr(a.geometry,c),e=new P;this.b&&e.Fc(this.b);e.Aa(d);a.id&&e.Pb(a.id);a.properties&&e.I(a.properties);return e};l.sf=function(a,c){if("Feature"==a.type)return[this.Cc(a,c)];if("FeatureCollection"==a.type){var d=[],e=a.features,f,g;f=0;for(g=e.length;f<g;++f)d.push(this.Cc(e[f],c));return d}return[]};l.Wg=function(a,c){return Wr(a,c)};
l.bh=function(a){return(a=a.crs)?"name"==a.type?Ce(a.properties.name):"EPSG"==a.type?Ce("EPSG:"+a.properties.code):null:this.defaultDataProjection};l.Ic=function(a,c){c=Kr(this,c);var d={type:"Feature"},e=a.Ca();e&&(d.id=e);e=a.W();d.geometry=e?Yr(e,c):null;e=a.R();delete e[a.a];d.properties=Pb(e)?null:e;return d};l.xe=function(a,c){c=Kr(this,c);var d=[],e,f;e=0;for(f=a.length;e<f;++e)d.push(this.Ic(a[e],c));return{type:"FeatureCollection",features:d}};l.ze=function(a,c){return Yr(a,Kr(this,c))};function $r(){this.defaultDataProjection=null}w($r,Ir);l=$r.prototype;l.X=function(){return"xml"};l.yb=function(a,c){if($o(a))return as(this,a,c);if(cp(a))return this.Ug(a,c);if(ia(a)){var d=mp(a);return as(this,d,c)}return null};function as(a,c,d){a=bs(a,c,d);return 0<a.length?a[0]:null}l.ta=function(a,c){if($o(a))return bs(this,a,c);if(cp(a))return this.Ob(a,c);if(ia(a)){var d=mp(a);return bs(this,d,c)}return[]};
function bs(a,c,d){var e=[];for(c=c.firstChild;c;c=c.nextSibling)1==c.nodeType&&ib(e,a.Ob(c,d));return e}l.Dc=function(a,c){if($o(a))return this.B(a,c);if(cp(a)){var d=this.oe(a,[Jr(this,a,c?c:{})]);return d?d:null}return ia(a)?(d=mp(a),this.B(d,c)):null};l.Ka=function(a){return $o(a)?this.wf(a):cp(a)?this.re(a):ia(a)?(a=mp(a),this.wf(a)):null};l.wf=function(){return this.defaultDataProjection};l.re=function(){return this.defaultDataProjection};l.od=function(a,c){var d=this.v(a,c);return Mo(d)};
l.Ab=function(a,c){var d=this.a(a,c);return Mo(d)};l.Jc=function(a,c){var d=this.D(a,c);return Mo(d)};function cs(a){a=a?a:{};this.featureType=a.featureType;this.featureNS=a.featureNS;this.srsName=a.srsName;this.schemaLocation="";this.b={};this.b["http://www.opengis.net/gml"]={featureMember:pp(cs.prototype.jd),featureMembers:pp(cs.prototype.jd)};this.defaultDataProjection=null}w(cs,$r);l=cs.prototype;
l.jd=function(a,c){var d=Xo(a),e;if("FeatureCollection"==d)"http://www.opengis.net/wfs"===a.namespaceURI?e=T([],this.b,a,c,this):e=T(null,this.b,a,c,this);else if("featureMembers"==d||"featureMember"==d){var f=c[0],g=f.featureType;e=f.featureNS;var h,k;if(!g&&a.childNodes){g=[];e={};h=0;for(k=a.childNodes.length;h<k;++h){var m=a.childNodes[h];if(1===m.nodeType){var n=m.nodeName.split(":").pop();if(-1===g.indexOf(n)){var p;Nb(e,m.namespaceURI)?p=Ob(e,function(a){return a===m.namespaceURI}):(p="p"+
Jb(e),e[p]=m.namespaceURI);g.push(p+":"+n)}}}f.featureType=g;f.featureNS=e}ia(e)&&(h=e,e={},e.p0=h);var f={},g=ga(g)?g:[g],q;for(q in e){n={};h=0;for(k=g.length;h<k;++h)(-1===g[h].indexOf(":")?"p0":g[h].split(":")[0])===q&&(n[g[h].split(":").pop()]="featureMembers"==d?op(this.rf,this):pp(this.rf,this));f[e[q]]=n}e=T([],f,a,c)}e||(e=[]);return e};l.oe=function(a,c){var d=c[0];d.srsName=a.firstElementChild.getAttribute("srsName");var e=T(null,this.Ff,a,c,this);if(e)return Lr(e,!1,d)};
l.rf=function(a,c){var d,e=a.getAttribute("fid")||gp(a,"http://www.opengis.net/gml","id"),f={},g;for(d=a.firstElementChild;d;d=d.nextElementSibling){var h=Xo(d);if(0===d.childNodes.length||1===d.childNodes.length&&(3===d.firstChild.nodeType||4===d.firstChild.nodeType)){var k=To(d,!1);/^[\s\xa0]*$/.test(k)&&(k=void 0);f[h]=k}else"boundedBy"!==h&&(g=h),f[h]=this.oe(d,c)}d=new P(f);g&&d.Fc(g);e&&d.Pb(e);return d};l.ah=function(a,c){var d=this.ne(a,c);if(d){var e=new C(null);vf(e,"XYZ",d);return e}};
l.Zg=function(a,c){var d=T([],this.Qh,a,c,this);if(d)return new jn(d)};l.Yg=function(a,c){var d=T([],this.Ph,a,c,this);if(d){var e=new L(null);hn(e,d);return e}};l.$g=function(a,c){var d=T([],this.Rh,a,c,this);if(d){var e=new N(null);ln(e,d);return e}};l.Rg=function(a,c){wp(this.Uh,a,c,this)};l.kg=function(a,c){wp(this.Nh,a,c,this)};l.Sg=function(a,c){wp(this.Vh,a,c,this)};l.pe=function(a,c){var d=this.ne(a,c);if(d){var e=new H(null);fn(e,"XYZ",d);return e}};
l.sn=function(a,c){var d=T(null,this.qd,a,c,this);if(d)return d};l.Xg=function(a,c){var d=this.ne(a,c);if(d){var e=new tf(null);uf(e,"XYZ",d);return e}};l.qe=function(a,c){var d=T([null],this.Be,a,c,this);if(d&&d[0]){var e=new D(null),f=d[0],g=[f.length],h,k;h=1;for(k=d.length;h<k;++h)ib(f,d[h]),g.push(f.length);Hf(e,"XYZ",f,g);return e}};l.ne=function(a,c){return T(null,this.qd,a,c,this)};l.Qh=Object({"http://www.opengis.net/gml":{pointMember:op(cs.prototype.Rg),pointMembers:op(cs.prototype.Rg)}});
l.Ph=Object({"http://www.opengis.net/gml":{lineStringMember:op(cs.prototype.kg),lineStringMembers:op(cs.prototype.kg)}});l.Rh=Object({"http://www.opengis.net/gml":{polygonMember:op(cs.prototype.Sg),polygonMembers:op(cs.prototype.Sg)}});l.Uh=Object({"http://www.opengis.net/gml":{Point:op(cs.prototype.ne)}});l.Nh=Object({"http://www.opengis.net/gml":{LineString:op(cs.prototype.pe)}});l.Vh=Object({"http://www.opengis.net/gml":{Polygon:op(cs.prototype.qe)}});l.rd=Object({"http://www.opengis.net/gml":{LinearRing:pp(cs.prototype.sn)}});
l.Ob=function(a,c){var d={featureType:this.featureType,featureNS:this.featureNS};c&&Wb(d,Jr(this,a,c));return this.jd(a,[d])};l.re=function(a){return Ce(this.A?this.A:a.firstElementChild.getAttribute("srsName"))};function ds(a){a=To(a,!1);return es(a)}function es(a){if(a=/^\s*(true|1)|(false|0)\s*$/.exec(a))return void 0!==a[1]||!1}
function fs(a){a=To(a,!1);if(a=/^\s*(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(Z|(?:([+\-])(\d{2})(?::(\d{2}))?))\s*$/.exec(a)){var c=Date.UTC(parseInt(a[1],10),parseInt(a[2],10)-1,parseInt(a[3],10),parseInt(a[4],10),parseInt(a[5],10),parseInt(a[6],10))/1E3;if("Z"!=a[7]){var d="-"==a[8]?-1:1,c=c+60*d*parseInt(a[9],10);void 0!==a[10]&&(c+=3600*d*parseInt(a[10],10))}return c}}function gs(a){a=To(a,!1);return hs(a)}
function hs(a){if(a=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(a))return parseFloat(a[1])}function is(a){a=To(a,!1);return js(a)}function js(a){if(a=/^\s*(\d+)\s*$/.exec(a))return parseInt(a[1],10)}function W(a){return To(a,!1).trim()}function ks(a,c){ls(a,c?"1":"0")}function ms(a,c){a.appendChild(Po.createTextNode(c.toPrecision()))}function ns(a,c){a.appendChild(Po.createTextNode(c.toString()))}function ls(a,c){a.appendChild(Po.createTextNode(c))};function os(a){a=a?a:{};cs.call(this,a);this.b["http://www.opengis.net/gml"].featureMember=op(cs.prototype.jd);this.schemaLocation=a.schemaLocation?a.schemaLocation:"http://www.opengis.net/gml http://schemas.opengis.net/gml/2.1.2/feature.xsd"}w(os,cs);l=os.prototype;
l.Vg=function(a,c){var d=To(a,!1).replace(/^\s*|\s*$/g,""),e=c[0].srsName,f=a.parentNode.getAttribute("srsDimension"),g="enu";e&&(g=Fe(Ce(e)));d=d.split(/[\s,]+/);e=2;a.getAttribute("srsDimension")?e=js(a.getAttribute("srsDimension")):a.getAttribute("dimension")?e=js(a.getAttribute("dimension")):f&&(e=js(f));for(var h,k,m=[],n=0,p=d.length;n<p;n+=e)f=parseFloat(d[n]),h=parseFloat(d[n+1]),k=3===e?parseFloat(d[n+2]):0,"en"===g.substr(0,2)?m.push(f,h,k):m.push(h,f,k);return m};
l.qn=function(a,c){var d=T([null],this.Jh,a,c,this);return Qd(d[1][0],d[1][1],d[1][3],d[1][4])};l.ek=function(a,c){var d=T(void 0,this.rd,a,c,this);d&&c[c.length-1].push(d)};l.$m=function(a,c){var d=T(void 0,this.rd,a,c,this);d&&(c[c.length-1][0]=d)};l.qd=Object({"http://www.opengis.net/gml":{coordinates:pp(os.prototype.Vg)}});l.Be=Object({"http://www.opengis.net/gml":{innerBoundaryIs:os.prototype.ek,outerBoundaryIs:os.prototype.$m}});l.Jh=Object({"http://www.opengis.net/gml":{coordinates:op(os.prototype.Vg)}});
l.Ff=Object({"http://www.opengis.net/gml":{Point:pp(cs.prototype.ah),MultiPoint:pp(cs.prototype.Zg),LineString:pp(cs.prototype.pe),MultiLineString:pp(cs.prototype.Yg),LinearRing:pp(cs.prototype.Xg),Polygon:pp(cs.prototype.qe),MultiPolygon:pp(cs.prototype.$g),Box:pp(os.prototype.qn)}});function ps(a){a=a?a:{};cs.call(this,a);this.l=void 0!==a.surface?a.surface:!1;this.g=void 0!==a.curve?a.curve:!1;this.j=void 0!==a.multiCurve?a.multiCurve:!0;this.i=void 0!==a.multiSurface?a.multiSurface:!0;this.schemaLocation=a.schemaLocation?a.schemaLocation:"http://www.opengis.net/gml http://schemas.opengis.net/gml/3.1.1/profiles/gmlsfProfile/1.0.0/gmlsf.xsd"}w(ps,cs);l=ps.prototype;l.wn=function(a,c){var d=T([],this.Oh,a,c,this);if(d){var e=new L(null);hn(e,d);return e}};
l.xn=function(a,c){var d=T([],this.Sh,a,c,this);if(d){var e=new N(null);ln(e,d);return e}};l.Tf=function(a,c){wp(this.Kh,a,c,this)};l.uh=function(a,c){wp(this.Zh,a,c,this)};l.An=function(a,c){return T([null],this.Th,a,c,this)};l.Cn=function(a,c){return T([null],this.Yh,a,c,this)};l.Bn=function(a,c){return T([null],this.Be,a,c,this)};l.vn=function(a,c){return T([null],this.qd,a,c,this)};l.gk=function(a,c){var d=T(void 0,this.rd,a,c,this);d&&c[c.length-1].push(d)};
l.zi=function(a,c){var d=T(void 0,this.rd,a,c,this);d&&(c[c.length-1][0]=d)};l.dh=function(a,c){var d=T([null],this.$h,a,c,this);if(d&&d[0]){var e=new D(null),f=d[0],g=[f.length],h,k;h=1;for(k=d.length;h<k;++h)ib(f,d[h]),g.push(f.length);Hf(e,"XYZ",f,g);return e}};l.Tg=function(a,c){var d=T([null],this.Lh,a,c,this);if(d){var e=new H(null);fn(e,"XYZ",d);return e}};l.rn=function(a,c){var d=T([null],this.Mh,a,c,this);return Qd(d[1][0],d[1][1],d[2][0],d[2][1])};
l.tn=function(a,c){for(var d=To(a,!1),e=/^\s*([+\-]?\d*\.?\d+(?:[eE][+\-]?\d+)?)\s*/,f=[],g;g=e.exec(d);)f.push(parseFloat(g[1])),d=d.substr(g[0].length);if(""===d){d=c[0].srsName;e="enu";d&&(e=Fe(Ce(d)));if("neu"===e)for(d=0,e=f.length;d<e;d+=3)g=f[d],f[d]=f[d+1],f[d+1]=g;d=f.length;2==d&&f.push(0);return 0===d?void 0:f}};
l.uf=function(a,c){var d=To(a,!1).replace(/^\s*|\s*$/g,""),e=c[0].srsName,f=a.parentNode.getAttribute("srsDimension"),g="enu";e&&(g=Fe(Ce(e)));d=d.split(/\s+/);e=2;a.getAttribute("srsDimension")?e=js(a.getAttribute("srsDimension")):a.getAttribute("dimension")?e=js(a.getAttribute("dimension")):f&&(e=js(f));for(var h,k,m=[],n=0,p=d.length;n<p;n+=e)f=parseFloat(d[n]),h=parseFloat(d[n+1]),k=3===e?parseFloat(d[n+2]):0,"en"===g.substr(0,2)?m.push(f,h,k):m.push(h,f,k);return m};
l.qd=Object({"http://www.opengis.net/gml":{pos:pp(ps.prototype.tn),posList:pp(ps.prototype.uf)}});l.Be=Object({"http://www.opengis.net/gml":{interior:ps.prototype.gk,exterior:ps.prototype.zi}});
l.Ff=Object({"http://www.opengis.net/gml":{Point:pp(cs.prototype.ah),MultiPoint:pp(cs.prototype.Zg),LineString:pp(cs.prototype.pe),MultiLineString:pp(cs.prototype.Yg),LinearRing:pp(cs.prototype.Xg),Polygon:pp(cs.prototype.qe),MultiPolygon:pp(cs.prototype.$g),Surface:pp(ps.prototype.dh),MultiSurface:pp(ps.prototype.xn),Curve:pp(ps.prototype.Tg),MultiCurve:pp(ps.prototype.wn),Envelope:pp(ps.prototype.rn)}});l.Oh=Object({"http://www.opengis.net/gml":{curveMember:op(ps.prototype.Tf),curveMembers:op(ps.prototype.Tf)}});
l.Sh=Object({"http://www.opengis.net/gml":{surfaceMember:op(ps.prototype.uh),surfaceMembers:op(ps.prototype.uh)}});l.Kh=Object({"http://www.opengis.net/gml":{LineString:op(cs.prototype.pe),Curve:op(ps.prototype.Tg)}});l.Zh=Object({"http://www.opengis.net/gml":{Polygon:op(cs.prototype.qe),Surface:op(ps.prototype.dh)}});l.$h=Object({"http://www.opengis.net/gml":{patches:pp(ps.prototype.An)}});l.Lh=Object({"http://www.opengis.net/gml":{segments:pp(ps.prototype.Cn)}});
l.Mh=Object({"http://www.opengis.net/gml":{lowerCorner:op(ps.prototype.uf),upperCorner:op(ps.prototype.uf)}});l.Th=Object({"http://www.opengis.net/gml":{PolygonPatch:pp(ps.prototype.Bn)}});l.Yh=Object({"http://www.opengis.net/gml":{LineStringSegment:pp(ps.prototype.vn)}});function qs(a,c,d){d=d[d.length-1].srsName;c=c.V();for(var e=c.length,f=Array(e),g,h=0;h<e;++h){g=c[h];var k=h,m="enu";d&&(m=Fe(Ce(d)));f[k]="en"===m.substr(0,2)?g[0]+" "+g[1]:g[1]+" "+g[0]}ls(a,f.join(" "))}
l.Fh=function(a,c,d){var e=d[d.length-1].srsName;e&&a.setAttribute("srsName",e);e=So(a.namespaceURI,"pos");a.appendChild(e);d=d[d.length-1].srsName;a="enu";d&&(a=Fe(Ce(d)));c=c.V();ls(e,"en"===a.substr(0,2)?c[0]+" "+c[1]:c[1]+" "+c[0])};var rs={"http://www.opengis.net/gml":{lowerCorner:R(ls),upperCorner:R(ls)}};l=ps.prototype;l.ro=function(a,c,d){var e=d[d.length-1].srsName;e&&a.setAttribute("srsName",e);xp({node:a},rs,up,[c[0]+" "+c[1],c[2]+" "+c[3]],d,["lowerCorner","upperCorner"],this)};
l.Ch=function(a,c,d){var e=d[d.length-1].srsName;e&&a.setAttribute("srsName",e);e=So(a.namespaceURI,"posList");a.appendChild(e);qs(e,c,d)};l.Xh=function(a,c){var d=c[c.length-1],e=d.node,f=d.exteriorWritten;void 0===f&&(d.exteriorWritten=!0);return So(e.namespaceURI,void 0!==f?"interior":"exterior")};
l.Ae=function(a,c,d){var e=d[d.length-1].srsName;"PolygonPatch"!==a.nodeName&&e&&a.setAttribute("srsName",e);"Polygon"===a.nodeName||"PolygonPatch"===a.nodeName?(c=c.Gd(),xp({node:a,srsName:e},ss,this.Xh,c,d,void 0,this)):"Surface"===a.nodeName&&(e=So(a.namespaceURI,"patches"),a.appendChild(e),a=So(e.namespaceURI,"PolygonPatch"),e.appendChild(a),this.Ae(a,c,d))};
l.ve=function(a,c,d){var e=d[d.length-1].srsName;"LineStringSegment"!==a.nodeName&&e&&a.setAttribute("srsName",e);"LineString"===a.nodeName||"LineStringSegment"===a.nodeName?(e=So(a.namespaceURI,"posList"),a.appendChild(e),qs(e,c,d)):"Curve"===a.nodeName&&(e=So(a.namespaceURI,"segments"),a.appendChild(e),a=So(e.namespaceURI,"LineStringSegment"),e.appendChild(a),this.ve(a,c,d))};
l.Eh=function(a,c,d){var e=d[d.length-1],f=e.srsName,e=e.surface;f&&a.setAttribute("srsName",f);c=c.Id();xp({node:a,srsName:f,surface:e},ts,this.f,c,d,void 0,this)};l.so=function(a,c,d){var e=d[d.length-1].srsName;e&&a.setAttribute("srsName",e);c=c.ae();xp({node:a,srsName:e},us,sp("pointMember"),c,d,void 0,this)};l.Dh=function(a,c,d){var e=d[d.length-1],f=e.srsName,e=e.curve;f&&a.setAttribute("srsName",f);c=c.$c();xp({node:a,srsName:f,curve:e},vs,this.f,c,d,void 0,this)};
l.Gh=function(a,c,d){var e=So(a.namespaceURI,"LinearRing");a.appendChild(e);this.Ch(e,c,d)};l.Hh=function(a,c,d){var e=this.c(c,d);e&&(a.appendChild(e),this.Ae(e,c,d))};l.to=function(a,c,d){var e=So(a.namespaceURI,"Point");a.appendChild(e);this.Fh(e,c,d)};l.Bh=function(a,c,d){var e=this.c(c,d);e&&(a.appendChild(e),this.ve(e,c,d))};
l.ye=function(a,c,d){var e=d[d.length-1],f=Tb(e);f.node=a;var g;ga(c)?e.dataProjection?g=Ye(c,e.featureProjection,e.dataProjection):g=c:g=Lr(c,!0,e);xp(f,ws,this.c,[g],d,void 0,this)};
l.zh=function(a,c,d){var e=c.Ca();e&&a.setAttribute("fid",e);var e=d[d.length-1],f=e.featureNS,g=c.a;e.hc||(e.hc={},e.hc[f]={});var h=c.R();c=[];var k=[],m;for(m in h){var n=h[m];null!==n&&(c.push(m),k.push(n),m==g||n instanceof Ze?m in e.hc[f]||(e.hc[f][m]=R(this.ye,this)):m in e.hc[f]||(e.hc[f][m]=R(ls)))}m=Tb(e);m.node=a;xp(m,e.hc,sp(void 0,f),k,d,c)};
var ts={"http://www.opengis.net/gml":{surfaceMember:R(ps.prototype.Hh),polygonMember:R(ps.prototype.Hh)}},us={"http://www.opengis.net/gml":{pointMember:R(ps.prototype.to)}},vs={"http://www.opengis.net/gml":{lineStringMember:R(ps.prototype.Bh),curveMember:R(ps.prototype.Bh)}},ss={"http://www.opengis.net/gml":{exterior:R(ps.prototype.Gh),interior:R(ps.prototype.Gh)}},ws={"http://www.opengis.net/gml":{Curve:R(ps.prototype.ve),MultiCurve:R(ps.prototype.Dh),Point:R(ps.prototype.Fh),MultiPoint:R(ps.prototype.so),
LineString:R(ps.prototype.ve),MultiLineString:R(ps.prototype.Dh),LinearRing:R(ps.prototype.Ch),Polygon:R(ps.prototype.Ae),MultiPolygon:R(ps.prototype.Eh),Surface:R(ps.prototype.Ae),MultiSurface:R(ps.prototype.Eh),Envelope:R(ps.prototype.ro)}},xs={MultiLineString:"lineStringMember",MultiCurve:"curveMember",MultiPolygon:"polygonMember",MultiSurface:"surfaceMember"};ps.prototype.f=function(a,c){return So("http://www.opengis.net/gml",xs[c[c.length-1].node.nodeName])};
ps.prototype.c=function(a,c){var d=c[c.length-1],e=d.multiSurface,f=d.surface,g=d.curve,d=d.multiCurve,h;ga(a)?h="Envelope":(h=a.X(),"MultiPolygon"===h&&!0===e?h="MultiSurface":"Polygon"===h&&!0===f?h="Surface":"LineString"===h&&!0===g?h="Curve":"MultiLineString"===h&&!0===d&&(h="MultiCurve"));return So("http://www.opengis.net/gml",h)};
ps.prototype.D=function(a,c){c=Kr(this,c);var d=So("http://www.opengis.net/gml","geom"),e={node:d,srsName:this.srsName,curve:this.g,surface:this.l,multiSurface:this.i,multiCurve:this.j};c&&Wb(e,c);this.ye(d,a,[e]);return d};
ps.prototype.a=function(a,c){c=Kr(this,c);var d=So("http://www.opengis.net/gml","featureMembers");lp(d,"http://www.w3.org/2001/XMLSchema-instance","xsi:schemaLocation",this.schemaLocation);var e={srsName:this.srsName,curve:this.g,surface:this.l,multiSurface:this.i,multiCurve:this.j,featureNS:this.featureNS,featureType:this.featureType};c&&Wb(e,c);var e=[e],f=e[e.length-1],g=f.featureType,h=f.featureNS,k={};k[h]={};k[h][g]=R(this.zh,this);f=Tb(f);f.node=d;xp(f,k,sp(g,h),a,e);return d};function ys(a){a=a?a:{};this.defaultDataProjection=null;this.defaultDataProjection=Ce("EPSG:4326");this.b=a.readExtensions}w(ys,$r);var zs=[null,"http://www.topografix.com/GPX/1/0","http://www.topografix.com/GPX/1/1"];function As(a,c,d){a.push(parseFloat(c.getAttribute("lon")),parseFloat(c.getAttribute("lat")));"ele"in d?(a.push(d.ele),delete d.ele):a.push(0);"time"in d?(a.push(d.time),delete d.time):a.push(0);return a}
function Bs(a,c){var d=c[c.length-1],e=a.getAttribute("href");null!==e&&(d.link=e);wp(Cs,a,c)}function Ds(a,c){c[c.length-1].extensionsNode_=a}function Es(a,c){var d=c[0],e=T({flatCoordinates:[]},Fs,a,c);if(e){var f=e.flatCoordinates;delete e.flatCoordinates;var g=new H(null);fn(g,"XYZM",f);Lr(g,!1,d);d=new P(g);d.I(e);return d}}
function Gs(a,c){var d=c[0],e=T({flatCoordinates:[],ends:[]},Hs,a,c);if(e){var f=e.flatCoordinates;delete e.flatCoordinates;var g=e.ends;delete e.ends;var h=new L(null);gn(h,"XYZM",f,g);Lr(h,!1,d);d=new P(h);d.I(e);return d}}function Is(a,c){var d=c[0],e=T({},Js,a,c);if(e){var f=As([],a,e),f=new C(f,"XYZM");Lr(f,!1,d);d=new P(f);d.I(e);return d}}
var Ks={rte:Es,trk:Gs,wpt:Is},Ls=S(zs,{rte:op(Es),trk:op(Gs),wpt:op(Is)}),Cs=S(zs,{text:Q(W,"linkText"),type:Q(W,"linkType")}),Fs=S(zs,{name:Q(W),cmt:Q(W),desc:Q(W),src:Q(W),link:Bs,number:Q(is),extensions:Ds,type:Q(W),rtept:function(a,c){var d=T({},Ms,a,c);d&&As(c[c.length-1].flatCoordinates,a,d)}}),Ms=S(zs,{ele:Q(gs),time:Q(fs)}),Hs=S(zs,{name:Q(W),cmt:Q(W),desc:Q(W),src:Q(W),link:Bs,number:Q(is),type:Q(W),extensions:Ds,trkseg:function(a,c){var d=c[c.length-1];wp(Ns,a,c);d.ends.push(d.flatCoordinates.length)}}),
Ns=S(zs,{trkpt:function(a,c){var d=T({},Os,a,c);d&&As(c[c.length-1].flatCoordinates,a,d)}}),Os=S(zs,{ele:Q(gs),time:Q(fs)}),Js=S(zs,{ele:Q(gs),time:Q(fs),magvar:Q(gs),geoidheight:Q(gs),name:Q(W),cmt:Q(W),desc:Q(W),src:Q(W),link:Bs,sym:Q(W),type:Q(W),fix:Q(W),sat:Q(is),hdop:Q(gs),vdop:Q(gs),pdop:Q(gs),ageofdgpsdata:Q(gs),dgpsid:Q(is),extensions:Ds});
function Ps(a,c){c||(c=[]);for(var d=0,e=c.length;d<e;++d){var f=c[d];if(a.b){var g=f.get("extensionsNode_")||null;a.b(f,g)}f.set("extensionsNode_",void 0)}}ys.prototype.Ug=function(a,c){if(!tb(zs,a.namespaceURI))return null;var d=Ks[a.localName];if(!d)return null;d=d(a,[Jr(this,a,c)]);if(!d)return null;Ps(this,[d]);return d};ys.prototype.Ob=function(a,c){if(!tb(zs,a.namespaceURI))return[];if("gpx"==a.localName){var d=T([],Ls,a,[Jr(this,a,c)]);if(d)return Ps(this,d),d}return[]};
function Qs(a,c,d){a.setAttribute("href",c);c=d[d.length-1].properties;xp({node:a},Rs,up,[c.linkText,c.linkType],d,Ss)}function Ts(a,c,d){var e=d[d.length-1],f=e.node.namespaceURI,g=e.properties;lp(a,null,"lat",c[1]);lp(a,null,"lon",c[0]);switch(e.geometryLayout){case "XYZM":0!==c[3]&&(g.time=c[3]);case "XYZ":0!==c[2]&&(g.ele=c[2]);break;case "XYM":0!==c[2]&&(g.time=c[2])}c=Us[f];e=vp(g,c);xp({node:a,properties:g},Vs,up,e,d,c)}
var Ss=["text","type"],Rs=S(zs,{text:R(ls),type:R(ls)}),Ws=S(zs,"name cmt desc src link number type rtept".split(" ")),Xs=S(zs,{name:R(ls),cmt:R(ls),desc:R(ls),src:R(ls),link:R(Qs),number:R(ns),type:R(ls),rtept:rp(R(Ts))}),Ys=S(zs,"name cmt desc src link number type trkseg".split(" ")),at=S(zs,{name:R(ls),cmt:R(ls),desc:R(ls),src:R(ls),link:R(Qs),number:R(ns),type:R(ls),trkseg:rp(R(function(a,c,d){xp({node:a,geometryLayout:c.a,properties:{}},Zs,$s,c.V(),d)}))}),$s=sp("trkpt"),Zs=S(zs,{trkpt:R(Ts)}),
Us=S(zs,"ele time magvar geoidheight name cmt desc src link sym type fix sat hdop vdop pdop ageofdgpsdata dgpsid".split(" ")),Vs=S(zs,{ele:R(ms),time:R(function(a,c){var d=new Date(1E3*c),d=d.getUTCFullYear()+"-"+La(d.getUTCMonth()+1)+"-"+La(d.getUTCDate())+"T"+La(d.getUTCHours())+":"+La(d.getUTCMinutes())+":"+La(d.getUTCSeconds())+"Z";a.appendChild(Po.createTextNode(d))}),magvar:R(ms),geoidheight:R(ms),name:R(ls),cmt:R(ls),desc:R(ls),src:R(ls),link:R(Qs),sym:R(ls),type:R(ls),fix:R(ls),sat:R(ns),
hdop:R(ms),vdop:R(ms),pdop:R(ms),ageofdgpsdata:R(ms),dgpsid:R(ns)}),bt={Point:"wpt",LineString:"rte",MultiLineString:"trk"};function ct(a,c){var d=a.W();if(d)return So(c[c.length-1].node.namespaceURI,bt[d.X()])}
var dt=S(zs,{rte:R(function(a,c,d){var e=d[0],f=c.R();a={node:a,properties:f};if(c=c.W())c=Lr(c,!0,e),a.geometryLayout=c.a,f.rtept=c.V();e=Ws[d[d.length-1].node.namespaceURI];f=vp(f,e);xp(a,Xs,up,f,d,e)}),trk:R(function(a,c,d){var e=d[0],f=c.R();a={node:a,properties:f};if(c=c.W())c=Lr(c,!0,e),f.trkseg=c.$c();e=Ys[d[d.length-1].node.namespaceURI];f=vp(f,e);xp(a,at,up,f,d,e)}),wpt:R(function(a,c,d){var e=d[0],f=d[d.length-1];f.properties=c.R();if(c=c.W())c=Lr(c,!0,e),f.geometryLayout=c.a,Ts(a,c.V(),
d)})});ys.prototype.a=function(a,c){c=Kr(this,c);var d=So("http://www.topografix.com/GPX/1/1","gpx");xp({node:d},dt,ct,a,[c]);return d};function et(a){a=ft(a);return ab(a,function(a){return a.c.substring(a.a,a.b)})}function gt(a,c,d){this.c=a;this.a=c;this.b=d}function ft(a){for(var c=RegExp("\r\n|\r|\n","g"),d=0,e,f=[];e=c.exec(a);)d=new gt(a,d,e.index),f.push(d),d=c.lastIndex;d<a.length&&(d=new gt(a,d,a.length),f.push(d));return f};function ht(){this.defaultDataProjection=null}w(ht,Ir);l=ht.prototype;l.X=function(){return"text"};l.yb=function(a,c){return this.hd(ia(a)?a:"",Kr(this,c))};l.ta=function(a,c){return this.tf(ia(a)?a:"",Kr(this,c))};l.Dc=function(a,c){return this.kd(ia(a)?a:"",Kr(this,c))};l.Ka=function(){return this.defaultDataProjection};l.od=function(a,c){return this.we(a,Kr(this,c))};l.Ab=function(a,c){return this.Ah(a,Kr(this,c))};l.Jc=function(a,c){return this.pd(a,Kr(this,c))};function it(a){a=a?a:{};this.defaultDataProjection=null;this.defaultDataProjection=Ce("EPSG:4326");this.b=a.altitudeMode?a.altitudeMode:"none"}w(it,ht);var jt=/^B(\d{2})(\d{2})(\d{2})(\d{2})(\d{5})([NS])(\d{3})(\d{5})([EW])([AV])(\d{5})(\d{5})/,kt=/^H.([A-Z]{3}).*?:(.*)/,lt=/^HFDTE(\d{2})(\d{2})(\d{2})/;
it.prototype.hd=function(a,c){var d=this.b,e=et(a),f={},g=[],h=2E3,k=0,m=1,n,p;n=0;for(p=e.length;n<p;++n){var q=e[n],r;if("B"==q.charAt(0)){if(r=jt.exec(q)){var q=parseInt(r[1],10),u=parseInt(r[2],10),y=parseInt(r[3],10),A=parseInt(r[4],10)+parseInt(r[5],10)/6E4;"S"==r[6]&&(A=-A);var F=parseInt(r[7],10)+parseInt(r[8],10)/6E4;"W"==r[9]&&(F=-F);g.push(F,A);"none"!=d&&g.push("gps"==d?parseInt(r[11],10):"barometric"==d?parseInt(r[12],10):0);g.push(Date.UTC(h,k,m,q,u,y)/1E3)}}else if("H"==q.charAt(0))if(r=
lt.exec(q))m=parseInt(r[1],10),k=parseInt(r[2],10)-1,h=2E3+parseInt(r[3],10);else if(r=kt.exec(q))f[r[1]]=r[2].trim(),lt.exec(q)}if(0===g.length)return null;e=new H(null);fn(e,"none"==d?"XYM":"XYZM",g);d=new P(Lr(e,!1,c));d.I(f);return d};it.prototype.tf=function(a,c){var d=this.hd(a,c);return d?[d]:[]};function mt(a,c){this.a=this.i=this.f="";this.l=null;this.g=this.b="";this.j=!1;var d;a instanceof mt?(this.j=ca(c)?c:a.j,nt(this,a.f),this.i=a.i,this.a=a.a,ot(this,a.l),this.b=a.b,pt(this,a.c.clone()),this.g=a.g):a&&(d=String(a).match(po))?(this.j=!!c,nt(this,d[1]||"",!0),this.i=qt(d[2]||""),this.a=qt(d[3]||"",!0),ot(this,d[4]),this.b=qt(d[5]||"",!0),pt(this,d[6]||"",!0),this.g=qt(d[7]||"")):(this.j=!!c,this.c=new rt(null,0,this.j))}
mt.prototype.toString=function(){var a=[],c=this.f;c&&a.push(st(c,tt,!0),":");var d=this.a;if(d||"file"==c)a.push("//"),(c=this.i)&&a.push(st(c,tt,!0),"@"),a.push(encodeURIComponent(String(d)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d=this.l,null!=d&&a.push(":",String(d));if(d=this.b)this.a&&"/"!=d.charAt(0)&&a.push("/"),a.push(st(d,"/"==d.charAt(0)?ut:vt,!0));(d=this.c.toString())&&a.push("?",d);(d=this.g)&&a.push("#",st(d,wt));return a.join("")};mt.prototype.clone=function(){return new mt(this)};
function nt(a,c,d){a.f=d?qt(c,!0):c;a.f&&(a.f=a.f.replace(/:$/,""))}function ot(a,c){if(c){c=Number(c);if(isNaN(c)||0>c)throw Error("Bad port number "+c);a.l=c}else a.l=null}function pt(a,c,d){c instanceof rt?(a.c=c,xt(a.c,a.j)):(d||(c=st(c,yt)),a.c=new rt(c,0,a.j))}function zt(a){return a instanceof mt?a.clone():new mt(a,void 0)}
function At(a,c){a instanceof mt||(a=zt(a));c instanceof mt||(c=zt(c));var d=a,e=c,f=d.clone(),g=!!e.f;g?nt(f,e.f):g=!!e.i;g?f.i=e.i:g=!!e.a;g?f.a=e.a:g=null!=e.l;var h=e.b;if(g)ot(f,e.l);else if(g=!!e.b)if("/"!=h.charAt(0)&&(d.a&&!d.b?h="/"+h:(d=f.b.lastIndexOf("/"),-1!=d&&(h=f.b.substr(0,d+1)+h))),d=h,".."==d||"."==d)h="";else if(-1!=d.indexOf("./")||-1!=d.indexOf("/.")){for(var h=0==d.lastIndexOf("/",0),d=d.split("/"),k=[],m=0;m<d.length;){var n=d[m++];"."==n?h&&m==d.length&&k.push(""):".."==n?
((1<k.length||1==k.length&&""!=k[0])&&k.pop(),h&&m==d.length&&k.push("")):(k.push(n),h=!0)}h=k.join("/")}else h=d;g?f.b=h:g=""!==e.c.toString();g?pt(f,qt(e.c.toString())):g=!!e.g;g&&(f.g=e.g);return f}function qt(a,c){return a?c?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function st(a,c,d){return ia(a)?(a=encodeURI(a).replace(c,Bt),d&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function Bt(a){a=a.charCodeAt(0);return"%"+(a>>4&15).toString(16)+(a&15).toString(16)}
var tt=/[#\/\?@]/g,vt=/[\#\?:]/g,ut=/[\#\?]/g,yt=/[\#\?@]/g,wt=/#/g;function rt(a,c,d){this.a=this.b=null;this.c=a||null;this.f=!!d}function Ct(a){a.b||(a.b=new si,a.a=0,a.c&&qo(a.c,function(c,d){a.add(decodeURIComponent(c.replace(/\+/g," ")),d)}))}l=rt.prototype;l.Sb=function(){Ct(this);return this.a};l.add=function(a,c){Ct(this);this.c=null;a=Dt(this,a);var d=this.b.get(a);d||this.b.set(a,d=[]);d.push(c);this.a++;return this};
l.remove=function(a){Ct(this);a=Dt(this,a);return ui(this.b.a,a)?(this.c=null,this.a-=this.b.get(a).length,this.b.remove(a)):!1};l.clear=function(){this.b=this.c=null;this.a=0};l.za=function(){Ct(this);return 0==this.a};function Et(a,c){Ct(a);c=Dt(a,c);return ui(a.b.a,c)}l.P=function(){Ct(this);for(var a=this.b.Wb(),c=this.b.P(),d=[],e=0;e<c.length;e++)for(var f=a[e],g=0;g<f.length;g++)d.push(c[e]);return d};
l.Wb=function(a){Ct(this);var c=[];if(ia(a))Et(this,a)&&(c=gb(c,this.b.get(Dt(this,a))));else{a=this.b.Wb();for(var d=0;d<a.length;d++)c=gb(c,a[d])}return c};l.set=function(a,c){Ct(this);this.c=null;a=Dt(this,a);Et(this,a)&&(this.a-=this.b.get(a).length);this.b.set(a,[c]);this.a++;return this};l.get=function(a,c){var d=a?this.Wb(a):[];return 0<d.length?String(d[0]):c};function Ft(a,c,d){a.remove(c);0<d.length&&(a.c=null,a.b.set(Dt(a,c),hb(d)),a.a+=d.length)}
l.toString=function(){if(this.c)return this.c;if(!this.b)return"";for(var a=[],c=this.b.P(),d=0;d<c.length;d++)for(var e=c[d],f=encodeURIComponent(String(e)),e=this.Wb(e),g=0;g<e.length;g++){var h=f;""!==e[g]&&(h+="="+encodeURIComponent(String(e[g])));a.push(h)}return this.c=a.join("&")};l.clone=function(){var a=new rt;a.c=this.c;this.b&&(a.b=this.b.clone(),a.a=this.a);return a};function Dt(a,c){var d=String(c);a.f&&(d=d.toLowerCase());return d}
function xt(a,c){c&&!a.f&&(Ct(a),a.c=null,a.b.forEach(function(a,c){var f=c.toLowerCase();c!=f&&(this.remove(c),Ft(this,f,a))},a));a.f=c};function Gt(a){a=a||{};this.f=a.font;this.i=a.rotation;this.a=a.scale;this.c=a.text;this.D=a.textAlign;this.B=a.textBaseline;this.b=void 0!==a.fill?a.fill:new Xl({color:"#333"});this.l=void 0!==a.stroke?a.stroke:null;this.g=void 0!==a.offsetX?a.offsetX:0;this.j=void 0!==a.offsetY?a.offsetY:0}l=Gt.prototype;l.Pi=function(){return this.f};l.dj=function(){return this.g};l.ej=function(){return this.j};l.Km=function(){return this.b};l.Lm=function(){return this.i};l.Mm=function(){return this.a};l.Nm=function(){return this.l};
l.Om=function(){return this.c};l.qj=function(){return this.D};l.rj=function(){return this.B};l.Tn=function(a){this.f=a};l.Zn=function(a){this.g=a};l.$n=function(a){this.j=a};l.Sn=function(a){this.b=a};l.Pm=function(a){this.i=a};l.Qm=function(a){this.a=a};l.ao=function(a){this.l=a};l.bo=function(a){this.c=a};l.co=function(a){this.D=a};l.eo=function(a){this.B=a};function Ht(a){a=a?a:{};this.defaultDataProjection=null;this.defaultDataProjection=Ce("EPSG:4326");this.c=a.defaultStyle?a.defaultStyle:It;this.f=void 0!==a.extractStyles?a.extractStyles:!0;this.b={}}w(Ht,$r);
var Jt=["http://www.google.com/kml/ext/2.2"],Kt=[null,"http://earth.google.com/kml/2.0","http://earth.google.com/kml/2.1","http://earth.google.com/kml/2.2","http://www.opengis.net/kml/2.2"],Lt=[255,255,255,1],Mt=new Xl({color:Lt}),Nt=[20,2],Ot=[64,64],Pt=new xk({anchor:Nt,anchorOrigin:"bottom-left",anchorXUnits:"pixels",anchorYUnits:"pixels",crossOrigin:"anonymous",rotation:0,scale:.5,size:Ot,src:"https://maps.google.com/mapfiles/kml/pushpin/ylw-pushpin.png"}),Qt=new bm({color:Lt,width:1}),Rt=new Gt({font:"normal 16px Helvetica",
fill:Mt,stroke:Qt,scale:1}),It=[new dm({fill:Mt,image:Pt,text:Rt,stroke:Qt,zIndex:0})],St={fraction:"fraction",pixels:"pixels"};function Tt(a,c,d,e){return function(){return a?a:c?Ut(c,d,e):d}}function Ut(a,c,d){return ga(a)?a:ia(a)?(!(a in d)&&"#"+a in d&&(a="#"+a),Ut(d[a],c,d)):c}function Vt(a){a=To(a,!1);if(a=/^\s*#?\s*([0-9A-Fa-f]{8})\s*$/.exec(a))return a=a[1],[parseInt(a.substr(6,2),16),parseInt(a.substr(4,2),16),parseInt(a.substr(2,2),16),parseInt(a.substr(0,2),16)/255]}
function Wt(a){a=To(a,!1);for(var c=[],d=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*,\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s*,\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?))?\s*/i,e;e=d.exec(a);)c.push(parseFloat(e[1]),parseFloat(e[2]),e[3]?parseFloat(e[3]):0),a=a.substr(e[0].length);return""!==a?void 0:c}function Xt(a){var c=To(a,!1);return a.baseURI?At(a.baseURI,c.trim()).toString():c.trim()}function Yt(a){a=gs(a);if(void 0!==a)return Math.sqrt(a)}function Zt(a,c){return T(null,$t,a,c)}
function au(a,c){var d=T({o:[],yh:[]},bu,a,c);if(d){var e=d.o,d=d.yh,f,g;f=0;for(g=Math.min(e.length,d.length);f<g;++f)e[4*f+3]=d[f];d=new H(null);fn(d,"XYZM",e);return d}}function cu(a,c){var d=T({},du,a,c),e=T(null,eu,a,c);if(e){var f=new H(null);fn(f,"XYZ",e);f.I(d);return f}}function fu(a,c){var d=T({},du,a,c),e=T(null,eu,a,c);if(e){var f=new D(null);Hf(f,"XYZ",e,[e.length]);f.I(d);return f}}
function gu(a,c){var d=T([],hu,a,c);if(!d)return null;if(0===d.length)return new Zm(d);var e=!0,f=d[0].X(),g,h,k;h=1;for(k=d.length;h<k;++h)if(g=d[h],g.X()!=f){e=!1;break}if(e){if("Point"==f){g=d[0];e=g.a;f=g.o;h=1;for(k=d.length;h<k;++h)g=d[h],ib(f,g.o);g=new jn(null);cf(g,e,f);g.u();iu(g,d);return g}return"LineString"==f?(g=new L(null),hn(g,d),iu(g,d),g):"Polygon"==f?(g=new N(null),ln(g,d),iu(g,d),g):"GeometryCollection"==f?new Zm(d):null}return new Zm(d)}
function ju(a,c){var d=T({},du,a,c),e=T(null,eu,a,c);if(e){var f=new C(null);vf(f,"XYZ",e);f.I(d);return f}}function ku(a,c){var d=T({},du,a,c),e=T([null],lu,a,c);if(e&&e[0]){var f=new D(null),g=e[0],h=[g.length],k,m;k=1;for(m=e.length;k<m;++k)ib(g,e[k]),h.push(g.length);Hf(f,"XYZ",g,h);f.I(d);return f}}
function mu(a,c){var d=T({},nu,a,c);if(!d)return null;var e="fillStyle"in d?d.fillStyle:Mt,f=d.fill;void 0===f||f||(e=null);var f="imageStyle"in d?d.imageStyle:Pt,g="textStyle"in d?d.textStyle:Rt,h="strokeStyle"in d?d.strokeStyle:Qt,d=d.outline;void 0===d||d||(h=null);return[new dm({fill:e,image:f,stroke:h,text:g,zIndex:void 0})]}
function iu(a,c){var d=c.length,e=Array(c.length),f=Array(c.length),g,h,k,m;k=m=!1;for(h=0;h<d;++h)g=c[h],e[h]=g.get("extrude"),f[h]=g.get("altitudeMode"),k=k||void 0!==e[h],m=m||f[h];k&&a.set("extrude",e);m&&a.set("altitudeMode",f)}function ou(a,c){wp(pu,a,c)}
var qu=S(Kt,{value:pp(W)}),pu=S(Kt,{Data:function(a,c){var d=a.getAttribute("name");if(null!==d){var e=T(void 0,qu,a,c);e&&(c[c.length-1][d]=e)}},SchemaData:function(a,c){wp(ru,a,c)}}),du=S(Kt,{extrude:Q(ds),altitudeMode:Q(W)}),$t=S(Kt,{coordinates:pp(Wt)}),lu=S(Kt,{innerBoundaryIs:function(a,c){var d=T(void 0,su,a,c);d&&c[c.length-1].push(d)},outerBoundaryIs:function(a,c){var d=T(void 0,tu,a,c);d&&(c[c.length-1][0]=d)}}),bu=S(Kt,{when:function(a,c){var d=c[c.length-1].yh,e=To(a,!1);if(e=/^\s*(\d{4})($|-(\d{2})($|-(\d{2})($|T(\d{2}):(\d{2}):(\d{2})(Z|(?:([+\-])(\d{2})(?::(\d{2}))?)))))\s*$/.exec(e)){var f=
Date.UTC(parseInt(e[1],10),e[3]?parseInt(e[3],10)-1:0,e[5]?parseInt(e[5],10):1,e[7]?parseInt(e[7],10):0,e[8]?parseInt(e[8],10):0,e[9]?parseInt(e[9],10):0);if(e[10]&&"Z"!=e[10]){var g="-"==e[11]?-1:1,f=f+60*g*parseInt(e[12],10);e[13]&&(f+=3600*g*parseInt(e[13],10))}d.push(f)}else d.push(0)}},S(Jt,{coord:function(a,c){var d=c[c.length-1].o,e=To(a,!1);(e=/^\s*([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s*$/i.exec(e))?d.push(parseFloat(e[1]),
parseFloat(e[2]),parseFloat(e[3]),0):d.push(0,0,0,0)}})),eu=S(Kt,{coordinates:pp(Wt)}),uu=S(Kt,{href:Q(Xt)},S(Jt,{x:Q(gs),y:Q(gs),w:Q(gs),h:Q(gs)})),vu=S(Kt,{Icon:Q(function(a,c){var d=T({},uu,a,c);return d?d:null}),heading:Q(gs),hotSpot:Q(function(a){var c=a.getAttribute("xunits"),d=a.getAttribute("yunits");return{x:parseFloat(a.getAttribute("x")),Df:St[c],y:parseFloat(a.getAttribute("y")),Ef:St[d]}}),scale:Q(Yt)}),su=S(Kt,{LinearRing:pp(Zt)}),wu=S(Kt,{color:Q(Vt),scale:Q(Yt)}),xu=S(Kt,{color:Q(Vt),
width:Q(gs)}),hu=S(Kt,{LineString:op(cu),LinearRing:op(fu),MultiGeometry:op(gu),Point:op(ju),Polygon:op(ku)}),yu=S(Jt,{Track:op(au)}),Au=S(Kt,{ExtendedData:ou,Link:function(a,c){wp(zu,a,c)},address:Q(W),description:Q(W),name:Q(W),open:Q(ds),phoneNumber:Q(W),visibility:Q(ds)}),zu=S(Kt,{href:Q(Xt)}),tu=S(Kt,{LinearRing:pp(Zt)}),Bu=S(Kt,{Style:Q(mu),key:Q(W),styleUrl:Q(function(a){var c=To(a,!1).trim();return a.baseURI?At(a.baseURI,c).toString():c})}),Du=S(Kt,{ExtendedData:ou,MultiGeometry:Q(gu,"geometry"),
LineString:Q(cu,"geometry"),LinearRing:Q(fu,"geometry"),Point:Q(ju,"geometry"),Polygon:Q(ku,"geometry"),Style:Q(mu),StyleMap:function(a,c){var d=T(void 0,Cu,a,c);if(d){var e=c[c.length-1];ga(d)?e.Style=d:ia(d)&&(e.styleUrl=d)}},address:Q(W),description:Q(W),name:Q(W),open:Q(ds),phoneNumber:Q(W),styleUrl:Q(Xt),visibility:Q(ds)},S(Jt,{MultiTrack:Q(function(a,c){var d=T([],yu,a,c);if(d){var e=new L(null);hn(e,d);return e}},"geometry"),Track:Q(au,"geometry")})),Eu=S(Kt,{color:Q(Vt),fill:Q(ds),outline:Q(ds)}),
ru=S(Kt,{SimpleData:function(a,c){var d=a.getAttribute("name");if(null!==d){var e=W(a);c[c.length-1][d]=e}}}),nu=S(Kt,{IconStyle:function(a,c){var d=T({},vu,a,c);if(d){var e=c[c.length-1],f="Icon"in d?d.Icon:{},g;g=(g=f.href)?g:"https://maps.google.com/mapfiles/kml/pushpin/ylw-pushpin.png";var h,k,m,n=d.hotSpot;n?(h=[n.x,n.y],k=n.Df,m=n.Ef):"https://maps.google.com/mapfiles/kml/pushpin/ylw-pushpin.png"===g?(h=Nt,m=k="pixels"):/^http:\/\/maps\.(?:google|gstatic)\.com\//.test(g)&&(h=[.5,0],m=k="fraction");
var p,n=f.x,q=f.y;void 0!==n&&void 0!==q&&(p=[n,q]);var r,n=f.w,f=f.h;void 0!==n&&void 0!==f&&(r=[n,f]);var u,f=d.heading;void 0!==f&&(u=Ta(f));d=d.scale;"https://maps.google.com/mapfiles/kml/pushpin/ylw-pushpin.png"==g&&(r=Ot);h=new xk({anchor:h,anchorOrigin:"bottom-left",anchorXUnits:k,anchorYUnits:m,crossOrigin:"anonymous",offset:p,offsetOrigin:"bottom-left",rotation:u,scale:d,size:r,src:g});e.imageStyle=h}},LabelStyle:function(a,c){var d=T({},wu,a,c);d&&(c[c.length-1].textStyle=new Gt({fill:new Xl({color:"color"in
d?d.color:Lt}),scale:d.scale}))},LineStyle:function(a,c){var d=T({},xu,a,c);d&&(c[c.length-1].strokeStyle=new bm({color:"color"in d?d.color:Lt,width:"width"in d?d.width:1}))},PolyStyle:function(a,c){var d=T({},Eu,a,c);if(d){var e=c[c.length-1];e.fillStyle=new Xl({color:"color"in d?d.color:Lt});var f=d.fill;void 0!==f&&(e.fill=f);d=d.outline;void 0!==d&&(e.outline=d)}}}),Cu=S(Kt,{Pair:function(a,c){var d=T({},Bu,a,c);if(d){var e=d.key;e&&"normal"==e&&((e=d.styleUrl)&&(c[c.length-1]=e),(d=d.Style)&&
(c[c.length-1]=d))}}});l=Ht.prototype;l.qf=function(a,c){Xo(a);var d=S(Kt,{Document:np(this.qf,this),Folder:np(this.qf,this),Placemark:op(this.vf,this),Style:qa(this.En,this),StyleMap:qa(this.Dn,this)});if(d=T([],d,a,c,this))return d};l.vf=function(a,c){var d=T({geometry:null},Du,a,c);if(d){var e=new P,f=a.getAttribute("id");null!==f&&e.Pb(f);var f=c[0],g=d.geometry;g&&Lr(g,!1,f);e.Aa(g);delete d.geometry;this.f&&e.ef(Tt(d.Style,d.styleUrl,this.c,this.b));delete d.Style;e.I(d);return e}};
l.En=function(a,c){var d=a.getAttribute("id");if(null!==d){var e=mu(a,c);e&&(d=a.baseURI?At(a.baseURI,"#"+d).toString():"#"+d,this.b[d]=e)}};l.Dn=function(a,c){var d=a.getAttribute("id");if(null!==d){var e=T(void 0,Cu,a,c);e&&(d=a.baseURI?At(a.baseURI,"#"+d).toString():"#"+d,this.b[d]=e)}};l.Ug=function(a,c){if(!tb(Kt,a.namespaceURI))return null;var d=this.vf(a,[Jr(this,a,c)]);return d?d:null};
l.Ob=function(a,c){if(!tb(Kt,a.namespaceURI))return[];var d;d=Xo(a);if("Document"==d||"Folder"==d)return(d=this.qf(a,[Jr(this,a,c)]))?d:[];if("Placemark"==d)return(d=this.vf(a,[Jr(this,a,c)]))?[d]:[];if("kml"==d){d=[];var e;for(e=a.firstElementChild;e;e=e.nextElementSibling){var f=this.Ob(e,c);f&&ib(d,f)}return d}return[]};l.yn=function(a){if($o(a))return Fu(this,a);if(cp(a))return Gu(this,a);if(ia(a))return a=mp(a),Fu(this,a)};
function Fu(a,c){var d;for(d=c.firstChild;d;d=d.nextSibling)if(1==d.nodeType){var e=Gu(a,d);if(e)return e}}function Gu(a,c){var d;for(d=c.firstElementChild;d;d=d.nextElementSibling)if(tb(Kt,d.namespaceURI)&&"name"==d.localName)return W(d);for(d=c.firstElementChild;d;d=d.nextElementSibling){var e=Xo(d);if(tb(Kt,d.namespaceURI)&&("Document"==e||"Folder"==e||"Placemark"==e||"kml"==e)&&(e=Gu(a,d)))return e}}
l.zn=function(a){var c=[];$o(a)?ib(c,Hu(this,a)):cp(a)?ib(c,Iu(this,a)):ia(a)&&(a=mp(a),ib(c,Hu(this,a)));return c};function Hu(a,c){var d,e=[];for(d=c.firstChild;d;d=d.nextSibling)1==d.nodeType&&ib(e,Iu(a,d));return e}
function Iu(a,c){var d,e=[];for(d=c.firstElementChild;d;d=d.nextElementSibling)if(tb(Kt,d.namespaceURI)&&"NetworkLink"==d.localName){var f=T({},Au,d,[]);e.push(f)}for(d=c.firstElementChild;d;d=d.nextElementSibling)f=Xo(d),!tb(Kt,d.namespaceURI)||"Document"!=f&&"Folder"!=f&&"kml"!=f||ib(e,Iu(a,d));return e}function Ju(a,c){var d=yg(c),d=[255*(4==d.length?d[3]:1),d[2],d[1],d[0]],e;for(e=0;4>e;++e){var f=parseInt(d[e],10).toString(16);d[e]=1==f.length?"0"+f:f}ls(a,d.join(""))}
function Ku(a,c,d){xp({node:a},Lu,Mu,[c],d)}function Nu(a,c,d){var e={node:a};c.Ca()&&a.setAttribute("id",c.Ca());a=c.R();var f=c.c;f&&(f=f.call(c,0))&&0<f.length&&(a.Style=f[0],(f=f[0].a)&&(a.name=f.c));f=Ou[d[d.length-1].node.namespaceURI];a=vp(a,f);xp(e,Pu,up,a,d,f);a=d[0];(c=c.W())&&(c=Lr(c,!0,a));xp(e,Pu,Qu,[c],d)}function Ru(a,c,d){var e=c.o;a={node:a};a.layout=c.a;a.stride=c.H;xp(a,Su,Tu,[e],d)}function Uu(a,c,d){c=c.Gd();var e=c.shift();a={node:a};xp(a,Vu,Wu,c,d);xp(a,Vu,Xu,[e],d)}
function Yu(a,c){ms(a,c*c)}
var Zu=S(Kt,["Document","Placemark"]),bv=S(Kt,{Document:R(function(a,c,d){xp({node:a},$u,av,c,d)}),Placemark:R(Nu)}),$u=S(Kt,{Placemark:R(Nu)}),cv={Point:"Point",LineString:"LineString",LinearRing:"LinearRing",Polygon:"Polygon",MultiPoint:"MultiGeometry",MultiLineString:"MultiGeometry",MultiPolygon:"MultiGeometry"},dv=S(Kt,["href"],S(Jt,["x","y","w","h"])),ev=S(Kt,{href:R(ls)},S(Jt,{x:R(ms),y:R(ms),w:R(ms),h:R(ms)})),fv=S(Kt,["scale","heading","Icon","hotSpot"]),hv=S(Kt,{Icon:R(function(a,c,d){a=
{node:a};var e=dv[d[d.length-1].node.namespaceURI],f=vp(c,e);xp(a,ev,up,f,d,e);e=dv[Jt[0]];f=vp(c,e);xp(a,ev,gv,f,d,e)}),heading:R(ms),hotSpot:R(function(a,c){a.setAttribute("x",c.x);a.setAttribute("y",c.y);a.setAttribute("xunits",c.Df);a.setAttribute("yunits",c.Ef)}),scale:R(Yu)}),iv=S(Kt,["color","scale"]),jv=S(Kt,{color:R(Ju),scale:R(Yu)}),kv=S(Kt,["color","width"]),lv=S(Kt,{color:R(Ju),width:R(ms)}),Lu=S(Kt,{LinearRing:R(Ru)}),mv=S(Kt,{LineString:R(Ru),Point:R(Ru),Polygon:R(Uu)}),Ou=S(Kt,"name open visibility address phoneNumber description styleUrl Style".split(" ")),
Pu=S(Kt,{MultiGeometry:R(function(a,c,d){a={node:a};var e=c.X(),f,g;"MultiPoint"==e?(f=c.ae(),g=nv):"MultiLineString"==e?(f=c.$c(),g=ov):"MultiPolygon"==e&&(f=c.Id(),g=pv);xp(a,mv,g,f,d)}),LineString:R(Ru),LinearRing:R(Ru),Point:R(Ru),Polygon:R(Uu),Style:R(function(a,c,d){a={node:a};var e={},f=c.g,g=c.c,h=c.j;c=c.a;h&&(e.IconStyle=h);c&&(e.LabelStyle=c);g&&(e.LineStyle=g);f&&(e.PolyStyle=f);c=qv[d[d.length-1].node.namespaceURI];e=vp(e,c);xp(a,rv,up,e,d,c)}),address:R(ls),description:R(ls),name:R(ls),
open:R(ks),phoneNumber:R(ls),styleUrl:R(ls),visibility:R(ks)}),Su=S(Kt,{coordinates:R(function(a,c,d){d=d[d.length-1];var e=d.layout;d=d.stride;var f;"XY"==e||"XYM"==e?f=2:("XYZ"==e||"XYZM"==e)&&(f=3);var g,h=c.length,k="";if(0<h){k+=c[0];for(e=1;e<f;++e)k+=","+c[e];for(g=d;g<h;g+=d)for(k+=" "+c[g],e=1;e<f;++e)k+=","+c[g+e]}ls(a,k)})}),Vu=S(Kt,{outerBoundaryIs:R(Ku),innerBoundaryIs:R(Ku)}),sv=S(Kt,{color:R(Ju)}),qv=S(Kt,["IconStyle","LabelStyle","LineStyle","PolyStyle"]),rv=S(Kt,{IconStyle:R(function(a,
c,d){a={node:a};var e={},f=c.ob(),g=c.Fd(),h={href:c.b.j};if(f){h.w=f[0];h.h=f[1];var k=c.Db(),m=c.ua();m&&g&&0!==m[0]&&m[1]!==f[1]&&(h.x=m[0],h.y=g[1]-(m[1]+f[1]));k&&0!==k[0]&&k[1]!==f[1]&&(e.hotSpot={x:k[0],Df:"pixels",y:f[1]-k[1],Ef:"pixels"})}e.Icon=h;f=c.B;1!==f&&(e.scale=f);c=c.D;0!==c&&(e.heading=c);c=fv[d[d.length-1].node.namespaceURI];e=vp(e,c);xp(a,hv,up,e,d,c)}),LabelStyle:R(function(a,c,d){a={node:a};var e={},f=c.b;f&&(e.color=f.b);(c=c.a)&&1!==c&&(e.scale=c);c=iv[d[d.length-1].node.namespaceURI];
e=vp(e,c);xp(a,jv,up,e,d,c)}),LineStyle:R(function(a,c,d){a={node:a};var e=kv[d[d.length-1].node.namespaceURI];c=vp({color:c.b,width:c.a},e);xp(a,lv,up,c,d,e)}),PolyStyle:R(function(a,c,d){xp({node:a},sv,tv,[c.b],d)})});function gv(a,c,d){return So(Jt[0],"gx:"+d)}function av(a,c){return So(c[c.length-1].node.namespaceURI,"Placemark")}function Qu(a,c){if(a)return So(c[c.length-1].node.namespaceURI,cv[a.X()])}
var tv=sp("color"),Tu=sp("coordinates"),Wu=sp("innerBoundaryIs"),nv=sp("Point"),ov=sp("LineString"),Mu=sp("LinearRing"),pv=sp("Polygon"),Xu=sp("outerBoundaryIs");
Ht.prototype.a=function(a,c){c=Kr(this,c);var d=So(Kt[4],"kml");lp(d,"http://www.w3.org/2000/xmlns/","xmlns:gx",Jt[0]);lp(d,"http://www.w3.org/2000/xmlns/","xmlns:xsi","http://www.w3.org/2001/XMLSchema-instance");lp(d,"http://www.w3.org/2001/XMLSchema-instance","xsi:schemaLocation","http://www.opengis.net/kml/2.2 https://developers.google.com/kml/schema/kml22gx.xsd");var e={node:d},f={};1<a.length?f.Document=a:1==a.length&&(f.Placemark=a[0]);var g=Zu[d.namespaceURI],f=vp(f,g);xp(e,bv,up,f,[c],g);
return d};function uv(){this.defaultDataProjection=null;this.defaultDataProjection=Ce("EPSG:4326")}w(uv,$r);function vv(a,c){c[c.length-1].md[a.getAttribute("k")]=a.getAttribute("v")}
var wv=[null],xv=S(wv,{nd:function(a,c){c[c.length-1].xc.push(a.getAttribute("ref"))},tag:vv}),zv=S(wv,{node:function(a,c){var d=c[0],e=c[c.length-1],f=a.getAttribute("id"),g=[parseFloat(a.getAttribute("lon")),parseFloat(a.getAttribute("lat"))];e.ng[f]=g;var h=T({md:{}},yv,a,c);Pb(h.md)||(g=new C(g),Lr(g,!1,d),d=new P(g),d.Pb(f),d.I(h.md),e.features.push(d))},way:function(a,c){for(var d=c[0],e=a.getAttribute("id"),f=T({xc:[],md:{}},xv,a,c),g=c[c.length-1],h=[],k=0,m=f.xc.length;k<m;k++)ib(h,g.ng[f.xc[k]]);
f.xc[0]==f.xc[f.xc.length-1]?(k=new D(null),Hf(k,"XY",h,[h.length])):(k=new H(null),fn(k,"XY",h));Lr(k,!1,d);d=new P(k);d.Pb(e);d.I(f.md);g.features.push(d)}}),yv=S(wv,{tag:vv});uv.prototype.Ob=function(a,c){var d=Jr(this,a,c);return"osm"==a.localName&&(d=T({ng:{},features:[]},zv,a,[d]),d.features)?d.features:[]};function Av(a){return a.getAttributeNS("http://www.w3.org/1999/xlink","href")};function Bv(){}Bv.prototype.c=function(a){return $o(a)?this.a(a):cp(a)?this.b(a):ia(a)?(a=mp(a),this.a(a)):null};function Cv(){}w(Cv,Bv);Cv.prototype.a=function(a){for(a=a.firstChild;a;a=a.nextSibling)if(1==a.nodeType)return this.b(a);return null};Cv.prototype.b=function(a){return(a=T({},Dv,a,[]))?a:null};
var Ev=[null,"http://www.opengis.net/ows/1.1"],Dv=S(Ev,{ServiceIdentification:Q(function(a,c){return T({},Fv,a,c)}),ServiceProvider:Q(function(a,c){return T({},Gv,a,c)}),OperationsMetadata:Q(function(a,c){return T({},Hv,a,c)})}),Iv=S(Ev,{DeliveryPoint:Q(W),City:Q(W),AdministrativeArea:Q(W),PostalCode:Q(W),Country:Q(W),ElectronicMailAddress:Q(W)}),Jv=S(Ev,{Value:qp(function(a){return W(a)})}),Kv=S(Ev,{AllowedValues:Q(function(a,c){return T({},Jv,a,c)})}),Mv=S(Ev,{Phone:Q(function(a,c){return T({},
Lv,a,c)}),Address:Q(function(a,c){return T({},Iv,a,c)})}),Ov=S(Ev,{HTTP:Q(function(a,c){return T({},Nv,a,c)})}),Nv=S(Ev,{Get:qp(function(a,c){var d=Av(a);return d?T({href:d},Pv,a,c):void 0}),Post:void 0}),Qv=S(Ev,{DCP:Q(function(a,c){return T({},Ov,a,c)})}),Hv=S(Ev,{Operation:function(a,c){var d=a.getAttribute("name"),e=T({},Qv,a,c);e&&(c[c.length-1][d]=e)}}),Lv=S(Ev,{Voice:Q(W),Facsimile:Q(W)}),Pv=S(Ev,{Constraint:qp(function(a,c){var d=a.getAttribute("name");return d?T({name:d},Kv,a,c):void 0})}),
Rv=S(Ev,{IndividualName:Q(W),PositionName:Q(W),ContactInfo:Q(function(a,c){return T({},Mv,a,c)})}),Fv=S(Ev,{Title:Q(W),ServiceTypeVersion:Q(W),ServiceType:Q(W)}),Gv=S(Ev,{ProviderName:Q(W),ProviderSite:Q(Av),ServiceContact:Q(function(a,c){return T({},Rv,a,c)})});function Sv(a,c,d,e){var f;void 0!==e?f=e:f=[];e=0;var g,h;for(g=0;g<c;)for(h=a[g++],f[e++]=a[g++],f[e++]=h,h=2;h<d;++h)f[e++]=a[g++];f.length=e};function Tv(a){a=a?a:{};this.defaultDataProjection=null;this.defaultDataProjection=Ce("EPSG:4326");this.b=a.factor?a.factor:1E5;this.a=a.geometryLayout?a.geometryLayout:"XY"}w(Tv,ht);function Uv(a,c,d){var e,f=Array(c);for(e=0;e<c;++e)f[e]=0;var g,h;g=0;for(h=a.length;g<h;)for(e=0;e<c;++e,++g){var k=a[g],m=k-f[e];f[e]=k;a[g]=m}return Vv(a,d?d:1E5)}
function Wv(a,c,d){var e,f=Array(c);for(e=0;e<c;++e)f[e]=0;a=Xv(a,d?d:1E5);var g;d=0;for(g=a.length;d<g;)for(e=0;e<c;++e,++d)f[e]+=a[d],a[d]=f[e];return a}function Vv(a,c){var d=c?c:1E5,e,f;e=0;for(f=a.length;e<f;++e)a[e]=Math.round(a[e]*d);d=0;for(e=a.length;d<e;++d)f=a[d],a[d]=0>f?~(f<<1):f<<1;d="";e=0;for(f=a.length;e<f;++e){for(var g=a[e],h=void 0,k="";32<=g;)h=(32|g&31)+63,k+=String.fromCharCode(h),g>>=5;h=g+63;k+=String.fromCharCode(h);d+=k}return d}
function Xv(a,c){var d=c?c:1E5,e=[],f=0,g=0,h,k;h=0;for(k=a.length;h<k;++h){var m=a.charCodeAt(h)-63,f=f|(m&31)<<g;32>m?(e.push(f),g=f=0):g+=5}f=0;for(g=e.length;f<g;++f)h=e[f],e[f]=h&1?~(h>>1):h>>1;f=0;for(g=e.length;f<g;++f)e[f]/=d;return e}l=Tv.prototype;l.hd=function(a,c){var d=this.kd(a,c);return new P(d)};l.tf=function(a,c){return[this.hd(a,c)]};l.kd=function(a,c){var d=bf(this.a),e=Wv(a,d,this.b);Sv(e,e.length,d,e);d=pf(e,0,e.length,d);return Lr(new H(d,this.a),!1,Kr(this,c))};
l.we=function(a,c){var d=a.W();return d?this.pd(d,c):""};l.Ah=function(a,c){return this.we(a[0],c)};l.pd=function(a,c){a=Lr(a,!0,Kr(this,c));var d=a.o,e=a.H;Sv(d,d.length,e,d);return Uv(d,e,this.b)};function Yv(a){a=a?a:{};this.defaultDataProjection=null;this.defaultDataProjection=Ce(a.defaultDataProjection?a.defaultDataProjection:"EPSG:4326")}w(Yv,Mr);function Zv(a,c){var d=[],e,f,g,h;g=0;for(h=a.length;g<h;++g)e=a[g],0<g&&d.pop(),0<=e?f=c[e]:f=c[~e].slice().reverse(),d.push.apply(d,f);e=0;for(f=d.length;e<f;++e)d[e]=d[e].slice();return d}function $v(a,c,d,e,f){a=a.geometries;var g=[],h,k;h=0;for(k=a.length;h<k;++h)g[h]=aw(a[h],c,d,e,f);return g}
function aw(a,c,d,e,f){var g=a.type,h=bw[g];c="Point"===g||"MultiPoint"===g?h(a,d,e):h(a,c);d=new P;d.Aa(Lr(c,!1,f));a.id&&d.Pb(a.id);a.properties&&d.I(a.properties);return d}
Yv.prototype.sf=function(a,c){if("Topology"==a.type){var d,e=null,f=null;a.transform&&(d=a.transform,e=d.scale,f=d.translate);var g=a.arcs;if(d){d=e;var h=f,k,m;k=0;for(m=g.length;k<m;++k)for(var n=g[k],p=d,q=h,r=0,u=0,y=void 0,A=void 0,F=void 0,A=0,F=n.length;A<F;++A)y=n[A],r+=y[0],u+=y[1],y[0]=r,y[1]=u,cw(y,p,q)}d=[];h=Kb(a.objects);k=0;for(m=h.length;k<m;++k)"GeometryCollection"===h[k].type?(n=h[k],d.push.apply(d,$v(n,g,e,f,c))):(n=h[k],d.push(aw(n,g,e,f,c)));return d}return[]};
function cw(a,c,d){a[0]=a[0]*c[0]+d[0];a[1]=a[1]*c[1]+d[1]}Yv.prototype.Ka=function(){return this.defaultDataProjection};
var bw={Point:function(a,c,d){a=a.coordinates;c&&d&&cw(a,c,d);return new C(a)},LineString:function(a,c){var d=Zv(a.arcs,c);return new H(d)},Polygon:function(a,c){var d=[],e,f;e=0;for(f=a.arcs.length;e<f;++e)d[e]=Zv(a.arcs[e],c);return new D(d)},MultiPoint:function(a,c,d){a=a.coordinates;var e,f;if(c&&d)for(e=0,f=a.length;e<f;++e)cw(a[e],c,d);return new jn(a)},MultiLineString:function(a,c){var d=[],e,f;e=0;for(f=a.arcs.length;e<f;++e)d[e]=Zv(a.arcs[e],c);return new L(d)},MultiPolygon:function(a,c){var d=
[],e,f,g,h,k,m;k=0;for(m=a.arcs.length;k<m;++k){e=a.arcs[k];f=[];g=0;for(h=e.length;g<h;++g)f[g]=Zv(e[g],c);d[k]=f}return new N(d)}};function dw(a){a=a?a:{};this.g=a.featureType;this.c=a.featureNS;this.b=a.gmlFormat?a.gmlFormat:new ps;this.f=a.schemaLocation?a.schemaLocation:"http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.1.0/wfs.xsd";this.defaultDataProjection=null}w(dw,$r);dw.prototype.Ob=function(a,c){var d={featureType:this.g,featureNS:this.c};Wb(d,Jr(this,a,c?c:{}));d=[d];this.b.b["http://www.opengis.net/gml"].featureMember=op(cs.prototype.jd);(d=T([],this.b.b,a,d,this.b))||(d=[]);return d};
dw.prototype.i=function(a){if($o(a))return ew(a);if(cp(a))return T({},fw,a,[]);if(ia(a))return a=mp(a),ew(a)};dw.prototype.j=function(a){if($o(a))return gw(this,a);if(cp(a))return hw(this,a);if(ia(a))return a=mp(a),gw(this,a)};function gw(a,c){for(var d=c.firstChild;d;d=d.nextSibling)if(1==d.nodeType)return hw(a,d)}var iw={"http://www.opengis.net/gml":{boundedBy:Q(cs.prototype.oe,"bounds")}};
function hw(a,c){var d={},e=js(c.getAttribute("numberOfFeatures"));d.numberOfFeatures=e;return T(d,iw,c,[],a.b)}
var jw={"http://www.opengis.net/wfs":{totalInserted:Q(is),totalUpdated:Q(is),totalDeleted:Q(is)}},kw={"http://www.opengis.net/ogc":{FeatureId:op(function(a){return a.getAttribute("fid")})}},lw={"http://www.opengis.net/wfs":{Feature:function(a,c){wp(kw,a,c)}}},fw={"http://www.opengis.net/wfs":{TransactionSummary:Q(function(a,c){return T({},jw,a,c)},"transactionSummary"),InsertResults:Q(function(a,c){return T([],lw,a,c)},"insertIds")}};
function ew(a){for(a=a.firstChild;a;a=a.nextSibling)if(1==a.nodeType)return T({},fw,a,[])}var mw={"http://www.opengis.net/wfs":{PropertyName:R(ls)}};function nw(a,c){var d=So("http://www.opengis.net/ogc","Filter"),e=So("http://www.opengis.net/ogc","FeatureId");d.appendChild(e);e.setAttribute("fid",c);a.appendChild(d)}
var ow={"http://www.opengis.net/wfs":{Insert:R(function(a,c,d){var e=d[d.length-1],e=So(e.featureNS,e.featureType);a.appendChild(e);ps.prototype.zh(e,c,d)}),Update:R(function(a,c,d){var e=d[d.length-1],f=e.featureType,g=e.featurePrefix,g=g?g:"feature",h=e.featureNS;a.setAttribute("typeName",g+":"+f);lp(a,"http://www.w3.org/2000/xmlns/","xmlns:"+g,h);if(f=c.Ca()){for(var g=c.P(),h=[],k=0,m=g.length;k<m;k++){var n=c.get(g[k]);void 0!==n&&h.push({name:g[k],value:n})}xp({node:a,srsName:e.srsName},ow,
sp("Property"),h,d);nw(a,f)}}),Delete:R(function(a,c,d){var e=d[d.length-1];d=e.featureType;var f=e.featurePrefix,f=f?f:"feature",e=e.featureNS;a.setAttribute("typeName",f+":"+d);lp(a,"http://www.w3.org/2000/xmlns/","xmlns:"+f,e);(c=c.Ca())&&nw(a,c)}),Property:R(function(a,c,d){var e=So("http://www.opengis.net/wfs","Name");a.appendChild(e);ls(e,c.name);void 0!==c.value&&null!==c.value&&(e=So("http://www.opengis.net/wfs","Value"),a.appendChild(e),c.value instanceof Ze?ps.prototype.ye(e,c.value,d):
ls(e,c.value))}),Native:R(function(a,c){c.qo&&a.setAttribute("vendorId",c.qo);void 0!==c.Qn&&a.setAttribute("safeToIgnore",c.Qn);void 0!==c.value&&ls(a,c.value)})}},pw={"http://www.opengis.net/wfs":{Query:R(function(a,c,d){var e=d[d.length-1],f=e.featurePrefix,g=e.featureNS,h=e.propertyNames,k=e.srsName;a.setAttribute("typeName",(f?f+":":"")+c);k&&a.setAttribute("srsName",k);g&&lp(a,"http://www.w3.org/2000/xmlns/","xmlns:"+f,g);c=Tb(e);c.node=a;xp(c,mw,sp("PropertyName"),h,d);if(e=e.bbox)h=So("http://www.opengis.net/ogc",
"Filter"),c=d[d.length-1].geometryName,f=So("http://www.opengis.net/ogc","BBOX"),h.appendChild(f),g=So("http://www.opengis.net/ogc","PropertyName"),ls(g,c),f.appendChild(g),ps.prototype.ye(f,e,d),a.appendChild(h)})}};
dw.prototype.l=function(a){var c=So("http://www.opengis.net/wfs","GetFeature");c.setAttribute("service","WFS");c.setAttribute("version","1.1.0");a&&(a.handle&&c.setAttribute("handle",a.handle),a.outputFormat&&c.setAttribute("outputFormat",a.outputFormat),void 0!==a.maxFeatures&&c.setAttribute("maxFeatures",a.maxFeatures),a.resultType&&c.setAttribute("resultType",a.resultType),void 0!==a.startIndex&&c.setAttribute("startIndex",a.startIndex),void 0!==a.count&&c.setAttribute("count",a.count));lp(c,"http://www.w3.org/2001/XMLSchema-instance",
"xsi:schemaLocation",this.f);var d=a.featureTypes;a=[{node:c,srsName:a.srsName,featureNS:a.featureNS?a.featureNS:this.c,featurePrefix:a.featurePrefix,geometryName:a.geometryName,bbox:a.bbox,propertyNames:a.propertyNames?a.propertyNames:[]}];var e=Tb(a[a.length-1]);e.node=c;xp(e,pw,sp("Query"),d,a);return c};
dw.prototype.A=function(a,c,d,e){var f=[],g=So("http://www.opengis.net/wfs","Transaction");g.setAttribute("service","WFS");g.setAttribute("version","1.1.0");var h,k;e&&(h=e.gmlOptions?e.gmlOptions:{},e.handle&&g.setAttribute("handle",e.handle));lp(g,"http://www.w3.org/2001/XMLSchema-instance","xsi:schemaLocation",this.f);a&&(k={node:g,featureNS:e.featureNS,featureType:e.featureType,featurePrefix:e.featurePrefix},Wb(k,h),xp(k,ow,sp("Insert"),a,f));c&&(k={node:g,featureNS:e.featureNS,featureType:e.featureType,
featurePrefix:e.featurePrefix},Wb(k,h),xp(k,ow,sp("Update"),c,f));d&&xp({node:g,featureNS:e.featureNS,featureType:e.featureType,featurePrefix:e.featurePrefix},ow,sp("Delete"),d,f);e.nativeElements&&xp({node:g,featureNS:e.featureNS,featureType:e.featureType,featurePrefix:e.featurePrefix},ow,sp("Native"),e.nativeElements,f);return g};dw.prototype.wf=function(a){for(a=a.firstChild;a;a=a.nextSibling)if(1==a.nodeType)return this.re(a);return null};
dw.prototype.re=function(a){if(a.firstElementChild&&a.firstElementChild.firstElementChild)for(a=a.firstElementChild.firstElementChild,a=a.firstElementChild;a;a=a.nextElementSibling)if(0!==a.childNodes.length&&(1!==a.childNodes.length||3!==a.firstChild.nodeType)){var c=[{}];this.b.oe(a,c);return Ce(c.pop().srsName)}return null};function qw(a){a=a?a:{};this.defaultDataProjection=null;this.b=void 0!==a.splitCollection?a.splitCollection:!1}w(qw,ht);function rw(a){a=a.V();return 0===a.length?"":a[0]+" "+a[1]}function sw(a){a=a.V();for(var c=[],d=0,e=a.length;d<e;++d)c.push(a[d][0]+" "+a[d][1]);return c.join(",")}function tw(a){var c=[];a=a.Gd();for(var d=0,e=a.length;d<e;++d)c.push("("+sw(a[d])+")");return c.join(",")}function uw(a){var c=a.X();a=(0,vw[c])(a);c=c.toUpperCase();return 0===a.length?c+" EMPTY":c+"("+a+")"}
var vw={Point:rw,LineString:sw,Polygon:tw,MultiPoint:function(a){var c=[];a=a.ae();for(var d=0,e=a.length;d<e;++d)c.push("("+rw(a[d])+")");return c.join(",")},MultiLineString:function(a){var c=[];a=a.$c();for(var d=0,e=a.length;d<e;++d)c.push("("+sw(a[d])+")");return c.join(",")},MultiPolygon:function(a){var c=[];a=a.Id();for(var d=0,e=a.length;d<e;++d)c.push("("+tw(a[d])+")");return c.join(",")},GeometryCollection:function(a){var c=[];a=a.Wf();for(var d=0,e=a.length;d<e;++d)c.push(uw(a[d]));return c.join(",")}};
l=qw.prototype;l.hd=function(a,c){var d=this.kd(a,c);if(d){var e=new P;e.Aa(d);return e}return null};l.tf=function(a,c){var d=[],e=this.kd(a,c);this.b&&"GeometryCollection"==e.X()?d=e.f:d=[e];for(var f=[],g=0,h=d.length;g<h;++g)e=new P,e.Aa(d[g]),f.push(e);return f};l.kd=function(a,c){var d;d=new ww(new xw(a));d.b=yw(d.a);return(d=zw(d))?Lr(d,!1,c):null};l.we=function(a,c){var d=a.W();return d?this.pd(d,c):""};
l.Ah=function(a,c){if(1==a.length)return this.we(a[0],c);for(var d=[],e=0,f=a.length;e<f;++e)d.push(a[e].W());d=new Zm(d);return this.pd(d,c)};l.pd=function(a,c){return uw(Lr(a,!0,c))};function xw(a){this.a=a;this.b=-1}function Aw(a,c){return"0"<=a&&"9">=a||"."==a&&!(void 0!==c&&c)}
function yw(a){var c=a.a.charAt(++a.b),d={position:a.b,value:c};if("("==c)d.type=2;else if(","==c)d.type=5;else if(")"==c)d.type=3;else if(Aw(c)||"-"==c){d.type=4;var e,c=a.b,f=!1,g=!1;do{if("."==e)f=!0;else if("e"==e||"E"==e)g=!0;e=a.a.charAt(++a.b)}while(Aw(e,f)||!g&&("e"==e||"E"==e)||g&&("-"==e||"+"==e));a=parseFloat(a.a.substring(c,a.b--));d.value=a}else if("a"<=c&&"z">=c||"A"<=c&&"Z">=c){d.type=1;c=a.b;do e=a.a.charAt(++a.b);while("a"<=e&&"z">=e||"A"<=e&&"Z">=e);a=a.a.substring(c,a.b--).toUpperCase();
d.value=a}else{if(" "==c||"\t"==c||"\r"==c||"\n"==c)return yw(a);if(""===c)d.type=6;else throw Error("Unexpected character: "+c);}return d}function ww(a){this.a=a}l=ww.prototype;l.match=function(a){if(a=this.b.type==a)this.b=yw(this.a);return a};
function zw(a){var c=a.b;if(a.match(1)){var d=c.value;if("GEOMETRYCOLLECTION"==d){a:{if(a.match(2)){c=[];do c.push(zw(a));while(a.match(5));if(a.match(3)){a=c;break a}}else if(Bw(a)){a=[];break a}throw Error(Cw(a));}return new Zm(a)}var e=Dw[d],c=Ew[d];if(!e||!c)throw Error("Invalid geometry type: "+d);a=e.call(a);return new c(a)}throw Error(Cw(a));}l.of=function(){if(this.match(2)){var a=Fw(this);if(this.match(3))return a}else if(Bw(this))return null;throw Error(Cw(this));};
l.nf=function(){if(this.match(2)){var a=Gw(this);if(this.match(3))return a}else if(Bw(this))return[];throw Error(Cw(this));};l.pf=function(){if(this.match(2)){var a=Hw(this);if(this.match(3))return a}else if(Bw(this))return[];throw Error(Cw(this));};l.cn=function(){if(this.match(2)){var a;if(2==this.b.type)for(a=[this.of()];this.match(5);)a.push(this.of());else a=Gw(this);if(this.match(3))return a}else if(Bw(this))return[];throw Error(Cw(this));};
l.bn=function(){if(this.match(2)){var a=Hw(this);if(this.match(3))return a}else if(Bw(this))return[];throw Error(Cw(this));};l.dn=function(){if(this.match(2)){for(var a=[this.pf()];this.match(5);)a.push(this.pf());if(this.match(3))return a}else if(Bw(this))return[];throw Error(Cw(this));};function Fw(a){for(var c=[],d=0;2>d;++d){var e=a.b;if(a.match(4))c.push(e.value);else break}if(2==c.length)return c;throw Error(Cw(a));}function Gw(a){for(var c=[Fw(a)];a.match(5);)c.push(Fw(a));return c}
function Hw(a){for(var c=[a.nf()];a.match(5);)c.push(a.nf());return c}function Bw(a){var c=1==a.b.type&&"EMPTY"==a.b.value;c&&(a.b=yw(a.a));return c}function Cw(a){return"Unexpected `"+a.b.value+"` at position "+a.b.position+" in `"+a.a.a+"`"}var Ew={POINT:C,LINESTRING:H,POLYGON:D,MULTIPOINT:jn,MULTILINESTRING:L,MULTIPOLYGON:N},Dw={POINT:ww.prototype.of,LINESTRING:ww.prototype.nf,POLYGON:ww.prototype.pf,MULTIPOINT:ww.prototype.cn,MULTILINESTRING:ww.prototype.bn,MULTIPOLYGON:ww.prototype.dn};function Iw(){this.version=void 0}w(Iw,Bv);Iw.prototype.a=function(a){for(a=a.firstChild;a;a=a.nextSibling)if(1==a.nodeType)return this.b(a);return null};Iw.prototype.b=function(a){this.version=a.getAttribute("version").trim();return(a=T({version:this.version},Jw,a,[]))?a:null};function Kw(a,c){return T({},Lw,a,c)}function Mw(a,c){return T({},Nw,a,c)}function Ow(a,c){var d=Kw(a,c);if(d){var e=[js(a.getAttribute("width")),js(a.getAttribute("height"))];d.size=e;return d}}
function Pw(a,c){return T([],Qw,a,c)}
var Rw=[null,"http://www.opengis.net/wms"],Jw=S(Rw,{Service:Q(function(a,c){return T({},Sw,a,c)}),Capability:Q(function(a,c){return T({},Tw,a,c)})}),Tw=S(Rw,{Request:Q(function(a,c){return T({},Uw,a,c)}),Exception:Q(function(a,c){return T([],Vw,a,c)}),Layer:Q(function(a,c){return T({},Ww,a,c)})}),Sw=S(Rw,{Name:Q(W),Title:Q(W),Abstract:Q(W),KeywordList:Q(Pw),OnlineResource:Q(Av),ContactInformation:Q(function(a,c){return T({},Xw,a,c)}),Fees:Q(W),AccessConstraints:Q(W),LayerLimit:Q(is),MaxWidth:Q(is),
MaxHeight:Q(is)}),Xw=S(Rw,{ContactPersonPrimary:Q(function(a,c){return T({},Yw,a,c)}),ContactPosition:Q(W),ContactAddress:Q(function(a,c){return T({},Zw,a,c)}),ContactVoiceTelephone:Q(W),ContactFacsimileTelephone:Q(W),ContactElectronicMailAddress:Q(W)}),Yw=S(Rw,{ContactPerson:Q(W),ContactOrganization:Q(W)}),Zw=S(Rw,{AddressType:Q(W),Address:Q(W),City:Q(W),StateOrProvince:Q(W),PostCode:Q(W),Country:Q(W)}),Vw=S(Rw,{Format:op(W)}),Ww=S(Rw,{Name:Q(W),Title:Q(W),Abstract:Q(W),KeywordList:Q(Pw),CRS:qp(W),
EX_GeographicBoundingBox:Q(function(a,c){var d=T({},$w,a,c);if(d){var e=d.westBoundLongitude,f=d.southBoundLatitude,g=d.eastBoundLongitude,d=d.northBoundLatitude;return void 0===e||void 0===f||void 0===g||void 0===d?void 0:[e,f,g,d]}}),BoundingBox:qp(function(a){var c=[hs(a.getAttribute("minx")),hs(a.getAttribute("miny")),hs(a.getAttribute("maxx")),hs(a.getAttribute("maxy"))],d=[hs(a.getAttribute("resx")),hs(a.getAttribute("resy"))];return{crs:a.getAttribute("CRS"),extent:c,res:d}}),Dimension:qp(function(a){return{name:a.getAttribute("name"),
units:a.getAttribute("units"),unitSymbol:a.getAttribute("unitSymbol"),"default":a.getAttribute("default"),multipleValues:es(a.getAttribute("multipleValues")),nearestValue:es(a.getAttribute("nearestValue")),current:es(a.getAttribute("current")),values:W(a)}}),Attribution:Q(function(a,c){return T({},ax,a,c)}),AuthorityURL:qp(function(a,c){var d=Kw(a,c);if(d)return d.name=a.getAttribute("name"),d}),Identifier:qp(W),MetadataURL:qp(function(a,c){var d=Kw(a,c);if(d)return d.type=a.getAttribute("type"),
d}),DataURL:qp(Kw),FeatureListURL:qp(Kw),Style:qp(function(a,c){return T({},bx,a,c)}),MinScaleDenominator:Q(gs),MaxScaleDenominator:Q(gs),Layer:qp(function(a,c){var d=c[c.length-1],e=T({},Ww,a,c);if(e){var f=es(a.getAttribute("queryable"));void 0===f&&(f=d.queryable);e.queryable=void 0!==f?f:!1;f=js(a.getAttribute("cascaded"));void 0===f&&(f=d.cascaded);e.cascaded=f;f=es(a.getAttribute("opaque"));void 0===f&&(f=d.opaque);e.opaque=void 0!==f?f:!1;f=es(a.getAttribute("noSubsets"));void 0===f&&(f=d.noSubsets);
e.noSubsets=void 0!==f?f:!1;(f=hs(a.getAttribute("fixedWidth")))||(f=d.fixedWidth);e.fixedWidth=f;(f=hs(a.getAttribute("fixedHeight")))||(f=d.fixedHeight);e.fixedHeight=f;["Style","CRS","AuthorityURL"].forEach(function(a){if(a in d){var c=Sb(e,a),c=c.concat(d[a]);e[a]=c}});"EX_GeographicBoundingBox BoundingBox Dimension Attribution MinScaleDenominator MaxScaleDenominator".split(" ").forEach(function(a){a in e||(e[a]=d[a])});return e}})}),ax=S(Rw,{Title:Q(W),OnlineResource:Q(Av),LogoURL:Q(Ow)}),$w=
S(Rw,{westBoundLongitude:Q(gs),eastBoundLongitude:Q(gs),southBoundLatitude:Q(gs),northBoundLatitude:Q(gs)}),Uw=S(Rw,{GetCapabilities:Q(Mw),GetMap:Q(Mw),GetFeatureInfo:Q(Mw)}),Nw=S(Rw,{Format:qp(W),DCPType:qp(function(a,c){return T({},cx,a,c)})}),cx=S(Rw,{HTTP:Q(function(a,c){return T({},dx,a,c)})}),dx=S(Rw,{Get:Q(Kw),Post:Q(Kw)}),bx=S(Rw,{Name:Q(W),Title:Q(W),Abstract:Q(W),LegendURL:qp(Ow),StyleSheetURL:Q(Kw),StyleURL:Q(Kw)}),Lw=S(Rw,{Format:Q(W),OnlineResource:Q(Av)}),Qw=S(Rw,{Keyword:op(W)});function ex(){this.c="http://mapserver.gis.umn.edu/mapserver";this.b=new os;this.defaultDataProjection=null}w(ex,$r);
ex.prototype.Ob=function(a,c){var d={featureType:this.featureType,featureNS:this.featureNS};c&&Wb(d,Jr(this,a,c));var e=[d];a.namespaceURI=this.c;var f=Xo(a),d=[];if(0!==a.childNodes.length){if("msGMLOutput"==f)for(var g=0,h=a.childNodes.length;g<h;g++){var k=a.childNodes[g];if(1===k.nodeType){var m=e[0],n=k.localName.replace("_layer","")+"_feature";m.featureType=n;m.featureNS=this.c;var p={};p[n]=op(this.b.rf,this.b);m=S([m.featureNS,null],p);k.namespaceURI=this.c;(k=T([],m,k,e,this.b))&&ib(d,k)}}"FeatureCollection"==
f&&(e=T([],this.b.b,a,[{}],this.b))&&(d=e)}return d};function fx(){this.f=new Cv}w(fx,Bv);fx.prototype.a=function(a){for(a=a.firstChild;a;a=a.nextSibling)if(1==a.nodeType)return this.b(a);return null};fx.prototype.b=function(a){this.version=a.getAttribute("version").trim();var c=this.f.b(a);if(!c)return null;c.version=this.version;return(c=T(c,gx,a,[]))?c:null};function hx(a){var c=W(a).split(" ");if(c&&2==c.length)return a=+c[0],c=+c[1],isNaN(a)||isNaN(c)?void 0:[a,c]}
var ix=[null,"http://www.opengis.net/wmts/1.0"],jx=[null,"http://www.opengis.net/ows/1.1"],gx=S(ix,{Contents:Q(function(a,c){return T({},kx,a,c)})}),kx=S(ix,{Layer:qp(function(a,c){return T({},lx,a,c)}),TileMatrixSet:qp(function(a,c){return T({},mx,a,c)})}),lx=S(ix,{Style:qp(function(a,c){var d=T({},nx,a,c);if(d){var e="true"===a.getAttribute("isDefault");d.isDefault=e;return d}}),Format:qp(W),TileMatrixSetLink:qp(function(a,c){return T({},ox,a,c)}),Dimension:qp(function(a,c){return T({},px,a,c)}),
ResourceURL:qp(function(a){var c=a.getAttribute("format"),d=a.getAttribute("template");a=a.getAttribute("resourceType");var e={};c&&(e.format=c);d&&(e.template=d);a&&(e.resourceType=a);return e})},S(jx,{Title:Q(W),Abstract:Q(W),WGS84BoundingBox:Q(function(a,c){var d=T([],qx,a,c);return 2!=d.length?void 0:Md(d)}),Identifier:Q(W)})),nx=S(ix,{LegendURL:qp(function(a){var c={};c.format=a.getAttribute("format");c.href=Av(a);return c})},S(jx,{Title:Q(W),Identifier:Q(W)})),ox=S(ix,{TileMatrixSet:Q(W)}),
px=S(ix,{Default:Q(W),Value:qp(W)},S(jx,{Identifier:Q(W)})),qx=S(jx,{LowerCorner:op(hx),UpperCorner:op(hx)}),mx=S(ix,{WellKnownScaleSet:Q(W),TileMatrix:qp(function(a,c){return T({},rx,a,c)})},S(jx,{SupportedCRS:Q(W),Identifier:Q(W)})),rx=S(ix,{TopLeftCorner:Q(hx),ScaleDenominator:Q(gs),TileWidth:Q(is),TileHeight:Q(is),MatrixWidth:Q(is),MatrixHeight:Q(is)},S(jx,{Identifier:Q(W)}));var sx=new xe(6378137);function tx(a){hd.call(this);a=a||{};this.a=null;this.f=We;this.c=void 0;B(this,jd("projection"),this.Gk,!1,this);B(this,jd("tracking"),this.Hk,!1,this);void 0!==a.projection&&this.rg(Ce(a.projection));void 0!==a.trackingOptions&&this.rh(a.trackingOptions);this.Xd(void 0!==a.tracking?a.tracking:!1)}w(tx,hd);l=tx.prototype;l.Z=function(){this.Xd(!1);tx.ca.Z.call(this)};l.Gk=function(){var a=this.pg();a&&(this.f=Ge(Ce("EPSG:4326"),a),this.a&&this.set("position",this.f(this.a)))};
l.Hk=function(){if(bj){var a=this.qg();a&&void 0===this.c?this.c=ba.navigator.geolocation.watchPosition(qa(this.ln,this),qa(this.mn,this),this.cg()):a||void 0===this.c||(ba.navigator.geolocation.clearWatch(this.c),this.c=void 0)}};
l.ln=function(a){a=a.coords;this.set("accuracy",a.accuracy);this.set("altitude",null===a.altitude?void 0:a.altitude);this.set("altitudeAccuracy",null===a.altitudeAccuracy?void 0:a.altitudeAccuracy);this.set("heading",null===a.heading?void 0:Ta(a.heading));this.a?(this.a[0]=a.longitude,this.a[1]=a.latitude):this.a=[a.longitude,a.latitude];var c=this.f(this.a);this.set("position",c);this.set("speed",null===a.speed?void 0:a.speed);a=Kf(sx,this.a,a.accuracy);a.Rb(this.f);this.set("accuracyGeometry",a);
this.u()};l.mn=function(a){a.type="error";this.Xd(!1);this.s(a)};l.Ei=function(){return this.get("accuracy")};l.Fi=function(){return this.get("accuracyGeometry")||null};l.Hi=function(){return this.get("altitude")};l.Ii=function(){return this.get("altitudeAccuracy")};l.Ek=function(){return this.get("heading")};l.Fk=function(){return this.get("position")};l.pg=function(){return this.get("projection")};l.oj=function(){return this.get("speed")};l.qg=function(){return this.get("tracking")};l.cg=function(){return this.get("trackingOptions")};
l.rg=function(a){this.set("projection",a)};l.Xd=function(a){this.set("tracking",a)};l.rh=function(a){this.set("trackingOptions",a)};function ux(a,c,d){for(var e=[],f=a(0),g=a(1),h=c(f),k=c(g),m=[g,f],n=[k,h],p=[1,0],q={},r=1E5,u,y,A,F,z;0<--r&&0<p.length;)A=p.pop(),f=m.pop(),h=n.pop(),g=A.toString(),g in q||(e.push(h[0],h[1]),q[g]=!0),F=p.pop(),g=m.pop(),k=n.pop(),z=(A+F)/2,u=a(z),y=c(u),Ra(y[0],y[1],h[0],h[1],k[0],k[1])<d?(e.push(k[0],k[1]),g=F.toString(),q[g]=!0):(p.push(F,z,z,A),n.push(k,y,y,h),m.push(g,u,u,f));return e}function vx(a,c,d,e,f){var g=Ce("EPSG:4326");return ux(function(e){return[a,c+(d-c)*e]},Ve(g,e),f)}
function wx(a,c,d,e,f){var g=Ce("EPSG:4326");return ux(function(e){return[c+(d-c)*e,a]},Ve(g,e),f)};function xx(a){a=a||{};this.g=this.l=null;this.c=this.j=Infinity;this.f=this.i=-Infinity;this.C=this.v=Infinity;this.ea=this.O=-Infinity;this.U=void 0!==a.targetSize?a.targetSize:100;this.ka=void 0!==a.maxLines?a.maxLines:100;this.b=[];this.a=[];this.J=void 0!==a.strokeStyle?a.strokeStyle:yx;this.A=this.D=void 0;this.B=null;this.setMap(void 0!==a.map?a.map:null)}var yx=new bm({color:"rgba(0,0,0,0.2)"}),zx=[90,45,30,20,10,5,2,1,.5,.2,.1,.05,.01,.005,.002,.001];
function Ax(a,c,d,e,f,g,h){var k=h;c=vx(c,d,e,a.g,f);k=void 0!==a.b[k]?a.b[k]:new H(null);fn(k,"XY",c);ke(k.S(),g)&&(a.b[h++]=k);return h}function Bx(a,c,d,e,f){var g=f;c=wx(c,a.f,a.c,a.g,d);g=void 0!==a.a[g]?a.a[g]:new H(null);fn(g,"XY",c);ke(g.S(),e)&&(a.a[f++]=g);return f}l=xx.prototype;l.Ik=function(){return this.l};l.bj=function(){return this.b};l.ij=function(){return this.a};
l.gg=function(a){var c=a.vectorContext,d=a.frameState,e=d.extent;a=d.viewState;var f=a.center,g=a.projection,h=a.resolution;a=d.pixelRatio;a=h*h/(4*a*a);if(!this.g||!Ue(this.g,g)){var k=Ce("EPSG:4326"),m=g.S(),n=g.i,p=Ye(n,k,g),q=n[2],r=n[1],u=n[0],y=p[3],A=p[2],F=p[1],p=p[0];this.j=n[3];this.c=q;this.i=r;this.f=u;this.v=y;this.C=A;this.O=F;this.ea=p;this.D=Ve(k,g);this.A=Ve(g,k);this.B=this.A(ge(m));this.g=g}k=0;g.c&&(g=g.S(),k=le(g),d=d.focus[0],d<g[0]||d>g[2])&&(k*=Math.ceil((g[0]-d)/k),e=[e[0]+
k,e[1],e[2]+k,e[3]]);d=this.B[0];g=this.B[1];k=-1;n=Math.pow(this.U*h,2);q=[];r=[];h=0;for(m=zx.length;h<m;++h){u=zx[h]/2;q[0]=d-u;q[1]=g-u;r[0]=d+u;r[1]=g+u;this.D(q,q);this.D(r,r);u=Math.pow(r[0]-q[0],2)+Math.pow(r[1]-q[1],2);if(u<=n)break;k=zx[h]}h=k;if(-1==h)this.b.length=this.a.length=0;else{d=this.A(f);f=d[0];d=d[1];g=this.ka;k=[Math.max(e[0],this.ea),Math.max(e[1],this.O),Math.min(e[2],this.C),Math.min(e[3],this.v)];k=Ye(k,this.g,"EPSG:4326");n=k[3];r=k[1];f=Math.floor(f/h)*h;q=Qa(f,this.f,
this.c);m=Ax(this,q,r,n,a,e,0);for(k=0;q!=this.f&&k++<g;)q=Math.max(q-h,this.f),m=Ax(this,q,r,n,a,e,m);q=Qa(f,this.f,this.c);for(k=0;q!=this.c&&k++<g;)q=Math.min(q+h,this.c),m=Ax(this,q,r,n,a,e,m);this.b.length=m;d=Math.floor(d/h)*h;f=Qa(d,this.i,this.j);m=Bx(this,f,a,e,0);for(k=0;f!=this.i&&k++<g;)f=Math.max(f-h,this.i),m=Bx(this,f,a,e,m);f=Qa(d,this.i,this.j);for(k=0;f!=this.j&&k++<g;)f=Math.min(f+h,this.j),m=Bx(this,f,a,e,m);this.a.length=m}c.Ma(null,this.J);a=0;for(f=this.b.length;a<f;++a)h=this.b[a],
c.Bb(h,null);a=0;for(f=this.a.length;a<f;++a)h=this.a[a],c.Bb(h,null)};l.setMap=function(a){this.l&&(this.l.K("postcompose",this.gg,this),this.l.render());a&&(a.G("postcompose",this.gg,this),a.render());this.l=a};function Cx(a,c,d,e,f,g,h){hk.call(this,a,c,d,0,e);this.l=f;this.a=new Image;g&&(this.a.crossOrigin=g);this.f={};this.c=null;this.state=0;this.i=h}w(Cx,hk);Cx.prototype.b=function(a){if(void 0!==a){var c=v(a);if(c in this.f)return this.f[c];a=Pb(this.f)?this.a:this.a.cloneNode(!1);return this.f[c]=a}return this.a};Cx.prototype.D=function(){this.state=3;this.c.forEach(Yc);this.c=null;ik(this)};
Cx.prototype.B=function(){void 0===this.resolution&&(this.resolution=ie(this.extent)/this.a.height);this.state=2;this.c.forEach(Yc);this.c=null;ik(this)};Cx.prototype.load=function(){0==this.state&&(this.state=1,ik(this),this.c=[Wc(this.a,"error",this.D,!1,this),Wc(this.a,"load",this.B,!1,this)],this.i(this,this.l))};function Dx(a,c,d,e,f){Ah.call(this,a,c);this.i=d;this.a=new Image;e&&(this.a.crossOrigin=e);this.c={};this.g=null;this.l=f}w(Dx,Ah);l=Dx.prototype;l.Z=function(){1==this.state&&Ex(this);Dx.ca.Z.call(this)};l.Ta=function(a){if(void 0!==a){var c=v(a);if(c in this.c)return this.c[c];a=Pb(this.c)?this.a:this.a.cloneNode(!1);return this.c[c]=a}return this.a};l.nb=function(){return this.i};l.Jk=function(){this.state=3;Ex(this);Bh(this)};
l.Kk=function(){this.state=this.a.naturalWidth&&this.a.naturalHeight?2:4;Ex(this);Bh(this)};l.load=function(){0==this.state&&(this.state=1,Bh(this),this.g=[Wc(this.a,"error",this.Jk,!1,this),Wc(this.a,"load",this.Kk,!1,this)],this.l(this,this.i))};function Ex(a){a.g.forEach(Yc);a.g=null};function Fx(a,c,d){return function(e,f,g){return d(a,c,e,f,g)}}function Gx(){};function Hx(a,c){bd.call(this);this.b=new rr(this);var d=a;c&&(d=Hg(a));this.b.Sa(d,"dragenter",this.Um);d!=a&&this.b.Sa(d,"dragover",this.Vm);this.b.Sa(a,"dragover",this.Wm);this.b.Sa(a,"drop",this.Xm)}w(Hx,bd);l=Hx.prototype;l.Wc=!1;l.Z=function(){Hx.ca.Z.call(this);this.b.Vc()};l.Um=function(a){var c=a.b.dataTransfer;(this.Wc=!(!c||!(c.types&&(0<=Ya(c.types,"Files")||0<=Ya(c.types,"public.file-url"))||c.files&&0<c.files.length)))&&a.preventDefault()};
l.Vm=function(a){this.Wc&&(a.preventDefault(),a.b.dataTransfer.dropEffect="none")};l.Wm=function(a){if(this.Wc){a.preventDefault();a.c();a=a.b.dataTransfer;try{a.effectAllowed="all"}catch(c){}a.dropEffect="copy"}};l.Xm=function(a){this.Wc&&(a.preventDefault(),a.c(),a=new zc(a.b),a.type="drop",this.s(a))};/*
 Portions of this code are from MochiKit, received by
 The Closure Authors under the MIT license. All other code is Copyright
 2005-2009 The Closure Authors. All Rights Reserved.
*/
function Ix(a,c){this.g=[];this.v=a;this.A=c||null;this.f=this.b=!1;this.c=void 0;this.D=this.C=this.i=!1;this.j=0;this.a=null;this.l=0}Ix.prototype.cancel=function(a){if(this.b)this.c instanceof Ix&&this.c.cancel();else{if(this.a){var c=this.a;delete this.a;a?c.cancel(a):(c.l--,0>=c.l&&c.cancel())}this.v?this.v.call(this.A,this):this.D=!0;this.b||(a=new Jx,Kx(this),Lx(this,!1,a))}};Ix.prototype.B=function(a,c){this.i=!1;Lx(this,a,c)};function Lx(a,c,d){a.b=!0;a.c=d;a.f=!c;Mx(a)}
function Kx(a){if(a.b){if(!a.D)throw new Nx;a.D=!1}}Ix.prototype.Nc=function(a){Kx(this);Lx(this,!0,a)};function Ox(a,c,d,e){a.g.push([c,d,e]);a.b&&Mx(a)}Ix.prototype.then=function(a,c,d){var e,f,g=new Nn(function(a,c){e=a;f=c});Ox(this,e,function(a){a instanceof Jx?g.cancel():f(a)});return g.then(a,c,d)};An(Ix);function Px(a){return bb(a.g,function(a){return ka(a[1])})}
function Mx(a){if(a.j&&a.b&&Px(a)){var c=a.j,d=Qx[c];d&&(ba.clearTimeout(d.qa),delete Qx[c]);a.j=0}a.a&&(a.a.l--,delete a.a);for(var c=a.c,e=d=!1;a.g.length&&!a.i;){var f=a.g.shift(),g=f[0],h=f[1],f=f[2];if(g=a.f?h:g)try{var k=g.call(f||a.A,c);ca(k)&&(a.f=a.f&&(k==c||k instanceof Error),a.c=c=k);if(Bn(c)||"function"===typeof ba.Promise&&c instanceof ba.Promise)e=!0,a.i=!0}catch(m){c=m,a.f=!0,Px(a)||(d=!0)}}a.c=c;e&&(k=qa(a.B,a,!0),e=qa(a.B,a,!1),c instanceof Ix?(Ox(c,k,e),c.C=!0):c.then(k,e));d&&
(c=new Rx(c),Qx[c.qa]=c,a.j=c.qa)}function Nx(){xa.call(this)}w(Nx,xa);Nx.prototype.message="Deferred has already fired";Nx.prototype.name="AlreadyCalledError";function Jx(){xa.call(this)}w(Jx,xa);Jx.prototype.message="Deferred was canceled";Jx.prototype.name="CanceledError";function Rx(a){this.qa=ba.setTimeout(qa(this.a,this),0);this.b=a}Rx.prototype.a=function(){delete Qx[this.qa];throw this.b;};var Qx={};function Sx(a,c){ca(a.name)?(this.name=a.name,this.code=Tx[a.name]):(this.code=a.code,this.name=Ux(a.code));xa.call(this,Aa("%s %s",this.name,c))}w(Sx,xa);function Ux(a){var c=Ob(Tx,function(c){return a==c});if(!ca(c))throw Error("Invalid code: "+a);return c}var Tx={AbortError:3,EncodingError:5,InvalidModificationError:9,InvalidStateError:7,NotFoundError:1,NotReadableError:4,NoModificationAllowedError:6,PathExistsError:12,QuotaExceededError:10,SecurityError:2,SyntaxError:8,TypeMismatchError:11};function Vx(a,c){uc.call(this,a.type,c)}w(Vx,uc);function Wx(){bd.call(this);this.eb=new FileReader;this.eb.onloadstart=qa(this.b,this);this.eb.onprogress=qa(this.b,this);this.eb.onload=qa(this.b,this);this.eb.onabort=qa(this.b,this);this.eb.onerror=qa(this.b,this);this.eb.onloadend=qa(this.b,this)}w(Wx,bd);Wx.prototype.getError=function(){return this.eb.error&&new Sx(this.eb.error,"reading file")};Wx.prototype.b=function(a){this.s(new Vx(a,this))};Wx.prototype.Z=function(){Wx.ca.Z.call(this);delete this.eb};
function Xx(a){var c=new Ix;a.Sa("loadend",ra(function(a,c){var f=c.eb.result,g=c.getError();null==f||g?(Kx(a),Lx(a,!1,g)):a.Nc(f);c.Vc()},c,a));return c};function Yx(a){a=a?a:{};Pk.call(this,{handleEvent:re});this.j=a.formatConstructors?a.formatConstructors:[];this.A=a.projection?Ce(a.projection):null;this.f=null;this.a=void 0}w(Yx,Pk);Yx.prototype.Z=function(){this.a&&Yc(this.a);Yx.ca.Z.call(this)};Yx.prototype.i=function(a){a=a.b.dataTransfer.files;var c,d,e;c=0;for(d=a.length;c<d;++c){var f=e=a[c],g=new Wx,h=Xx(g);g.eb.readAsText(f,"");Ox(h,ra(this.l,e),null,this)}};
Yx.prototype.l=function(a,c){var d=this.B,e=this.A;e||(e=d.aa().g);var d=this.j,f=[],g,h;g=0;for(h=d.length;g<h;++g){var k=new d[g],m;try{m=k.ta(c)}catch(u){m=null}if(m){var k=k.Ka(c),k=Ve(k,e),n,p;n=0;for(p=m.length;n<p;++n){var q=m[n],r=q.W();r&&r.Rb(k);f.push(q)}}}this.s(new Zx($x,this,a,f,e))};Yx.prototype.setMap=function(a){this.a&&(Yc(this.a),this.a=void 0);this.f&&(tc(this.f),this.f=null);Yx.ca.setMap.call(this,a);a&&(this.f=new Hx(a.a),this.a=B(this.f,"drop",this.i,!1,this))};var $x="addfeatures";
function Zx(a,c,d,e,f){uc.call(this,a,c);this.features=e;this.file=d;this.projection=f}w(Zx,uc);function ay(a,c){this.x=a;this.y=c}w(ay,Dg);ay.prototype.clone=function(){return new ay(this.x,this.y)};ay.prototype.scale=Dg.prototype.scale;ay.prototype.add=function(a){this.x+=a.x;this.y+=a.y;return this};ay.prototype.rotate=function(a){var c=Math.cos(a);a=Math.sin(a);var d=this.y*c+this.x*a;this.x=this.x*c-this.y*a;this.y=d;return this};function by(a){a=a?a:{};bl.call(this,{handleDownEvent:cy,handleDragEvent:dy,handleUpEvent:ey});this.l=a.condition?a.condition:Zk;this.a=this.f=void 0;this.i=0;this.A=a.duration?a.duration:400}w(by,bl);
function dy(a){if(al(a)){var c=a.map,d=c.Ha();a=a.pixel;a=new ay(a[0]-d[0]/2,d[1]/2-a[1]);d=Math.atan2(a.y,a.x);a=Math.sqrt(a.x*a.x+a.y*a.y);var e=c.aa();c.render();if(void 0!==this.f){var f=d-this.f;Qk(c,e,e.wa()-f)}this.f=d;void 0!==this.a&&(d=this.a*(e.ba()/a),Sk(c,e,d));void 0!==this.a&&(this.i=this.a/a);this.a=a}}
function ey(a){if(!al(a))return!0;a=a.map;var c=a.aa();Uf(c,-1);var d=this.i-1,e=c.wa(),e=c.constrainRotation(e,0);Qk(a,c,e,void 0,void 0);var e=c.ba(),f=this.A,e=c.constrainResolution(e,0,d);Sk(a,c,e,void 0,f);this.i=0;return!1}function cy(a){return al(a)&&this.l(a)?(Uf(a.map.aa(),1),this.a=this.f=void 0,!0):!1};function fy(a,c){uc.call(this,a);this.feature=c}w(fy,uc);
function gy(a){bl.call(this,{handleDownEvent:hy,handleEvent:iy,handleUpEvent:jy});this.da=null;this.U=!1;this.qb=a.source?a.source:null;this.ib=a.features?a.features:null;this.Ih=a.snapTolerance?a.snapTolerance:12;this.$=a.type;this.f=ky(this.$);this.Qa=a.minPoints?a.minPoints:this.f===ly?3:2;this.xa=a.maxPoints?a.maxPoints:Infinity;var c=a.geometryFunction;if(!c)if("Circle"===this.$)c=function(a,c){var d=c?c:new Xm([NaN,NaN]);d.yf(a[0],Math.sqrt(wd(a[0],a[1])));return d};else{var d,c=this.f;c===
my?d=C:c===ny?d=H:c===ly&&(d=D);c=function(a,c){var g=c;g?g.ja(a):g=new d(a);return g}}this.C=c;this.J=this.A=this.a=this.O=this.i=this.l=null;this.ki=a.clickTolerance?a.clickTolerance*a.clickTolerance:36;this.ga=new G({source:new U({useSpatialIndex:!1,wrapX:a.wrapX?a.wrapX:!1}),style:a.style?a.style:oy()});this.pb=a.geometryName;this.De=a.condition?a.condition:Yk;this.sa=a.freehandCondition?a.freehandCondition:Zk;B(this,jd("active"),this.xh,!1,this)}w(gy,bl);
function oy(){var a=im();return function(c){return a[c.W().X()]}}l=gy.prototype;l.setMap=function(a){gy.ca.setMap.call(this,a);this.xh()};function iy(a){var c=!this.U;this.U&&a.type===Zj?(py(this,a),c=!1):a.type===Yj?c=qy(this,a):a.type===Sj&&(c=!1);return cl.call(this,a)&&c}function hy(a){if(this.De(a))return this.da=a.pixel,!0;if(this.f!==ny&&this.f!==ly||!this.sa(a))return!1;this.da=a.pixel;this.U=!0;this.l||ry(this,a);return!0}
function jy(a){this.U=!1;var c=this.da,d=a.pixel,e=c[0]-d[0],c=c[1]-d[1],d=!0;e*e+c*c<=this.ki&&(qy(this,a),this.l?this.f===sy?this.Yc():ty(this,a)?this.Yc():py(this,a):(ry(this,a),this.f===my&&this.Yc()),d=!1);return d}
function qy(a,c){if(a.l){var d=c.coordinate,e=a.i.W(),f;a.f===my?f=a.a:a.f===ly?(f=a.a[0],f=f[f.length-1],ty(a,c)&&(d=a.l.slice())):(f=a.a,f=f[f.length-1]);f[0]=d[0];f[1]=d[1];a.C(a.a,e);a.O&&a.O.W().ja(d);e instanceof D&&a.f!==ly?(a.A||(a.A=new P(new H(null))),e=e.Yf(0),d=a.A.W(),fn(d,e.a,e.o)):a.J&&(d=a.A.W(),d.ja(a.J));uy(a)}else d=c.coordinate.slice(),a.O?a.O.W().ja(d):(a.O=new P(new C(d)),uy(a));return!0}
function ty(a,c){var d=!1;if(a.i){var e=!1,f=[a.l];a.f===ny?e=a.a.length>a.Qa:a.f===ly&&(e=a.a[0].length>a.Qa,f=[a.a[0][0],a.a[0][a.a[0].length-2]]);if(e)for(var e=c.map,g=0,h=f.length;g<h;g++){var k=f[g],m=e.Da(k),n=c.pixel,d=n[0]-m[0],m=n[1]-m[1],n=a.U&&a.sa(c)?1:a.Ih;if(d=Math.sqrt(d*d+m*m)<=n){a.l=k;break}}}return d}
function ry(a,c){var d=c.coordinate;a.l=d;a.f===my?a.a=d.slice():a.f===ly?(a.a=[[d.slice(),d.slice()]],a.J=a.a[0]):(a.a=[d.slice(),d.slice()],a.f===sy&&(a.J=a.a));a.J&&(a.A=new P(new H(a.J)));d=a.C(a.a);a.i=new P;a.pb&&a.i.Fc(a.pb);a.i.Aa(d);uy(a);a.s(new fy("drawstart",a.i))}
function py(a,c){var d=c.coordinate,e=a.i.W(),f,g;if(a.f===ny)a.l=d.slice(),g=a.a,g.push(d.slice()),f=g.length>a.xa,a.C(g,e);else if(a.f===ly){g=a.a[0];g.push(d.slice());if(f=g.length>a.xa)a.l=g[0];a.C(a.a,e)}uy(a);f&&a.Yc()}l.In=function(){var a=this.i.W(),c,d;this.f===ny?(c=this.a,c.splice(-2,1),this.C(c,a)):this.f===ly&&(c=this.a[0],c.splice(-2,1),d=this.A.W(),d.ja(c),this.C(this.a,a));0===c.length&&(this.l=null);uy(this)};
l.Yc=function(){var a=vy(this),c=this.a,d=a.W();this.f===ny?(c.pop(),this.C(c,d)):this.f===ly&&(c[0].pop(),c[0].push(c[0][0]),this.C(c,d));"MultiPoint"===this.$?a.Aa(new jn([c])):"MultiLineString"===this.$?a.Aa(new L([c])):"MultiPolygon"===this.$&&a.Aa(new N([c]));this.s(new fy("drawend",a));this.ib&&this.ib.push(a);this.qb&&this.qb.Ac(a)};function vy(a){a.l=null;var c=a.i;c&&(a.i=null,a.O=null,a.A=null,a.ga.fa().clear(!0));return c}
l.il=function(a){var c=a.W();this.i=a;this.a=c.V();a=this.a[this.a.length-1];this.l=a.slice();this.a.push(a.slice());uy(this);this.s(new fy("drawstart",this.i))};l.kc=qe;function uy(a){var c=[];a.i&&c.push(a.i);a.A&&c.push(a.A);a.O&&c.push(a.O);a=a.ga.fa();a.clear(!0);a.Qb(c)}l.xh=function(){var a=this.B,c=this.c();a&&c||vy(this);this.ga.setMap(c?a:null)};
function ky(a){var c;"Point"===a||"MultiPoint"===a?c=my:"LineString"===a||"MultiLineString"===a?c=ny:"Polygon"===a||"MultiPolygon"===a?c=ly:"Circle"===a&&(c=sy);return c}var my="Point",ny="LineString",ly="Polygon",sy="Circle";function wy(a,c,d){uc.call(this,a);this.features=c;this.mapBrowserPointerEvent=d}w(wy,uc);
function xy(a){bl.call(this,{handleDownEvent:yy,handleDragEvent:zy,handleEvent:Ay,handleUpEvent:By});this.xa=a.deleteCondition?a.deleteCondition:we(Yk,Xk);this.sa=this.f=null;this.da=[0,0];this.C=this.U=!1;this.a=new Dp;this.O=void 0!==a.pixelTolerance?a.pixelTolerance:10;this.l=this.ga=!1;this.i=null;this.J=new G({source:new U({useSpatialIndex:!1,wrapX:!!a.wrapX}),style:a.style?a.style:Cy(),updateWhileAnimating:!0,updateWhileInteracting:!0});this.$={Point:this.pl,LineString:this.xg,LinearRing:this.xg,
Polygon:this.ql,MultiPoint:this.nl,MultiLineString:this.ml,MultiPolygon:this.ol,GeometryCollection:this.ll};this.A=a.features;this.A.forEach(this.jf,this);B(this.A,"add",this.jl,!1,this);B(this.A,"remove",this.kl,!1,this)}w(xy,bl);l=xy.prototype;l.jf=function(a){var c=a.W();c.X()in this.$&&this.$[c.X()].call(this,a,c);(c=this.B)&&Dy(this,this.da,c);B(a,"change",this.wg,!1,this)};function Ey(a,c){a.C||(a.C=!0,a.s(new wy("modifystart",a.A,c)))}
function Fy(a,c){Gy(a,c);a.f&&0===a.A.Jb()&&(a.J.fa().fc(a.f),a.f=null);Xc(c,"change",a.wg,!1,a)}function Gy(a,c){var d=a.a,e=[];d.forEach(function(a){c===a.feature&&e.push(a)});for(var f=e.length-1;0<=f;--f)d.remove(e[f])}l.setMap=function(a){this.J.setMap(a);xy.ca.setMap.call(this,a)};l.jl=function(a){this.jf(a.element)};l.wg=function(a){this.l||(a=a.target,Fy(this,a),this.jf(a))};l.kl=function(a){Fy(this,a.element)};
l.pl=function(a,c){var d=c.V(),d={feature:a,geometry:c,ia:[d,d]};this.a.ra(c.S(),d)};l.nl=function(a,c){var d=c.V(),e,f,g;f=0;for(g=d.length;f<g;++f)e=d[f],e={feature:a,geometry:c,depth:[f],index:f,ia:[e,e]},this.a.ra(c.S(),e)};l.xg=function(a,c){var d=c.V(),e,f,g,h;e=0;for(f=d.length-1;e<f;++e)g=d.slice(e,e+2),h={feature:a,geometry:c,index:e,ia:g},this.a.ra(Md(g),h)};
l.ml=function(a,c){var d=c.V(),e,f,g,h,k,m,n;h=0;for(k=d.length;h<k;++h)for(e=d[h],f=0,g=e.length-1;f<g;++f)m=e.slice(f,f+2),n={feature:a,geometry:c,depth:[h],index:f,ia:m},this.a.ra(Md(m),n)};l.ql=function(a,c){var d=c.V(),e,f,g,h,k,m,n;h=0;for(k=d.length;h<k;++h)for(e=d[h],f=0,g=e.length-1;f<g;++f)m=e.slice(f,f+2),n={feature:a,geometry:c,depth:[h],index:f,ia:m},this.a.ra(Md(m),n)};
l.ol=function(a,c){var d=c.V(),e,f,g,h,k,m,n,p,q,r;m=0;for(n=d.length;m<n;++m)for(p=d[m],h=0,k=p.length;h<k;++h)for(e=p[h],f=0,g=e.length-1;f<g;++f)q=e.slice(f,f+2),r={feature:a,geometry:c,depth:[h,m],index:f,ia:q},this.a.ra(Md(q),r)};l.ll=function(a,c){var d,e=c.f;for(d=0;d<e.length;++d)this.$[e[d].X()].call(this,a,e[d])};function Hy(a,c){var d=a.f;d?d.W().ja(c):(d=new P(new C(c)),a.f=d,a.J.fa().Ac(d))}function Iy(a,c){return a.index-c.index}
function yy(a){Dy(this,a.pixel,a.map);this.i=[];this.C=!1;var c=this.f;if(c){var d=[],c=c.W().V(),e=Md([c]),e=Gp(this.a,e),f={};e.sort(Iy);for(var g=0,h=e.length;g<h;++g){var k=e[g],m=k.ia,n=v(k.feature),p=k.depth;p&&(n+="-"+p.join("-"));f[n]||(f[n]=Array(2));if(ud(m[0],c)&&!f[n][0])this.i.push([k,0]),f[n][0]=k;else if(ud(m[1],c)&&!f[n][1]){if("LineString"!==k.geometry.X()&&"MultiLineString"!==k.geometry.X()||!f[n][0]||0!==f[n][0].index)this.i.push([k,1]),f[n][1]=k}else v(m)in this.sa&&!f[n][0]&&
!f[n][1]&&d.push([k,c])}d.length&&Ey(this,a);for(g=d.length-1;0<=g;--g)this.fk.apply(this,d[g])}return!!this.f}
function zy(a){this.U=!1;Ey(this,a);a=a.coordinate;for(var c=0,d=this.i.length;c<d;++c){for(var e=this.i[c],f=e[0],g=f.depth,h=f.geometry,k=h.V(),m=f.ia,e=e[1];a.length<h.H;)a.push(0);switch(h.X()){case "Point":k=a;m[0]=m[1]=a;break;case "MultiPoint":k[f.index]=a;m[0]=m[1]=a;break;case "LineString":k[f.index+e]=a;m[e]=a;break;case "MultiLineString":k[g[0]][f.index+e]=a;m[e]=a;break;case "Polygon":k[g[0]][f.index+e]=a;m[e]=a;break;case "MultiPolygon":k[g[1]][g[0]][f.index+e]=a,m[e]=a}f=h;this.l=!0;
f.ja(k);this.l=!1}Hy(this,a)}function By(a){for(var c,d=this.i.length-1;0<=d;--d)c=this.i[d][0],Ep(this.a,Md(c.ia),c);this.C&&(this.s(new wy("modifyend",this.A,a)),this.C=!1);return!1}
function Ay(a){if(!(a instanceof Oj))return!0;var c;a.map.aa().c.slice()[1]||a.type!=Yj||this.v||(this.da=a.pixel,Dy(this,a.pixel,a.map));if(this.f&&this.xa(a))if(a.type==Tj&&this.U)c=!0;else{this.f.W();Ey(this,a);c=this.i;var d={},e,f,g,h,k,m,n,p,q;for(k=c.length-1;0<=k;--k)if(g=c[k],p=g[0],h=p.geometry,f=h.V(),q=v(p.feature),p.depth&&(q+="-"+p.depth.join("-")),n=e=m=void 0,0===g[1]?(e=p,m=p.index):1==g[1]&&(n=p,m=p.index+1),q in d||(d[q]=[n,e,m]),g=d[q],void 0!==n&&(g[0]=n),void 0!==e&&(g[1]=e),
void 0!==g[0]&&void 0!==g[1]){e=f;q=!1;n=m-1;switch(h.X()){case "MultiLineString":f[p.depth[0]].splice(m,1);q=!0;break;case "LineString":f.splice(m,1);q=!0;break;case "MultiPolygon":e=e[p.depth[1]];case "Polygon":e=e[p.depth[0]],4<e.length&&(m==e.length-1&&(m=0),e.splice(m,1),q=!0,0===m&&(e.pop(),e.push(e[0]),n=e.length-1))}q&&(this.a.remove(g[0]),this.a.remove(g[1]),e=h,this.l=!0,e.ja(f),this.l=!1,f={depth:p.depth,feature:p.feature,geometry:p.geometry,index:n,ia:[g[0].ia[0],g[1].ia[1]]},this.a.ra(Md(f.ia),
f),Jy(this,h,m,p.depth,-1),this.f&&(this.J.fa().fc(this.f),this.f=null))}c=!0;this.s(new wy("modifyend",this.A,a));this.C=!1}a.type==Tj&&(this.U=!1);return cl.call(this,a)&&!c}
function Dy(a,c,d){function e(a,c){return xd(f,a.ia)-xd(f,c.ia)}var f=d.ya(c),g=d.ya([c[0]-a.O,c[1]+a.O]),h=d.ya([c[0]+a.O,c[1]-a.O]),g=Md([g,h]),g=Gp(a.a,g);if(0<g.length){g.sort(e);var h=g[0].ia,k=rd(f,h),m=d.Da(k);if(Math.sqrt(wd(c,m))<=a.O){c=d.Da(h[0]);d=d.Da(h[1]);c=wd(m,c);d=wd(m,d);a.ga=Math.sqrt(Math.min(c,d))<=a.O;a.ga&&(k=c>d?h[1]:h[0]);Hy(a,k);d={};d[v(h)]=!0;c=1;for(m=g.length;c<m;++c)if(k=g[c].ia,ud(h[0],k[0])&&ud(h[1],k[1])||ud(h[0],k[1])&&ud(h[1],k[0]))d[v(k)]=!0;else break;a.sa=d;
return}}a.f&&(a.J.fa().fc(a.f),a.f=null)}
l.fk=function(a,c){for(var d=a.ia,e=a.feature,f=a.geometry,g=a.depth,h=a.index,k;c.length<f.H;)c.push(0);switch(f.X()){case "MultiLineString":k=f.V();k[g[0]].splice(h+1,0,c);break;case "Polygon":k=f.V();k[g[0]].splice(h+1,0,c);break;case "MultiPolygon":k=f.V();k[g[1]][g[0]].splice(h+1,0,c);break;case "LineString":k=f.V();k.splice(h+1,0,c);break;default:return}this.l=!0;f.ja(k);this.l=!1;k=this.a;k.remove(a);Jy(this,f,h,g,1);var m={ia:[d[0],c],feature:e,geometry:f,depth:g,index:h};k.ra(Md(m.ia),m);
this.i.push([m,1]);d={ia:[c,d[1]],feature:e,geometry:f,depth:g,index:h+1};k.ra(Md(d.ia),d);this.i.push([d,0]);this.U=!0};function Jy(a,c,d,e,f){Ip(a.a,c.S(),function(a){a.geometry===c&&(void 0===e||void 0===a.depth||pb(a.depth,e))&&a.index>d&&(a.index+=f)})}function Cy(){var a=im();return function(){return a.Point}};function Ky(a,c,d,e){uc.call(this,a);this.selected=c;this.deselected=d;this.mapBrowserEvent=e}w(Ky,uc);
function Ly(a){Pk.call(this,{handleEvent:My});a=a?a:{};this.v=a.condition?a.condition:Xk;this.l=a.addCondition?a.addCondition:qe;this.C=a.removeCondition?a.removeCondition:qe;this.O=a.toggleCondition?a.toggleCondition:Zk;this.A=a.multi?a.multi:!1;this.j=a.filter?a.filter:re;var c;if(a.layers)if(ka(a.layers))c=a.layers;else{var d=a.layers;c=function(a){return tb(d,a)}}else c=re;this.i=c;this.a={};this.f=new G({source:new U({useSpatialIndex:!1,features:a.features,wrapX:a.wrapX}),style:a.style?a.style:
Ny(),updateWhileAnimating:!0,updateWhileInteracting:!0});a=this.f.fa().c;B(a,"add",this.rl,!1,this);B(a,"remove",this.ul,!1,this)}w(Ly,Pk);l=Ly.prototype;l.sl=function(){return this.f.fa().c};l.tl=function(a){a=v(a);return this.a[a]};
function My(a){if(!this.v(a))return!0;var c=this.l(a),d=this.C(a),e=this.O(a),f=!c&&!d&&!e,g=a.map,h=this.f.fa().c,k=[],m=[],n=!1;if(f)g.Zc(a.pixel,function(a,c){if(this.j(a,c)){m.push(a);var d=v(a);this.a[d]=c;return!this.A}},this,this.i),0<m.length&&1==h.Jb()&&h.item(0)==m[0]||(n=!0,0!==h.Jb()&&(k=Array.prototype.concat(h.a),h.clear()),h.cf(m),0===m.length?Qb(this.a):0<k.length&&k.forEach(function(a){a=v(a);delete this.a[a]},this));else{g.Zc(a.pixel,function(a,f){if(!tb(h.a,a)){if((c||e)&&this.j(a,
f)){m.push(a);var g=v(a);this.a[g]=f}}else if(d||e)k.push(a),g=v(a),delete this.a[g]},this,this.i);for(f=k.length-1;0<=f;--f)h.remove(k[f]);h.cf(m);if(0<m.length||0<k.length)n=!0}n&&this.s(new Ky("select",m,k,a));return Wk(a)}l.setMap=function(a){var c=this.B,d=this.f.fa().c;null===c||d.forEach(c.vh,c);Ly.ca.setMap.call(this,a);this.f.setMap(a);null===a||d.forEach(a.sh,a)};
function Ny(){var a=im();ib(a.Polygon,a.LineString);ib(a.GeometryCollection,a.LineString);return function(c){return a[c.W().X()]}}l.rl=function(a){a=a.element;var c=this.B;null===c||c.sh(a)};l.ul=function(a){a=a.element;var c=this.B;null===c||c.vh(a)};function Oy(a){bl.call(this,{handleEvent:Py,handleDownEvent:re,handleUpEvent:Qy});a=a?a:{};this.l=a.source?a.source:null;this.i=a.features?a.features:null;this.da=[];this.C={};this.O={};this.U={};this.A={};this.J=null;this.f=void 0!==a.pixelTolerance?a.pixelTolerance:10;this.ga=qa(Ry,this);this.a=new Dp;this.$={Point:this.Al,LineString:this.Ag,LinearRing:this.Ag,Polygon:this.Bl,MultiPoint:this.yl,MultiLineString:this.xl,MultiPolygon:this.zl,GeometryCollection:this.wl}}w(Oy,bl);l=Oy.prototype;
l.dd=function(a,c){var d=void 0!==c?c:!0,e=a.W(),f=this.$[e.X()];if(f){var g=v(a);this.U[g]=e.S(Nd());f.call(this,a,e);d&&(this.O[g]=e.G("change",qa(this.Ej,this,a),this),this.C[g]=a.G(jd(a.a),this.vl,this))}};l.Bi=function(a){this.dd(a)};l.Ci=function(a){this.ed(a)};l.yg=function(a){var c;a instanceof Np?c=a.feature:a instanceof sg&&(c=a.element);this.dd(c)};l.zg=function(a){var c;a instanceof Np?c=a.feature:a instanceof sg&&(c=a.element);this.ed(c)};
l.vl=function(a){a=a.g;this.ed(a,!0);this.dd(a,!0)};l.Ej=function(a){if(this.v){var c=v(a);c in this.A||(this.A[c]=a)}else this.wh(a)};l.ed=function(a,c){var d=void 0!==c?c:!0,e=v(a),f=this.U[e];if(f){var g=this.a,h=[];Ip(g,f,function(c){a===c.feature&&h.push(c)});for(f=h.length-1;0<=f;--f)g.remove(h[f]);d&&(Yc(this.O[e]),delete this.O[e],Yc(this.C[e]),delete this.C[e])}};
l.setMap=function(a){var c=this.B,d=this.da,e;this.i?e=this.i:this.l&&(e=this.l.Bc());c&&(d.forEach(fd),d.length=0,e.forEach(this.Ci,this));Oy.ca.setMap.call(this,a);a&&(this.i?(d.push(this.i.G("add",this.yg,this)),d.push(this.i.G("remove",this.zg,this))):this.l&&(d.push(this.l.G("addfeature",this.yg,this)),d.push(this.l.G("removefeature",this.zg,this))),e.forEach(this.Bi,this))};l.kc=qe;l.wh=function(a){this.ed(a,!1);this.dd(a,!1)};
l.wl=function(a,c){var d,e=c.f;for(d=0;d<e.length;++d)this.$[e[d].X()].call(this,a,e[d])};l.Ag=function(a,c){var d=c.V(),e,f,g,h;e=0;for(f=d.length-1;e<f;++e)g=d.slice(e,e+2),h={feature:a,ia:g},this.a.ra(Md(g),h)};l.xl=function(a,c){var d=c.V(),e,f,g,h,k,m,n;h=0;for(k=d.length;h<k;++h)for(e=d[h],f=0,g=e.length-1;f<g;++f)m=e.slice(f,f+2),n={feature:a,ia:m},this.a.ra(Md(m),n)};l.yl=function(a,c){var d=c.V(),e,f,g;f=0;for(g=d.length;f<g;++f)e=d[f],e={feature:a,ia:[e,e]},this.a.ra(c.S(),e)};
l.zl=function(a,c){var d=c.V(),e,f,g,h,k,m,n,p,q,r;m=0;for(n=d.length;m<n;++m)for(p=d[m],h=0,k=p.length;h<k;++h)for(e=p[h],f=0,g=e.length-1;f<g;++f)q=e.slice(f,f+2),r={feature:a,ia:q},this.a.ra(Md(q),r)};l.Al=function(a,c){var d=c.V(),d={feature:a,ia:[d,d]};this.a.ra(c.S(),d)};l.Bl=function(a,c){var d=c.V(),e,f,g,h,k,m,n;h=0;for(k=d.length;h<k;++h)for(e=d[h],f=0,g=e.length-1;f<g;++f)m=e.slice(f,f+2),n={feature:a,ia:m},this.a.ra(Md(m),n)};
function Py(a){var c,d,e=a.pixel,f=a.coordinate;c=a.map;var g=c.ya([e[0]-this.f,e[1]+this.f]);d=c.ya([e[0]+this.f,e[1]-this.f]);var g=Md([g,d]),h=Gp(this.a,g),k=!1,g=!1,m=null;d=null;0<h.length&&(this.J=f,h.sort(this.ga),h=h[0].ia,m=rd(f,h),d=c.Da(m),Math.sqrt(wd(e,d))<=this.f&&(g=!0,e=c.Da(h[0]),f=c.Da(h[1]),e=wd(d,e),f=wd(d,f),k=Math.sqrt(Math.min(e,f))<=this.f))&&(m=e>f?h[1]:h[0],d=c.Da(m),d=[Math.round(d[0]),Math.round(d[1])]);c=m;g&&(a.coordinate=c.slice(0,2),a.pixel=d);return cl.call(this,a)}
function Qy(){var a=Kb(this.A);a.length&&(a.forEach(this.wh,this),this.A={});return!1}function Ry(a,c){return xd(this.J,a.ia)-xd(this.J,c.ia)};function Sy(a,c,d){uc.call(this,a);this.features=c;this.coordinate=d}w(Sy,uc);function Ty(a){bl.call(this,{handleDownEvent:Uy,handleDragEvent:Vy,handleMoveEvent:Wy,handleUpEvent:Xy});this.l=void 0;this.a=null;this.f=void 0!==a.features?a.features:null;this.i=null}w(Ty,bl);function Uy(a){this.i=Yy(this,a.pixel,a.map);return!this.a&&this.i?(this.a=a.coordinate,Wy.call(this,a),this.s(new Sy("translatestart",this.f,a.coordinate)),!0):!1}
function Xy(a){return this.a?(this.a=null,Wy.call(this,a),this.s(new Sy("translateend",this.f,a.coordinate)),!0):!1}function Vy(a){if(this.a){a=a.coordinate;var c=a[0]-this.a[0],d=a[1]-this.a[1];if(this.f)this.f.forEach(function(a){var e=a.W();e.yc(c,d);a.Aa(e)});else if(this.i){var e=this.i.W();e.yc(c,d);this.i.Aa(e)}this.a=a;this.s(new Sy("translating",this.f,a))}}
function Wy(a){var c=a.map.wc();if(a=a.map.Zc(a.pixel,function(a){return a})){var d=!1;this.f&&tb(this.f.a,a)&&(d=!0);this.l=c.style.cursor;c.style.cursor=this.a?"-webkit-grabbing":d?"-webkit-grab":"pointer";c.style.cursor=this.a?d?"grab":"pointer":"grabbing"}else c.style.cursor=void 0!==this.l?this.l:"",this.l=void 0}function Yy(a,c,d){var e=null;c=d.Zc(c,function(a){return a});a.f&&tb(a.f.a,c)&&(e=c);return e};function X(a){a=a?a:{};var c=Tb(a);delete c.gradient;delete c.radius;delete c.blur;delete c.shadow;delete c.weight;G.call(this,c);this.f=null;this.$=void 0!==a.shadow?a.shadow:250;this.J=void 0;this.v=null;B(this,jd("gradient"),this.Fj,!1,this);this.mh(a.gradient?a.gradient:Zy);this.ih(void 0!==a.blur?a.blur:15);this.Cg(void 0!==a.radius?a.radius:8);B(this,[jd("blur"),jd("radius")],this.hg,!1,this);this.hg();var d=a.weight?a.weight:"weight",e;ia(d)?e=function(a){return a.get(d)}:e=d;this.g(qa(function(a){a=
e(a);a=void 0!==a?Qa(a,0,1):1;var c=255*a|0,d=this.v[c];d||(d=[new dm({image:new xk({opacity:a,src:this.J})})],this.v[c]=d);return d},this));this.set("renderOrder",null);B(this,"render",this.Xj,!1,this)}w(X,G);var Zy=["#00f","#0ff","#0f0","#ff0","#f00"];l=X.prototype;l.Uf=function(){return this.get("blur")};l.Xf=function(){return this.get("gradient")};l.Bg=function(){return this.get("radius")};
l.Fj=function(){for(var a=this.Xf(),c=Qi(1,256),d=c.createLinearGradient(0,0,1,256),e=1/(a.length-1),f=0,g=a.length;f<g;++f)d.addColorStop(f*e,a[f]);c.fillStyle=d;c.fillRect(0,0,1,256);this.f=c.getImageData(0,0,1,256).data};l.hg=function(){var a=this.Bg(),c=this.Uf(),d=a+c+1,e=2*d,e=Qi(e,e);e.shadowOffsetX=e.shadowOffsetY=this.$;e.shadowBlur=c;e.shadowColor="#000";e.beginPath();c=d-this.$;e.arc(c,c,a,0,2*Math.PI,!0);e.fill();this.J=e.canvas.toDataURL();this.v=Array(256);this.u()};
l.Xj=function(a){a=a.context;var c=a.canvas,c=a.getImageData(0,0,c.width,c.height),d=c.data,e,f,g;e=0;for(f=d.length;e<f;e+=4)if(g=4*d[e+3])d[e]=this.f[g],d[e+1]=this.f[g+1],d[e+2]=this.f[g+2];a.putImageData(c,0,0)};l.ih=function(a){this.set("blur",a)};l.mh=function(a){this.set("gradient",a)};l.Cg=function(a){this.set("radius",a)};function $y(a,c){var d=c||{},e=d.document||document,f=Pg("SCRIPT"),g={hh:f,lc:void 0},h=new Ix(az,g),k=null,m=null!=d.timeout?d.timeout:5E3;0<m&&(k=window.setTimeout(function(){bz(f,!0);var c=new cz(dz,"Timeout reached for loading script "+a);Kx(h);Lx(h,!1,c)},m),g.lc=k);f.onload=f.onreadystatechange=function(){f.readyState&&"loaded"!=f.readyState&&"complete"!=f.readyState||(bz(f,d.wi||!1,k),h.Nc(null))};f.onerror=function(){bz(f,!0,k);var c=new cz(ez,"Error while loading script "+a);Kx(h);Lx(h,!1,
c)};g=d.attributes||{};Wb(g,{type:"text/javascript",charset:"UTF-8",src:a});Jg(f,g);fz(e).appendChild(f);return h}function fz(a){var c=a.getElementsByTagName("HEAD");return c&&0!=c.length?c[0]:a.documentElement}function az(){if(this&&this.hh){var a=this.hh;a&&"SCRIPT"==a.tagName&&bz(a,!0,this.lc)}}function bz(a,c,d){null!=d&&ba.clearTimeout(d);a.onload=da;a.onerror=da;a.onreadystatechange=da;c&&window.setTimeout(function(){Tg(a)},0)}var ez=0,dz=1;
function cz(a,c){var d="Jsloader error (code #"+a+")";c&&(d+=": "+c);xa.call(this,d);this.code=a}w(cz,xa);function gz(a,c){this.a=new mt(a);this.b=c?c:"callback";this.lc=5E3}var hz=0;function iz(a,c,d,e){c=c||null;var f="_"+(hz++).toString(36)+sa().toString(36);ba._callbacks_||(ba._callbacks_={});var g=a.a.clone();if(c)for(var h in c)if(!c.hasOwnProperty||c.hasOwnProperty(h)){var k=g,m=h,n=c[h];ga(n)||(n=[String(n)]);Ft(k.c,m,n)}d&&(ba._callbacks_[f]=jz(f,d),d=a.b,h="_callbacks_."+f,ga(h)||(h=[String(h)]),Ft(g.c,d,h));a=$y(g.toString(),{timeout:a.lc,wi:!0});Ox(a,null,kz(f,c,e),void 0)}
gz.prototype.cancel=function(a){a&&(a.xi&&a.xi.cancel(),a.qa&&lz(a.qa,!1))};function kz(a,c,d){return function(){lz(a,!1);d&&d(c)}}function jz(a,c){return function(d){lz(a,!0);c.apply(void 0,arguments)}}function lz(a,c){ba._callbacks_[a]&&(c?delete ba._callbacks_[a]:ba._callbacks_[a]=da)};function mz(a,c){var d=/\{z\}/g,e=/\{x\}/g,f=/\{y\}/g,g=/\{-y\}/g;return function(h){if(h)return a.replace(d,h[0].toString()).replace(e,h[1].toString()).replace(f,function(){return(-h[2]-1).toString()}).replace(g,function(){return(og(c.a?c.a[h[0]]:null)+h[2]).toString()})}}function nz(a,c){for(var d=a.length,e=Array(d),f=0;f<d;++f)e[f]=mz(a[f],c);return oz(e)}function oz(a){return 1===a.length?a[0]:function(c,d,e){if(c)return a[od((c[1]<<c[0])+c[2],a.length)](c,d,e)}}function pz(){}
function qz(a){var c=[],d=/\{(\d)-(\d)\}/.exec(a)||/\{([a-z])-([a-z])\}/.exec(a);if(d){var e=d[2].charCodeAt(0),f;for(f=d[1].charCodeAt(0);f<=e;++f)c.push(a.replace(d[0],String.fromCharCode(f)))}else c.push(a);return c};function rz(a){Ph.call(this,{attributions:a.attributions,extent:a.extent,logo:a.logo,opaque:a.opaque,projection:a.projection,state:void 0!==a.state?a.state:void 0,tileGrid:a.tileGrid,tilePixelRatio:a.tilePixelRatio,wrapX:a.wrapX});this.tileUrlFunction=void 0!==a.tileUrlFunction?a.tileUrlFunction:pz;this.crossOrigin=void 0!==a.crossOrigin?a.crossOrigin:null;this.tileLoadFunction=void 0!==a.tileLoadFunction?a.tileLoadFunction:sz;this.tileClass=void 0!==a.tileClass?a.tileClass:Dx}w(rz,Ph);
function sz(a,c){a.Ta().src=c}l=rz.prototype;l.Ub=function(a,c,d,e,f){var g=this.lb(a,c,d);if(xh(this.a,g))return this.a.get(g);a=[a,c,d];e=(c=Th(this,a,f))?this.tileUrlFunction(c,e,f):void 0;e=new this.tileClass(a,void 0!==e?0:4,void 0!==e?e:"",this.crossOrigin,this.tileLoadFunction);B(e,"change",this.em,!1,this);this.a.set(g,e);return e};l.ab=function(){return this.tileLoadFunction};l.bb=function(){return this.tileUrlFunction};
l.em=function(a){a=a.target;switch(a.state){case 1:this.s(new Uh("tileloadstart",a));break;case 2:this.s(new Uh("tileloadend",a));break;case 3:this.s(new Uh("tileloaderror",a))}};l.gb=function(a){this.a.clear();this.tileLoadFunction=a;this.u()};l.Ja=function(a){this.a.clear();this.tileUrlFunction=a;this.u()};l.Cf=function(a,c,d){a=this.lb(a,c,d);xh(this.a,a)&&this.a.get(a)};function tz(a){rz.call(this,{crossOrigin:"anonymous",opaque:!0,projection:Ce("EPSG:3857"),state:"loading",tileLoadFunction:a.tileLoadFunction,wrapX:void 0!==a.wrapX?a.wrapX:!0});this.g=void 0!==a.culture?a.culture:"en-us";this.f=void 0!==a.maxZoom?a.maxZoom:-1;var c=new mt("https://dev.virtualearth.net/REST/v1/Imagery/Metadata/"+a.imagerySet);iz(new gz(c,"jsonp"),{include:"ImageryProviders",uriScheme:"https",key:a.key},qa(this.l,this))}w(tz,rz);var uz=new rg({html:'<a class="ol-attribution-bing-tos" href="http://www.microsoft.com/maps/product/terms.html">Terms of Use</a>'});
tz.prototype.l=function(a){if(200!=a.statusCode||"OK"!=a.statusDescription||"ValidCredentials"!=a.authenticationResultCode||1!=a.resourceSets.length||1!=a.resourceSets[0].resources.length)Eh(this,"error");else{var c=a.brandLogoUri;-1==c.indexOf("https")&&(c=c.replace("http","https"));var d=a.resourceSets[0].resources[0],e=-1==this.f?d.zoomMax:this.f;a=ig(this.i);var f=Nh({extent:a,minZoom:d.zoomMin,maxZoom:e,tileSize:d.imageWidth==d.imageHeight?d.imageWidth:[d.imageWidth,d.imageHeight]});this.tileGrid=
f;var g=this.g;this.tileUrlFunction=oz(d.imageUrlSubdomains.map(function(a){var c=[0,0,0],e=d.imageUrl.replace("{subdomain}",a).replace("{culture}",g);return function(a){if(a)return cg(a[0],a[1],-a[2]-1,c),e.replace("{quadkey}",eg(c))}}));if(d.imageryProviders){var h=Ge(Ce("EPSG:4326"),this.i);a=d.imageryProviders.map(function(a){var c=a.attribution,d={};a.coverageAreas.forEach(function(a){var c=a.zoomMin,g=Math.min(a.zoomMax,e);a=a.bbox;a=oe([a[1],a[0],a[3],a[2]],h);var k,m;for(k=c;k<=g;++k)m=k.toString(),
c=kg(f,a,k),m in d?d[m].push(c):d[m]=[c]});return new rg({html:c,tileRanges:d})});a.push(uz);this.la(a)}this.U=c;Eh(this,"ready")}};function Y(a){U.call(this,{attributions:a.attributions,extent:a.extent,logo:a.logo,projection:a.projection});this.J=void 0;this.da=void 0!==a.distance?a.distance:20;this.C=[];this.v=a.source;this.v.G("change",Y.prototype.sa,this)}w(Y,U);Y.prototype.ga=function(){return this.v};Y.prototype.Yb=function(a,c,d){this.v.Yb(a,c,d);c!==this.J&&(this.clear(),this.J=c,vz(this),this.Qb(this.C))};Y.prototype.sa=function(){this.clear();vz(this);this.Qb(this.C);this.u()};
function vz(a){if(void 0!==a.J){a.C.length=0;for(var c=Nd(),d=a.da*a.J,e=a.v.Bc(),f={},g=0,h=e.length;g<h;g++){var k=e[g];Mb(f,v(k).toString())||(k=k.W().V(),Yd(k,c),Rd(c,d,c),k=a.v.Dd(c),k=k.filter(function(a){a=v(a).toString();return a in f?!1:f[a]=!0}),a.C.push(wz(k)))}}}function wz(a){for(var c=a.length,d=[0,0],e=0;e<c;e++){var f=a[e].W().V();qd(d,f)}c=1/c;d[0]*=c;d[1]*=c;d=new P(new C(d));d.set("features",a);return d};function xz(a){rn.call(this,{projection:a.projection,resolutions:a.resolutions});this.$=void 0!==a.crossOrigin?a.crossOrigin:null;this.g=void 0!==a.displayDpi?a.displayDpi:96;this.f=void 0!==a.params?a.params:{};var c;void 0!==a.url?c=Fx(a.url,this.f,qa(this.Ll,this)):c=Gx;this.J=c;this.a=void 0!==a.imageLoadFunction?a.imageLoadFunction:xn;this.da=void 0!==a.hidpi?a.hidpi:!0;this.Y=void 0!==a.metersPerUnit?a.metersPerUnit:1;this.v=void 0!==a.ratio?a.ratio:1;this.ga=void 0!==a.useOverlay?a.useOverlay:
!1;this.c=null;this.C=0}w(xz,rn);l=xz.prototype;l.Kl=function(){return this.f};l.ec=function(a,c,d,e){c=sn(this,c);d=this.da?d:1;var f=this.c;if(f&&this.C==this.b&&f.ba()==c&&f.g==d&&Wd(f.S(),a))return f;1!=this.v&&(a=a.slice(),ne(a,this.v));e=this.J(a,[le(a)/c*d,ie(a)/c*d],e);void 0!==e?(f=new Cx(a,c,d,this.j,e,this.$,this.a),B(f,"change",this.l,!1,this)):f=null;this.c=f;this.C=this.b;return f};l.Jl=function(){return this.a};l.Nl=function(a){Wb(this.f,a);this.u()};
l.Ll=function(a,c,d,e){var f=ge(d),g=this.Y,h=le(d);d=ie(d);var k=e[0],m=e[1],n=.0254/this.g;e={OPERATION:this.ga?"GETDYNAMICMAPOVERLAYIMAGE":"GETMAPIMAGE",VERSION:"2.0.0",LOCALE:"en",CLIENTAGENT:"ol.source.ImageMapGuide source",CLIP:"1",SETDISPLAYDPI:this.g,SETDISPLAYWIDTH:Math.round(e[0]),SETDISPLAYHEIGHT:Math.round(e[1]),SETVIEWSCALE:m*h>k*d?h*g/(k*n):d*g/(m*n),SETVIEWCENTERX:f[0],SETVIEWCENTERY:f[1]};Wb(e,c);return ro(to([a],e))};l.Ml=function(a){this.c=null;this.a=a;this.u()};function yz(a){var c=void 0!==a.attributions?a.attributions:null,d=a.imageExtent,e,f;void 0!==a.imageSize&&(e=ie(d)/a.imageSize[1],f=[e]);var g=void 0!==a.crossOrigin?a.crossOrigin:null,h=void 0!==a.imageLoadFunction?a.imageLoadFunction:xn;rn.call(this,{attributions:c,logo:a.logo,projection:Ce(a.projection),resolutions:f});this.a=new Cx(d,e,1,c,a.url,g,h);B(this.a,"change",this.l,!1,this)}w(yz,rn);yz.prototype.ec=function(a){return ke(a,this.a.S())?this.a:null};function zz(a){a=a||{};rn.call(this,{attributions:a.attributions,logo:a.logo,projection:a.projection,resolutions:a.resolutions});this.da=void 0!==a.crossOrigin?a.crossOrigin:null;this.f=a.url;this.v=void 0!==a.imageLoadFunction?a.imageLoadFunction:xn;this.c=a.params;this.g=!0;Az(this);this.$=a.serverType;this.ga=void 0!==a.hidpi?a.hidpi:!0;this.a=null;this.C=[0,0];this.Y=0;this.J=void 0!==a.ratio?a.ratio:1.5}w(zz,rn);var Bz=[101,101];l=zz.prototype;
l.Tl=function(a,c,d,e){if(void 0!==this.f){var f=he(a,c,0,Bz),g={SERVICE:"WMS",VERSION:"1.3.0",REQUEST:"GetFeatureInfo",FORMAT:"image/png",TRANSPARENT:!0,QUERY_LAYERS:this.c.LAYERS};Wb(g,this.c,e);e=Math.floor((f[3]-a[1])/c);g[this.g?"I":"X"]=Math.floor((a[0]-f[0])/c);g[this.g?"J":"Y"]=e;return Cz(this,f,Bz,1,Ce(d),g)}};l.Vl=function(){return this.c};
l.ec=function(a,c,d,e){if(void 0===this.f)return null;c=sn(this,c);1==d||this.ga&&void 0!==this.$||(d=1);a=a.slice();var f=(a[0]+a[2])/2,g=(a[1]+a[3])/2;if(1!=this.J){var h=this.J*le(a)/2,k=this.J*ie(a)/2;a[0]=f-h;a[1]=g-k;a[2]=f+h;a[3]=g+k}var m=c/d,h=Math.ceil(le(a)/m),k=Math.ceil(ie(a)/m);a[0]=f-m*h/2;a[2]=f+m*h/2;a[1]=g-m*k/2;a[3]=g+m*k/2;if((f=this.a)&&this.Y==this.b&&f.ba()==c&&f.g==d&&Wd(f.S(),a))return f;f={SERVICE:"WMS",VERSION:"1.3.0",REQUEST:"GetMap",FORMAT:"image/png",TRANSPARENT:!0};
Wb(f,this.c);this.C[0]=h;this.C[1]=k;e=Cz(this,a,this.C,d,e,f);this.a=new Cx(a,c,d,this.j,e,this.da,this.v);this.Y=this.b;B(this.a,"change",this.l,!1,this);return this.a};l.Ul=function(){return this.v};
function Cz(a,c,d,e,f,g){g[a.g?"CRS":"SRS"]=f.b;"STYLES"in a.c||(g.STYLES=new String(""));if(1!=e)switch(a.$){case "geoserver":e=90*e+.5|0;g.FORMAT_OPTIONS="FORMAT_OPTIONS"in g?g.FORMAT_OPTIONS+(";dpi:"+e):"dpi:"+e;break;case "mapserver":g.MAP_RESOLUTION=90*e;break;case "carmentaserver":case "qgis":g.DPI=90*e}g.WIDTH=d[0];g.HEIGHT=d[1];d=f.g;var h;a.g&&"ne"==d.substr(0,2)?h=[c[1],c[0],c[3],c[2]]:h=c;g.BBOX=h.join(",");return ro(to([a.f],g))}l.Wl=function(){return this.f};
l.Xl=function(a){this.a=null;this.v=a;this.u()};l.Yl=function(a){a!=this.f&&(this.f=a,this.a=null,this.u())};l.Zl=function(a){Wb(this.c,a);Az(this);this.a=null;this.u()};function Az(a){a.g=0<=Na(Rb(a.c,"VERSION","1.3.0"),"1.3")};function Dz(a){var c=void 0!==a.projection?a.projection:"EPSG:3857",d=void 0!==a.tileGrid?a.tileGrid:Nh({extent:ig(c),maxZoom:a.maxZoom,tileSize:a.tileSize});this.l=null;rz.call(this,{attributions:a.attributions,crossOrigin:a.crossOrigin,logo:a.logo,projection:c,tileGrid:d,tileLoadFunction:a.tileLoadFunction,tilePixelRatio:a.tilePixelRatio,tileUrlFunction:pz,wrapX:void 0!==a.wrapX?a.wrapX:!0});void 0!==a.tileUrlFunction?this.Ja(a.tileUrlFunction):void 0!==a.urls?(a=a.urls,this.Ja(nz(a,this.tileGrid)),
this.l=a):void 0!==a.url&&this.f(a.url)}w(Dz,rz);Dz.prototype.g=function(){return this.l};Dz.prototype.f=function(a){this.Ja(nz(qz(a),this.tileGrid));this.l=[a]};function Ez(a){a=a||{};var c;void 0!==a.attributions?c=a.attributions:c=[Fz];Dz.call(this,{attributions:c,crossOrigin:void 0!==a.crossOrigin?a.crossOrigin:"anonymous",opaque:!0,maxZoom:void 0!==a.maxZoom?a.maxZoom:19,tileLoadFunction:a.tileLoadFunction,url:void 0!==a.url?a.url:"https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png",wrapX:a.wrapX})}w(Ez,Dz);var Fz=new rg({html:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors.'});function Gz(a){a=a||{};var c=Hz[a.layer];this.B=a.layer;Dz.call(this,{attributions:c.attributions,crossOrigin:"anonymous",logo:"https://developer.mapquest.com/content/osm/mq_logo.png",maxZoom:c.maxZoom,opaque:!0,tileLoadFunction:a.tileLoadFunction,url:void 0!==a.url?a.url:"https://otile{1-4}-s.mqcdn.com/tiles/1.0.0/"+this.B+"/{z}/{x}/{y}.jpg"})}w(Gz,Dz);
var Iz=new rg({html:'Tiles Courtesy of <a href="http://www.mapquest.com/">MapQuest</a>'}),Hz={osm:{maxZoom:19,attributions:[Iz,Fz]},sat:{maxZoom:18,attributions:[Iz,new rg({html:"Portions Courtesy NASA/JPL-Caltech and U.S. Depart. of Agriculture, Farm Service Agency"})]},hyb:{maxZoom:18,attributions:[Iz,Fz]}};Gz.prototype.v=function(){return this.B};(function(){var a={},c={kb:a};(function(d){if("object"===typeof a&&"undefined"!==typeof c)c.kb=d();else{var e;"undefined"!==typeof window?e=window:"undefined"!==typeof global?e=global:"undefined"!==typeof self?e=self:e=this;e.Io=d()}})(function(){return function e(a,c,h){function k(n,q){if(!c[n]){if(!a[n]){var r="function"==typeof require&&require;if(!q&&r)return r(n,!0);if(m)return m(n,!0);r=Error("Cannot find module '"+n+"'");throw r.code="MODULE_NOT_FOUND",r;}r=c[n]={kb:{}};a[n][0].call(r.kb,function(c){var e=
a[n][1][c];return k(e?e:c)},r,r.kb,e,a,c,h)}return c[n].kb}for(var m="function"==typeof require&&require,n=0;n<h.length;n++)k(h[n]);return k}({1:[function(a,c,g){a=a("./processor");g.Wh=a},{"./processor":2}],2:[function(a,c){function g(a){return function(c){var e=c.buffers,f=c.meta,g=c.width,h=c.height,k=e.length,m=e[0].byteLength,z;if(c.imageOps){m=Array(k);for(z=0;z<k;++z)m[z]=new ImageData(new Uint8ClampedArray(e[z]),g,h);g=a(m,f).data}else{g=new Uint8ClampedArray(m);h=Array(k);c=Array(k);for(z=
0;z<k;++z)h[z]=new Uint8ClampedArray(e[z]),c[z]=[0,0,0,0];for(e=0;e<m;e+=4){for(z=0;z<k;++z){var x=h[z];c[z][0]=x[e];c[z][1]=x[e+1];c[z][2]=x[e+2];c[z][3]=x[e+3]}z=a(c,f);g[e]=z[0];g[e+1]=z[1];g[e+2]=z[2];g[e+3]=z[3]}}return g.buffer}}function h(a,c){var e=Object.keys(a.lib||{}).map(function(c){return"var "+c+" = "+a.lib[c].toString()+";"}).concat(["var __minion__ = ("+g.toString()+")(",a.operation.toString(),");",'self.addEventListener("message", function(__event__) {',"var buffer = __minion__(__event__.data);",
"self.postMessage({buffer: buffer, meta: __event__.data.meta}, [buffer]);","});"]),e=URL.createObjectURL(new Blob(e,{type:"text/javascript"})),e=new Worker(e);e.addEventListener("message",c);return e}function k(a,c){var e=g(a.operation);return{postMessage:function(a){setTimeout(function(){c({data:{buffer:e(a),Wd:a.Wd}})},0)}}}function m(a){this.Ee=!!a.dk;var c;0===a.threads?c=0:this.Ee?c=1:c=a.threads||1;var e=[];if(c)for(var f=0;f<c;++f)e[f]=h(a,this.Mf.bind(this,f));else e[0]=k(a,this.Mf.bind(this,
0));this.ud=e;this.Lc=[];this.hi=a.pn||Infinity;this.td=0;this.pc={};this.Fe=null}m.prototype.nn=function(a,c,e){this.fi({Xb:a,Wd:c,Nc:e});this.Jf()};m.prototype.fi=function(a){for(this.Lc.push(a);this.Lc.length>this.hi;)this.Lc.shift().Nc(null,null)};m.prototype.Jf=function(){if(0===this.td&&0<this.Lc.length){var a=this.Fe=this.Lc.shift(),c=a.Xb[0].width,e=a.Xb[0].height,f=a.Xb.map(function(a){return a.data.buffer}),g=this.ud.length;this.td=g;if(1===g)this.ud[0].postMessage({buffers:f,meta:a.Wd,
imageOps:this.Ee,width:c,height:e},f);else for(var h=4*Math.ceil(a.Xb[0].data.length/4/g),k=0;k<g;++k){for(var m=k*h,z=[],x=0,K=f.length;x<K;++x)z.push(f[k].slice(m,m+h));this.ud[k].postMessage({buffers:z,meta:a.Wd,imageOps:this.Ee,width:c,height:e},z)}}};m.prototype.Mf=function(a,c){this.Go||(this.pc[a]=c.data,--this.td,0===this.td&&this.ii())};m.prototype.ii=function(){var a=this.Fe,c=this.ud.length,e,f;if(1===c)e=new Uint8ClampedArray(this.pc[0].buffer),f=this.pc[0].meta;else{var g=a.Xb[0].data.length;
e=new Uint8ClampedArray(g);f=Array(g);for(var g=4*Math.ceil(g/4/c),h=0;h<c;++h){var k=h*g;e.set(new Uint8ClampedArray(this.pc[h].buffer),k);f[h]=this.pc[h].meta}}this.Fe=null;this.pc={};a.Nc(null,new ImageData(e,a.Xb[0].width,a.Xb[0].height),f);this.Jf()};c.kb=m},{}]},{},[1])(1)});Cp=c.kb})();function Jz(a){this.C=null;this.ga=void 0!==a.operationType?a.operationType:"pixel";this.sa=void 0!==a.threads?a.threads:1;this.a=Kz(a.sources);for(var c=0,d=this.a.length;c<d;++c)B(this.a[c],"change",this.u,!1,this);this.c=Qi();this.$=new Lk(function(){return 1},qa(this.u,this));for(var c=Lz(this.a),d={},e=0,f=c.length;e<f;++e)d[v(c[e].layer)]=c[e];this.f=this.g=null;this.Y={animate:!1,attributions:{},coordinateToPixelMatrix:Cd(),extent:null,focus:null,index:0,layerStates:d,layerStatesArray:c,logos:{},
pixelRatio:1,pixelToCoordinateMatrix:Cd(),postRenderFunctions:[],size:[0,0],skippedFeatureUids:{},tileQueue:this.$,time:Date.now(),usedTiles:{},viewState:{rotation:0},viewHints:[],wantedTiles:{}};rn.call(this,{});void 0!==a.operation&&this.v(a.operation,a.lib)}w(Jz,rn);Jz.prototype.v=function(a,c){this.C=new Cp.Wh({operation:a,dk:"image"===this.ga,pn:1,lib:c,threads:this.sa});this.u()};function Mz(a,c,d){var e=a.g;return!e||a.b!==e.Pn||d!==e.resolution||!Zd(c,e.extent)}
Jz.prototype.ec=function(a,c,d,e){d=!0;for(var f,g=0,h=this.a.length;g<h;++g)if(f=this.a[g].a.fa(),"ready"!==f.A){d=!1;break}if(!d)return null;if(!Mz(this,a,c))return this.f;d=this.c.canvas;f=Math.round(le(a)/c);g=Math.round(ie(a)/c);if(f!==d.width||g!==d.height)d.width=f,d.height=g;f=Tb(this.Y);f.viewState=Tb(f.viewState);var g=ge(a),h=Math.round(le(a)/c),k=Math.round(ie(a)/c);f.extent=a;f.focus=ge(a);f.size[0]=h;f.size[1]=k;h=f.viewState;h.center=g;h.projection=e;h.resolution=c;this.f=e=new qn(a,
c,1,this.j,d,this.J.bind(this,f));this.g={extent:a,resolution:c,Pn:this.b};return e};
Jz.prototype.J=function(a,c){for(var d=this.a.length,e=Array(d),f=0;f<d;++f){var g;var h=this.a[f],k=a;h.de(k,a.layerStatesArray[f]);if(g=h.fd()){var h=h.We(),m=Math.round(h[12]),n=Math.round(h[13]),p=k.size[0],k=k.size[1];if(g instanceof Image){if(Nz){var q=Nz.canvas;q.width!==p||q.height!==k?Nz=Qi(p,k):Nz.clearRect(0,0,p,k)}else Nz=Qi(p,k);Nz.drawImage(g,m,n,Math.round(g.width*h[0]),Math.round(g.height*h[5]));g=Nz.getImageData(0,0,p,k)}else g=g.getContext("2d").getImageData(-m,-n,p,k)}else g=null;
if(g)e[f]=g;else return}d={};this.s(new Oz(Pz,a,d));this.C.nn(e,d,this.da.bind(this,a,c));Mk(a.tileQueue,16,16)};Jz.prototype.da=function(a,c,d,e,f){d?c(d):e&&(this.s(new Oz(Qz,a,f)),Mz(this,a.extent,a.viewState.resolution/a.pixelRatio)||this.c.putImageData(e,0,0),c(null))};var Nz=null;function Lz(a){return a.map(function(a){return ck(a.a)})}
function Kz(a){for(var c=a.length,d=Array(c),e=0;e<c;++e){var f=e,g=a[e],h=null;g instanceof Ph?(g=new E({source:g}),h=new Tp(g)):g instanceof rn&&(g=new Tl({source:g}),h=new Sp(g));d[f]=h}return d}function Oz(a,c,d){uc.call(this,a);this.extent=c.extent;this.resolution=c.viewState.resolution/c.pixelRatio;this.data=d}w(Oz,uc);var Pz="beforeoperations",Qz="afteroperations";var Rz={terrain:{Za:"jpg",opaque:!0},"terrain-background":{Za:"jpg",opaque:!0},"terrain-labels":{Za:"png",opaque:!1},"terrain-lines":{Za:"png",opaque:!1},"toner-background":{Za:"png",opaque:!0},toner:{Za:"png",opaque:!0},"toner-hybrid":{Za:"png",opaque:!1},"toner-labels":{Za:"png",opaque:!1},"toner-lines":{Za:"png",opaque:!1},"toner-lite":{Za:"png",opaque:!0},watercolor:{Za:"jpg",opaque:!0}},Sz={terrain:{minZoom:4,maxZoom:18},toner:{minZoom:0,maxZoom:20},watercolor:{minZoom:3,maxZoom:16}};
function Tz(a){var c=a.layer.indexOf("-"),d=Rz[a.layer];Dz.call(this,{attributions:Uz,crossOrigin:"anonymous",maxZoom:Sz[-1==c?a.layer:a.layer.slice(0,c)].maxZoom,opaque:d.opaque,tileLoadFunction:a.tileLoadFunction,url:void 0!==a.url?a.url:"https://stamen-tiles-{a-d}.a.ssl.fastly.net/"+a.layer+"/{z}/{x}/{y}."+d.Za})}w(Tz,Dz);var Uz=[new rg({html:'Map tiles by <a href="http://stamen.com/">Stamen Design</a>, under <a href="http://creativecommons.org/licenses/by/3.0/">CC BY 3.0</a>.'}),Fz];function Vz(a){a=a||{};var c=void 0!==a.params?a.params:{};rz.call(this,{attributions:a.attributions,crossOrigin:a.crossOrigin,logo:a.logo,projection:a.projection,tileGrid:a.tileGrid,tileLoadFunction:a.tileLoadFunction,tileUrlFunction:qa(this.cm,this),wrapX:void 0!==a.wrapX?a.wrapX:!0});var d=a.urls;void 0===d&&void 0!==a.url&&(d=qz(a.url));this.g=d||[];this.f=c;this.l=Nd()}w(Vz,rz);l=Vz.prototype;l.$l=function(){return this.f};
l.Vb=function(a,c,d){a=Vz.ca.Vb.call(this,a,c,d);return 1==c?a:md(a,c,this.c)};l.am=function(){return this.g};l.bm=function(a){a=void 0!==a?qz(a):null;this.Hg(a)};l.Hg=function(a){this.g=a||[];this.u()};
l.cm=function(a,c,d){var e=this.tileGrid;e||(e=Sh(this,d));if(!(e.b.length<=a[0])){var f=e.Ea(a,this.l),g=nd(e.La(a[0]),this.c);1!=c&&(g=md(g,c,this.c));e={F:"image",FORMAT:"PNG32",TRANSPARENT:!0};Wb(e,this.f);var h=this.g;0!==h.length?(d=d.b.split(":").pop(),e.SIZE=g[0]+","+g[1],e.BBOX=f.join(","),e.BBOXSR=d,e.IMAGESR=d,e.DPI=Math.round(90*c),a=1==h.length?h[0]:h[od((a[1]<<a[0])+a[2],h.length)],za(a,"/")||(a+="/"),za(a,"MapServer/")?a+="export":za(a,"ImageServer/")&&(a+="exportImage"),a=ro(to([a],
e))):a=void 0;return a}};l.dm=function(a){Wb(this.f,a);this.u()};function Wz(a,c,d){Ah.call(this,a,2);this.f=c;this.c=d;this.a={}}w(Wz,Ah);Wz.prototype.Ta=function(a){a=void 0!==a?v(a):-1;if(a in this.a)return this.a[a];var c=this.f,d=Qi(c[0],c[1]);d.strokeStyle="black";d.strokeRect(.5,.5,c[0]+.5,c[1]+.5);d.fillStyle="black";d.textAlign="center";d.textBaseline="middle";d.font="24px sans-serif";d.fillText(this.c,c[0]/2,c[1]/2);return this.a[a]=d.canvas};
function Xz(a){Ph.call(this,{opaque:!1,projection:a.projection,tileGrid:a.tileGrid,wrapX:void 0!==a.wrapX?a.wrapX:!0})}w(Xz,Ph);Xz.prototype.Ub=function(a,c,d){var e=this.lb(a,c,d);if(xh(this.a,e))return this.a.get(e);var f=nd(this.tileGrid.La(a));a=[a,c,d];c=(c=Th(this,a))?fg(Th(this,c)):"";f=new Wz(a,f,c);this.a.set(e,f);return f};function Yz(a){rz.call(this,{attributions:a.attributions,crossOrigin:a.crossOrigin,projection:Ce("EPSG:3857"),state:"loading",tileLoadFunction:a.tileLoadFunction,wrapX:void 0!==a.wrapX?a.wrapX:!0});iz(new gz(a.url),void 0,qa(this.g,this),qa(this.f,this))}w(Yz,rz);
Yz.prototype.g=function(a){var c=Ce("EPSG:4326"),d=this.i,e;void 0!==a.bounds&&(e=oe(a.bounds,Ge(c,d)));var f=a.minzoom||0,g=a.maxzoom||22;this.tileGrid=d=Nh({extent:ig(d),maxZoom:g,minZoom:f});this.tileUrlFunction=nz(a.tiles,d);if(void 0!==a.attribution&&!this.j){c=void 0!==e?e:c.S();e={};for(var h;f<=g;++f)h=f.toString(),e[h]=[kg(d,c,f)];this.la([new rg({html:a.attribution,tileRanges:e})])}Eh(this,"ready")};Yz.prototype.f=function(){Eh(this,"error")};function Zz(a){Ph.call(this,{projection:Ce("EPSG:3857"),state:"loading"});this.l=void 0!==a.preemptive?a.preemptive:!0;this.f=pz;this.g=void 0;iz(new gz(a.url),void 0,qa(this.gm,this))}w(Zz,Ph);l=Zz.prototype;l.pj=function(){return this.g};l.Ai=function(a,c,d,e,f){this.tileGrid?(c=this.tileGrid.ad(a,c),$z(this.Ub(c[0],c[1],c[2],1,this.i),a,d,e,f)):!0===f?oi(function(){d.call(e,null)}):d.call(e,null)};
l.gm=function(a){var c=Ce("EPSG:4326"),d=this.i,e;void 0!==a.bounds&&(e=oe(a.bounds,Ge(c,d)));var f=a.minzoom||0,g=a.maxzoom||22;this.tileGrid=d=Nh({extent:ig(d),maxZoom:g,minZoom:f});this.g=a.template;var h=a.grids;if(h){this.f=nz(h,d);if(void 0!==a.attribution){c=void 0!==e?e:c.S();for(e={};f<=g;++f)h=f.toString(),e[h]=[kg(d,c,f)];this.la([new rg({html:a.attribution,tileRanges:e})])}Eh(this,"ready")}else Eh(this,"error")};
l.Ub=function(a,c,d,e,f){var g=this.lb(a,c,d);if(xh(this.a,g))return this.a.get(g);a=[a,c,d];c=Th(this,a,f);e=this.f(c,e,f);e=new aA(a,void 0!==e?0:4,void 0!==e?e:"",this.tileGrid.Ea(a),this.l);this.a.set(g,e);return e};l.Cf=function(a,c,d){a=this.lb(a,c,d);xh(this.a,a)&&this.a.get(a)};function aA(a,c,d,e,f){Ah.call(this,a,c);this.i=d;this.a=e;this.l=f;this.g=this.f=this.c=null}w(aA,Ah);l=aA.prototype;l.Ta=function(){return null};
function bA(a,c){if(!a.c||!a.f||!a.g)return null;var d=a.c[Math.floor((1-(c[1]-a.a[1])/(a.a[3]-a.a[1]))*a.c.length)];if(!ia(d))return null;d=d.charCodeAt(Math.floor((c[0]-a.a[0])/(a.a[2]-a.a[0])*d.length));93<=d&&d--;35<=d&&d--;d-=32;return d in a.f?a.g[a.f[d]]:null}function $z(a,c,d,e,f){0==a.state&&!0===f?(Wc(a,"change",function(){d.call(e,bA(this,c))},!1,a),cA(a)):!0===f?oi(function(){d.call(e,bA(this,c))},a):d.call(e,bA(a,c))}l.nb=function(){return this.i};l.Dj=function(){this.state=3;Bh(this)};
l.fm=function(a){this.c=a.grid;this.f=a.keys;this.g=a.data;this.state=4;Bh(this)};function cA(a){0==a.state&&(a.state=1,iz(new gz(a.i),void 0,qa(a.fm,a),qa(a.Dj,a)))}l.load=function(){this.l&&cA(this)};function Z(a){U.call(this,{attributions:a.attributions,logo:a.logo,projection:void 0,state:"ready",wrapX:a.wrapX});this.ga=void 0!==a.format?a.format:null;this.v=a.tileGrid;this.J=pz;this.da=void 0!==a.tileLoadFunction?a.tileLoadFunction:null;this.C={};void 0!==a.tileUrlFunction?(this.J=a.tileUrlFunction,this.u()):void 0!==a.urls?(this.J=nz(a.urls,this.v),this.u()):void 0!==a.url&&(this.J=nz(qz(a.url),this.v),this.u())}w(Z,U);l=Z.prototype;l.clear=function(){Qb(this.C)};
function dA(a,c,d,e){var f=a.C;a=a.v.ad(c,d);f=f[a[0]+"/"+a[1]+"/"+a[2]];if(void 0!==f)for(a=0,d=f.length;a<d;++a){var g=f[a];if(g.W().Le(c)&&e.call(void 0,g))break}}l.Cb=function(a,c,d,e){var f=this.v,g=this.C;c=Mh(f,c);a=kg(f,a,c);for(var h,f=a.b;f<=a.f;++f)for(h=a.a;h<=a.c;++h){var k=g[c+"/"+f+"/"+h];if(void 0!==k){var m,n;m=0;for(n=k.length;m<n;++m){var p=d.call(e,k[m]);if(p)return p}}}};l.Bc=function(){var a=this.C,c=[],d;for(d in a)ib(c,a[d]);return c};
l.Oi=function(a,c){var d=[];dA(this,a,c,function(a){d.push(a)});return d};function eA(a,c,d){var e=a.v;a.O&&d.f&&(c=gg(c,e,d));return jg(c,e)?c:null}l.Yb=function(a,c,d){function e(a,c){h[a]=c;this.u()}var f=this.v,g=this.J,h=this.C,k=Mh(f,c),f=kg(f,a,k),m=[k,0,0],n,p;for(n=f.b;n<=f.f;++n)for(p=f.a;p<=f.c;++p){var q=k+"/"+n+"/"+p;if(!(q in h)){m[1]=n;m[2]=p;var r=eA(this,m,d),r=r?g(r,1,d):void 0;void 0!==r&&(h[q]=[],q=ra(e,q),this.da?this.da(r,qa(q,this)):yp(r,this.ga,q).call(this,a,c,d))}}};function fA(a){a=a||{};var c=void 0!==a.params?a.params:{};rz.call(this,{attributions:a.attributions,crossOrigin:a.crossOrigin,logo:a.logo,opaque:!Rb(c,"TRANSPARENT",!0),projection:a.projection,tileGrid:a.tileGrid,tileLoadFunction:a.tileLoadFunction,tileUrlFunction:qa(this.lm,this),wrapX:void 0!==a.wrapX?a.wrapX:!0});var d=a.urls;void 0===d&&void 0!==a.url&&(d=qz(a.url));this.g=d||[];this.B=void 0!==a.gutter?a.gutter:0;this.f=c;this.l=!0;this.v=a.serverType;this.J=void 0!==a.hidpi?a.hidpi:!0;this.C=
"";gA(this);this.Y=Nd();hA(this)}w(fA,rz);l=fA.prototype;
l.hm=function(a,c,d,e){d=Ce(d);var f=this.tileGrid;f||(f=Sh(this,d));c=f.ad(a,c);if(!(f.b.length<=c[0])){var g=f.ba(c[0]),h=f.Ea(c,this.Y),f=nd(f.La(c[0]),this.c),k=this.B;0!==k&&(f=ld(f,k,this.c),h=Rd(h,g*k,h));k={SERVICE:"WMS",VERSION:"1.3.0",REQUEST:"GetFeatureInfo",FORMAT:"image/png",TRANSPARENT:!0,QUERY_LAYERS:this.f.LAYERS};Wb(k,this.f,e);e=Math.floor((h[3]-a[1])/g);k[this.l?"I":"X"]=Math.floor((a[0]-h[0])/g);k[this.l?"J":"Y"]=e;return iA(this,c,f,h,1,d,k)}};l.Ed=function(){return this.B};
l.lb=function(a,c,d){return this.C+fA.ca.lb.call(this,a,c,d)};l.im=function(){return this.f};
function iA(a,c,d,e,f,g,h){var k=a.g;if(0!==k.length){h.WIDTH=d[0];h.HEIGHT=d[1];h[a.l?"CRS":"SRS"]=g.b;"STYLES"in a.f||(h.STYLES=new String(""));if(1!=f)switch(a.v){case "geoserver":d=90*f+.5|0;h.FORMAT_OPTIONS="FORMAT_OPTIONS"in h?h.FORMAT_OPTIONS+(";dpi:"+d):"dpi:"+d;break;case "mapserver":h.MAP_RESOLUTION=90*f;break;case "carmentaserver":case "qgis":h.DPI=90*f}g=g.g;a.l&&"ne"==g.substr(0,2)&&(a=e[0],e[0]=e[1],e[1]=a,a=e[2],e[2]=e[3],e[3]=a);h.BBOX=e.join(",");return ro(to([1==k.length?k[0]:k[od((c[1]<<
c[0])+c[2],k.length)]],h))}}l.Vb=function(a,c,d){a=fA.ca.Vb.call(this,a,c,d);return 1!=c&&this.J&&void 0!==this.v?md(a,c,this.c):a};l.jm=function(){return this.g};function gA(a){var c=0,d=[],e,f;e=0;for(f=a.g.length;e<f;++e)d[c++]=a.g[e];for(var g in a.f)d[c++]=g+"-"+a.f[g];a.C=d.join("#")}l.km=function(a){a=void 0!==a?qz(a):null;this.Ig(a)};l.Ig=function(a){this.g=a||[];gA(this);this.u()};
l.lm=function(a,c,d){var e=this.tileGrid;e||(e=Sh(this,d));if(!(e.b.length<=a[0])){1==c||this.J&&void 0!==this.v||(c=1);var f=e.ba(a[0]),g=e.Ea(a,this.Y),e=nd(e.La(a[0]),this.c),h=this.B;0!==h&&(e=ld(e,h,this.c),g=Rd(g,f*h,g));1!=c&&(e=md(e,c,this.c));f={SERVICE:"WMS",VERSION:"1.3.0",REQUEST:"GetMap",FORMAT:"image/png",TRANSPARENT:!0};Wb(f,this.f);return iA(this,a,e,g,c,d,f)}};l.mm=function(a){Wb(this.f,a);gA(this);hA(this);this.u()};function hA(a){a.l=0<=Na(Rb(a.f,"VERSION","1.3.0"),"1.3")};function jA(a){this.i=a.matrixIds;Fh.call(this,{extent:a.extent,origin:a.origin,origins:a.origins,resolutions:a.resolutions,tileSize:a.tileSize,tileSizes:a.tileSizes,sizes:a.sizes})}w(jA,Fh);jA.prototype.D=function(){return this.i};
function kA(a,c){var d=[],e=[],f=[],g=[],h=[],k;k=Ce(a.SupportedCRS.replace(/urn:ogc:def:crs:(\w+):(.*:)?(\w+)$/,"$1:$3"));var m=k.Hd(),n="ne"==k.g.substr(0,2);lb(a.TileMatrix,function(a,c){return c.ScaleDenominator-a.ScaleDenominator});a.TileMatrix.forEach(function(a){e.push(a.Identifier);var c=2.8E-4*a.ScaleDenominator/m,k=a.TileWidth,u=a.TileHeight;n?f.push([a.TopLeftCorner[1],a.TopLeftCorner[0]]):f.push(a.TopLeftCorner);d.push(c);g.push(k==u?k:[k,u]);h.push([a.MatrixWidth,-a.MatrixHeight])});
return new jA({extent:c,origins:f,resolutions:d,matrixIds:e,tileSizes:g,sizes:h})};function lA(a){function c(a){a="KVP"==e?ro(to([a],g)):a.replace(/\{(\w+?)\}/g,function(a,c){return c.toLowerCase()in g?g[c.toLowerCase()]:a});return function(c){if(c){var d={TileMatrix:f.i[c[0]],TileCol:c[1],TileRow:-c[2]-1};Wb(d,h);c=a;return c="KVP"==e?ro(to([c],d)):c.replace(/\{(\w+?)\}/g,function(a,c){return d[c]})}}}this.Y=void 0!==a.version?a.version:"1.0.0";this.v=void 0!==a.format?a.format:"image/jpeg";this.f=void 0!==a.dimensions?a.dimensions:{};this.B="";mA(this);this.C=a.layer;this.l=a.matrixSet;
this.J=a.style;var d=a.urls;void 0===d&&void 0!==a.url&&(d=qz(a.url));this.g=d||[];var e=this.$=void 0!==a.requestEncoding?a.requestEncoding:"KVP",f=a.tileGrid,g={layer:this.C,style:this.J,tilematrixset:this.l};"KVP"==e&&Wb(g,{Service:"WMTS",Request:"GetTile",Version:this.Y,Format:this.v});var h=this.f,d=0<this.g.length?oz(this.g.map(c)):pz;rz.call(this,{attributions:a.attributions,crossOrigin:a.crossOrigin,logo:a.logo,projection:a.projection,tileClass:a.tileClass,tileGrid:f,tileLoadFunction:a.tileLoadFunction,
tilePixelRatio:a.tilePixelRatio,tileUrlFunction:d,wrapX:void 0!==a.wrapX?a.wrapX:!1})}w(lA,rz);l=lA.prototype;l.Mi=function(){return this.f};l.Qi=function(){return this.v};l.lb=function(a,c,d){return this.B+lA.ca.lb.call(this,a,c,d)};l.nm=function(){return this.C};l.aj=function(){return this.l};l.nj=function(){return this.$};l.om=function(){return this.J};l.pm=function(){return this.g};l.tj=function(){return this.Y};function mA(a){var c=0,d=[],e;for(e in a.f)d[c++]=e+"-"+a.f[e];a.B=d.join("/")}
l.po=function(a){Wb(this.f,a);mA(this);this.u()};function nA(a){a=a||{};var c=a.size,d=c[0],e=c[1],f=[],g=256;switch(void 0!==a.tierSizeCalculation?a.tierSizeCalculation:"default"){case "default":for(;d>g||e>g;)f.push([Math.ceil(d/g),Math.ceil(e/g)]),g+=g;break;case "truncated":for(;d>g||e>g;)f.push([Math.ceil(d/g),Math.ceil(e/g)]),d>>=1,e>>=1}f.push([1,1]);f.reverse();for(var g=[1],h=[0],e=1,d=f.length;e<d;e++)g.push(1<<e),h.push(f[e-1][0]*f[e-1][1]+h[e-1]);g.reverse();var c=[0,-c[1],c[0],0],c=new Fh({extent:c,origin:fe(c),resolutions:g}),k=a.url;
rz.call(this,{attributions:a.attributions,crossOrigin:a.crossOrigin,logo:a.logo,tileClass:oA,tileGrid:c,tileUrlFunction:function(a){if(a){var c=a[0],d=a[1];a=-a[2]-1;return k+"TileGroup"+((d+a*f[c][0]+h[c])/256|0)+"/"+c+"-"+d+"-"+a+".jpg"}}})}w(nA,rz);function oA(a,c,d,e,f){Dx.call(this,a,c,d,e,f);this.f={}}w(oA,Dx);
oA.prototype.Ta=function(a){var c=void 0!==a?v(a).toString():"";if(c in this.f)return this.f[c];a=oA.ca.Ta.call(this,a);if(2==this.state){if(256==a.width&&256==a.height)return this.f[c]=a;var d=Qi(256,256);d.drawImage(a,0,0);return this.f[c]=d.canvas}return a};function pA(a){a=a||{};this.a=void 0!==a.initialSize?a.initialSize:256;this.c=void 0!==a.maxSize?a.maxSize:void 0!==ta?ta:2048;this.b=void 0!==a.space?a.space:1;this.g=[new qA(this.a,this.b)];this.f=this.a;this.j=[new qA(this.f,this.b)]}pA.prototype.add=function(a,c,d,e,f,g){if(c+this.b>this.c||d+this.b>this.c)return null;e=rA(this,!1,a,c,d,e,g);if(!e)return null;a=rA(this,!0,a,c,d,void 0!==f?f:se,g);return{offsetX:e.offsetX,offsetY:e.offsetY,image:e.image,ig:a.image}};
function rA(a,c,d,e,f,g,h){var k=c?a.j:a.g,m,n,p;n=0;for(p=k.length;n<p;++n){m=k[n];if(m=m.add(d,e,f,g,h))return m;m||n!==p-1||(c?(m=Math.min(2*a.f,a.c),a.f=m):(m=Math.min(2*a.a,a.c),a.a=m),m=new qA(m,a.b),k.push(m),++p)}}function qA(a,c){this.b=c;this.a=[{x:0,y:0,width:a,height:a}];this.f={};this.c=Pg("CANVAS");this.c.width=a;this.c.height=a;this.g=this.c.getContext("2d")}qA.prototype.get=function(a){return Rb(this.f,a,null)};
qA.prototype.add=function(a,c,d,e,f){var g,h,k;h=0;for(k=this.a.length;h<k;++h)if(g=this.a[h],g.width>=c+this.b&&g.height>=d+this.b)return k={offsetX:g.x+this.b,offsetY:g.y+this.b,image:this.c},this.f[a]=k,e.call(f,this.g,g.x+this.b,g.y+this.b),a=h,c=c+this.b,d=d+this.b,f=e=void 0,g.width-c>g.height-d?(e={x:g.x+c,y:g.y,width:g.width-c,height:g.height},f={x:g.x,y:g.y+d,width:c,height:g.height-d},sA(this,a,e,f)):(e={x:g.x+c,y:g.y,width:g.width-c,height:d},f={x:g.x,y:g.y+d,width:g.width,height:g.height-
d},sA(this,a,e,f)),k;return null};function sA(a,c,d,e){c=[c,1];0<d.width&&0<d.height&&c.push(d);0<e.width&&0<e.height&&c.push(e);a.a.splice.apply(a.a,c)};function tA(a){this.v=this.f=this.g=null;this.l=void 0!==a.fill?a.fill:null;this.J=[0,0];this.b=a.points;this.c=void 0!==a.radius?a.radius:a.radius1;this.j=void 0!==a.radius2?a.radius2:this.c;this.i=void 0!==a.angle?a.angle:0;this.a=void 0!==a.stroke?a.stroke:null;this.ka=this.U=this.ea=null;var c=a.atlasManager,d="",e="",f=0,g=null,h,k=0;this.a&&(h=Ag(this.a.b),k=this.a.a,void 0===k&&(k=1),g=this.a.c,Zi||(g=null),e=this.a.g,void 0===e&&(e="round"),d=this.a.f,void 0===d&&(d="round"),f=this.a.j,void 0===
f&&(f=10));var m=2*(this.c+k)+1,d={strokeStyle:h,ld:k,size:m,lineCap:d,lineDash:g,lineJoin:e,miterLimit:f};if(void 0===c){this.f=Pg("CANVAS");this.f.height=m;this.f.width=m;var c=m=this.f.width,n=this.f.getContext("2d");this.Ng(d,n,0,0);this.l?this.v=this.f:(n=this.v=Pg("CANVAS"),n.height=d.size,n.width=d.size,n=n.getContext("2d"),this.Mg(d,n,0,0))}else m=Math.round(m),(e=!this.l)&&(n=qa(this.Mg,this,d)),f=this.ub(),n=c.add(f,m,m,qa(this.Ng,this,d),n),this.f=n.image,this.J=[n.offsetX,n.offsetY],c=
n.image.width,this.v=e?n.ig:this.f;this.ea=[m/2,m/2];this.U=[m,m];this.ka=[c,c];wk.call(this,{opacity:1,rotateWithView:!1,rotation:void 0!==a.rotation?a.rotation:0,scale:1,snapToPixel:void 0!==a.snapToPixel?a.snapToPixel:!0})}w(tA,wk);l=tA.prototype;l.Db=function(){return this.ea};l.um=function(){return this.i};l.vm=function(){return this.l};l.fe=function(){return this.v};l.Mb=function(){return this.f};l.Fd=function(){return this.ka};l.gd=function(){return 2};l.ua=function(){return this.J};l.wm=function(){return this.b};
l.xm=function(){return this.c};l.mj=function(){return this.j};l.ob=function(){return this.U};l.ym=function(){return this.a};l.bf=va;l.load=va;l.Bf=va;
l.Ng=function(a,c,d,e){var f;c.setTransform(1,0,0,1,0,0);c.translate(d,e);c.beginPath();this.j!==this.c&&(this.b*=2);for(d=0;d<=this.b;d++)e=2*d*Math.PI/this.b-Math.PI/2+this.i,f=0===d%2?this.c:this.j,c.lineTo(a.size/2+f*Math.cos(e),a.size/2+f*Math.sin(e));this.l&&(c.fillStyle=Ag(this.l.b),c.fill());this.a&&(c.strokeStyle=a.strokeStyle,c.lineWidth=a.ld,a.lineDash&&c.setLineDash(a.lineDash),c.lineCap=a.lineCap,c.lineJoin=a.lineJoin,c.miterLimit=a.miterLimit,c.stroke());c.closePath()};
l.Mg=function(a,c,d,e){c.setTransform(1,0,0,1,0,0);c.translate(d,e);c.beginPath();this.j!==this.c&&(this.b*=2);var f;for(d=0;d<=this.b;d++)f=2*d*Math.PI/this.b-Math.PI/2+this.i,e=0===d%2?this.c:this.j,c.lineTo(a.size/2+e*Math.cos(f),a.size/2+e*Math.sin(f));c.fillStyle=Ul;c.fill();this.a&&(c.strokeStyle=a.strokeStyle,c.lineWidth=a.ld,a.lineDash&&c.setLineDash(a.lineDash),c.stroke());c.closePath()};
l.ub=function(){var a=this.a?this.a.ub():"-",c=this.l?this.l.ub():"-";this.g&&a==this.g[1]&&c==this.g[2]&&this.c==this.g[3]&&this.j==this.g[4]&&this.i==this.g[5]&&this.b==this.g[6]||(this.g=["r"+a+c+(void 0!==this.c?this.c.toString():"-")+(void 0!==this.j?this.j.toString():"-")+(void 0!==this.i?this.i.toString():"-")+(void 0!==this.b?this.b.toString():"-"),a,c,this.c,this.j,this.i,this.b]);return this.g[0]};t("ol.animation.bounce",function(a){var c=a.resolution,d=a.start?a.start:Date.now(),e=void 0!==a.duration?a.duration:1E3,f=a.easing?a.easing:Zf;return function(a,h){if(h.time<d)return h.animate=!0,h.viewHints[0]+=1,!0;if(h.time<d+e){var k=f((h.time-d)/e),m=c-h.viewState.resolution;h.animate=!0;h.viewState.resolution+=k*m;h.viewHints[0]+=1;return!0}return!1}},OPENLAYERS);t("ol.animation.pan",$f,OPENLAYERS);t("ol.animation.rotate",ag,OPENLAYERS);t("ol.animation.zoom",bg,OPENLAYERS);
t("ol.Attribution",rg,OPENLAYERS);rg.prototype.getHTML=rg.prototype.c;sg.prototype.element=sg.prototype.element;t("ol.Collection",tg,OPENLAYERS);tg.prototype.clear=tg.prototype.clear;tg.prototype.extend=tg.prototype.cf;tg.prototype.forEach=tg.prototype.forEach;tg.prototype.getArray=tg.prototype.yk;tg.prototype.item=tg.prototype.item;tg.prototype.getLength=tg.prototype.Jb;tg.prototype.insertAt=tg.prototype.Rd;tg.prototype.pop=tg.prototype.pop;tg.prototype.push=tg.prototype.push;
tg.prototype.remove=tg.prototype.remove;tg.prototype.removeAt=tg.prototype.xf;tg.prototype.setAt=tg.prototype.Rn;t("ol.coordinate.add",qd,OPENLAYERS);t("ol.coordinate.createStringXY",function(a){return function(c){return yd(c,a)}},OPENLAYERS);t("ol.coordinate.format",td,OPENLAYERS);t("ol.coordinate.rotate",vd,OPENLAYERS);t("ol.coordinate.toStringHDMS",function(a){return a?sd(a[1],"NS")+" "+sd(a[0],"EW"):""},OPENLAYERS);t("ol.coordinate.toStringXY",yd,OPENLAYERS);t("ol.DeviceOrientation",Hr,OPENLAYERS);
Hr.prototype.getAlpha=Hr.prototype.Gi;Hr.prototype.getBeta=Hr.prototype.Ji;Hr.prototype.getGamma=Hr.prototype.Ri;Hr.prototype.getHeading=Hr.prototype.zk;Hr.prototype.getTracking=Hr.prototype.og;Hr.prototype.setTracking=Hr.prototype.df;t("ol.easing.easeIn",Vf,OPENLAYERS);t("ol.easing.easeOut",Wf,OPENLAYERS);t("ol.easing.inAndOut",Xf,OPENLAYERS);t("ol.easing.linear",Yf,OPENLAYERS);t("ol.easing.upAndDown",Zf,OPENLAYERS);t("ol.extent.boundingExtent",Md,OPENLAYERS);t("ol.extent.buffer",Rd,OPENLAYERS);
t("ol.extent.containsCoordinate",Ud,OPENLAYERS);t("ol.extent.containsExtent",Wd,OPENLAYERS);t("ol.extent.containsXY",Vd,OPENLAYERS);t("ol.extent.createEmpty",Nd,OPENLAYERS);t("ol.extent.equals",Zd,OPENLAYERS);t("ol.extent.extend",$d,OPENLAYERS);t("ol.extent.getBottomLeft",ce,OPENLAYERS);t("ol.extent.getBottomRight",de,OPENLAYERS);t("ol.extent.getCenter",ge,OPENLAYERS);t("ol.extent.getHeight",ie,OPENLAYERS);t("ol.extent.getIntersection",je,OPENLAYERS);
t("ol.extent.getSize",function(a){return[a[2]-a[0],a[3]-a[1]]},OPENLAYERS);t("ol.extent.getTopLeft",fe,OPENLAYERS);t("ol.extent.getTopRight",ee,OPENLAYERS);t("ol.extent.getWidth",le,OPENLAYERS);t("ol.extent.intersects",ke,OPENLAYERS);t("ol.extent.isEmpty",me,OPENLAYERS);t("ol.extent.applyTransform",oe,OPENLAYERS);t("ol.Feature",P,OPENLAYERS);P.prototype.clone=P.prototype.clone;P.prototype.getGeometry=P.prototype.W;P.prototype.getId=P.prototype.Ca;P.prototype.getGeometryName=P.prototype.Ti;
P.prototype.getStyle=P.prototype.Bk;P.prototype.getStyleFunction=P.prototype.Ck;P.prototype.setGeometry=P.prototype.Aa;P.prototype.setStyle=P.prototype.ef;P.prototype.setId=P.prototype.Pb;P.prototype.setGeometryName=P.prototype.Fc;t("ol.featureloader.xhr",zp,OPENLAYERS);t("ol.Geolocation",tx,OPENLAYERS);tx.prototype.getAccuracy=tx.prototype.Ei;tx.prototype.getAccuracyGeometry=tx.prototype.Fi;tx.prototype.getAltitude=tx.prototype.Hi;tx.prototype.getAltitudeAccuracy=tx.prototype.Ii;
tx.prototype.getHeading=tx.prototype.Ek;tx.prototype.getPosition=tx.prototype.Fk;tx.prototype.getProjection=tx.prototype.pg;tx.prototype.getSpeed=tx.prototype.oj;tx.prototype.getTracking=tx.prototype.qg;tx.prototype.getTrackingOptions=tx.prototype.cg;tx.prototype.setProjection=tx.prototype.rg;tx.prototype.setTracking=tx.prototype.Xd;tx.prototype.setTrackingOptions=tx.prototype.rh;t("ol.Graticule",xx,OPENLAYERS);xx.prototype.getMap=xx.prototype.Ik;xx.prototype.getMeridians=xx.prototype.bj;
xx.prototype.getParallels=xx.prototype.ij;xx.prototype.setMap=xx.prototype.setMap;t("ol.has.DEVICE_PIXEL_RATIO",Yi,OPENLAYERS);t("ol.has.CANVAS",$i,OPENLAYERS);t("ol.has.DEVICE_ORIENTATION",aj,OPENLAYERS);t("ol.has.GEOLOCATION",bj,OPENLAYERS);t("ol.has.TOUCH",cj,OPENLAYERS);t("ol.has.WEBGL",Xi,OPENLAYERS);Cx.prototype.getImage=Cx.prototype.b;Dx.prototype.getImage=Dx.prototype.Ta;t("ol.Kinetic",Nk,OPENLAYERS);t("ol.loadingstrategy.all",Ap,OPENLAYERS);
t("ol.loadingstrategy.bbox",function(a){return[a]},OPENLAYERS);t("ol.loadingstrategy.tile",function(a){return function(c,d){var e=Mh(a,d),f=kg(a,c,e),g=[],e=[e,0,0];for(e[1]=f.b;e[1]<=f.f;++e[1])for(e[2]=f.a;e[2]<=f.c;++e[2])g.push(a.Ea(e));return g}},OPENLAYERS);t("ol.Map",V,OPENLAYERS);V.prototype.addControl=V.prototype.li;V.prototype.addInteraction=V.prototype.mi;V.prototype.addLayer=V.prototype.Of;V.prototype.addOverlay=V.prototype.Pf;V.prototype.beforeRender=V.prototype.Ba;
V.prototype.forEachFeatureAtPixel=V.prototype.Zc;V.prototype.forEachLayerAtPixel=V.prototype.Mk;V.prototype.hasFeatureAtPixel=V.prototype.ck;V.prototype.getEventCoordinate=V.prototype.Ni;V.prototype.getEventPixel=V.prototype.Cd;V.prototype.getTarget=V.prototype.ff;V.prototype.getTargetElement=V.prototype.wc;V.prototype.getCoordinateFromPixel=V.prototype.ya;V.prototype.getControls=V.prototype.Li;V.prototype.getOverlays=V.prototype.gj;V.prototype.getOverlayById=V.prototype.fj;
V.prototype.getInteractions=V.prototype.Ui;V.prototype.getLayerGroup=V.prototype.Tb;V.prototype.getLayers=V.prototype.sg;V.prototype.getPixelFromCoordinate=V.prototype.Da;V.prototype.getSize=V.prototype.Ha;V.prototype.getView=V.prototype.aa;V.prototype.getViewport=V.prototype.uj;V.prototype.renderSync=V.prototype.Nn;V.prototype.render=V.prototype.render;V.prototype.removeControl=V.prototype.Gn;V.prototype.removeInteraction=V.prototype.Hn;V.prototype.removeLayer=V.prototype.Jn;
V.prototype.removeOverlay=V.prototype.Kn;V.prototype.setLayerGroup=V.prototype.nh;V.prototype.setSize=V.prototype.zf;V.prototype.setTarget=V.prototype.Ok;V.prototype.setView=V.prototype.fo;V.prototype.updateSize=V.prototype.Hc;Nj.prototype.originalEvent=Nj.prototype.originalEvent;Nj.prototype.pixel=Nj.prototype.pixel;Nj.prototype.coordinate=Nj.prototype.coordinate;Nj.prototype.dragging=Nj.prototype.dragging;Nj.prototype.preventDefault=Nj.prototype.preventDefault;Nj.prototype.stopPropagation=Nj.prototype.c;
uh.prototype.map=uh.prototype.map;uh.prototype.frameState=uh.prototype.frameState;gd.prototype.key=gd.prototype.key;gd.prototype.oldValue=gd.prototype.oldValue;t("ol.Object",hd,OPENLAYERS);hd.prototype.get=hd.prototype.get;hd.prototype.getKeys=hd.prototype.P;hd.prototype.getProperties=hd.prototype.R;hd.prototype.set=hd.prototype.set;hd.prototype.setProperties=hd.prototype.I;hd.prototype.unset=hd.prototype.T;t("ol.Observable",ed,OPENLAYERS);t("ol.Observable.unByKey",fd,OPENLAYERS);
ed.prototype.changed=ed.prototype.u;ed.prototype.dispatchEvent=ed.prototype.s;ed.prototype.getRevision=ed.prototype.L;ed.prototype.on=ed.prototype.G;ed.prototype.once=ed.prototype.M;ed.prototype.un=ed.prototype.K;ed.prototype.unByKey=ed.prototype.N;t("ol.inherits",w,OPENLAYERS);t("ol.Overlay",er,OPENLAYERS);er.prototype.getElement=er.prototype.Yd;er.prototype.getId=er.prototype.Ca;er.prototype.getMap=er.prototype.Zd;er.prototype.getOffset=er.prototype.ag;er.prototype.getPosition=er.prototype.tg;
er.prototype.getPositioning=er.prototype.bg;er.prototype.setElement=er.prototype.kh;er.prototype.setMap=er.prototype.setMap;er.prototype.setOffset=er.prototype.ph;er.prototype.setPosition=er.prototype.gf;er.prototype.setPositioning=er.prototype.qh;t("ol.size.toSize",nd,OPENLAYERS);Ah.prototype.getTileCoord=Ah.prototype.j;t("ol.View",Of,OPENLAYERS);Of.prototype.constrainCenter=Of.prototype.yd;Of.prototype.constrainResolution=Of.prototype.constrainResolution;Of.prototype.constrainRotation=Of.prototype.constrainRotation;
Of.prototype.getCenter=Of.prototype.Ia;Of.prototype.calculateExtent=Of.prototype.Mc;Of.prototype.getProjection=Of.prototype.Pk;Of.prototype.getResolution=Of.prototype.ba;Of.prototype.getRotation=Of.prototype.wa;Of.prototype.getZoom=Of.prototype.wj;Of.prototype.fit=Of.prototype.Oe;Of.prototype.centerOn=Of.prototype.vi;Of.prototype.rotate=Of.prototype.rotate;Of.prototype.setCenter=Of.prototype.Ua;Of.prototype.setResolution=Of.prototype.zb;Of.prototype.setRotation=Of.prototype.$d;
Of.prototype.setZoom=Of.prototype.jo;t("ol.xml.getAllTextContent",To,OPENLAYERS);t("ol.xml.parse",mp,OPENLAYERS);lq.prototype.getGL=lq.prototype.Rm;lq.prototype.useProgram=lq.prototype.me;t("ol.tilegrid.TileGrid",Fh,OPENLAYERS);Fh.prototype.getMaxZoom=Fh.prototype.Zf;Fh.prototype.getMinZoom=Fh.prototype.$f;Fh.prototype.getOrigin=Fh.prototype.ua;Fh.prototype.getResolution=Fh.prototype.ba;Fh.prototype.getResolutions=Fh.prototype.Pg;Fh.prototype.getTileCoordExtent=Fh.prototype.Ea;
Fh.prototype.getTileCoordForCoordAndResolution=Fh.prototype.ad;Fh.prototype.getTileCoordForCoordAndZ=Fh.prototype.Md;Fh.prototype.getTileSize=Fh.prototype.La;t("ol.tilegrid.createXYZ",Nh,OPENLAYERS);t("ol.tilegrid.WMTS",jA,OPENLAYERS);jA.prototype.getMatrixIds=jA.prototype.D;t("ol.tilegrid.WMTS.createFromCapabilitiesMatrixSet",kA,OPENLAYERS);t("ol.style.AtlasManager",pA,OPENLAYERS);t("ol.style.Circle",cm,OPENLAYERS);cm.prototype.getFill=cm.prototype.qm;cm.prototype.getImage=cm.prototype.Mb;
cm.prototype.getRadius=cm.prototype.rm;cm.prototype.getStroke=cm.prototype.sm;t("ol.style.Fill",Xl,OPENLAYERS);Xl.prototype.getColor=Xl.prototype.c;Xl.prototype.setColor=Xl.prototype.f;t("ol.style.Icon",xk,OPENLAYERS);xk.prototype.getAnchor=xk.prototype.Db;xk.prototype.getImage=xk.prototype.Mb;xk.prototype.getOrigin=xk.prototype.ua;xk.prototype.getSrc=xk.prototype.tm;xk.prototype.getSize=xk.prototype.ob;xk.prototype.load=xk.prototype.load;t("ol.style.Image",wk,OPENLAYERS);
wk.prototype.getOpacity=wk.prototype.ge;wk.prototype.getRotateWithView=wk.prototype.Jd;wk.prototype.getRotation=wk.prototype.he;wk.prototype.getScale=wk.prototype.ie;wk.prototype.getSnapToPixel=wk.prototype.Ld;wk.prototype.setOpacity=wk.prototype.je;wk.prototype.setRotation=wk.prototype.ke;wk.prototype.setScale=wk.prototype.le;t("ol.style.RegularShape",tA,OPENLAYERS);tA.prototype.getAnchor=tA.prototype.Db;tA.prototype.getAngle=tA.prototype.um;tA.prototype.getFill=tA.prototype.vm;
tA.prototype.getImage=tA.prototype.Mb;tA.prototype.getOrigin=tA.prototype.ua;tA.prototype.getPoints=tA.prototype.wm;tA.prototype.getRadius=tA.prototype.xm;tA.prototype.getRadius2=tA.prototype.mj;tA.prototype.getSize=tA.prototype.ob;tA.prototype.getStroke=tA.prototype.ym;t("ol.style.Stroke",bm,OPENLAYERS);bm.prototype.getColor=bm.prototype.zm;bm.prototype.getLineCap=bm.prototype.Xi;bm.prototype.getLineDash=bm.prototype.Am;bm.prototype.getLineJoin=bm.prototype.Yi;bm.prototype.getMiterLimit=bm.prototype.cj;
bm.prototype.getWidth=bm.prototype.Bm;bm.prototype.setColor=bm.prototype.Cm;bm.prototype.setLineCap=bm.prototype.Wn;bm.prototype.setLineDash=bm.prototype.Dm;bm.prototype.setLineJoin=bm.prototype.Xn;bm.prototype.setMiterLimit=bm.prototype.Yn;bm.prototype.setWidth=bm.prototype.ho;t("ol.style.Style",dm,OPENLAYERS);dm.prototype.getGeometry=dm.prototype.W;dm.prototype.getGeometryFunction=dm.prototype.Si;dm.prototype.getFill=dm.prototype.Em;dm.prototype.getImage=dm.prototype.Fm;dm.prototype.getStroke=dm.prototype.Gm;
dm.prototype.getText=dm.prototype.Hm;dm.prototype.getZIndex=dm.prototype.Im;dm.prototype.setGeometry=dm.prototype.Og;dm.prototype.setZIndex=dm.prototype.Jm;t("ol.style.Text",Gt,OPENLAYERS);Gt.prototype.getFont=Gt.prototype.Pi;Gt.prototype.getOffsetX=Gt.prototype.dj;Gt.prototype.getOffsetY=Gt.prototype.ej;Gt.prototype.getFill=Gt.prototype.Km;Gt.prototype.getRotation=Gt.prototype.Lm;Gt.prototype.getScale=Gt.prototype.Mm;Gt.prototype.getStroke=Gt.prototype.Nm;Gt.prototype.getText=Gt.prototype.Om;
Gt.prototype.getTextAlign=Gt.prototype.qj;Gt.prototype.getTextBaseline=Gt.prototype.rj;Gt.prototype.setFont=Gt.prototype.Tn;Gt.prototype.setOffsetX=Gt.prototype.Zn;Gt.prototype.setOffsetY=Gt.prototype.$n;Gt.prototype.setFill=Gt.prototype.Sn;Gt.prototype.setRotation=Gt.prototype.Pm;Gt.prototype.setScale=Gt.prototype.Qm;Gt.prototype.setStroke=Gt.prototype.ao;Gt.prototype.setText=Gt.prototype.bo;Gt.prototype.setTextAlign=Gt.prototype.co;Gt.prototype.setTextBaseline=Gt.prototype.eo;t("ol.Sphere",xe,OPENLAYERS);
xe.prototype.geodesicArea=xe.prototype.a;xe.prototype.haversineDistance=xe.prototype.b;t("ol.source.BingMaps",tz,OPENLAYERS);t("ol.source.BingMaps.TOS_ATTRIBUTION",uz,OPENLAYERS);t("ol.source.Cluster",Y,OPENLAYERS);Y.prototype.getSource=Y.prototype.ga;t("ol.source.ImageCanvas",yn,OPENLAYERS);t("ol.source.ImageMapGuide",xz,OPENLAYERS);xz.prototype.getParams=xz.prototype.Kl;xz.prototype.getImageLoadFunction=xz.prototype.Jl;xz.prototype.updateParams=xz.prototype.Nl;
xz.prototype.setImageLoadFunction=xz.prototype.Ml;t("ol.source.Image",rn,OPENLAYERS);tn.prototype.image=tn.prototype.image;t("ol.source.ImageStatic",yz,OPENLAYERS);t("ol.source.ImageVector",Qp,OPENLAYERS);Qp.prototype.getSource=Qp.prototype.Ol;Qp.prototype.getStyle=Qp.prototype.Pl;Qp.prototype.getStyleFunction=Qp.prototype.Ql;Qp.prototype.setStyle=Qp.prototype.Gg;t("ol.source.ImageWMS",zz,OPENLAYERS);zz.prototype.getGetFeatureInfoUrl=zz.prototype.Tl;zz.prototype.getParams=zz.prototype.Vl;
zz.prototype.getImageLoadFunction=zz.prototype.Ul;zz.prototype.getUrl=zz.prototype.Wl;zz.prototype.setImageLoadFunction=zz.prototype.Xl;zz.prototype.setUrl=zz.prototype.Yl;zz.prototype.updateParams=zz.prototype.Zl;t("ol.source.MapQuest",Gz,OPENLAYERS);Gz.prototype.getLayer=Gz.prototype.v;t("ol.source.OSM",Ez,OPENLAYERS);t("ol.source.OSM.ATTRIBUTION",Fz,OPENLAYERS);t("ol.source.Raster",Jz,OPENLAYERS);Jz.prototype.setOperation=Jz.prototype.v;Oz.prototype.extent=Oz.prototype.extent;
Oz.prototype.resolution=Oz.prototype.resolution;Oz.prototype.data=Oz.prototype.data;t("ol.source.Source",Ch,OPENLAYERS);Ch.prototype.getAttributions=Ch.prototype.na;Ch.prototype.getLogo=Ch.prototype.ma;Ch.prototype.getProjection=Ch.prototype.oa;Ch.prototype.getState=Ch.prototype.pa;Ch.prototype.setAttributions=Ch.prototype.la;t("ol.source.Stamen",Tz,OPENLAYERS);t("ol.source.TileArcGISRest",Vz,OPENLAYERS);Vz.prototype.getParams=Vz.prototype.$l;Vz.prototype.getUrls=Vz.prototype.am;
Vz.prototype.setUrl=Vz.prototype.bm;Vz.prototype.setUrls=Vz.prototype.Hg;Vz.prototype.updateParams=Vz.prototype.dm;t("ol.source.TileDebug",Xz,OPENLAYERS);t("ol.source.TileImage",rz,OPENLAYERS);rz.prototype.getTileLoadFunction=rz.prototype.ab;rz.prototype.getTileUrlFunction=rz.prototype.bb;rz.prototype.setTileLoadFunction=rz.prototype.gb;rz.prototype.setTileUrlFunction=rz.prototype.Ja;t("ol.source.TileJSON",Yz,OPENLAYERS);t("ol.source.Tile",Ph,OPENLAYERS);Ph.prototype.getTileGrid=Ph.prototype.Fa;
Uh.prototype.tile=Uh.prototype.tile;t("ol.source.TileUTFGrid",Zz,OPENLAYERS);Zz.prototype.getTemplate=Zz.prototype.pj;Zz.prototype.forDataAtCoordinateAndResolution=Zz.prototype.Ai;t("ol.source.TileVector",Z,OPENLAYERS);Z.prototype.getFeaturesAtCoordinateAndResolution=Z.prototype.Oi;t("ol.source.TileWMS",fA,OPENLAYERS);fA.prototype.getGetFeatureInfoUrl=fA.prototype.hm;fA.prototype.getParams=fA.prototype.im;fA.prototype.getUrls=fA.prototype.jm;fA.prototype.setUrl=fA.prototype.km;
fA.prototype.setUrls=fA.prototype.Ig;fA.prototype.updateParams=fA.prototype.mm;t("ol.source.Vector",U,OPENLAYERS);U.prototype.addFeature=U.prototype.Ac;U.prototype.addFeatures=U.prototype.Qb;U.prototype.clear=U.prototype.clear;U.prototype.forEachFeature=U.prototype.Pe;U.prototype.forEachFeatureInExtent=U.prototype.uc;U.prototype.forEachFeatureIntersectingExtent=U.prototype.Qe;U.prototype.getFeaturesCollection=U.prototype.Ve;U.prototype.getFeatures=U.prototype.Bc;
U.prototype.getFeaturesAtCoordinate=U.prototype.Ue;U.prototype.getFeaturesInExtent=U.prototype.Dd;U.prototype.getClosestFeatureToCoordinate=U.prototype.Se;U.prototype.getExtent=U.prototype.S;U.prototype.getFeatureById=U.prototype.Te;U.prototype.removeFeature=U.prototype.fc;Np.prototype.feature=Np.prototype.feature;t("ol.source.WMTS",lA,OPENLAYERS);lA.prototype.getDimensions=lA.prototype.Mi;lA.prototype.getFormat=lA.prototype.Qi;lA.prototype.getLayer=lA.prototype.nm;lA.prototype.getMatrixSet=lA.prototype.aj;
lA.prototype.getRequestEncoding=lA.prototype.nj;lA.prototype.getStyle=lA.prototype.om;lA.prototype.getUrls=lA.prototype.pm;lA.prototype.getVersion=lA.prototype.tj;lA.prototype.updateDimensions=lA.prototype.po;
t("ol.source.WMTS.optionsFromCapabilities",function(a,c){var d=cb(a.Contents.Layer,function(a){return a.Identifier==c.layer}),e=a.Contents.TileMatrixSet,f,g;f=1<d.TileMatrixSetLink.length?"projection"in c?db(d.TileMatrixSetLink,function(a){return cb(e,function(c){return c.Identifier==a.TileMatrixSet}).SupportedCRS.replace(/urn:ogc:def:crs:(\w+):(.*:)?(\w+)$/,"$1:$3")==c.projection}):db(d.TileMatrixSetLink,function(a){return a.TileMatrixSet==c.matrixSet}):0;0>f&&(f=0);g=d.TileMatrixSetLink[f].TileMatrixSet;
var h=d.Format[0];"format"in c&&(h=c.format);f=db(d.Style,function(a){return"style"in c?a.Title==c.style:a.isDefault});0>f&&(f=0);f=d.Style[f].Identifier;var k={};"Dimension"in d&&d.Dimension.forEach(function(a){var c=a.Identifier,d=a.Default;void 0===d&&(d=a.Value[0]);k[c]=d});var m=cb(a.Contents.TileMatrixSet,function(a){return a.Identifier==g}),n;n="projection"in c?Ce(c.projection):Ce(m.SupportedCRS.replace(/urn:ogc:def:crs:(\w+):(.*:)?(\w+)$/,"$1:$3"));var p=d.WGS84BoundingBox,q,r;void 0!==p&&
(r=Ce("EPSG:4326").S(),r=p[0]==r[0]&&p[2]==r[2],q=Ye(p,"EPSG:4326",n),(p=n.S())&&(Wd(p,q)||(q=void 0)));var m=kA(m,q),u=[];q=c.requestEncoding;q=void 0!==q?q:"";if(a.hasOwnProperty("OperationsMetadata")&&a.OperationsMetadata.hasOwnProperty("GetTile")&&0!==q.indexOf("REST"))for(var d=a.OperationsMetadata.GetTile.DCP.HTTP.Get,p=0,y=d.length;p<y;++p){var A=cb(d[p].Constraint,function(a){return"GetEncoding"==a.name}).AllowedValues.Value;0<A.length&&tb(A,"KVP")&&(q="KVP",u.push(d[p].href))}else q="REST",
d.ResourceURL.forEach(function(a){"tile"==a.resourceType&&(h=a.format,u.push(a.template))});return{urls:u,layer:c.layer,matrixSet:g,format:h,projection:n,requestEncoding:q,tileGrid:m,style:f,dimensions:k,wrapX:r}},OPENLAYERS);t("ol.source.XYZ",Dz,OPENLAYERS);Dz.prototype.getUrls=Dz.prototype.g;Dz.prototype.setUrl=Dz.prototype.f;t("ol.source.Zoomify",nA,OPENLAYERS);ek.prototype.vectorContext=ek.prototype.vectorContext;ek.prototype.frameState=ek.prototype.frameState;ek.prototype.context=ek.prototype.context;
ek.prototype.glContext=ek.prototype.glContext;t("ol.render.VectorContext",dk,OPENLAYERS);Jq.prototype.drawAsync=Jq.prototype.Xc;Jq.prototype.drawCircleGeometry=Jq.prototype.qc;Jq.prototype.drawFeature=Jq.prototype.Ne;Jq.prototype.drawGeometryCollectionGeometry=Jq.prototype.Ad;Jq.prototype.drawPointGeometry=Jq.prototype.sb;Jq.prototype.drawLineStringGeometry=Jq.prototype.Bb;Jq.prototype.drawMultiLineStringGeometry=Jq.prototype.rc;Jq.prototype.drawMultiPointGeometry=Jq.prototype.rb;
Jq.prototype.drawMultiPolygonGeometry=Jq.prototype.sc;Jq.prototype.drawPolygonGeometry=Jq.prototype.tc;Jq.prototype.drawText=Jq.prototype.tb;Jq.prototype.setFillStrokeStyle=Jq.prototype.Ma;Jq.prototype.setImageStyle=Jq.prototype.fb;Jq.prototype.setTextStyle=Jq.prototype.Na;jm.prototype.drawAsync=jm.prototype.Xc;jm.prototype.drawCircleGeometry=jm.prototype.qc;jm.prototype.drawFeature=jm.prototype.Ne;jm.prototype.drawPointGeometry=jm.prototype.sb;jm.prototype.drawMultiPointGeometry=jm.prototype.rb;
jm.prototype.drawLineStringGeometry=jm.prototype.Bb;jm.prototype.drawMultiLineStringGeometry=jm.prototype.rc;jm.prototype.drawPolygonGeometry=jm.prototype.tc;jm.prototype.drawMultiPolygonGeometry=jm.prototype.sc;jm.prototype.setFillStrokeStyle=jm.prototype.Ma;jm.prototype.setImageStyle=jm.prototype.fb;jm.prototype.setTextStyle=jm.prototype.Na;t("ol.proj.common.add",Sl,OPENLAYERS);t("ol.proj.METERS_PER_UNIT",ze,OPENLAYERS);t("ol.proj.Projection",Ae,OPENLAYERS);Ae.prototype.getCode=Ae.prototype.Ki;
Ae.prototype.getExtent=Ae.prototype.S;Ae.prototype.getUnits=Ae.prototype.Dl;Ae.prototype.getMetersPerUnit=Ae.prototype.Hd;Ae.prototype.getWorldExtent=Ae.prototype.vj;Ae.prototype.isGlobal=Ae.prototype.hk;Ae.prototype.setGlobal=Ae.prototype.Vn;Ae.prototype.setExtent=Ae.prototype.El;Ae.prototype.setWorldExtent=Ae.prototype.io;Ae.prototype.setGetPointResolution=Ae.prototype.Un;Ae.prototype.getPointResolution=Ae.prototype.getPointResolution;t("ol.proj.addEquivalentProjections",De,OPENLAYERS);
t("ol.proj.addProjection",Re,OPENLAYERS);t("ol.proj.addCoordinateTransforms",Ee,OPENLAYERS);t("ol.proj.fromLonLat",function(a,c){return Xe(a,"EPSG:4326",void 0!==c?c:"EPSG:3857")},OPENLAYERS);t("ol.proj.toLonLat",function(a,c){return Xe(a,void 0!==c?c:"EPSG:3857","EPSG:4326")},OPENLAYERS);t("ol.proj.get",Ce,OPENLAYERS);t("ol.proj.getTransform",Ve,OPENLAYERS);t("ol.proj.transform",Xe,OPENLAYERS);t("ol.proj.transformExtent",Ye,OPENLAYERS);t("ol.layer.Heatmap",X,OPENLAYERS);X.prototype.getBlur=X.prototype.Uf;
X.prototype.getGradient=X.prototype.Xf;X.prototype.getRadius=X.prototype.Bg;X.prototype.setBlur=X.prototype.ih;X.prototype.setGradient=X.prototype.mh;X.prototype.setRadius=X.prototype.Cg;t("ol.layer.Image",Tl,OPENLAYERS);Tl.prototype.getSource=Tl.prototype.fa;t("ol.layer.Layer",fk,OPENLAYERS);fk.prototype.getSource=fk.prototype.fa;fk.prototype.setMap=fk.prototype.setMap;fk.prototype.setSource=fk.prototype.Gc;t("ol.layer.Base",bk,OPENLAYERS);bk.prototype.getExtent=bk.prototype.S;
bk.prototype.getMaxResolution=bk.prototype.Fb;bk.prototype.getMinResolution=bk.prototype.Gb;bk.prototype.getOpacity=bk.prototype.Kb;bk.prototype.getVisible=bk.prototype.mb;bk.prototype.getZIndex=bk.prototype.Lb;bk.prototype.setExtent=bk.prototype.$b;bk.prototype.setMaxResolution=bk.prototype.ic;bk.prototype.setMinResolution=bk.prototype.jc;bk.prototype.setOpacity=bk.prototype.ac;bk.prototype.setVisible=bk.prototype.bc;bk.prototype.setZIndex=bk.prototype.cc;t("ol.layer.Group",Ll,OPENLAYERS);
Ll.prototype.getLayers=Ll.prototype.zc;Ll.prototype.setLayers=Ll.prototype.oh;t("ol.layer.Tile",E,OPENLAYERS);E.prototype.getPreload=E.prototype.a;E.prototype.getSource=E.prototype.fa;E.prototype.setPreload=E.prototype.f;E.prototype.getUseInterimTilesOnError=E.prototype.c;E.prototype.setUseInterimTilesOnError=E.prototype.g;t("ol.layer.Vector",G,OPENLAYERS);G.prototype.getSource=G.prototype.fa;G.prototype.getStyle=G.prototype.U;G.prototype.getStyleFunction=G.prototype.Y;G.prototype.setStyle=G.prototype.g;
t("ol.interaction.DoubleClickZoom",Tk,OPENLAYERS);t("ol.interaction.DoubleClickZoom.handleEvent",Uk,OPENLAYERS);t("ol.interaction.DragAndDrop",Yx,OPENLAYERS);t("ol.interaction.DragAndDrop.handleEvent",re,OPENLAYERS);Zx.prototype.features=Zx.prototype.features;Zx.prototype.file=Zx.prototype.file;Zx.prototype.projection=Zx.prototype.projection;ql.prototype.coordinate=ql.prototype.coordinate;t("ol.interaction.DragBox",rl,OPENLAYERS);rl.prototype.getGeometry=rl.prototype.W;
t("ol.interaction.DragPan",el,OPENLAYERS);t("ol.interaction.DragRotateAndZoom",by,OPENLAYERS);t("ol.interaction.DragRotate",il,OPENLAYERS);t("ol.interaction.DragZoom",vl,OPENLAYERS);fy.prototype.feature=fy.prototype.feature;t("ol.interaction.Draw",gy,OPENLAYERS);t("ol.interaction.Draw.handleEvent",iy,OPENLAYERS);gy.prototype.removeLastPoint=gy.prototype.In;gy.prototype.finishDrawing=gy.prototype.Yc;gy.prototype.extend=gy.prototype.il;
t("ol.interaction.Draw.createRegularPolygon",function(a,c){return function(d,e){var f=d[0],g=d[1],h=Math.sqrt(wd(f,g)),k=e?e:Mf(new Xm(f),a);Nf(k,f,h,c?c:Math.atan((g[1]-f[1])/(g[0]-f[0])));return k}},OPENLAYERS);t("ol.interaction.Interaction",Pk,OPENLAYERS);Pk.prototype.getActive=Pk.prototype.c;Pk.prototype.setActive=Pk.prototype.g;t("ol.interaction.defaults",Kl,OPENLAYERS);t("ol.interaction.KeyboardPan",wl,OPENLAYERS);t("ol.interaction.KeyboardPan.handleEvent",xl,OPENLAYERS);
t("ol.interaction.KeyboardZoom",yl,OPENLAYERS);t("ol.interaction.KeyboardZoom.handleEvent",zl,OPENLAYERS);wy.prototype.features=wy.prototype.features;wy.prototype.mapBrowserPointerEvent=wy.prototype.mapBrowserPointerEvent;t("ol.interaction.Modify",xy,OPENLAYERS);t("ol.interaction.Modify.handleEvent",Ay,OPENLAYERS);t("ol.interaction.MouseWheelZoom",Al,OPENLAYERS);t("ol.interaction.MouseWheelZoom.handleEvent",Bl,OPENLAYERS);Al.prototype.setMouseAnchor=Al.prototype.C;
t("ol.interaction.PinchRotate",Cl,OPENLAYERS);t("ol.interaction.PinchZoom",Gl,OPENLAYERS);t("ol.interaction.Pointer",bl,OPENLAYERS);t("ol.interaction.Pointer.handleEvent",cl,OPENLAYERS);Ky.prototype.selected=Ky.prototype.selected;Ky.prototype.deselected=Ky.prototype.deselected;Ky.prototype.mapBrowserEvent=Ky.prototype.mapBrowserEvent;t("ol.interaction.Select",Ly,OPENLAYERS);Ly.prototype.getFeatures=Ly.prototype.sl;Ly.prototype.getLayer=Ly.prototype.tl;t("ol.interaction.Select.handleEvent",My,OPENLAYERS);
Ly.prototype.setMap=Ly.prototype.setMap;t("ol.interaction.Snap",Oy,OPENLAYERS);Oy.prototype.addFeature=Oy.prototype.dd;Oy.prototype.removeFeature=Oy.prototype.ed;Sy.prototype.features=Sy.prototype.features;Sy.prototype.coordinate=Sy.prototype.coordinate;t("ol.interaction.Translate",Ty,OPENLAYERS);t("ol.geom.Circle",Xm,OPENLAYERS);Xm.prototype.clone=Xm.prototype.clone;Xm.prototype.getCenter=Xm.prototype.cd;Xm.prototype.getRadius=Xm.prototype.hf;Xm.prototype.getType=Xm.prototype.X;
Xm.prototype.intersectsExtent=Xm.prototype.va;Xm.prototype.setCenter=Xm.prototype.al;Xm.prototype.setCenterAndRadius=Xm.prototype.yf;Xm.prototype.setRadius=Xm.prototype.bl;Xm.prototype.transform=Xm.prototype.Va;t("ol.geom.Geometry",Ze,OPENLAYERS);Ze.prototype.getClosestPoint=Ze.prototype.$a;Ze.prototype.getExtent=Ze.prototype.S;Ze.prototype.simplify=Ze.prototype.hb;Ze.prototype.transform=Ze.prototype.Va;t("ol.geom.GeometryCollection",Zm,OPENLAYERS);Zm.prototype.clone=Zm.prototype.clone;
Zm.prototype.getGeometries=Zm.prototype.Wf;Zm.prototype.getType=Zm.prototype.X;Zm.prototype.intersectsExtent=Zm.prototype.va;Zm.prototype.setGeometries=Zm.prototype.lh;Zm.prototype.applyTransform=Zm.prototype.Rb;Zm.prototype.translate=Zm.prototype.yc;t("ol.geom.LinearRing",tf,OPENLAYERS);tf.prototype.clone=tf.prototype.clone;tf.prototype.getArea=tf.prototype.el;tf.prototype.getCoordinates=tf.prototype.V;tf.prototype.getType=tf.prototype.X;tf.prototype.setCoordinates=tf.prototype.ja;
t("ol.geom.LineString",H,OPENLAYERS);H.prototype.appendCoordinate=H.prototype.ni;H.prototype.clone=H.prototype.clone;H.prototype.forEachSegment=H.prototype.Di;H.prototype.getCoordinateAtM=H.prototype.cl;H.prototype.getCoordinates=H.prototype.V;H.prototype.getLength=H.prototype.dl;H.prototype.getType=H.prototype.X;H.prototype.intersectsExtent=H.prototype.va;H.prototype.setCoordinates=H.prototype.ja;t("ol.geom.MultiLineString",L,OPENLAYERS);L.prototype.appendLineString=L.prototype.oi;
L.prototype.clone=L.prototype.clone;L.prototype.getCoordinateAtM=L.prototype.fl;L.prototype.getCoordinates=L.prototype.V;L.prototype.getLineString=L.prototype.Zi;L.prototype.getLineStrings=L.prototype.$c;L.prototype.getType=L.prototype.X;L.prototype.intersectsExtent=L.prototype.va;L.prototype.setCoordinates=L.prototype.ja;t("ol.geom.MultiPoint",jn,OPENLAYERS);jn.prototype.appendPoint=jn.prototype.ri;jn.prototype.clone=jn.prototype.clone;jn.prototype.getCoordinates=jn.prototype.V;
jn.prototype.getPoint=jn.prototype.jj;jn.prototype.getPoints=jn.prototype.ae;jn.prototype.getType=jn.prototype.X;jn.prototype.intersectsExtent=jn.prototype.va;jn.prototype.setCoordinates=jn.prototype.ja;t("ol.geom.MultiPolygon",N,OPENLAYERS);N.prototype.appendPolygon=N.prototype.si;N.prototype.clone=N.prototype.clone;N.prototype.getArea=N.prototype.gl;N.prototype.getCoordinates=N.prototype.V;N.prototype.getInteriorPoints=N.prototype.Wi;N.prototype.getPolygon=N.prototype.lj;
N.prototype.getPolygons=N.prototype.Id;N.prototype.getType=N.prototype.X;N.prototype.intersectsExtent=N.prototype.va;N.prototype.setCoordinates=N.prototype.ja;t("ol.geom.Point",C,OPENLAYERS);C.prototype.clone=C.prototype.clone;C.prototype.getCoordinates=C.prototype.V;C.prototype.getType=C.prototype.X;C.prototype.intersectsExtent=C.prototype.va;C.prototype.setCoordinates=C.prototype.ja;t("ol.geom.Polygon",D,OPENLAYERS);D.prototype.appendLinearRing=D.prototype.pi;D.prototype.clone=D.prototype.clone;
D.prototype.getArea=D.prototype.hl;D.prototype.getCoordinates=D.prototype.V;D.prototype.getInteriorPoint=D.prototype.Vi;D.prototype.getLinearRingCount=D.prototype.$i;D.prototype.getLinearRing=D.prototype.Yf;D.prototype.getLinearRings=D.prototype.Gd;D.prototype.getType=D.prototype.X;D.prototype.intersectsExtent=D.prototype.va;D.prototype.setCoordinates=D.prototype.ja;t("ol.geom.Polygon.circular",Kf,OPENLAYERS);t("ol.geom.Polygon.fromExtent",Lf,OPENLAYERS);t("ol.geom.Polygon.fromCircle",Mf,OPENLAYERS);
t("ol.geom.SimpleGeometry",af,OPENLAYERS);af.prototype.getFirstCoordinate=af.prototype.vb;af.prototype.getLastCoordinate=af.prototype.wb;af.prototype.getLayout=af.prototype.xb;af.prototype.applyTransform=af.prototype.Rb;af.prototype.translate=af.prototype.yc;t("ol.format.EsriJSON",Or,OPENLAYERS);Or.prototype.readFeature=Or.prototype.yb;Or.prototype.readFeatures=Or.prototype.ta;Or.prototype.readGeometry=Or.prototype.Dc;Or.prototype.readProjection=Or.prototype.Ka;Or.prototype.writeGeometry=Or.prototype.Jc;
Or.prototype.writeGeometryObject=Or.prototype.ze;Or.prototype.writeFeature=Or.prototype.od;Or.prototype.writeFeatureObject=Or.prototype.Ic;Or.prototype.writeFeatures=Or.prototype.Ab;Or.prototype.writeFeaturesObject=Or.prototype.xe;t("ol.format.Feature",Ir,OPENLAYERS);t("ol.format.GeoJSON",Vr,OPENLAYERS);Vr.prototype.readFeature=Vr.prototype.yb;Vr.prototype.readFeatures=Vr.prototype.ta;Vr.prototype.readGeometry=Vr.prototype.Dc;Vr.prototype.readProjection=Vr.prototype.Ka;Vr.prototype.writeFeature=Vr.prototype.od;
Vr.prototype.writeFeatureObject=Vr.prototype.Ic;Vr.prototype.writeFeatures=Vr.prototype.Ab;Vr.prototype.writeFeaturesObject=Vr.prototype.xe;Vr.prototype.writeGeometry=Vr.prototype.Jc;Vr.prototype.writeGeometryObject=Vr.prototype.ze;t("ol.format.GPX",ys,OPENLAYERS);ys.prototype.readFeature=ys.prototype.yb;ys.prototype.readFeatures=ys.prototype.ta;ys.prototype.readProjection=ys.prototype.Ka;ys.prototype.writeFeatures=ys.prototype.Ab;ys.prototype.writeFeaturesNode=ys.prototype.a;
t("ol.format.IGC",it,OPENLAYERS);it.prototype.readFeature=it.prototype.yb;it.prototype.readFeatures=it.prototype.ta;it.prototype.readProjection=it.prototype.Ka;t("ol.format.KML",Ht,OPENLAYERS);Ht.prototype.readFeature=Ht.prototype.yb;Ht.prototype.readFeatures=Ht.prototype.ta;Ht.prototype.readName=Ht.prototype.yn;Ht.prototype.readNetworkLinks=Ht.prototype.zn;Ht.prototype.readProjection=Ht.prototype.Ka;Ht.prototype.writeFeatures=Ht.prototype.Ab;Ht.prototype.writeFeaturesNode=Ht.prototype.a;
t("ol.format.OSMXML",uv,OPENLAYERS);uv.prototype.readFeatures=uv.prototype.ta;uv.prototype.readProjection=uv.prototype.Ka;t("ol.format.Polyline",Tv,OPENLAYERS);t("ol.format.Polyline.encodeDeltas",Uv,OPENLAYERS);t("ol.format.Polyline.decodeDeltas",Wv,OPENLAYERS);t("ol.format.Polyline.encodeFloats",Vv,OPENLAYERS);t("ol.format.Polyline.decodeFloats",Xv,OPENLAYERS);Tv.prototype.readFeature=Tv.prototype.yb;Tv.prototype.readFeatures=Tv.prototype.ta;Tv.prototype.readGeometry=Tv.prototype.Dc;
Tv.prototype.readProjection=Tv.prototype.Ka;Tv.prototype.writeGeometry=Tv.prototype.Jc;t("ol.format.TopoJSON",Yv,OPENLAYERS);Yv.prototype.readFeatures=Yv.prototype.ta;Yv.prototype.readProjection=Yv.prototype.Ka;t("ol.format.WFS",dw,OPENLAYERS);dw.prototype.readFeatures=dw.prototype.ta;dw.prototype.readTransactionResponse=dw.prototype.i;dw.prototype.readFeatureCollectionMetadata=dw.prototype.j;dw.prototype.writeGetFeature=dw.prototype.l;dw.prototype.writeTransaction=dw.prototype.A;
dw.prototype.readProjection=dw.prototype.Ka;t("ol.format.WKT",qw,OPENLAYERS);qw.prototype.readFeature=qw.prototype.yb;qw.prototype.readFeatures=qw.prototype.ta;qw.prototype.readGeometry=qw.prototype.Dc;qw.prototype.writeFeature=qw.prototype.od;qw.prototype.writeFeatures=qw.prototype.Ab;qw.prototype.writeGeometry=qw.prototype.Jc;t("ol.format.WMSCapabilities",Iw,OPENLAYERS);Iw.prototype.read=Iw.prototype.c;t("ol.format.WMSGetFeatureInfo",ex,OPENLAYERS);ex.prototype.readFeatures=ex.prototype.ta;
t("ol.format.WMTSCapabilities",fx,OPENLAYERS);fx.prototype.read=fx.prototype.c;t("ol.format.GML2",os,OPENLAYERS);t("ol.format.GML3",ps,OPENLAYERS);ps.prototype.writeGeometryNode=ps.prototype.D;ps.prototype.writeFeatures=ps.prototype.Ab;ps.prototype.writeFeaturesNode=ps.prototype.a;t("ol.format.GML",ps,OPENLAYERS);ps.prototype.writeFeatures=ps.prototype.Ab;ps.prototype.writeFeaturesNode=ps.prototype.a;cs.prototype.readFeatures=cs.prototype.ta;
t("ol.events.condition.altKeyOnly",function(a){a=a.b;return a.a&&!a.l&&!a.f},OPENLAYERS);t("ol.events.condition.altShiftKeysOnly",Vk,OPENLAYERS);t("ol.events.condition.always",re,OPENLAYERS);t("ol.events.condition.click",function(a){return a.type==Rj},OPENLAYERS);t("ol.events.condition.never",qe,OPENLAYERS);t("ol.events.condition.pointerMove",Wk,OPENLAYERS);t("ol.events.condition.singleClick",Xk,OPENLAYERS);t("ol.events.condition.doubleClick",function(a){return a.type==Sj},OPENLAYERS);
t("ol.events.condition.noModifierKeys",Yk,OPENLAYERS);t("ol.events.condition.platformModifierKeyOnly",function(a){a=a.b;return!a.a&&a.l&&!a.f},OPENLAYERS);t("ol.events.condition.shiftKeyOnly",Zk,OPENLAYERS);t("ol.events.condition.targetNotEditable",$k,OPENLAYERS);t("ol.events.condition.mouseOnly",al,OPENLAYERS);t("ol.control.Attribution",Vh,OPENLAYERS);t("ol.control.Attribution.render",Wh,OPENLAYERS);Vh.prototype.getCollapsible=Vh.prototype.Rk;Vh.prototype.setCollapsible=Vh.prototype.Uk;
Vh.prototype.setCollapsed=Vh.prototype.Tk;Vh.prototype.getCollapsed=Vh.prototype.Qk;t("ol.control.Control",vh,OPENLAYERS);vh.prototype.getMap=vh.prototype.g;vh.prototype.setMap=vh.prototype.setMap;vh.prototype.setTarget=vh.prototype.f;t("ol.control.defaults",ai,OPENLAYERS);t("ol.control.FullScreen",fi,OPENLAYERS);t("ol.control.MousePosition",gi,OPENLAYERS);t("ol.control.MousePosition.render",hi,OPENLAYERS);gi.prototype.getCoordinateFormat=gi.prototype.Vf;gi.prototype.getProjection=gi.prototype.ug;
gi.prototype.setCoordinateFormat=gi.prototype.jh;gi.prototype.setProjection=gi.prototype.vg;t("ol.control.OverviewMap",ir,OPENLAYERS);t("ol.control.OverviewMap.render",jr,OPENLAYERS);ir.prototype.getCollapsible=ir.prototype.Xk;ir.prototype.setCollapsible=ir.prototype.$k;ir.prototype.setCollapsed=ir.prototype.Zk;ir.prototype.getCollapsed=ir.prototype.Wk;ir.prototype.getOverviewMap=ir.prototype.hj;t("ol.control.Rotate",Yh,OPENLAYERS);t("ol.control.Rotate.render",Zh,OPENLAYERS);
t("ol.control.ScaleLine",nr,OPENLAYERS);nr.prototype.getUnits=nr.prototype.O;t("ol.control.ScaleLine.render",or,OPENLAYERS);nr.prototype.setUnits=nr.prototype.Y;t("ol.control.Zoom",$h,OPENLAYERS);t("ol.control.ZoomSlider",Br,OPENLAYERS);t("ol.control.ZoomSlider.render",Dr,OPENLAYERS);t("ol.control.ZoomToExtent",Gr,OPENLAYERS);t("ol.color.asArray",yg,OPENLAYERS);t("ol.color.asString",Ag,OPENLAYERS);hd.prototype.changed=hd.prototype.u;hd.prototype.dispatchEvent=hd.prototype.s;
hd.prototype.getRevision=hd.prototype.L;hd.prototype.on=hd.prototype.G;hd.prototype.once=hd.prototype.M;hd.prototype.un=hd.prototype.K;hd.prototype.unByKey=hd.prototype.N;tg.prototype.get=tg.prototype.get;tg.prototype.getKeys=tg.prototype.P;tg.prototype.getProperties=tg.prototype.R;tg.prototype.set=tg.prototype.set;tg.prototype.setProperties=tg.prototype.I;tg.prototype.unset=tg.prototype.T;tg.prototype.changed=tg.prototype.u;tg.prototype.dispatchEvent=tg.prototype.s;tg.prototype.getRevision=tg.prototype.L;
tg.prototype.on=tg.prototype.G;tg.prototype.once=tg.prototype.M;tg.prototype.un=tg.prototype.K;tg.prototype.unByKey=tg.prototype.N;Hr.prototype.get=Hr.prototype.get;Hr.prototype.getKeys=Hr.prototype.P;Hr.prototype.getProperties=Hr.prototype.R;Hr.prototype.set=Hr.prototype.set;Hr.prototype.setProperties=Hr.prototype.I;Hr.prototype.unset=Hr.prototype.T;Hr.prototype.changed=Hr.prototype.u;Hr.prototype.dispatchEvent=Hr.prototype.s;Hr.prototype.getRevision=Hr.prototype.L;Hr.prototype.on=Hr.prototype.G;
Hr.prototype.once=Hr.prototype.M;Hr.prototype.un=Hr.prototype.K;Hr.prototype.unByKey=Hr.prototype.N;P.prototype.get=P.prototype.get;P.prototype.getKeys=P.prototype.P;P.prototype.getProperties=P.prototype.R;P.prototype.set=P.prototype.set;P.prototype.setProperties=P.prototype.I;P.prototype.unset=P.prototype.T;P.prototype.changed=P.prototype.u;P.prototype.dispatchEvent=P.prototype.s;P.prototype.getRevision=P.prototype.L;P.prototype.on=P.prototype.G;P.prototype.once=P.prototype.M;P.prototype.un=P.prototype.K;
P.prototype.unByKey=P.prototype.N;tx.prototype.get=tx.prototype.get;tx.prototype.getKeys=tx.prototype.P;tx.prototype.getProperties=tx.prototype.R;tx.prototype.set=tx.prototype.set;tx.prototype.setProperties=tx.prototype.I;tx.prototype.unset=tx.prototype.T;tx.prototype.changed=tx.prototype.u;tx.prototype.dispatchEvent=tx.prototype.s;tx.prototype.getRevision=tx.prototype.L;tx.prototype.on=tx.prototype.G;tx.prototype.once=tx.prototype.M;tx.prototype.un=tx.prototype.K;tx.prototype.unByKey=tx.prototype.N;
Dx.prototype.getTileCoord=Dx.prototype.j;V.prototype.get=V.prototype.get;V.prototype.getKeys=V.prototype.P;V.prototype.getProperties=V.prototype.R;V.prototype.set=V.prototype.set;V.prototype.setProperties=V.prototype.I;V.prototype.unset=V.prototype.T;V.prototype.changed=V.prototype.u;V.prototype.dispatchEvent=V.prototype.s;V.prototype.getRevision=V.prototype.L;V.prototype.on=V.prototype.G;V.prototype.once=V.prototype.M;V.prototype.un=V.prototype.K;V.prototype.unByKey=V.prototype.N;
Nj.prototype.map=Nj.prototype.map;Nj.prototype.frameState=Nj.prototype.frameState;Oj.prototype.originalEvent=Oj.prototype.originalEvent;Oj.prototype.pixel=Oj.prototype.pixel;Oj.prototype.coordinate=Oj.prototype.coordinate;Oj.prototype.dragging=Oj.prototype.dragging;Oj.prototype.preventDefault=Oj.prototype.preventDefault;Oj.prototype.stopPropagation=Oj.prototype.c;Oj.prototype.map=Oj.prototype.map;Oj.prototype.frameState=Oj.prototype.frameState;er.prototype.get=er.prototype.get;
er.prototype.getKeys=er.prototype.P;er.prototype.getProperties=er.prototype.R;er.prototype.set=er.prototype.set;er.prototype.setProperties=er.prototype.I;er.prototype.unset=er.prototype.T;er.prototype.changed=er.prototype.u;er.prototype.dispatchEvent=er.prototype.s;er.prototype.getRevision=er.prototype.L;er.prototype.on=er.prototype.G;er.prototype.once=er.prototype.M;er.prototype.un=er.prototype.K;er.prototype.unByKey=er.prototype.N;Of.prototype.get=Of.prototype.get;Of.prototype.getKeys=Of.prototype.P;
Of.prototype.getProperties=Of.prototype.R;Of.prototype.set=Of.prototype.set;Of.prototype.setProperties=Of.prototype.I;Of.prototype.unset=Of.prototype.T;Of.prototype.changed=Of.prototype.u;Of.prototype.dispatchEvent=Of.prototype.s;Of.prototype.getRevision=Of.prototype.L;Of.prototype.on=Of.prototype.G;Of.prototype.once=Of.prototype.M;Of.prototype.un=Of.prototype.K;Of.prototype.unByKey=Of.prototype.N;jA.prototype.getMaxZoom=jA.prototype.Zf;jA.prototype.getMinZoom=jA.prototype.$f;
jA.prototype.getOrigin=jA.prototype.ua;jA.prototype.getResolution=jA.prototype.ba;jA.prototype.getResolutions=jA.prototype.Pg;jA.prototype.getTileCoordExtent=jA.prototype.Ea;jA.prototype.getTileCoordForCoordAndResolution=jA.prototype.ad;jA.prototype.getTileCoordForCoordAndZ=jA.prototype.Md;jA.prototype.getTileSize=jA.prototype.La;cm.prototype.getOpacity=cm.prototype.ge;cm.prototype.getRotateWithView=cm.prototype.Jd;cm.prototype.getRotation=cm.prototype.he;cm.prototype.getScale=cm.prototype.ie;
cm.prototype.getSnapToPixel=cm.prototype.Ld;cm.prototype.setOpacity=cm.prototype.je;cm.prototype.setRotation=cm.prototype.ke;cm.prototype.setScale=cm.prototype.le;xk.prototype.getOpacity=xk.prototype.ge;xk.prototype.getRotateWithView=xk.prototype.Jd;xk.prototype.getRotation=xk.prototype.he;xk.prototype.getScale=xk.prototype.ie;xk.prototype.getSnapToPixel=xk.prototype.Ld;xk.prototype.setOpacity=xk.prototype.je;xk.prototype.setRotation=xk.prototype.ke;xk.prototype.setScale=xk.prototype.le;
tA.prototype.getOpacity=tA.prototype.ge;tA.prototype.getRotateWithView=tA.prototype.Jd;tA.prototype.getRotation=tA.prototype.he;tA.prototype.getScale=tA.prototype.ie;tA.prototype.getSnapToPixel=tA.prototype.Ld;tA.prototype.setOpacity=tA.prototype.je;tA.prototype.setRotation=tA.prototype.ke;tA.prototype.setScale=tA.prototype.le;Ch.prototype.get=Ch.prototype.get;Ch.prototype.getKeys=Ch.prototype.P;Ch.prototype.getProperties=Ch.prototype.R;Ch.prototype.set=Ch.prototype.set;
Ch.prototype.setProperties=Ch.prototype.I;Ch.prototype.unset=Ch.prototype.T;Ch.prototype.changed=Ch.prototype.u;Ch.prototype.dispatchEvent=Ch.prototype.s;Ch.prototype.getRevision=Ch.prototype.L;Ch.prototype.on=Ch.prototype.G;Ch.prototype.once=Ch.prototype.M;Ch.prototype.un=Ch.prototype.K;Ch.prototype.unByKey=Ch.prototype.N;Ph.prototype.getAttributions=Ph.prototype.na;Ph.prototype.getLogo=Ph.prototype.ma;Ph.prototype.getProjection=Ph.prototype.oa;Ph.prototype.getState=Ph.prototype.pa;
Ph.prototype.setAttributions=Ph.prototype.la;Ph.prototype.get=Ph.prototype.get;Ph.prototype.getKeys=Ph.prototype.P;Ph.prototype.getProperties=Ph.prototype.R;Ph.prototype.set=Ph.prototype.set;Ph.prototype.setProperties=Ph.prototype.I;Ph.prototype.unset=Ph.prototype.T;Ph.prototype.changed=Ph.prototype.u;Ph.prototype.dispatchEvent=Ph.prototype.s;Ph.prototype.getRevision=Ph.prototype.L;Ph.prototype.on=Ph.prototype.G;Ph.prototype.once=Ph.prototype.M;Ph.prototype.un=Ph.prototype.K;
Ph.prototype.unByKey=Ph.prototype.N;rz.prototype.getTileGrid=rz.prototype.Fa;rz.prototype.getAttributions=rz.prototype.na;rz.prototype.getLogo=rz.prototype.ma;rz.prototype.getProjection=rz.prototype.oa;rz.prototype.getState=rz.prototype.pa;rz.prototype.setAttributions=rz.prototype.la;rz.prototype.get=rz.prototype.get;rz.prototype.getKeys=rz.prototype.P;rz.prototype.getProperties=rz.prototype.R;rz.prototype.set=rz.prototype.set;rz.prototype.setProperties=rz.prototype.I;rz.prototype.unset=rz.prototype.T;
rz.prototype.changed=rz.prototype.u;rz.prototype.dispatchEvent=rz.prototype.s;rz.prototype.getRevision=rz.prototype.L;rz.prototype.on=rz.prototype.G;rz.prototype.once=rz.prototype.M;rz.prototype.un=rz.prototype.K;rz.prototype.unByKey=rz.prototype.N;tz.prototype.getTileLoadFunction=tz.prototype.ab;tz.prototype.getTileUrlFunction=tz.prototype.bb;tz.prototype.setTileLoadFunction=tz.prototype.gb;tz.prototype.setTileUrlFunction=tz.prototype.Ja;tz.prototype.getTileGrid=tz.prototype.Fa;
tz.prototype.getAttributions=tz.prototype.na;tz.prototype.getLogo=tz.prototype.ma;tz.prototype.getProjection=tz.prototype.oa;tz.prototype.getState=tz.prototype.pa;tz.prototype.setAttributions=tz.prototype.la;tz.prototype.get=tz.prototype.get;tz.prototype.getKeys=tz.prototype.P;tz.prototype.getProperties=tz.prototype.R;tz.prototype.set=tz.prototype.set;tz.prototype.setProperties=tz.prototype.I;tz.prototype.unset=tz.prototype.T;tz.prototype.changed=tz.prototype.u;tz.prototype.dispatchEvent=tz.prototype.s;
tz.prototype.getRevision=tz.prototype.L;tz.prototype.on=tz.prototype.G;tz.prototype.once=tz.prototype.M;tz.prototype.un=tz.prototype.K;tz.prototype.unByKey=tz.prototype.N;U.prototype.getAttributions=U.prototype.na;U.prototype.getLogo=U.prototype.ma;U.prototype.getProjection=U.prototype.oa;U.prototype.getState=U.prototype.pa;U.prototype.setAttributions=U.prototype.la;U.prototype.get=U.prototype.get;U.prototype.getKeys=U.prototype.P;U.prototype.getProperties=U.prototype.R;U.prototype.set=U.prototype.set;
U.prototype.setProperties=U.prototype.I;U.prototype.unset=U.prototype.T;U.prototype.changed=U.prototype.u;U.prototype.dispatchEvent=U.prototype.s;U.prototype.getRevision=U.prototype.L;U.prototype.on=U.prototype.G;U.prototype.once=U.prototype.M;U.prototype.un=U.prototype.K;U.prototype.unByKey=U.prototype.N;Y.prototype.addFeature=Y.prototype.Ac;Y.prototype.addFeatures=Y.prototype.Qb;Y.prototype.clear=Y.prototype.clear;Y.prototype.forEachFeature=Y.prototype.Pe;Y.prototype.forEachFeatureInExtent=Y.prototype.uc;
Y.prototype.forEachFeatureIntersectingExtent=Y.prototype.Qe;Y.prototype.getFeaturesCollection=Y.prototype.Ve;Y.prototype.getFeatures=Y.prototype.Bc;Y.prototype.getFeaturesAtCoordinate=Y.prototype.Ue;Y.prototype.getFeaturesInExtent=Y.prototype.Dd;Y.prototype.getClosestFeatureToCoordinate=Y.prototype.Se;Y.prototype.getExtent=Y.prototype.S;Y.prototype.getFeatureById=Y.prototype.Te;Y.prototype.removeFeature=Y.prototype.fc;Y.prototype.getAttributions=Y.prototype.na;Y.prototype.getLogo=Y.prototype.ma;
Y.prototype.getProjection=Y.prototype.oa;Y.prototype.getState=Y.prototype.pa;Y.prototype.setAttributions=Y.prototype.la;Y.prototype.get=Y.prototype.get;Y.prototype.getKeys=Y.prototype.P;Y.prototype.getProperties=Y.prototype.R;Y.prototype.set=Y.prototype.set;Y.prototype.setProperties=Y.prototype.I;Y.prototype.unset=Y.prototype.T;Y.prototype.changed=Y.prototype.u;Y.prototype.dispatchEvent=Y.prototype.s;Y.prototype.getRevision=Y.prototype.L;Y.prototype.on=Y.prototype.G;Y.prototype.once=Y.prototype.M;
Y.prototype.un=Y.prototype.K;Y.prototype.unByKey=Y.prototype.N;rn.prototype.getAttributions=rn.prototype.na;rn.prototype.getLogo=rn.prototype.ma;rn.prototype.getProjection=rn.prototype.oa;rn.prototype.getState=rn.prototype.pa;rn.prototype.setAttributions=rn.prototype.la;rn.prototype.get=rn.prototype.get;rn.prototype.getKeys=rn.prototype.P;rn.prototype.getProperties=rn.prototype.R;rn.prototype.set=rn.prototype.set;rn.prototype.setProperties=rn.prototype.I;rn.prototype.unset=rn.prototype.T;
rn.prototype.changed=rn.prototype.u;rn.prototype.dispatchEvent=rn.prototype.s;rn.prototype.getRevision=rn.prototype.L;rn.prototype.on=rn.prototype.G;rn.prototype.once=rn.prototype.M;rn.prototype.un=rn.prototype.K;rn.prototype.unByKey=rn.prototype.N;yn.prototype.getAttributions=yn.prototype.na;yn.prototype.getLogo=yn.prototype.ma;yn.prototype.getProjection=yn.prototype.oa;yn.prototype.getState=yn.prototype.pa;yn.prototype.setAttributions=yn.prototype.la;yn.prototype.get=yn.prototype.get;
yn.prototype.getKeys=yn.prototype.P;yn.prototype.getProperties=yn.prototype.R;yn.prototype.set=yn.prototype.set;yn.prototype.setProperties=yn.prototype.I;yn.prototype.unset=yn.prototype.T;yn.prototype.changed=yn.prototype.u;yn.prototype.dispatchEvent=yn.prototype.s;yn.prototype.getRevision=yn.prototype.L;yn.prototype.on=yn.prototype.G;yn.prototype.once=yn.prototype.M;yn.prototype.un=yn.prototype.K;yn.prototype.unByKey=yn.prototype.N;xz.prototype.getAttributions=xz.prototype.na;
xz.prototype.getLogo=xz.prototype.ma;xz.prototype.getProjection=xz.prototype.oa;xz.prototype.getState=xz.prototype.pa;xz.prototype.setAttributions=xz.prototype.la;xz.prototype.get=xz.prototype.get;xz.prototype.getKeys=xz.prototype.P;xz.prototype.getProperties=xz.prototype.R;xz.prototype.set=xz.prototype.set;xz.prototype.setProperties=xz.prototype.I;xz.prototype.unset=xz.prototype.T;xz.prototype.changed=xz.prototype.u;xz.prototype.dispatchEvent=xz.prototype.s;xz.prototype.getRevision=xz.prototype.L;
xz.prototype.on=xz.prototype.G;xz.prototype.once=xz.prototype.M;xz.prototype.un=xz.prototype.K;xz.prototype.unByKey=xz.prototype.N;yz.prototype.getAttributions=yz.prototype.na;yz.prototype.getLogo=yz.prototype.ma;yz.prototype.getProjection=yz.prototype.oa;yz.prototype.getState=yz.prototype.pa;yz.prototype.setAttributions=yz.prototype.la;yz.prototype.get=yz.prototype.get;yz.prototype.getKeys=yz.prototype.P;yz.prototype.getProperties=yz.prototype.R;yz.prototype.set=yz.prototype.set;
yz.prototype.setProperties=yz.prototype.I;yz.prototype.unset=yz.prototype.T;yz.prototype.changed=yz.prototype.u;yz.prototype.dispatchEvent=yz.prototype.s;yz.prototype.getRevision=yz.prototype.L;yz.prototype.on=yz.prototype.G;yz.prototype.once=yz.prototype.M;yz.prototype.un=yz.prototype.K;yz.prototype.unByKey=yz.prototype.N;Qp.prototype.getAttributions=Qp.prototype.na;Qp.prototype.getLogo=Qp.prototype.ma;Qp.prototype.getProjection=Qp.prototype.oa;Qp.prototype.getState=Qp.prototype.pa;
Qp.prototype.setAttributions=Qp.prototype.la;Qp.prototype.get=Qp.prototype.get;Qp.prototype.getKeys=Qp.prototype.P;Qp.prototype.getProperties=Qp.prototype.R;Qp.prototype.set=Qp.prototype.set;Qp.prototype.setProperties=Qp.prototype.I;Qp.prototype.unset=Qp.prototype.T;Qp.prototype.changed=Qp.prototype.u;Qp.prototype.dispatchEvent=Qp.prototype.s;Qp.prototype.getRevision=Qp.prototype.L;Qp.prototype.on=Qp.prototype.G;Qp.prototype.once=Qp.prototype.M;Qp.prototype.un=Qp.prototype.K;
Qp.prototype.unByKey=Qp.prototype.N;zz.prototype.getAttributions=zz.prototype.na;zz.prototype.getLogo=zz.prototype.ma;zz.prototype.getProjection=zz.prototype.oa;zz.prototype.getState=zz.prototype.pa;zz.prototype.setAttributions=zz.prototype.la;zz.prototype.get=zz.prototype.get;zz.prototype.getKeys=zz.prototype.P;zz.prototype.getProperties=zz.prototype.R;zz.prototype.set=zz.prototype.set;zz.prototype.setProperties=zz.prototype.I;zz.prototype.unset=zz.prototype.T;zz.prototype.changed=zz.prototype.u;
zz.prototype.dispatchEvent=zz.prototype.s;zz.prototype.getRevision=zz.prototype.L;zz.prototype.on=zz.prototype.G;zz.prototype.once=zz.prototype.M;zz.prototype.un=zz.prototype.K;zz.prototype.unByKey=zz.prototype.N;Dz.prototype.getTileLoadFunction=Dz.prototype.ab;Dz.prototype.getTileUrlFunction=Dz.prototype.bb;Dz.prototype.setTileLoadFunction=Dz.prototype.gb;Dz.prototype.setTileUrlFunction=Dz.prototype.Ja;Dz.prototype.getTileGrid=Dz.prototype.Fa;Dz.prototype.getAttributions=Dz.prototype.na;
Dz.prototype.getLogo=Dz.prototype.ma;Dz.prototype.getProjection=Dz.prototype.oa;Dz.prototype.getState=Dz.prototype.pa;Dz.prototype.setAttributions=Dz.prototype.la;Dz.prototype.get=Dz.prototype.get;Dz.prototype.getKeys=Dz.prototype.P;Dz.prototype.getProperties=Dz.prototype.R;Dz.prototype.set=Dz.prototype.set;Dz.prototype.setProperties=Dz.prototype.I;Dz.prototype.unset=Dz.prototype.T;Dz.prototype.changed=Dz.prototype.u;Dz.prototype.dispatchEvent=Dz.prototype.s;Dz.prototype.getRevision=Dz.prototype.L;
Dz.prototype.on=Dz.prototype.G;Dz.prototype.once=Dz.prototype.M;Dz.prototype.un=Dz.prototype.K;Dz.prototype.unByKey=Dz.prototype.N;Gz.prototype.getUrls=Gz.prototype.g;Gz.prototype.setUrl=Gz.prototype.f;Gz.prototype.getTileLoadFunction=Gz.prototype.ab;Gz.prototype.getTileUrlFunction=Gz.prototype.bb;Gz.prototype.setTileLoadFunction=Gz.prototype.gb;Gz.prototype.setTileUrlFunction=Gz.prototype.Ja;Gz.prototype.getTileGrid=Gz.prototype.Fa;Gz.prototype.getAttributions=Gz.prototype.na;
Gz.prototype.getLogo=Gz.prototype.ma;Gz.prototype.getProjection=Gz.prototype.oa;Gz.prototype.getState=Gz.prototype.pa;Gz.prototype.setAttributions=Gz.prototype.la;Gz.prototype.get=Gz.prototype.get;Gz.prototype.getKeys=Gz.prototype.P;Gz.prototype.getProperties=Gz.prototype.R;Gz.prototype.set=Gz.prototype.set;Gz.prototype.setProperties=Gz.prototype.I;Gz.prototype.unset=Gz.prototype.T;Gz.prototype.changed=Gz.prototype.u;Gz.prototype.dispatchEvent=Gz.prototype.s;Gz.prototype.getRevision=Gz.prototype.L;
Gz.prototype.on=Gz.prototype.G;Gz.prototype.once=Gz.prototype.M;Gz.prototype.un=Gz.prototype.K;Gz.prototype.unByKey=Gz.prototype.N;Ez.prototype.getUrls=Ez.prototype.g;Ez.prototype.setUrl=Ez.prototype.f;Ez.prototype.getTileLoadFunction=Ez.prototype.ab;Ez.prototype.getTileUrlFunction=Ez.prototype.bb;Ez.prototype.setTileLoadFunction=Ez.prototype.gb;Ez.prototype.setTileUrlFunction=Ez.prototype.Ja;Ez.prototype.getTileGrid=Ez.prototype.Fa;Ez.prototype.getAttributions=Ez.prototype.na;
Ez.prototype.getLogo=Ez.prototype.ma;Ez.prototype.getProjection=Ez.prototype.oa;Ez.prototype.getState=Ez.prototype.pa;Ez.prototype.setAttributions=Ez.prototype.la;Ez.prototype.get=Ez.prototype.get;Ez.prototype.getKeys=Ez.prototype.P;Ez.prototype.getProperties=Ez.prototype.R;Ez.prototype.set=Ez.prototype.set;Ez.prototype.setProperties=Ez.prototype.I;Ez.prototype.unset=Ez.prototype.T;Ez.prototype.changed=Ez.prototype.u;Ez.prototype.dispatchEvent=Ez.prototype.s;Ez.prototype.getRevision=Ez.prototype.L;
Ez.prototype.on=Ez.prototype.G;Ez.prototype.once=Ez.prototype.M;Ez.prototype.un=Ez.prototype.K;Ez.prototype.unByKey=Ez.prototype.N;Jz.prototype.getAttributions=Jz.prototype.na;Jz.prototype.getLogo=Jz.prototype.ma;Jz.prototype.getProjection=Jz.prototype.oa;Jz.prototype.getState=Jz.prototype.pa;Jz.prototype.setAttributions=Jz.prototype.la;Jz.prototype.get=Jz.prototype.get;Jz.prototype.getKeys=Jz.prototype.P;Jz.prototype.getProperties=Jz.prototype.R;Jz.prototype.set=Jz.prototype.set;
Jz.prototype.setProperties=Jz.prototype.I;Jz.prototype.unset=Jz.prototype.T;Jz.prototype.changed=Jz.prototype.u;Jz.prototype.dispatchEvent=Jz.prototype.s;Jz.prototype.getRevision=Jz.prototype.L;Jz.prototype.on=Jz.prototype.G;Jz.prototype.once=Jz.prototype.M;Jz.prototype.un=Jz.prototype.K;Jz.prototype.unByKey=Jz.prototype.N;Tz.prototype.getUrls=Tz.prototype.g;Tz.prototype.setUrl=Tz.prototype.f;Tz.prototype.getTileLoadFunction=Tz.prototype.ab;Tz.prototype.getTileUrlFunction=Tz.prototype.bb;
Tz.prototype.setTileLoadFunction=Tz.prototype.gb;Tz.prototype.setTileUrlFunction=Tz.prototype.Ja;Tz.prototype.getTileGrid=Tz.prototype.Fa;Tz.prototype.getAttributions=Tz.prototype.na;Tz.prototype.getLogo=Tz.prototype.ma;Tz.prototype.getProjection=Tz.prototype.oa;Tz.prototype.getState=Tz.prototype.pa;Tz.prototype.setAttributions=Tz.prototype.la;Tz.prototype.get=Tz.prototype.get;Tz.prototype.getKeys=Tz.prototype.P;Tz.prototype.getProperties=Tz.prototype.R;Tz.prototype.set=Tz.prototype.set;
Tz.prototype.setProperties=Tz.prototype.I;Tz.prototype.unset=Tz.prototype.T;Tz.prototype.changed=Tz.prototype.u;Tz.prototype.dispatchEvent=Tz.prototype.s;Tz.prototype.getRevision=Tz.prototype.L;Tz.prototype.on=Tz.prototype.G;Tz.prototype.once=Tz.prototype.M;Tz.prototype.un=Tz.prototype.K;Tz.prototype.unByKey=Tz.prototype.N;Vz.prototype.getTileLoadFunction=Vz.prototype.ab;Vz.prototype.getTileUrlFunction=Vz.prototype.bb;Vz.prototype.setTileLoadFunction=Vz.prototype.gb;
Vz.prototype.setTileUrlFunction=Vz.prototype.Ja;Vz.prototype.getTileGrid=Vz.prototype.Fa;Vz.prototype.getAttributions=Vz.prototype.na;Vz.prototype.getLogo=Vz.prototype.ma;Vz.prototype.getProjection=Vz.prototype.oa;Vz.prototype.getState=Vz.prototype.pa;Vz.prototype.setAttributions=Vz.prototype.la;Vz.prototype.get=Vz.prototype.get;Vz.prototype.getKeys=Vz.prototype.P;Vz.prototype.getProperties=Vz.prototype.R;Vz.prototype.set=Vz.prototype.set;Vz.prototype.setProperties=Vz.prototype.I;
Vz.prototype.unset=Vz.prototype.T;Vz.prototype.changed=Vz.prototype.u;Vz.prototype.dispatchEvent=Vz.prototype.s;Vz.prototype.getRevision=Vz.prototype.L;Vz.prototype.on=Vz.prototype.G;Vz.prototype.once=Vz.prototype.M;Vz.prototype.un=Vz.prototype.K;Vz.prototype.unByKey=Vz.prototype.N;Xz.prototype.getTileGrid=Xz.prototype.Fa;Xz.prototype.getAttributions=Xz.prototype.na;Xz.prototype.getLogo=Xz.prototype.ma;Xz.prototype.getProjection=Xz.prototype.oa;Xz.prototype.getState=Xz.prototype.pa;
Xz.prototype.setAttributions=Xz.prototype.la;Xz.prototype.get=Xz.prototype.get;Xz.prototype.getKeys=Xz.prototype.P;Xz.prototype.getProperties=Xz.prototype.R;Xz.prototype.set=Xz.prototype.set;Xz.prototype.setProperties=Xz.prototype.I;Xz.prototype.unset=Xz.prototype.T;Xz.prototype.changed=Xz.prototype.u;Xz.prototype.dispatchEvent=Xz.prototype.s;Xz.prototype.getRevision=Xz.prototype.L;Xz.prototype.on=Xz.prototype.G;Xz.prototype.once=Xz.prototype.M;Xz.prototype.un=Xz.prototype.K;
Xz.prototype.unByKey=Xz.prototype.N;Yz.prototype.getTileLoadFunction=Yz.prototype.ab;Yz.prototype.getTileUrlFunction=Yz.prototype.bb;Yz.prototype.setTileLoadFunction=Yz.prototype.gb;Yz.prototype.setTileUrlFunction=Yz.prototype.Ja;Yz.prototype.getTileGrid=Yz.prototype.Fa;Yz.prototype.getAttributions=Yz.prototype.na;Yz.prototype.getLogo=Yz.prototype.ma;Yz.prototype.getProjection=Yz.prototype.oa;Yz.prototype.getState=Yz.prototype.pa;Yz.prototype.setAttributions=Yz.prototype.la;Yz.prototype.get=Yz.prototype.get;
Yz.prototype.getKeys=Yz.prototype.P;Yz.prototype.getProperties=Yz.prototype.R;Yz.prototype.set=Yz.prototype.set;Yz.prototype.setProperties=Yz.prototype.I;Yz.prototype.unset=Yz.prototype.T;Yz.prototype.changed=Yz.prototype.u;Yz.prototype.dispatchEvent=Yz.prototype.s;Yz.prototype.getRevision=Yz.prototype.L;Yz.prototype.on=Yz.prototype.G;Yz.prototype.once=Yz.prototype.M;Yz.prototype.un=Yz.prototype.K;Yz.prototype.unByKey=Yz.prototype.N;Zz.prototype.getTileGrid=Zz.prototype.Fa;
Zz.prototype.getAttributions=Zz.prototype.na;Zz.prototype.getLogo=Zz.prototype.ma;Zz.prototype.getProjection=Zz.prototype.oa;Zz.prototype.getState=Zz.prototype.pa;Zz.prototype.setAttributions=Zz.prototype.la;Zz.prototype.get=Zz.prototype.get;Zz.prototype.getKeys=Zz.prototype.P;Zz.prototype.getProperties=Zz.prototype.R;Zz.prototype.set=Zz.prototype.set;Zz.prototype.setProperties=Zz.prototype.I;Zz.prototype.unset=Zz.prototype.T;Zz.prototype.changed=Zz.prototype.u;Zz.prototype.dispatchEvent=Zz.prototype.s;
Zz.prototype.getRevision=Zz.prototype.L;Zz.prototype.on=Zz.prototype.G;Zz.prototype.once=Zz.prototype.M;Zz.prototype.un=Zz.prototype.K;Zz.prototype.unByKey=Zz.prototype.N;Z.prototype.addFeature=Z.prototype.Ac;Z.prototype.addFeatures=Z.prototype.Qb;Z.prototype.clear=Z.prototype.clear;Z.prototype.forEachFeature=Z.prototype.Pe;Z.prototype.forEachFeatureInExtent=Z.prototype.uc;Z.prototype.forEachFeatureIntersectingExtent=Z.prototype.Qe;Z.prototype.getFeaturesCollection=Z.prototype.Ve;
Z.prototype.getFeatures=Z.prototype.Bc;Z.prototype.getFeaturesAtCoordinate=Z.prototype.Ue;Z.prototype.getFeaturesInExtent=Z.prototype.Dd;Z.prototype.getClosestFeatureToCoordinate=Z.prototype.Se;Z.prototype.getExtent=Z.prototype.S;Z.prototype.getFeatureById=Z.prototype.Te;Z.prototype.removeFeature=Z.prototype.fc;Z.prototype.getAttributions=Z.prototype.na;Z.prototype.getLogo=Z.prototype.ma;Z.prototype.getProjection=Z.prototype.oa;Z.prototype.getState=Z.prototype.pa;Z.prototype.setAttributions=Z.prototype.la;
Z.prototype.get=Z.prototype.get;Z.prototype.getKeys=Z.prototype.P;Z.prototype.getProperties=Z.prototype.R;Z.prototype.set=Z.prototype.set;Z.prototype.setProperties=Z.prototype.I;Z.prototype.unset=Z.prototype.T;Z.prototype.changed=Z.prototype.u;Z.prototype.dispatchEvent=Z.prototype.s;Z.prototype.getRevision=Z.prototype.L;Z.prototype.on=Z.prototype.G;Z.prototype.once=Z.prototype.M;Z.prototype.un=Z.prototype.K;Z.prototype.unByKey=Z.prototype.N;fA.prototype.getTileLoadFunction=fA.prototype.ab;
fA.prototype.getTileUrlFunction=fA.prototype.bb;fA.prototype.setTileLoadFunction=fA.prototype.gb;fA.prototype.setTileUrlFunction=fA.prototype.Ja;fA.prototype.getTileGrid=fA.prototype.Fa;fA.prototype.getAttributions=fA.prototype.na;fA.prototype.getLogo=fA.prototype.ma;fA.prototype.getProjection=fA.prototype.oa;fA.prototype.getState=fA.prototype.pa;fA.prototype.setAttributions=fA.prototype.la;fA.prototype.get=fA.prototype.get;fA.prototype.getKeys=fA.prototype.P;fA.prototype.getProperties=fA.prototype.R;
fA.prototype.set=fA.prototype.set;fA.prototype.setProperties=fA.prototype.I;fA.prototype.unset=fA.prototype.T;fA.prototype.changed=fA.prototype.u;fA.prototype.dispatchEvent=fA.prototype.s;fA.prototype.getRevision=fA.prototype.L;fA.prototype.on=fA.prototype.G;fA.prototype.once=fA.prototype.M;fA.prototype.un=fA.prototype.K;fA.prototype.unByKey=fA.prototype.N;lA.prototype.getTileLoadFunction=lA.prototype.ab;lA.prototype.getTileUrlFunction=lA.prototype.bb;lA.prototype.setTileLoadFunction=lA.prototype.gb;
lA.prototype.setTileUrlFunction=lA.prototype.Ja;lA.prototype.getTileGrid=lA.prototype.Fa;lA.prototype.getAttributions=lA.prototype.na;lA.prototype.getLogo=lA.prototype.ma;lA.prototype.getProjection=lA.prototype.oa;lA.prototype.getState=lA.prototype.pa;lA.prototype.setAttributions=lA.prototype.la;lA.prototype.get=lA.prototype.get;lA.prototype.getKeys=lA.prototype.P;lA.prototype.getProperties=lA.prototype.R;lA.prototype.set=lA.prototype.set;lA.prototype.setProperties=lA.prototype.I;
lA.prototype.unset=lA.prototype.T;lA.prototype.changed=lA.prototype.u;lA.prototype.dispatchEvent=lA.prototype.s;lA.prototype.getRevision=lA.prototype.L;lA.prototype.on=lA.prototype.G;lA.prototype.once=lA.prototype.M;lA.prototype.un=lA.prototype.K;lA.prototype.unByKey=lA.prototype.N;nA.prototype.getTileLoadFunction=nA.prototype.ab;nA.prototype.getTileUrlFunction=nA.prototype.bb;nA.prototype.setTileLoadFunction=nA.prototype.gb;nA.prototype.setTileUrlFunction=nA.prototype.Ja;
nA.prototype.getTileGrid=nA.prototype.Fa;nA.prototype.getAttributions=nA.prototype.na;nA.prototype.getLogo=nA.prototype.ma;nA.prototype.getProjection=nA.prototype.oa;nA.prototype.getState=nA.prototype.pa;nA.prototype.setAttributions=nA.prototype.la;nA.prototype.get=nA.prototype.get;nA.prototype.getKeys=nA.prototype.P;nA.prototype.getProperties=nA.prototype.R;nA.prototype.set=nA.prototype.set;nA.prototype.setProperties=nA.prototype.I;nA.prototype.unset=nA.prototype.T;nA.prototype.changed=nA.prototype.u;
nA.prototype.dispatchEvent=nA.prototype.s;nA.prototype.getRevision=nA.prototype.L;nA.prototype.on=nA.prototype.G;nA.prototype.once=nA.prototype.M;nA.prototype.un=nA.prototype.K;nA.prototype.unByKey=nA.prototype.N;mk.prototype.changed=mk.prototype.u;mk.prototype.dispatchEvent=mk.prototype.s;mk.prototype.getRevision=mk.prototype.L;mk.prototype.on=mk.prototype.G;mk.prototype.once=mk.prototype.M;mk.prototype.un=mk.prototype.K;mk.prototype.unByKey=mk.prototype.N;Oq.prototype.changed=Oq.prototype.u;
Oq.prototype.dispatchEvent=Oq.prototype.s;Oq.prototype.getRevision=Oq.prototype.L;Oq.prototype.on=Oq.prototype.G;Oq.prototype.once=Oq.prototype.M;Oq.prototype.un=Oq.prototype.K;Oq.prototype.unByKey=Oq.prototype.N;Rq.prototype.changed=Rq.prototype.u;Rq.prototype.dispatchEvent=Rq.prototype.s;Rq.prototype.getRevision=Rq.prototype.L;Rq.prototype.on=Rq.prototype.G;Rq.prototype.once=Rq.prototype.M;Rq.prototype.un=Rq.prototype.K;Rq.prototype.unByKey=Rq.prototype.N;Xq.prototype.changed=Xq.prototype.u;
Xq.prototype.dispatchEvent=Xq.prototype.s;Xq.prototype.getRevision=Xq.prototype.L;Xq.prototype.on=Xq.prototype.G;Xq.prototype.once=Xq.prototype.M;Xq.prototype.un=Xq.prototype.K;Xq.prototype.unByKey=Xq.prototype.N;Zq.prototype.changed=Zq.prototype.u;Zq.prototype.dispatchEvent=Zq.prototype.s;Zq.prototype.getRevision=Zq.prototype.L;Zq.prototype.on=Zq.prototype.G;Zq.prototype.once=Zq.prototype.M;Zq.prototype.un=Zq.prototype.K;Zq.prototype.unByKey=Zq.prototype.N;Xp.prototype.changed=Xp.prototype.u;
Xp.prototype.dispatchEvent=Xp.prototype.s;Xp.prototype.getRevision=Xp.prototype.L;Xp.prototype.on=Xp.prototype.G;Xp.prototype.once=Xp.prototype.M;Xp.prototype.un=Xp.prototype.K;Xp.prototype.unByKey=Xp.prototype.N;Yp.prototype.changed=Yp.prototype.u;Yp.prototype.dispatchEvent=Yp.prototype.s;Yp.prototype.getRevision=Yp.prototype.L;Yp.prototype.on=Yp.prototype.G;Yp.prototype.once=Yp.prototype.M;Yp.prototype.un=Yp.prototype.K;Yp.prototype.unByKey=Yp.prototype.N;Zp.prototype.changed=Zp.prototype.u;
Zp.prototype.dispatchEvent=Zp.prototype.s;Zp.prototype.getRevision=Zp.prototype.L;Zp.prototype.on=Zp.prototype.G;Zp.prototype.once=Zp.prototype.M;Zp.prototype.un=Zp.prototype.K;Zp.prototype.unByKey=Zp.prototype.N;aq.prototype.changed=aq.prototype.u;aq.prototype.dispatchEvent=aq.prototype.s;aq.prototype.getRevision=aq.prototype.L;aq.prototype.on=aq.prototype.G;aq.prototype.once=aq.prototype.M;aq.prototype.un=aq.prototype.K;aq.prototype.unByKey=aq.prototype.N;xm.prototype.changed=xm.prototype.u;
xm.prototype.dispatchEvent=xm.prototype.s;xm.prototype.getRevision=xm.prototype.L;xm.prototype.on=xm.prototype.G;xm.prototype.once=xm.prototype.M;xm.prototype.un=xm.prototype.K;xm.prototype.unByKey=xm.prototype.N;Sp.prototype.changed=Sp.prototype.u;Sp.prototype.dispatchEvent=Sp.prototype.s;Sp.prototype.getRevision=Sp.prototype.L;Sp.prototype.on=Sp.prototype.G;Sp.prototype.once=Sp.prototype.M;Sp.prototype.un=Sp.prototype.K;Sp.prototype.unByKey=Sp.prototype.N;Tp.prototype.changed=Tp.prototype.u;
Tp.prototype.dispatchEvent=Tp.prototype.s;Tp.prototype.getRevision=Tp.prototype.L;Tp.prototype.on=Tp.prototype.G;Tp.prototype.once=Tp.prototype.M;Tp.prototype.un=Tp.prototype.K;Tp.prototype.unByKey=Tp.prototype.N;Up.prototype.changed=Up.prototype.u;Up.prototype.dispatchEvent=Up.prototype.s;Up.prototype.getRevision=Up.prototype.L;Up.prototype.on=Up.prototype.G;Up.prototype.once=Up.prototype.M;Up.prototype.un=Up.prototype.K;Up.prototype.unByKey=Up.prototype.N;bk.prototype.get=bk.prototype.get;
bk.prototype.getKeys=bk.prototype.P;bk.prototype.getProperties=bk.prototype.R;bk.prototype.set=bk.prototype.set;bk.prototype.setProperties=bk.prototype.I;bk.prototype.unset=bk.prototype.T;bk.prototype.changed=bk.prototype.u;bk.prototype.dispatchEvent=bk.prototype.s;bk.prototype.getRevision=bk.prototype.L;bk.prototype.on=bk.prototype.G;bk.prototype.once=bk.prototype.M;bk.prototype.un=bk.prototype.K;bk.prototype.unByKey=bk.prototype.N;fk.prototype.getExtent=fk.prototype.S;
fk.prototype.getMaxResolution=fk.prototype.Fb;fk.prototype.getMinResolution=fk.prototype.Gb;fk.prototype.getOpacity=fk.prototype.Kb;fk.prototype.getVisible=fk.prototype.mb;fk.prototype.getZIndex=fk.prototype.Lb;fk.prototype.setExtent=fk.prototype.$b;fk.prototype.setMaxResolution=fk.prototype.ic;fk.prototype.setMinResolution=fk.prototype.jc;fk.prototype.setOpacity=fk.prototype.ac;fk.prototype.setVisible=fk.prototype.bc;fk.prototype.setZIndex=fk.prototype.cc;fk.prototype.get=fk.prototype.get;
fk.prototype.getKeys=fk.prototype.P;fk.prototype.getProperties=fk.prototype.R;fk.prototype.set=fk.prototype.set;fk.prototype.setProperties=fk.prototype.I;fk.prototype.unset=fk.prototype.T;fk.prototype.changed=fk.prototype.u;fk.prototype.dispatchEvent=fk.prototype.s;fk.prototype.getRevision=fk.prototype.L;fk.prototype.on=fk.prototype.G;fk.prototype.once=fk.prototype.M;fk.prototype.un=fk.prototype.K;fk.prototype.unByKey=fk.prototype.N;G.prototype.setMap=G.prototype.setMap;G.prototype.setSource=G.prototype.Gc;
G.prototype.getExtent=G.prototype.S;G.prototype.getMaxResolution=G.prototype.Fb;G.prototype.getMinResolution=G.prototype.Gb;G.prototype.getOpacity=G.prototype.Kb;G.prototype.getVisible=G.prototype.mb;G.prototype.getZIndex=G.prototype.Lb;G.prototype.setExtent=G.prototype.$b;G.prototype.setMaxResolution=G.prototype.ic;G.prototype.setMinResolution=G.prototype.jc;G.prototype.setOpacity=G.prototype.ac;G.prototype.setVisible=G.prototype.bc;G.prototype.setZIndex=G.prototype.cc;G.prototype.get=G.prototype.get;
G.prototype.getKeys=G.prototype.P;G.prototype.getProperties=G.prototype.R;G.prototype.set=G.prototype.set;G.prototype.setProperties=G.prototype.I;G.prototype.unset=G.prototype.T;G.prototype.changed=G.prototype.u;G.prototype.dispatchEvent=G.prototype.s;G.prototype.getRevision=G.prototype.L;G.prototype.on=G.prototype.G;G.prototype.once=G.prototype.M;G.prototype.un=G.prototype.K;G.prototype.unByKey=G.prototype.N;X.prototype.getSource=X.prototype.fa;X.prototype.getStyle=X.prototype.U;
X.prototype.getStyleFunction=X.prototype.Y;X.prototype.setStyle=X.prototype.g;X.prototype.setMap=X.prototype.setMap;X.prototype.setSource=X.prototype.Gc;X.prototype.getExtent=X.prototype.S;X.prototype.getMaxResolution=X.prototype.Fb;X.prototype.getMinResolution=X.prototype.Gb;X.prototype.getOpacity=X.prototype.Kb;X.prototype.getVisible=X.prototype.mb;X.prototype.getZIndex=X.prototype.Lb;X.prototype.setExtent=X.prototype.$b;X.prototype.setMaxResolution=X.prototype.ic;X.prototype.setMinResolution=X.prototype.jc;
X.prototype.setOpacity=X.prototype.ac;X.prototype.setVisible=X.prototype.bc;X.prototype.setZIndex=X.prototype.cc;X.prototype.get=X.prototype.get;X.prototype.getKeys=X.prototype.P;X.prototype.getProperties=X.prototype.R;X.prototype.set=X.prototype.set;X.prototype.setProperties=X.prototype.I;X.prototype.unset=X.prototype.T;X.prototype.changed=X.prototype.u;X.prototype.dispatchEvent=X.prototype.s;X.prototype.getRevision=X.prototype.L;X.prototype.on=X.prototype.G;X.prototype.once=X.prototype.M;
X.prototype.un=X.prototype.K;X.prototype.unByKey=X.prototype.N;Tl.prototype.setMap=Tl.prototype.setMap;Tl.prototype.setSource=Tl.prototype.Gc;Tl.prototype.getExtent=Tl.prototype.S;Tl.prototype.getMaxResolution=Tl.prototype.Fb;Tl.prototype.getMinResolution=Tl.prototype.Gb;Tl.prototype.getOpacity=Tl.prototype.Kb;Tl.prototype.getVisible=Tl.prototype.mb;Tl.prototype.getZIndex=Tl.prototype.Lb;Tl.prototype.setExtent=Tl.prototype.$b;Tl.prototype.setMaxResolution=Tl.prototype.ic;
Tl.prototype.setMinResolution=Tl.prototype.jc;Tl.prototype.setOpacity=Tl.prototype.ac;Tl.prototype.setVisible=Tl.prototype.bc;Tl.prototype.setZIndex=Tl.prototype.cc;Tl.prototype.get=Tl.prototype.get;Tl.prototype.getKeys=Tl.prototype.P;Tl.prototype.getProperties=Tl.prototype.R;Tl.prototype.set=Tl.prototype.set;Tl.prototype.setProperties=Tl.prototype.I;Tl.prototype.unset=Tl.prototype.T;Tl.prototype.changed=Tl.prototype.u;Tl.prototype.dispatchEvent=Tl.prototype.s;Tl.prototype.getRevision=Tl.prototype.L;
Tl.prototype.on=Tl.prototype.G;Tl.prototype.once=Tl.prototype.M;Tl.prototype.un=Tl.prototype.K;Tl.prototype.unByKey=Tl.prototype.N;Ll.prototype.getExtent=Ll.prototype.S;Ll.prototype.getMaxResolution=Ll.prototype.Fb;Ll.prototype.getMinResolution=Ll.prototype.Gb;Ll.prototype.getOpacity=Ll.prototype.Kb;Ll.prototype.getVisible=Ll.prototype.mb;Ll.prototype.getZIndex=Ll.prototype.Lb;Ll.prototype.setExtent=Ll.prototype.$b;Ll.prototype.setMaxResolution=Ll.prototype.ic;Ll.prototype.setMinResolution=Ll.prototype.jc;
Ll.prototype.setOpacity=Ll.prototype.ac;Ll.prototype.setVisible=Ll.prototype.bc;Ll.prototype.setZIndex=Ll.prototype.cc;Ll.prototype.get=Ll.prototype.get;Ll.prototype.getKeys=Ll.prototype.P;Ll.prototype.getProperties=Ll.prototype.R;Ll.prototype.set=Ll.prototype.set;Ll.prototype.setProperties=Ll.prototype.I;Ll.prototype.unset=Ll.prototype.T;Ll.prototype.changed=Ll.prototype.u;Ll.prototype.dispatchEvent=Ll.prototype.s;Ll.prototype.getRevision=Ll.prototype.L;Ll.prototype.on=Ll.prototype.G;
Ll.prototype.once=Ll.prototype.M;Ll.prototype.un=Ll.prototype.K;Ll.prototype.unByKey=Ll.prototype.N;E.prototype.setMap=E.prototype.setMap;E.prototype.setSource=E.prototype.Gc;E.prototype.getExtent=E.prototype.S;E.prototype.getMaxResolution=E.prototype.Fb;E.prototype.getMinResolution=E.prototype.Gb;E.prototype.getOpacity=E.prototype.Kb;E.prototype.getVisible=E.prototype.mb;E.prototype.getZIndex=E.prototype.Lb;E.prototype.setExtent=E.prototype.$b;E.prototype.setMaxResolution=E.prototype.ic;
E.prototype.setMinResolution=E.prototype.jc;E.prototype.setOpacity=E.prototype.ac;E.prototype.setVisible=E.prototype.bc;E.prototype.setZIndex=E.prototype.cc;E.prototype.get=E.prototype.get;E.prototype.getKeys=E.prototype.P;E.prototype.getProperties=E.prototype.R;E.prototype.set=E.prototype.set;E.prototype.setProperties=E.prototype.I;E.prototype.unset=E.prototype.T;E.prototype.changed=E.prototype.u;E.prototype.dispatchEvent=E.prototype.s;E.prototype.getRevision=E.prototype.L;E.prototype.on=E.prototype.G;
E.prototype.once=E.prototype.M;E.prototype.un=E.prototype.K;E.prototype.unByKey=E.prototype.N;Pk.prototype.get=Pk.prototype.get;Pk.prototype.getKeys=Pk.prototype.P;Pk.prototype.getProperties=Pk.prototype.R;Pk.prototype.set=Pk.prototype.set;Pk.prototype.setProperties=Pk.prototype.I;Pk.prototype.unset=Pk.prototype.T;Pk.prototype.changed=Pk.prototype.u;Pk.prototype.dispatchEvent=Pk.prototype.s;Pk.prototype.getRevision=Pk.prototype.L;Pk.prototype.on=Pk.prototype.G;Pk.prototype.once=Pk.prototype.M;
Pk.prototype.un=Pk.prototype.K;Pk.prototype.unByKey=Pk.prototype.N;Tk.prototype.getActive=Tk.prototype.c;Tk.prototype.setActive=Tk.prototype.g;Tk.prototype.get=Tk.prototype.get;Tk.prototype.getKeys=Tk.prototype.P;Tk.prototype.getProperties=Tk.prototype.R;Tk.prototype.set=Tk.prototype.set;Tk.prototype.setProperties=Tk.prototype.I;Tk.prototype.unset=Tk.prototype.T;Tk.prototype.changed=Tk.prototype.u;Tk.prototype.dispatchEvent=Tk.prototype.s;Tk.prototype.getRevision=Tk.prototype.L;Tk.prototype.on=Tk.prototype.G;
Tk.prototype.once=Tk.prototype.M;Tk.prototype.un=Tk.prototype.K;Tk.prototype.unByKey=Tk.prototype.N;Yx.prototype.getActive=Yx.prototype.c;Yx.prototype.setActive=Yx.prototype.g;Yx.prototype.get=Yx.prototype.get;Yx.prototype.getKeys=Yx.prototype.P;Yx.prototype.getProperties=Yx.prototype.R;Yx.prototype.set=Yx.prototype.set;Yx.prototype.setProperties=Yx.prototype.I;Yx.prototype.unset=Yx.prototype.T;Yx.prototype.changed=Yx.prototype.u;Yx.prototype.dispatchEvent=Yx.prototype.s;
Yx.prototype.getRevision=Yx.prototype.L;Yx.prototype.on=Yx.prototype.G;Yx.prototype.once=Yx.prototype.M;Yx.prototype.un=Yx.prototype.K;Yx.prototype.unByKey=Yx.prototype.N;bl.prototype.getActive=bl.prototype.c;bl.prototype.setActive=bl.prototype.g;bl.prototype.get=bl.prototype.get;bl.prototype.getKeys=bl.prototype.P;bl.prototype.getProperties=bl.prototype.R;bl.prototype.set=bl.prototype.set;bl.prototype.setProperties=bl.prototype.I;bl.prototype.unset=bl.prototype.T;bl.prototype.changed=bl.prototype.u;
bl.prototype.dispatchEvent=bl.prototype.s;bl.prototype.getRevision=bl.prototype.L;bl.prototype.on=bl.prototype.G;bl.prototype.once=bl.prototype.M;bl.prototype.un=bl.prototype.K;bl.prototype.unByKey=bl.prototype.N;rl.prototype.getActive=rl.prototype.c;rl.prototype.setActive=rl.prototype.g;rl.prototype.get=rl.prototype.get;rl.prototype.getKeys=rl.prototype.P;rl.prototype.getProperties=rl.prototype.R;rl.prototype.set=rl.prototype.set;rl.prototype.setProperties=rl.prototype.I;rl.prototype.unset=rl.prototype.T;
rl.prototype.changed=rl.prototype.u;rl.prototype.dispatchEvent=rl.prototype.s;rl.prototype.getRevision=rl.prototype.L;rl.prototype.on=rl.prototype.G;rl.prototype.once=rl.prototype.M;rl.prototype.un=rl.prototype.K;rl.prototype.unByKey=rl.prototype.N;el.prototype.getActive=el.prototype.c;el.prototype.setActive=el.prototype.g;el.prototype.get=el.prototype.get;el.prototype.getKeys=el.prototype.P;el.prototype.getProperties=el.prototype.R;el.prototype.set=el.prototype.set;el.prototype.setProperties=el.prototype.I;
el.prototype.unset=el.prototype.T;el.prototype.changed=el.prototype.u;el.prototype.dispatchEvent=el.prototype.s;el.prototype.getRevision=el.prototype.L;el.prototype.on=el.prototype.G;el.prototype.once=el.prototype.M;el.prototype.un=el.prototype.K;el.prototype.unByKey=el.prototype.N;by.prototype.getActive=by.prototype.c;by.prototype.setActive=by.prototype.g;by.prototype.get=by.prototype.get;by.prototype.getKeys=by.prototype.P;by.prototype.getProperties=by.prototype.R;by.prototype.set=by.prototype.set;
by.prototype.setProperties=by.prototype.I;by.prototype.unset=by.prototype.T;by.prototype.changed=by.prototype.u;by.prototype.dispatchEvent=by.prototype.s;by.prototype.getRevision=by.prototype.L;by.prototype.on=by.prototype.G;by.prototype.once=by.prototype.M;by.prototype.un=by.prototype.K;by.prototype.unByKey=by.prototype.N;il.prototype.getActive=il.prototype.c;il.prototype.setActive=il.prototype.g;il.prototype.get=il.prototype.get;il.prototype.getKeys=il.prototype.P;il.prototype.getProperties=il.prototype.R;
il.prototype.set=il.prototype.set;il.prototype.setProperties=il.prototype.I;il.prototype.unset=il.prototype.T;il.prototype.changed=il.prototype.u;il.prototype.dispatchEvent=il.prototype.s;il.prototype.getRevision=il.prototype.L;il.prototype.on=il.prototype.G;il.prototype.once=il.prototype.M;il.prototype.un=il.prototype.K;il.prototype.unByKey=il.prototype.N;vl.prototype.getGeometry=vl.prototype.W;vl.prototype.getActive=vl.prototype.c;vl.prototype.setActive=vl.prototype.g;vl.prototype.get=vl.prototype.get;
vl.prototype.getKeys=vl.prototype.P;vl.prototype.getProperties=vl.prototype.R;vl.prototype.set=vl.prototype.set;vl.prototype.setProperties=vl.prototype.I;vl.prototype.unset=vl.prototype.T;vl.prototype.changed=vl.prototype.u;vl.prototype.dispatchEvent=vl.prototype.s;vl.prototype.getRevision=vl.prototype.L;vl.prototype.on=vl.prototype.G;vl.prototype.once=vl.prototype.M;vl.prototype.un=vl.prototype.K;vl.prototype.unByKey=vl.prototype.N;gy.prototype.getActive=gy.prototype.c;gy.prototype.setActive=gy.prototype.g;
gy.prototype.get=gy.prototype.get;gy.prototype.getKeys=gy.prototype.P;gy.prototype.getProperties=gy.prototype.R;gy.prototype.set=gy.prototype.set;gy.prototype.setProperties=gy.prototype.I;gy.prototype.unset=gy.prototype.T;gy.prototype.changed=gy.prototype.u;gy.prototype.dispatchEvent=gy.prototype.s;gy.prototype.getRevision=gy.prototype.L;gy.prototype.on=gy.prototype.G;gy.prototype.once=gy.prototype.M;gy.prototype.un=gy.prototype.K;gy.prototype.unByKey=gy.prototype.N;wl.prototype.getActive=wl.prototype.c;
wl.prototype.setActive=wl.prototype.g;wl.prototype.get=wl.prototype.get;wl.prototype.getKeys=wl.prototype.P;wl.prototype.getProperties=wl.prototype.R;wl.prototype.set=wl.prototype.set;wl.prototype.setProperties=wl.prototype.I;wl.prototype.unset=wl.prototype.T;wl.prototype.changed=wl.prototype.u;wl.prototype.dispatchEvent=wl.prototype.s;wl.prototype.getRevision=wl.prototype.L;wl.prototype.on=wl.prototype.G;wl.prototype.once=wl.prototype.M;wl.prototype.un=wl.prototype.K;wl.prototype.unByKey=wl.prototype.N;
yl.prototype.getActive=yl.prototype.c;yl.prototype.setActive=yl.prototype.g;yl.prototype.get=yl.prototype.get;yl.prototype.getKeys=yl.prototype.P;yl.prototype.getProperties=yl.prototype.R;yl.prototype.set=yl.prototype.set;yl.prototype.setProperties=yl.prototype.I;yl.prototype.unset=yl.prototype.T;yl.prototype.changed=yl.prototype.u;yl.prototype.dispatchEvent=yl.prototype.s;yl.prototype.getRevision=yl.prototype.L;yl.prototype.on=yl.prototype.G;yl.prototype.once=yl.prototype.M;yl.prototype.un=yl.prototype.K;
yl.prototype.unByKey=yl.prototype.N;xy.prototype.getActive=xy.prototype.c;xy.prototype.setActive=xy.prototype.g;xy.prototype.get=xy.prototype.get;xy.prototype.getKeys=xy.prototype.P;xy.prototype.getProperties=xy.prototype.R;xy.prototype.set=xy.prototype.set;xy.prototype.setProperties=xy.prototype.I;xy.prototype.unset=xy.prototype.T;xy.prototype.changed=xy.prototype.u;xy.prototype.dispatchEvent=xy.prototype.s;xy.prototype.getRevision=xy.prototype.L;xy.prototype.on=xy.prototype.G;
xy.prototype.once=xy.prototype.M;xy.prototype.un=xy.prototype.K;xy.prototype.unByKey=xy.prototype.N;Al.prototype.getActive=Al.prototype.c;Al.prototype.setActive=Al.prototype.g;Al.prototype.get=Al.prototype.get;Al.prototype.getKeys=Al.prototype.P;Al.prototype.getProperties=Al.prototype.R;Al.prototype.set=Al.prototype.set;Al.prototype.setProperties=Al.prototype.I;Al.prototype.unset=Al.prototype.T;Al.prototype.changed=Al.prototype.u;Al.prototype.dispatchEvent=Al.prototype.s;
Al.prototype.getRevision=Al.prototype.L;Al.prototype.on=Al.prototype.G;Al.prototype.once=Al.prototype.M;Al.prototype.un=Al.prototype.K;Al.prototype.unByKey=Al.prototype.N;Cl.prototype.getActive=Cl.prototype.c;Cl.prototype.setActive=Cl.prototype.g;Cl.prototype.get=Cl.prototype.get;Cl.prototype.getKeys=Cl.prototype.P;Cl.prototype.getProperties=Cl.prototype.R;Cl.prototype.set=Cl.prototype.set;Cl.prototype.setProperties=Cl.prototype.I;Cl.prototype.unset=Cl.prototype.T;Cl.prototype.changed=Cl.prototype.u;
Cl.prototype.dispatchEvent=Cl.prototype.s;Cl.prototype.getRevision=Cl.prototype.L;Cl.prototype.on=Cl.prototype.G;Cl.prototype.once=Cl.prototype.M;Cl.prototype.un=Cl.prototype.K;Cl.prototype.unByKey=Cl.prototype.N;Gl.prototype.getActive=Gl.prototype.c;Gl.prototype.setActive=Gl.prototype.g;Gl.prototype.get=Gl.prototype.get;Gl.prototype.getKeys=Gl.prototype.P;Gl.prototype.getProperties=Gl.prototype.R;Gl.prototype.set=Gl.prototype.set;Gl.prototype.setProperties=Gl.prototype.I;Gl.prototype.unset=Gl.prototype.T;
Gl.prototype.changed=Gl.prototype.u;Gl.prototype.dispatchEvent=Gl.prototype.s;Gl.prototype.getRevision=Gl.prototype.L;Gl.prototype.on=Gl.prototype.G;Gl.prototype.once=Gl.prototype.M;Gl.prototype.un=Gl.prototype.K;Gl.prototype.unByKey=Gl.prototype.N;Ly.prototype.getActive=Ly.prototype.c;Ly.prototype.setActive=Ly.prototype.g;Ly.prototype.get=Ly.prototype.get;Ly.prototype.getKeys=Ly.prototype.P;Ly.prototype.getProperties=Ly.prototype.R;Ly.prototype.set=Ly.prototype.set;Ly.prototype.setProperties=Ly.prototype.I;
Ly.prototype.unset=Ly.prototype.T;Ly.prototype.changed=Ly.prototype.u;Ly.prototype.dispatchEvent=Ly.prototype.s;Ly.prototype.getRevision=Ly.prototype.L;Ly.prototype.on=Ly.prototype.G;Ly.prototype.once=Ly.prototype.M;Ly.prototype.un=Ly.prototype.K;Ly.prototype.unByKey=Ly.prototype.N;Oy.prototype.getActive=Oy.prototype.c;Oy.prototype.setActive=Oy.prototype.g;Oy.prototype.get=Oy.prototype.get;Oy.prototype.getKeys=Oy.prototype.P;Oy.prototype.getProperties=Oy.prototype.R;Oy.prototype.set=Oy.prototype.set;
Oy.prototype.setProperties=Oy.prototype.I;Oy.prototype.unset=Oy.prototype.T;Oy.prototype.changed=Oy.prototype.u;Oy.prototype.dispatchEvent=Oy.prototype.s;Oy.prototype.getRevision=Oy.prototype.L;Oy.prototype.on=Oy.prototype.G;Oy.prototype.once=Oy.prototype.M;Oy.prototype.un=Oy.prototype.K;Oy.prototype.unByKey=Oy.prototype.N;Ty.prototype.getActive=Ty.prototype.c;Ty.prototype.setActive=Ty.prototype.g;Ty.prototype.get=Ty.prototype.get;Ty.prototype.getKeys=Ty.prototype.P;Ty.prototype.getProperties=Ty.prototype.R;
Ty.prototype.set=Ty.prototype.set;Ty.prototype.setProperties=Ty.prototype.I;Ty.prototype.unset=Ty.prototype.T;Ty.prototype.changed=Ty.prototype.u;Ty.prototype.dispatchEvent=Ty.prototype.s;Ty.prototype.getRevision=Ty.prototype.L;Ty.prototype.on=Ty.prototype.G;Ty.prototype.once=Ty.prototype.M;Ty.prototype.un=Ty.prototype.K;Ty.prototype.unByKey=Ty.prototype.N;Ze.prototype.get=Ze.prototype.get;Ze.prototype.getKeys=Ze.prototype.P;Ze.prototype.getProperties=Ze.prototype.R;Ze.prototype.set=Ze.prototype.set;
Ze.prototype.setProperties=Ze.prototype.I;Ze.prototype.unset=Ze.prototype.T;Ze.prototype.changed=Ze.prototype.u;Ze.prototype.dispatchEvent=Ze.prototype.s;Ze.prototype.getRevision=Ze.prototype.L;Ze.prototype.on=Ze.prototype.G;Ze.prototype.once=Ze.prototype.M;Ze.prototype.un=Ze.prototype.K;Ze.prototype.unByKey=Ze.prototype.N;af.prototype.getClosestPoint=af.prototype.$a;af.prototype.getExtent=af.prototype.S;af.prototype.simplify=af.prototype.hb;af.prototype.transform=af.prototype.Va;
af.prototype.get=af.prototype.get;af.prototype.getKeys=af.prototype.P;af.prototype.getProperties=af.prototype.R;af.prototype.set=af.prototype.set;af.prototype.setProperties=af.prototype.I;af.prototype.unset=af.prototype.T;af.prototype.changed=af.prototype.u;af.prototype.dispatchEvent=af.prototype.s;af.prototype.getRevision=af.prototype.L;af.prototype.on=af.prototype.G;af.prototype.once=af.prototype.M;af.prototype.un=af.prototype.K;af.prototype.unByKey=af.prototype.N;
Xm.prototype.getFirstCoordinate=Xm.prototype.vb;Xm.prototype.getLastCoordinate=Xm.prototype.wb;Xm.prototype.getLayout=Xm.prototype.xb;Xm.prototype.getClosestPoint=Xm.prototype.$a;Xm.prototype.getExtent=Xm.prototype.S;Xm.prototype.simplify=Xm.prototype.hb;Xm.prototype.get=Xm.prototype.get;Xm.prototype.getKeys=Xm.prototype.P;Xm.prototype.getProperties=Xm.prototype.R;Xm.prototype.set=Xm.prototype.set;Xm.prototype.setProperties=Xm.prototype.I;Xm.prototype.unset=Xm.prototype.T;Xm.prototype.changed=Xm.prototype.u;
Xm.prototype.dispatchEvent=Xm.prototype.s;Xm.prototype.getRevision=Xm.prototype.L;Xm.prototype.on=Xm.prototype.G;Xm.prototype.once=Xm.prototype.M;Xm.prototype.un=Xm.prototype.K;Xm.prototype.unByKey=Xm.prototype.N;Zm.prototype.getClosestPoint=Zm.prototype.$a;Zm.prototype.getExtent=Zm.prototype.S;Zm.prototype.simplify=Zm.prototype.hb;Zm.prototype.transform=Zm.prototype.Va;Zm.prototype.get=Zm.prototype.get;Zm.prototype.getKeys=Zm.prototype.P;Zm.prototype.getProperties=Zm.prototype.R;
Zm.prototype.set=Zm.prototype.set;Zm.prototype.setProperties=Zm.prototype.I;Zm.prototype.unset=Zm.prototype.T;Zm.prototype.changed=Zm.prototype.u;Zm.prototype.dispatchEvent=Zm.prototype.s;Zm.prototype.getRevision=Zm.prototype.L;Zm.prototype.on=Zm.prototype.G;Zm.prototype.once=Zm.prototype.M;Zm.prototype.un=Zm.prototype.K;Zm.prototype.unByKey=Zm.prototype.N;tf.prototype.getFirstCoordinate=tf.prototype.vb;tf.prototype.getLastCoordinate=tf.prototype.wb;tf.prototype.getLayout=tf.prototype.xb;
tf.prototype.getClosestPoint=tf.prototype.$a;tf.prototype.getExtent=tf.prototype.S;tf.prototype.simplify=tf.prototype.hb;tf.prototype.transform=tf.prototype.Va;tf.prototype.get=tf.prototype.get;tf.prototype.getKeys=tf.prototype.P;tf.prototype.getProperties=tf.prototype.R;tf.prototype.set=tf.prototype.set;tf.prototype.setProperties=tf.prototype.I;tf.prototype.unset=tf.prototype.T;tf.prototype.changed=tf.prototype.u;tf.prototype.dispatchEvent=tf.prototype.s;tf.prototype.getRevision=tf.prototype.L;
tf.prototype.on=tf.prototype.G;tf.prototype.once=tf.prototype.M;tf.prototype.un=tf.prototype.K;tf.prototype.unByKey=tf.prototype.N;H.prototype.getFirstCoordinate=H.prototype.vb;H.prototype.getLastCoordinate=H.prototype.wb;H.prototype.getLayout=H.prototype.xb;H.prototype.getClosestPoint=H.prototype.$a;H.prototype.getExtent=H.prototype.S;H.prototype.simplify=H.prototype.hb;H.prototype.transform=H.prototype.Va;H.prototype.get=H.prototype.get;H.prototype.getKeys=H.prototype.P;
H.prototype.getProperties=H.prototype.R;H.prototype.set=H.prototype.set;H.prototype.setProperties=H.prototype.I;H.prototype.unset=H.prototype.T;H.prototype.changed=H.prototype.u;H.prototype.dispatchEvent=H.prototype.s;H.prototype.getRevision=H.prototype.L;H.prototype.on=H.prototype.G;H.prototype.once=H.prototype.M;H.prototype.un=H.prototype.K;H.prototype.unByKey=H.prototype.N;L.prototype.getFirstCoordinate=L.prototype.vb;L.prototype.getLastCoordinate=L.prototype.wb;L.prototype.getLayout=L.prototype.xb;
L.prototype.getClosestPoint=L.prototype.$a;L.prototype.getExtent=L.prototype.S;L.prototype.simplify=L.prototype.hb;L.prototype.transform=L.prototype.Va;L.prototype.get=L.prototype.get;L.prototype.getKeys=L.prototype.P;L.prototype.getProperties=L.prototype.R;L.prototype.set=L.prototype.set;L.prototype.setProperties=L.prototype.I;L.prototype.unset=L.prototype.T;L.prototype.changed=L.prototype.u;L.prototype.dispatchEvent=L.prototype.s;L.prototype.getRevision=L.prototype.L;L.prototype.on=L.prototype.G;
L.prototype.once=L.prototype.M;L.prototype.un=L.prototype.K;L.prototype.unByKey=L.prototype.N;jn.prototype.getFirstCoordinate=jn.prototype.vb;jn.prototype.getLastCoordinate=jn.prototype.wb;jn.prototype.getLayout=jn.prototype.xb;jn.prototype.getClosestPoint=jn.prototype.$a;jn.prototype.getExtent=jn.prototype.S;jn.prototype.simplify=jn.prototype.hb;jn.prototype.transform=jn.prototype.Va;jn.prototype.get=jn.prototype.get;jn.prototype.getKeys=jn.prototype.P;jn.prototype.getProperties=jn.prototype.R;
jn.prototype.set=jn.prototype.set;jn.prototype.setProperties=jn.prototype.I;jn.prototype.unset=jn.prototype.T;jn.prototype.changed=jn.prototype.u;jn.prototype.dispatchEvent=jn.prototype.s;jn.prototype.getRevision=jn.prototype.L;jn.prototype.on=jn.prototype.G;jn.prototype.once=jn.prototype.M;jn.prototype.un=jn.prototype.K;jn.prototype.unByKey=jn.prototype.N;N.prototype.getFirstCoordinate=N.prototype.vb;N.prototype.getLastCoordinate=N.prototype.wb;N.prototype.getLayout=N.prototype.xb;
N.prototype.getClosestPoint=N.prototype.$a;N.prototype.getExtent=N.prototype.S;N.prototype.simplify=N.prototype.hb;N.prototype.transform=N.prototype.Va;N.prototype.get=N.prototype.get;N.prototype.getKeys=N.prototype.P;N.prototype.getProperties=N.prototype.R;N.prototype.set=N.prototype.set;N.prototype.setProperties=N.prototype.I;N.prototype.unset=N.prototype.T;N.prototype.changed=N.prototype.u;N.prototype.dispatchEvent=N.prototype.s;N.prototype.getRevision=N.prototype.L;N.prototype.on=N.prototype.G;
N.prototype.once=N.prototype.M;N.prototype.un=N.prototype.K;N.prototype.unByKey=N.prototype.N;C.prototype.getFirstCoordinate=C.prototype.vb;C.prototype.getLastCoordinate=C.prototype.wb;C.prototype.getLayout=C.prototype.xb;C.prototype.getClosestPoint=C.prototype.$a;C.prototype.getExtent=C.prototype.S;C.prototype.simplify=C.prototype.hb;C.prototype.transform=C.prototype.Va;C.prototype.get=C.prototype.get;C.prototype.getKeys=C.prototype.P;C.prototype.getProperties=C.prototype.R;C.prototype.set=C.prototype.set;
C.prototype.setProperties=C.prototype.I;C.prototype.unset=C.prototype.T;C.prototype.changed=C.prototype.u;C.prototype.dispatchEvent=C.prototype.s;C.prototype.getRevision=C.prototype.L;C.prototype.on=C.prototype.G;C.prototype.once=C.prototype.M;C.prototype.un=C.prototype.K;C.prototype.unByKey=C.prototype.N;D.prototype.getFirstCoordinate=D.prototype.vb;D.prototype.getLastCoordinate=D.prototype.wb;D.prototype.getLayout=D.prototype.xb;D.prototype.getClosestPoint=D.prototype.$a;D.prototype.getExtent=D.prototype.S;
D.prototype.simplify=D.prototype.hb;D.prototype.transform=D.prototype.Va;D.prototype.get=D.prototype.get;D.prototype.getKeys=D.prototype.P;D.prototype.getProperties=D.prototype.R;D.prototype.set=D.prototype.set;D.prototype.setProperties=D.prototype.I;D.prototype.unset=D.prototype.T;D.prototype.changed=D.prototype.u;D.prototype.dispatchEvent=D.prototype.s;D.prototype.getRevision=D.prototype.L;D.prototype.on=D.prototype.G;D.prototype.once=D.prototype.M;D.prototype.un=D.prototype.K;
D.prototype.unByKey=D.prototype.N;os.prototype.readFeatures=os.prototype.ta;ps.prototype.readFeatures=ps.prototype.ta;ps.prototype.readFeatures=ps.prototype.ta;vh.prototype.get=vh.prototype.get;vh.prototype.getKeys=vh.prototype.P;vh.prototype.getProperties=vh.prototype.R;vh.prototype.set=vh.prototype.set;vh.prototype.setProperties=vh.prototype.I;vh.prototype.unset=vh.prototype.T;vh.prototype.changed=vh.prototype.u;vh.prototype.dispatchEvent=vh.prototype.s;vh.prototype.getRevision=vh.prototype.L;
vh.prototype.on=vh.prototype.G;vh.prototype.once=vh.prototype.M;vh.prototype.un=vh.prototype.K;vh.prototype.unByKey=vh.prototype.N;Vh.prototype.getMap=Vh.prototype.g;Vh.prototype.setMap=Vh.prototype.setMap;Vh.prototype.setTarget=Vh.prototype.f;Vh.prototype.get=Vh.prototype.get;Vh.prototype.getKeys=Vh.prototype.P;Vh.prototype.getProperties=Vh.prototype.R;Vh.prototype.set=Vh.prototype.set;Vh.prototype.setProperties=Vh.prototype.I;Vh.prototype.unset=Vh.prototype.T;Vh.prototype.changed=Vh.prototype.u;
Vh.prototype.dispatchEvent=Vh.prototype.s;Vh.prototype.getRevision=Vh.prototype.L;Vh.prototype.on=Vh.prototype.G;Vh.prototype.once=Vh.prototype.M;Vh.prototype.un=Vh.prototype.K;Vh.prototype.unByKey=Vh.prototype.N;fi.prototype.getMap=fi.prototype.g;fi.prototype.setMap=fi.prototype.setMap;fi.prototype.setTarget=fi.prototype.f;fi.prototype.get=fi.prototype.get;fi.prototype.getKeys=fi.prototype.P;fi.prototype.getProperties=fi.prototype.R;fi.prototype.set=fi.prototype.set;fi.prototype.setProperties=fi.prototype.I;
fi.prototype.unset=fi.prototype.T;fi.prototype.changed=fi.prototype.u;fi.prototype.dispatchEvent=fi.prototype.s;fi.prototype.getRevision=fi.prototype.L;fi.prototype.on=fi.prototype.G;fi.prototype.once=fi.prototype.M;fi.prototype.un=fi.prototype.K;fi.prototype.unByKey=fi.prototype.N;gi.prototype.getMap=gi.prototype.g;gi.prototype.setMap=gi.prototype.setMap;gi.prototype.setTarget=gi.prototype.f;gi.prototype.get=gi.prototype.get;gi.prototype.getKeys=gi.prototype.P;gi.prototype.getProperties=gi.prototype.R;
gi.prototype.set=gi.prototype.set;gi.prototype.setProperties=gi.prototype.I;gi.prototype.unset=gi.prototype.T;gi.prototype.changed=gi.prototype.u;gi.prototype.dispatchEvent=gi.prototype.s;gi.prototype.getRevision=gi.prototype.L;gi.prototype.on=gi.prototype.G;gi.prototype.once=gi.prototype.M;gi.prototype.un=gi.prototype.K;gi.prototype.unByKey=gi.prototype.N;ir.prototype.getMap=ir.prototype.g;ir.prototype.setMap=ir.prototype.setMap;ir.prototype.setTarget=ir.prototype.f;ir.prototype.get=ir.prototype.get;
ir.prototype.getKeys=ir.prototype.P;ir.prototype.getProperties=ir.prototype.R;ir.prototype.set=ir.prototype.set;ir.prototype.setProperties=ir.prototype.I;ir.prototype.unset=ir.prototype.T;ir.prototype.changed=ir.prototype.u;ir.prototype.dispatchEvent=ir.prototype.s;ir.prototype.getRevision=ir.prototype.L;ir.prototype.on=ir.prototype.G;ir.prototype.once=ir.prototype.M;ir.prototype.un=ir.prototype.K;ir.prototype.unByKey=ir.prototype.N;Yh.prototype.getMap=Yh.prototype.g;Yh.prototype.setMap=Yh.prototype.setMap;
Yh.prototype.setTarget=Yh.prototype.f;Yh.prototype.get=Yh.prototype.get;Yh.prototype.getKeys=Yh.prototype.P;Yh.prototype.getProperties=Yh.prototype.R;Yh.prototype.set=Yh.prototype.set;Yh.prototype.setProperties=Yh.prototype.I;Yh.prototype.unset=Yh.prototype.T;Yh.prototype.changed=Yh.prototype.u;Yh.prototype.dispatchEvent=Yh.prototype.s;Yh.prototype.getRevision=Yh.prototype.L;Yh.prototype.on=Yh.prototype.G;Yh.prototype.once=Yh.prototype.M;Yh.prototype.un=Yh.prototype.K;Yh.prototype.unByKey=Yh.prototype.N;
nr.prototype.getMap=nr.prototype.g;nr.prototype.setMap=nr.prototype.setMap;nr.prototype.setTarget=nr.prototype.f;nr.prototype.get=nr.prototype.get;nr.prototype.getKeys=nr.prototype.P;nr.prototype.getProperties=nr.prototype.R;nr.prototype.set=nr.prototype.set;nr.prototype.setProperties=nr.prototype.I;nr.prototype.unset=nr.prototype.T;nr.prototype.changed=nr.prototype.u;nr.prototype.dispatchEvent=nr.prototype.s;nr.prototype.getRevision=nr.prototype.L;nr.prototype.on=nr.prototype.G;
nr.prototype.once=nr.prototype.M;nr.prototype.un=nr.prototype.K;nr.prototype.unByKey=nr.prototype.N;$h.prototype.getMap=$h.prototype.g;$h.prototype.setMap=$h.prototype.setMap;$h.prototype.setTarget=$h.prototype.f;$h.prototype.get=$h.prototype.get;$h.prototype.getKeys=$h.prototype.P;$h.prototype.getProperties=$h.prototype.R;$h.prototype.set=$h.prototype.set;$h.prototype.setProperties=$h.prototype.I;$h.prototype.unset=$h.prototype.T;$h.prototype.changed=$h.prototype.u;$h.prototype.dispatchEvent=$h.prototype.s;
$h.prototype.getRevision=$h.prototype.L;$h.prototype.on=$h.prototype.G;$h.prototype.once=$h.prototype.M;$h.prototype.un=$h.prototype.K;$h.prototype.unByKey=$h.prototype.N;Br.prototype.getMap=Br.prototype.g;Br.prototype.setMap=Br.prototype.setMap;Br.prototype.setTarget=Br.prototype.f;Br.prototype.get=Br.prototype.get;Br.prototype.getKeys=Br.prototype.P;Br.prototype.getProperties=Br.prototype.R;Br.prototype.set=Br.prototype.set;Br.prototype.setProperties=Br.prototype.I;Br.prototype.unset=Br.prototype.T;
Br.prototype.changed=Br.prototype.u;Br.prototype.dispatchEvent=Br.prototype.s;Br.prototype.getRevision=Br.prototype.L;Br.prototype.on=Br.prototype.G;Br.prototype.once=Br.prototype.M;Br.prototype.un=Br.prototype.K;Br.prototype.unByKey=Br.prototype.N;Gr.prototype.getMap=Gr.prototype.g;Gr.prototype.setMap=Gr.prototype.setMap;Gr.prototype.setTarget=Gr.prototype.f;Gr.prototype.get=Gr.prototype.get;Gr.prototype.getKeys=Gr.prototype.P;Gr.prototype.getProperties=Gr.prototype.R;Gr.prototype.set=Gr.prototype.set;
Gr.prototype.setProperties=Gr.prototype.I;Gr.prototype.unset=Gr.prototype.T;Gr.prototype.changed=Gr.prototype.u;Gr.prototype.dispatchEvent=Gr.prototype.s;Gr.prototype.getRevision=Gr.prototype.L;Gr.prototype.on=Gr.prototype.G;Gr.prototype.once=Gr.prototype.M;Gr.prototype.un=Gr.prototype.K;Gr.prototype.unByKey=Gr.prototype.N;
  return OPENLAYERS.ol;
}));


define('src/util/util',['jquery', "src/core/baseview", 'ol'], function($, BaseView, ol) {
    window.ace = window.ace || {}
    window.ace.util = window.ace.util || {}

    if(!window.console) {
        window.console = {};
    }
    if(!window.console.log) {
        window.console.log = function(){};
    }

    if(!String.prototype.trim) {
        String.prototype.trim = function() { return this.replace(/^\s+|\s+$/gm,''); }
    }

    ace.util.Event = BaseView.prototype.ea;
    ace.util.DomEvent = $(document);
    ace.util.convertMeters = function(value, dec, uom) {
        dec = dec ? dec : '2';
        uom = uom ? uom : ace._distanceuom;
        uom = uom ? uom : 'mile';
        switch (uom.toLowerCase()) {
            case 'mile':
                value = (value * 3.281) / 5280;
                break;
            case 'km':
                value /= 1000;
                break;
        }
        return ace.util.roundNumber(value, dec)
    }
    ace.util.roundNumber = function(num, dec) {
        return Math.round(num * Math.pow(10, dec)) / Math.pow(10, dec);
    }
    /**
     * alert creates a lightwindow based on input html/options and the current
     * lightwindow_cache template implementation
     *
     */
    ace.util.alert = function(html, options) {

        ace.util.checkAlertTemplate();
        if (options && options.close_text) {
            $('.modal .closeBtn').text(options.close_text)
        }

        var title_el = $('#lightwindow_title_bar_title');
        if (title_el) {
             if (options && options.title_text) {
                 title_el.text(options.title_text);
             } else {
                 title_el.text('');
             }
        }

        $('.modal p').html(html)
        $('.modal').modal()
	var event = new CustomEvent("w2gi:modalopen");
	document.dispatchEvent(event);         
    }

    ace.util.checkAlertTemplate = function() {
        if ($('.overlay').length && $('.modal').length) { return }

        var obj = [
            '<div class="overlay"></div>',
            '<div class="modal">',
            '<a href="#" class="closeBtn">Close</a>',
            '<p></p>',
            '</div>'
        ].join('')
        var overlayStyles = {
            width:      '100 %',
            height:     '100 %',
            position:   'fixed',
            top:        0,
            left:       0,
            zIndex:     1000,
            display:    'none'
        }
        var modalStyles = {
            display:    'none',
            background: 'rgb(238, 238, 238)',
            padding:    '0 20px 20px',
            overflow:   'auto',
            zIndex:     '1001',
            position:   'absolute',
            width:      '500px',
            minHeight:  '300px'
        }

        $(document).append($(obj))

        $('.overlay').css(overlayStyles)
        $('.modal').css(modalStyles)
    }

    /**
     * alertExternal creates an iframe implementation of lightwindow
     *
     * @return {lightwindow}
     */
    ace.util.alertExternal = function(anchor) {
        var href = (anchor.attr('href') != '') ? anchor.attr('href') : anchor.href
        var url = anchor.data('url')
        var title = anchor.data('title')
        var height = anchor.data('height')
        var width = anchor.data('width')
        var content = $('.modal p')
        var ct = ''

        if ($('#close_text').length && $('#close_text').text().length > 0) {
            ct = $('#close_text').text();
        } else {
            ct = 'Close';
        }

        href = (url && url != '') ? url : href
        height = height ? height : 400
        width = width ? width : 400

        var title_el = $('#lightwindow_title_bar_title')
        if (title_el) {
                if (title) {
                    title_el.text(title)
                } else {
                    title_el.text('')
                }
        }

        $('.modal p').empty()
        var frame = $('<iframe/>', {
                height:     height ,
                width:      width,
                frameborder: 0,
                //scrolling:  "no",
                marginheight:   0,
                marginwidth:    0,
                src:  href
        }).appendTo(content)

        $('.modal').modal()
        ace.locale.refreshLocale('.modal');
	var event = new CustomEvent("w2gi:modalopen");
	document.dispatchEvent(event);         
    }

    ace.util.setCookie = function(name, value, expires, path, domain, secure) {
        // set time, it's in milliseconds
        var today = new Date();
        today.setTime(today.getTime());

        /*
         if the expires variable is set, make the correct
         expires time, the current script below will set
         it for x number of days, to make it for hours,
         delete * 24, for minutes, delete * 60 * 24
         */
        if (expires) {
            expires = expires * 1000 * 60 * 60 * 24;
        }
        var expires_date = new Date(today.getTime() + (expires));

        document.cookie = name + "=" + escape(value) +
            ((expires) ? ";expires=" + expires_date.toGMTString() : "") +
            ((path) ? ";path=" + path : "") +
            ((domain) ? ";domain=" + domain : "") +
            ((secure) ? ";secure" : "");
    }

    ace.util.deleteCookie = function(name, domain) {
        this.setCookie(name, '', -30, null, domain, 0);
    }

    ace.util.getCookie = function(check_name) {
        // first we'll split this cookie up into name/value pairs
        // note: document.cookie only returns name=value, not the other components
        var a_all_cookies = document.cookie.split(';');
        var a_temp_cookie = '';
        var cookie_name = '';
        var cookie_value = '';
        var b_cookie_found = false; // set boolean t/f default f
        for (i = 0; i < a_all_cookies.length; i++) {
            // now we'll split apart each name=value pair
            a_temp_cookie = a_all_cookies[i].split('=');


            // and trim left/right whitespace while we're at it
            cookie_name = a_temp_cookie[0].replace(/^\s+|\s+$/g, '');

            // if the extracted name matches passed check_name
            if (cookie_name == check_name) {
                b_cookie_found = true;
                // we need to handle case where cookie has no value but exists (no = sign, that is):
                if (a_temp_cookie.length > 1) {
                    cookie_value = unescape(a_temp_cookie[1].replace(/^\s+|\s+$/g, ''));
                }
                // note that in cases where cookie is initialized but no value, null is returned
                //return cookie_value;
                //break;
            }
            a_temp_cookie = null;
            cookie_name = '';
        }
        if (!b_cookie_found) {
            return null;
        }
        return cookie_value;
    }

    ace.util.searchExternal= function(searchformId) {
        if(searchformId == 'locator_search') {
          var event = new CustomEvent("w2gi:proximitysearch", {searchformId: searchformId});
          document.dispatchEvent(event);         
        }
        if(searchformId == 'getlist') {
          var event = new CustomEvent("w2gi:getlistsearchexternal", {searchformId: searchformId});
          document.dispatchEvent(event);          
        }
    }

    ace.util._addAjaxActivityIndicator = function(map) {
        var temp = $('#ajax_activity');
        if (!temp) {
            var img = $('<img id="#ajax_activity" style: "display: none;" src= "/w2gi/images/indicator.gif" alt="Activity" />');
            map.appendChild(img);
        }
    }

    ace.util.isMobile = (function() {
      return navigator.userAgent.match(/Mobile|iP(hone|od|ad)|Android|BlackBerry|IEMobile|Kindle|NetFront|Silk-Accelerated|(hpw|web)OS|Fennec|Minimo|Opera M(obi|ini)|Blazer|Dolfin|Dolphin|Skyfire|Zune/);
    })();

    ace.util.isTouchDevice = 'ontouchstart' in window || window.DocumentTouch && document instanceof window.DocumentTouch

    ace.util.addOLTouchFix = function() {
        function touchHandler(event) {
            var touches = event.changedTouches,
                first = touches[0],
                eventMappings = {
                    touchstart: 'mousedown',
                    touchmove:  'mousemove',
                    touchend:   'mouseup'
                },
                type = '',
                simulatedEvent = document.createEvent("MouseEvent");

            type = eventMappings[event.type]

            // initMouseEvent(type, canBubble, cancelable, view, clickCount,
            //                screenX, screenY, clientX, clientY, ctrlKey,
            //                altKey, shiftKey, metaKey, button, relatedTarget);

            simulatedEvent.initMouseEvent(type, true, true, window, 1,
                                          first.screenX, first.screenY,
                                          first.clientX, first.clientY, false,
                                          false, false, false, 0, null);

            first.target.dispatchEvent(simulatedEvent);
            //event.preventDefault();
         }

         document.addEventListener("touchstart",    touchHandler, true);
         document.addEventListener("touchmove",     touchHandler, true);
         document.addEventListener("touchend",      touchHandler, true);
         document.addEventListener("touchcancel",   touchHandler, true);
    }

    ace.util.checkQuery = function() {
            var query = window.location.search,
                params = null

            if (query && query.length > 0) {
                params = ace.util.getQueryParams()
            }
            if (params && params.redirection) {
              delete params.redirection
            }
            return _.isEmpty(params) ? null : params
     }

     ace.util.getQueryParams = function() {
            var match,
                pl     = /\+/g,  // Regex for replacing addition symbol with a space
                search = /([^&=]+)=?([^&]*)/g,
                decode = function (s) { return decodeURIComponent(s.replace(pl, " ")); },
                query  = window.location.search.substring(1)

            urlParams = {};
            while (match = search.exec(query)) {
               urlParams[decode(match[1]).toLowerCase()] = decode(match[2])
            }
            return urlParams
     }

    ace.util.printUrl = function(page) {
        var url     = location.href.substring(0, location.href.lastIndexOf('/') + 1) + page;
        var form = '#' + W2GI.form
        var qs      = $(form).serialize()
        var likeAttrib = Math.random();
        url += '?form=' + W2GI.form + '&' + qs + '&like=' + likeAttrib;
        if(W2GI.config.uid)
            url+= '&uid='+W2GI.config.uid;

        //if product locator and no driving directions:
        //if(this.locator.locatorType && this.locator.locatorType == 'product' && this.locator.panel.innerHTML.length < 10)
        //    url = page + '?uid=' + this.locator.uid;

        var addresses = W2GI.addresses;
        if (addresses[0] && addresses[0].latitude && addresses[0].longitude) {
            url += '&latitude=' + addresses[0].latitude;
            url += '&longitude=' + addresses[0].longitude;
        }
        if (addresses[1] && addresses[1].latitude && addresses[1].longitude) {
            url += '&dest_latitude=' + addresses[1].latitude;
            url += '&dest_longitude=' + addresses[1].longitude;
        }
        if (ace.locale.current && ace.locale.current.length) {
                url += '&lang=' + ace.locale.current;
        }

        return url
    }

    ace.util.getScaleFromResolution = function(resolution, units) {
      //var dpi = 25.4 / 0.28;
      var dpi = 72;
      var ipu;
      if (units === 'degrees') {
        ipu = 4374754;
      } else {
        var mpu = ol.proj.METERS_PER_UNIT[units];
        ipu = mpu * 39.3701;
      }
      var scale = resolution * ipu * dpi;
      return scale;
    }

    ace.util.getCenter = function(feature) {
      var geometry = feature.getGeometry();

      if (geometry.getType() == 'Point') {
        return geometry.getCoordinates();
      }

      var extent = geometry.getExtent()

      var deltaX = extent[2] - extent[0];
      var deltaY = extent[3] - extent[1];

      return [(extent[0] + deltaX / 2), (extent[1] + deltaY / 2)];
    }

    /**
     * Returns the RGB string of a color
     * http://stackoverflow.com/questions/1573053/javascript-function-to-convert-color-names-to-hex-codes
     *
     * @param {string} color The color in hexa or plain text, for example:
     *     '#0000FF', 'blue', etc.
     * @return {string}
     */
    ace.util.buildRGBString = function(color) {
      var div = document.createElement('div');
      div.style.display = 'none';
      div.style.color = color;
      document.body.appendChild(div);
      var rgbString = window.getComputedStyle(div).color;
      document.body.removeChild(div);
      div = null;
      return rgbString;
    }

    /**
     * Returns a RGBA string from the combinaison of a color and opacity.
     *
     * @param {string} color The color in hexa or plain text, for example:
     *     '#0000FF', 'blue', etc.
     * @param {number} opacity Opacity between 0 (transparent) and 1 (opaque)
     * @return {string|null}
     */
    ace.util.buildRGBAString = function(color, opacity) {
      var rgbaString = null;

      var rgbString = ace.util.buildRGBString(color);
      if (rgbString) {
        var rgb = ace.util.getRGBFromString(rgbString);
        if (rgb) {
          var c = [];
          c.push('rgba(');
          c.push(rgb.r);
          c.push(',');
          c.push(rgb.g);
          c.push(',');
          c.push(rgb.b);
          c.push(',');
          c.push(opacity);
          c.push(')');
          rgbaString = c.join('');
        }
      }

      return rgbaString
    }

    /**
     * Returns an object containing RGB keys from a rgb string.
     * http://stackoverflow.com/questions/9585973/javascript-regular-expression-for-rgb-values
     *
     * @param {string} rgbString
     * @return {Object|null}
     */
    ace.util.getRGBFromString =  function(rgbString) {
      var rgb = null;
      var matchColors = /rgb\((\d{1,3}), (\d{1,3}), (\d{1,3})\)/;
      var match = matchColors.exec(rgbString);
      if (match !== null) {
        rgb = {
          r: match[1],
          g: match[2],
          b: match[3]
        }
      }
      return rgb;
    }

    /**
     * Reproject and return extent
     *
     * @param {ol.Extent} bounds
     * @param {ol.View} view
     * @param {ol.proj.ProjectionLike} boundsProjection
     * @return {ol.Extent}
     */
    ace.util.transformExtent =  function(bounds, view, boundsProjection) {
      var out = bounds;
      var transformFn = ol.proj.getTransform(boundsProjection, view.getProjection());
      out = ol.extent.applyTransform(bounds, transformFn);

      return out;
    }

    ace.util.changeCountryDropDownLocale = function() {
            var languageCode = ace.locale && ace.locale.languageCode ? ace.locale.languageCode.toLocaleLowerCase() : null;

            if(window.ace.collection.countryDropDownLocales && languageCode){
	            var countryArr = [],
	                target = $("[name=country]");

	            var _val = target.val();
	            target.find("option").remove();

	            _(window.ace.collection.countryDropDownLocales).each(function(rec) {
	                var description = "description";

	                languageCode = (languageCode == "kr") ? "ko" : languageCode;
	                languageCode = (languageCode == "mx") ? "es" : languageCode;
	                languageCode = (languageCode == "cn") ? "zh" : languageCode;
	                languageCode = (languageCode == "jp") ? "ja" : languageCode;
	                languageCode = (languageCode == "be") ? "fr" : languageCode;
	                languageCode = (languageCode == "lamerica_nsc_cnt_amer") ? "es" : languageCode;


	                rec["description_" + languageCode] && (description = "description_" + languageCode);
	                var name = rec.name;
	                desc = rec[description];
	                countryArr.push({
	                    value: name,
	                    text: desc
	                });
	                ace.cache.add("#search_country", countryArr);

	            });

	            countryArr.sort(function (a, b) {
	                 return a['text'].localeCompare(b['text']);
	            });

	            for (i = 0; i < countryArr.length ; i++){

                    target.append($("<option/>", {
                         value: countryArr[i].value,
                         text: countryArr[i].text
                    }))
                }

	            target.val(_val);
            }
    }

    $( document ).ready(function() {

		if(window.ace.collection && window.ace.collection.countryDropDownLocales && ace.locale && ace.locale.languageCode) {
			ace.util.changeCountryDropDownLocale();
		} else {
			ace.util.Event.on("countries:data", function() {
				ace.util.changeCountryDropDownLocale();
			});
		}
	});


    $(function($) {
        $(".lightwindow").on("click", function(evt) {
            ace.util.alertExternal($(evt.target));
        })

        if (ace.util.isTouchDevice) {
            //ace.util.addOLTouchFix()
        }
    });

})
;
define('src/util/request',['jquery'], function($) {
    window.ace = window.ace || {}


    ace.request = function(form, callback, options) {
        options = options || {};
        var ajaxURL = options.url || 'ajax'
        var params = (form && !!form.nodeType) ? Form.serialize(form, true) : form;
        var formdataID = (options && !!options.formdataID) ? options.formdataID : $(form).attr('id');
        var objectName = (options && !!options.objectName) ? options.objectName : null;
        var like = (options && !!options.like) ? options.like : null;
        var formData = form;
        var tagName = options ? options.tagName : null;
        var geoip = options && options.geoip;
        /* if (ace.util.numberFormat)
            params = ace.util.format(params);
        if (options && !!options.extendGetVals)
            params = Object.extend(params, ace.util.retrieveGetVals());

        var requestXML = formData ? this._getRequestXML(formData, params, geoip, like) : this._generateRequestXML(formdataID, params, tagName, objectName, geoip, like, options);
        */
        //this.ajaxRequest(ajaxURL, requestXML, callback, options);
        //return requestXML;
    }

    /**
     * @method
     * @param {String} ajaxURL
     * @param {String} requestXML
     * @param {Function} callback (optional)
     * @param {Object} options (optional)
     */
    ace.ajaxRequest = function(method, requestXML, callback, options) {
        var appkey = W2GI.config.appkey,
            requestObject = {},
            ajaxURL = W2GI.config.url || 'rest/',
            self = this,
            $ajaxTA = $(options.ajaxLoader)
        // ajax activity
        if ($ajaxTA.length === 0) { options.ajaxLoader = $ajaxTA = $('#ajax_activity') }

        var asyncflag = true;
        if (options.asynchronous === false) {
           asyncflag = false;
        }

        if (!!options.formdata) {
            formdata = options.formdata
        } else {
            formdata = {
                _like: Math.random(),
                objectname: options.objectName
            }
            if (!formdata.objectname) { delete formdata.objectName }
        }
        // check for softmatch
        if (typeof options.softmatch != 'undefined') {
            formdata._softmatch = '1';
        }
        // convert true / false to 0 / 1
        _.each(formdata, function(param) {
            if (param === false) {
                formdata[param] = '0'
            } else if (param === true) {
                formdata[param] = '1'
            }
        });

        requestObject = {
            'request': {
                'appkey': W2GI.config.appkey || options.appkey || $('#appkey').val(),
                'formdata': formdata
            }
        }

        ajaxURL +=  (method || 'getlist')

        if (ace.locale && ace.locale.current) {
            var lang = ace.locale.current;
            if (ajaxURL.match(/([?&]lang=)/)) {
                ajaxURL = ajaxURL.replace(/([?&]lang=)([^&]*)/, "$1" + lang);
            } else {
                ajaxURL = ajaxURL.replace(/[?]$/, '');
                ajaxURL += "?lang=" + lang;
            }
            ajaxURL += '&like=' + Math.random()
        } else {
            ajaxURL += '?like=' + Math.random()
        }
        
        if (!!options.allowcache) { delete formdata._like }

        var reqStr = JSON.stringify(requestObject),
            cachedResponse = ace.cache.get(reqStr)
        if (cachedResponse) {
            if (typeof options.success == 'function') { options.success(cachedResponse, options) }
            return
        }

        $.ajax({
            url: ajaxURL,
            type: 'POST',
            beforeSend: function(xhr) { $ajaxTA.toggle(true) },
            contentType: 'application/json',
            data: reqStr,
            dataType: 'json',
            success: ace._processResponse.bind(this, callback, options, reqStr),
            async: asyncflag,
            error: ace._reportError
        })
    }
    ace._processResponse = function(callback, options, reqStr, res) {
        var response  = res.response ? res.response : res
        options.ajaxLoader.toggle(false)

        if (response.code && response.code != '1' && response.code != '1006') {
            $(document).trigger("w2gi:fetchError", {
                xhr: xhr,
                error: res && res.message,
                errorCode: response.code
            })
            return
        }
        if (!ace._checkResponse(options, res)) { return }
        if (!callback) { return }

        if (response.attributes) {
            options.responseAttributes = response.attributes
        }
        if (response && response.collection && response.collectionname !== 'multiple_address') {
            response = response.collection || {};
        }

        switch (typeof callback) {
            case 'function':
                try {
                    var ret = callback(response)
                    if (ret) {
                        ace.cache.add(reqStr, response);
                        if (options && !!options.onHistory) options.onHistory(params.xml_request, callback);
                    }
                } catch (e) {
                    ace.util.alert(e, { height: 100 })
                }
                break;
            case 'boolean':
                if (callback) { ace.cache.add(reqStr, response) }
                break;
            default:
                throw new Error('Bad callback type.');
        }
    }
    ace._checkResponse =  function(options, request) {
        if (request === null) { return false }

        if (request.code == '999') {
            ace._sessionEnd(request)
            return false
        }
        return true
    }
    ace._sessionEnd =  function(data){
        document.body.innerHTML = data
    }
    ace._reportError =  function(jqXHR, textStatus, errorThrown) {
        /*
        if(
            (request.getHeader && request.getHeader('Content-Type') && request.getHeader('Content-Type').include && request.getHeader('Content-Type').include('html'))
            || !exception
            || (exception && exception.message && exception.message.include('xml'))
        ){
            document.body.innerHTML = request.transport.responseText;
            return false;
        } */
        ace.util.alert('Internal error: ' + errorThrown, {height:100});
    }
})
;
define('src/util/collection',['jquery'], function($) {
    window.ace = window.ace || {}

    window.ace.collection = {
        appendOptions: function(targetID, objectName, filter, tagName, optValue, optDesc, callback, options) {            
            var method = (options && options.method) || 'getlist'           
            var request = {
                 objectname: objectName 
            }

            if (filter && !_.isEmpty(filter)) { request.where = filter }                
            if (options && options.order) { request.order =  options.order }

            ace.ajaxRequest(method, null, _processResponse.bind(this), { formdata: request });

            function _processResponse(response) {
                var target = $(targetID),
                    responseArr = []
                    
                _(response).each(function(e) {
                    var value = e[optValue]
                    var desc = e[optDesc]
                    responseArr.push({value: value, text: desc})                    
                    target.append($('<option/>', { value: value, text: desc } ))
                })
                ace.cache.add(targetID, responseArr)
                return typeof callback == 'function' ? callback(response) : false
            }
        },
        customApi: function(apimethod, formdata, callback, targetID, templateID) {
                this.targetID   = targetID;
                this.templateID = templateID;
                ace.ajaxRequest(apimethod, null, _processResponse.bind(this), { formdata: formdata});

                function _processResponse(response) {
                        if (W2GI.custom_ob && W2GI.custom_ob.updateRecordsCustom) {
                                try {
                                        response = W2GI.custom_ob.updateRecordsCustom(response);
                                } catch (e) {}
                        }

                        var target;
                        if (this.targetID) {
                                target = $('#' + this.targetID);
                        }
                        var template;
                        if (this.templateID) {
                                template = $('script#' + this.templateID).html() || "";
                        }
                        var templateContent;
                        if (target && template) {
                                var templateObj = Handlebars.compile(template)
                                templateContent = templateObj(response);
                                target.html(templateContent);
                        }
                        return typeof callback == 'function' ? callback(response) : false
                }
        }
    }
})
;
/**
*
*   Main app module, required libraries have been loaded
*
*   @param {Object} core module, includes the event aggregator under core.EA
*   @param {Object} special name used by require to pass settings, use module.config() to access them
*                   settings can be controlled in config.js
*/

define( 'main',['core', 'src/util/util', 'src/util/request', 'src/util/collection'], function(core){
    ace = _.extend({}, core, ace)
    core.load()
})
;
/** @license
 * RequireJS plugin for async dependency load like JSONP and Google Maps
 * Author: Miller Medeiros
 * Version: 0.1.2 (2014/02/24)
 * Released under the MIT license
 */
define('async',[],function(){

    var DEFAULT_PARAM_NAME = 'callback',
        _uid = 0;

    function injectScript(src){
        var s, t;
        s = document.createElement('script'); s.type = 'text/javascript'; s.async = true; s.src = src;
        t = document.getElementsByTagName('script')[0]; t.parentNode.insertBefore(s,t);
    }

    function formatUrl(name, id){
        var paramRegex = /!(.+)/,
            url = name.replace(paramRegex, ''),
            param = (paramRegex.test(name))? name.replace(/.+!/, '') : DEFAULT_PARAM_NAME;
        url += (url.indexOf('?') < 0)? '?' : '&';
        return url + param +'='+ id;
    }

    function uid() {
        _uid += 1;
        return '__async_req_'+ _uid +'__';
    }

    return{
        load : function(name, req, onLoad, config){
            if(config.isBuild){
                onLoad(null); //avoid errors on the optimizer
            }else{
                var id = uid();
                //create a global variable that stores onLoad so callback
                //function can define new module after async load
                window[id] = onLoad;
                injectScript(formatUrl(req.toUrl(name), id));
            }
        }
    };
});

define('src/util/table',['jquery'], function($) {
    window.ace = window.ace || {}

    window.ace.table = {
        data: {},
        getCollection: function(res, name) {
            var collection = _.findWhere(res, {collectionname: name})
           
            return collection
        },
        getPoiCollection: function(res) {
            var collection

            if (res && _.isArray(res)) {
                collection = _.findWhere(res, {collectionname: 'poi'})
            }
            return collection && !_.isEmpty(collection) ? collection : res
        },
        getCollectionAttributes: function(res) {
            if (res.attributes) {
                options.responseAttributes = res.attributes
                if (res.collectioncount) {
                    options.responseAttributes.collectioncount = res.collectioncount
                }
            }
        },

        getValueCollection: function(res, name) {
            var result = this.getCollection(res, name)
            return  result && result.collection || []
        }
    }
});
define('src/util/locale',['jquery'], function($) {
    window.ace = window.ace || {}
    
    window.ace.locale = {
        locales: {}, // A cache of loaded locales.  Usually, there is only one loaded locale.
        current: null, // The default locale (the last one loaded is the default).

        // Called on page load.  A locale does not usually need to be specified.  The AJAX handler will
        // use the same locale that it would use for messages.  When the AJAX call returns, the response
        // handler will substitute the locale strings in the document, and call an optional callback.
        //

        loadLocale: function(locale, callback, errorCallback) {
            var localeInfo = this.locales[locale],
                request = {
                    formdata: {}
                }    
              
            this.current = locale;            
            if (localeInfo) {
                this._setLocale();
                if (_.isFunction(callback))
                    callback(this.current);
                return;
            }

            
            if (locale) {
                request.formdata.locale = locale
            }
            request.asynchronous = false;

            return ace.ajaxRequest('getlocaleinfo',  null, _processResponse.bind(this), request )                

            // When the AJAX call returns, store the locale info and substitute the locale strings
            // in the document.
            //
            function _processResponse(response) {                                
                var localeInfo = response.locale;

                this.locales[localeInfo] = localeInfo
                this.current = localeInfo
                this.currentMappings = response.mappings;
                
                if (localeInfo) {
                    parsedResponse = localeInfo.split('_')
                    if (parsedResponse && !_.isEmpty(parsedResponse)) {
                        this.languageCode = localeInfo.split('_')[0]
                        this.countryCode = $('#search_country').val() || localeInfo.split('_')[1]
                    }
                }
                
                this._setLocale()
                if (_.isFunction(callback))
                    callback(this.current)
            }            
        },

        // Insert the locale strings in the document.  Each element that has a "msgid" attribute will
        // have its inner HTML replaced with the translated text.  The current locale's mapping table
        // will be used.
        //
        _setLocale: function() {
            var elemList = $('*[msgid]');
            elemList.each(function(e, elem) {
                var msgid = $(elem).attr('msgid');
                var childinputtextobjects = $(elem).find('input[type=text]');
                var childinputtextlist = {};
                childinputtextobjects.each(function(e, elem) {
                        var id  = $(elem).attr('id');
                        var val = $(elem).val();
                        childinputtextlist[id] = val;
                });
                elem.innerHTML = ace.locale.gettext(msgid);
                $.each(childinputtextlist, function(key, value) {
                        $('#' + key).val(value);
                });
            });
            $(document).trigger("add:autocomplete");
        },
        refreshLocale: function(elem) {
            var elemList = $(elem + ' *[msgid]');
            elemList.each(function(e, elem) {
                var msgid = $(elem).attr('msgid');
                elem.innerHTML = ace.locale.gettext(msgid);
            });
        },

        // Return the translated text for a given msgid.  The current locale will be used unless
        // specified.  If the translated text cannot be found, return the msgid argument.
        //
        gettext: function(msgid, locale) {
            var mappings = (locale && this.locales[locale]) ? this.locales[locale].mappings : this.currentMappings;
            var msgstr = mappings[msgid];
            return (msgstr != undefined) ? msgstr : msgid;
        },

        // Scan the XML text for tags that contain a msgid attribute.
        // Replace the tag's inner-XML with the translated value.
        //
        getTextXML: function(xmlStr) {
            var newXML = xmlStr.replace(
                / msgid="([^"]+)">([^<]*?)</g,
                function(str, p1, p2, offset, s) {
                    return '>' + ace.locale.gettext(p1) + '<'
                }
            )
            return newXML
        }
    };

})
;
/*
*   Multiple Address collection
*
*/

define(
    'src/multipleaddress/models/multiple-address',['core', 'jquery'],
    function(core, $){
        var AddressCollection = Backbone.Collection.extend({
            getOptions: function() {
                return {
                    method:     'geocoder',
                    reset:      true,
                    success:    this.success
                }
            },
            initialize: function(options) {
                this._isMultipleAddress   = false
                this.options             = this.getOptions()
            },
            generateRequest: function(items) {
                var arr = $.makeArray(items),
                    result = {geoloc: []}
                _(arr).each(function(i) { result.geoloc.push(i) })
                this.options.formdata = { geolocs : result }
                this.load()
            },
            load: function() {
                this.fetch(this.options)
            },
            isMultipleAddress: function() {
                return this._isMultipleAddress
            },
            setAddress: function(model) {
                this._isMultipleAddress = false
                this.reset(model, { silent: true })
                this.trigger('address:loaded')
            },
            success: function(self) {
                    self.trigger('address:loaded')
            },
            parse: function(response, options) {
                /* we check for multiple address
                 * and set an flag, overriding reset or parse does not help,
                 * these methods are called cascaded
                 */
                if (response.collectionname && response.collectionname === 'multiple_address') {
                    this._isMultipleAddress = true
                    return response.collection ? response.collection : []
                } else {
                    this._isMultipleAddress = false
                    return response
                }
            }
        })
        return AddressCollection
    }
)
;
/**
*
* Multiple address view
*
* Emits - {collection:addressselected}
*/

define(
  'src/multipleaddress/multiple',[
    'src/multipleaddress/models/multiple-address',
    'src/core/baseview'
  ],
  function(AddressCollection, BaseView) {
    var module = {}
                  
      var MultipleAddressView = BaseView.extend({
          events: { 'click .address-suggestions li': 'itemClick' },
          initialize: function(options) {
              this.setElement(options.element)
              this.template   = this.loadTemplate('collection_multiple_address')
              this.collection = new AddressCollection(options.collection)

              this.listenTo(this.collection, 'reset', this.render)
              this.render()
          },
          render: function() { this.$el.html(this.template(this.collection.toJSON())) },
          show: function(options){
              this.collection.reset(options.collection, {silent: true})
              this.render()
          },
          itemClick: function(event) {
            var idx   = this.getTarget(event),
                model = null
            if (!idx.is('li')) { idx = idx.parents('li') }
            model = this.collection.at(idx.data('id'))
            if (model) {
              this.ea.trigger('collection:addressselected', model)
              this.$el.empty()
            }
          }
      })
  return MultipleAddressView
});
/**
*
* base collection, stub for now
*
*/
define( 'src/core/basemodel',[],function(){

    return Backbone.Model.extend({
        initialize: function(options) {
            this.options = this.getOptions(options)
        },
        url: W2GI.config.url || 'rest',
        getOptions: function(options) {
            var defaults = {
                method:     'getlist',
                reset:      true
            }
            return _.extend(defaults, options)
        },
        setModelValues: function(items, model) {
           var _model  = model,
               self    = this
          _.each(_(items).keys(), function(e) {
              self.deepFind(_model, e, items[e])
          })
          return _model
        },
        deepFind: function(obj, key, value) {
          if (typeof obj === 'object') { // || typeof obj == 'array') {
            if (key in obj && obj.hasOwnProperty(key) && obj[key] !== 'undefined') {
              if (value) {
                 obj[key] = this.setValue(obj[key], value)
              }
              return true
            } else {
              for (var x in obj) {
                if (obj.hasOwnProperty(x) && x[key] !== 'undefined') {
                  var found = this.deepFind(obj[x], key, value)
                  if (found !== false) {
                     if (value) {
                      x[key] = this.setValue(x[key], value)
                    }
                     return true
                  }
                }
              }
            }
          }
          return false
        },
        /*
        * Sets the value of a given object, taking into
        * account possible nested operator elements
        */
        setValue: function(obj, value) {
          var childObj  = _.keys(obj)[0],
              result    = obj,
              _value = value

          if (_.isBoolean(_value)) { _value = _value.toString() }

          if (_.isEmpty(childObj)) { // no nested tags
            result = _value
          } else {
            if (obj[childObj] !== 'undefined') {
              result[childObj] = _value
              if (childObj === 'ilike' && _.isString(value)) {
                result[childObj] = '%' + _value + '%'
              }
            }
          }
          return result
        },

        load: function() {
            this.fetch(this.options)
        }
    })
})
;
/*
*
*   Locator model
*
*/

define(
    'src/map/models/locator-search',['src/core/basemodel'],
    function(Model){
        return Model.extend({
            getOptions: function() {
                return {
                    //url:        'rest',
                    method:     'locator_search',
                    reset:      true
                }
            },
            initialize: function(options) { this.options = this.getOptions() },
            load:       function() { this.fetch(this.options) },
            setModelValues: function(items, model) {
                var _model  = model,
                    self    = this
              _.each(_(items).keys(), function(e) { 
                         self.deepFind(_model, e, items[e])
 
              })
              if(items.addressline && items.addressline !== "Enter street address, city, state or zip code" && !!_model.geoip) {
                  _model.geoip = false
              }
              return _model
            },
            
            validate: function(attrs, options) {
                var reg = /[|&;$%@"<>/\()+]/g,
                    isValid = true
                if (attrs) {
                    if (attrs.addressline) {
                        isValid = !(_.isEmpty(attrs.addressline) || reg.test(attrs.addressline))
                    }
                }
                if (!isValid) { return 'Invalid address' }
            }
        })
    }
)
;
/**
*
* base collection, stub for now
*
*/
define( 'src/core/basecollection',[],function(){

    /*
    * Underscore mixins
    */

    _.mixin({ mapValues: function (obj, f_val) { 
              return _.object(_.keys(obj), _.map(obj, f_val));
    }})

    return Backbone.Collection.extend({
        initialize: function(options) {
            this.options = this.getOptions(options)
        },
        getOptions: function(options) {
            var defaults = {
                url:        W2GI.config.url || 'rest',
                method:     'getlist',
                reset:      true
            }
            return _.extend(defaults, options)
        },
        
        load: function() {
            this.fetch(this.options)
        },
        error: function(error) {
            this.trigger('error')   
        }
    })    
});
/**
*
* Client side geocoder & directions
*
* Listens to - {}
* Emits - {locator:search}
*
*/

define(
  'src/clientside/client',[
    'src/core/baseview',
    'src/core/basemodel',
    'src/core/basecollection',
    'jquery'
  ],
  function(BaseView, BaseModel, BaseCollection, $) {
    var module = {}
    var W2GILocatorsModel = BaseCollection.extend({
        getOptions: function() {
            return {
                url:        W2GI.config.url || 'rest',
                method:     'getlist',
                tagName:    'locator',
                    formdata: {
                        objectname: 'W2GILocator',
                        where: {
                            appkey: {
                                eq: W2GI.config.appkey
                            }
                    }
                },
                alertError  : false,
                asynchronous: false,
                reset:  true
            }
        },
        initialize: function(options) {
         this.options = this.getOptions()
         this.load()
        },
        load: function(data) { this.fetch(this.options) }
    })

    var googleLanguageCodes = [
        {"name":"ARABIC","code":"ar"},  {"name":"BASQUE","code":"eu"},  {"name":"BULGARIAN","code":"bg"},   {"name":"BENGALI","code":"bn"},
        {"name":"CATALAN","code":"ca"}, {"name":"CZECH","code":"cs"},   {"name":"DANISH","code":"da"},      {"name":"GERMAN","code":"de"},
        {"name":"GREEK","code":"el"},   {"name":"ENGLISH","code":"en"}, {"name":"ENGLISH (AUSTRALIAN)","code":"en-AU"}, 
        {"name":"ENGLISH (GREAT BRITAIN)","code":"en-GB"}, {"name":"SPANISH","code":"es"}, {"name":"BASQUE","code":"eu"}, 
        {"name":"FARSI","code":"fa"},    {"name":"FINNISH","code":"fi"},    {"name":"FILIPINO","code":"fil"}, {"name":"FRENCH","code":"fr"},
        {"name":"GALICIAN","code":"gl"}, {"name":"GUJARATI","code":"gu"},   {"name":"HINDI","code":"hi"},   {"name":"CROATIAN","code":"hr"},
        {"name":"HUNGARIAN","code":"hu"}, {"name":"INDONESIAN","code":"id"}, {"name":"ITALIAN","code":"it"},{"name":"HEBREW","code":"iw"},
        {"name":"JAPANESE","code":"ja"}, {"name":"KANNADA","code":"kn"},    {"name":"KOREAN","code":"ko"},  {"name":"LITHUANIAN","code":"lt"},
        {"name":"LATVIAN","code":"lv"},  {"name":"MALAYALAM","code":"ml"},  {"name":"MARATHI","code":"mr"}, {"name":"DUTCH","code":"nl"},
        {"name":"NORWEGIAN","code":"no"}, {"name":"POLISH","code":"pl"},    {"name":"PORTUGUESE","code":"pt"}, 
        {"name":"PORTUGUESE (BRAZIL)","code":"pt-BR"}, {"name":"PORTUGUESE (PORTUGAL)","code":"pt-PT"},     {"name":"ROMANIAN","code":"ro"}, 
        {"name":"RUSSIAN","code":"ru"}, {"name":"SLOVAK","code":"sk"},  {"name":"SLOVENIAN","code":"sl"},   {"name":"SERBIAN","code":"sr"}, 
        {"name":"SWEDISH","code":"sv"}, {"name":"TAGALOG","code":"tl"}, {"name":"TAMIL","code":"ta"},       {"name":"TELUGU","code":"te"}, 
        {"name":"THAI","code":"th"},    {"name":"TURKISH","code":"tr"}, {"name":"UKRAINIAN","code":"uk"},   {"name":"VIETNAMESE","code":"vi"}, 
        {"name":"CHINESE","code":"zh-CN"}, {"name":"CHINESE (SIMPLIFIED)","code":"zh-CN"}, {"name":"CHINESE (TRADITIONAL)","code":"zh-TW"},
        {"name":"MALAY","code":"ms"}
    ]
                      
    var ClientSide = BaseView.extend({
        initialize: function(options) {
            this.clientLocators = new W2GILocatorsModel()
            this.options = options
            //this.useClientSideGeocoding = true
            //this.useClientSideDirections = true
            this.searchFormID = options.searchFormID
            this.registerEvents()
        },
        registerEvents: function() {
            _.bindAll(this, 'searchClientSide')
            this.ea.bind('locator:searchclientside',  this.searchClientSide)
            this.listenTo(this.clientLocators, 'reset', this.locatorsLoaded)
        },
        doClientGeocode: function(request, options) {
            //client side geocoding is on, need to intercept this, but first make sure that it is
            //a product or locator search, without this the locator console can't do advance search
            if ( _.contains(['locator_search', 'base_locator_search', 'product_search'], this.options.searchFormID )) {
                return this.cgeo.geocode(request, undefined, options)
                //return this.ea.trigger('locator:search', request)
            } else {
                return this.ea.trigger('locator:search', request, options)
            }
        },
        searchClientSide: function(request, options) {

            if (this.useClientSideGeocoding) {
                var self = this
                if (typeof this.cgeo === 'undefined' || this.cgeo === null) {
                    //wait for it
                    //$(document).on('w2gi:acecgeoloaded', function(ev) {
                    this.ea.bind('w2gi:acecgeoloaded', function(ev) {
                        self.doClientGeocode(request, options)
                    }.bind(this));
                } else {
                    self.doClientGeocode(request, options)
                }
            } else {
                //the client side geocoding is not enabled
                return this.ea.trigger('locator:search', request, options)
            }

            
        },
        locatorsLoaded: function() {
            ace = ace || {}
            ace.w2gilocator = this.clientLocators.toJSON()

            this.useClientSideGeocoding = !!this.clientLocators.find(function(model) {
                return model.get('clientsidegeocoding') === 1
            })

            this.useClientSideDirections = !!this.clientLocators.find(function(model) {
                return model.get('clientsidedirections') === 1
            })
            
            this.useClientSideDirections = (this.options.cdirections === undefined || this.options.cdirections == null) ? this.useClientSideDirections : this.options.cdirections;
            
            /* If cdirections is true, then cgeo must be true */
            if(this.useClientSideDirections){
            	this.useClientSideGeocoding = true;
            }else
            	this.useClientSideGeocoding = (this.options.cgeo === undefined || this.options.cgeo == null) ? this.useClientSideGeocoding : this.options.cgeo;
            
            
            var self = this
            
            if (this.useClientSideDirections /*|| this.options.cdirections*/) { //remove
                require(['src/clientside/cdirections'], function(directions) {
                    self.cdirections = directions
                    self.ea.trigger('locator:clientdirectionson')
                    self.cdirectionLoaded = true;
                    $(document).trigger('locatorloaded:directionssearch')
                })
            }else{
            	self.cdirectionLoaded = false;
            	$(document).trigger('locatorloaded:directionssearch')
            }
            
            if (this.useClientSideGeocoding /*|| this.options.cgeo*/) {//remove
               require(['src/clientside/cgeo'], function(geocoder) {
                    self.cgeo = new geocoder(self.options)
                    ace.cgeo.reverseGeocode = function(address, options) {
                        var deferred = $.Deferred(),
                            opts = _.extend({clientSide: true}, options)
                        self.cgeo.reverseGeocode(address, null, opts).then(function(res) {
                            deferred.resolve(res)
                        })
                        return deferred.promise()
                    }
                    self.ea.trigger('locator:clientgeocodingon')
                    self.ea.trigger('w2gi:acecgeoloaded') 
                })
            }
                      
            var count = 0;

            if ((this.useClientSideDirections || this.useClientSideGeocoding) && 
                (typeof google === 'undefined' || typeof google.maps === 'undefined')) {
                //try to get language
                var language = '', lang = '', url='', arr
                
                arr = $('.route .language')
                if(arr.length > 0){ lang = arr.first().text() }

                if(lang){                    
                    lang = _(googleLanguageCodes).first(function(lang,el){
                        return (el.name.toLowerCase() == lang.toLowerCase()) || (el.code == lang)
                    })
                    if (lang){ language = lang.code }
                }
                
                if(/^https/.test(window.location.protocol)) {
                    url = 'https://maps-api-ssl.google.com'
                } else {
                    url = 'http://maps.googleapis.com'
                }

                url += '/maps/api/js?v=3.31&sensor=false&client=gme-where2getit';
                url += '&libraries=places';
                if(!_.isEmpty(language)) {
                    url += '&language=' + language
                }
            }          
            

            if(typeof cb != 'undefined' && count <= 0) {
                cb()
            }
        }
    })
    module.init = function(options) {
        return new ClientSide(options)
    }
    return module
  })
;
/*!
 * geo-location-javascript v0.4.3
 * http://code.google.com/p/geo-location-javascript/
 *
 * Copyright (c) 2009 Stan Wiechers
 * Licensed under the MIT licenses.
 *
 * Revision: $Rev: 68 $: 
 * Author: $Author: whoisstan $:
 * Date: $Date: 2010-02-15 13:42:19 +0100 (Mon, 15 Feb 2010) $:    
 */
var bb_successCallback;
var bb_errorCallback;
var bb_blackberryTimeout_id=-1;

function handleBlackBerryLocationTimeout()
{
	if(bb_blackberryTimeout_id!=-1)
	{
		bb_errorCallback({message:"Timeout error", code:3});
	}
}
function handleBlackBerryLocation()
{
		clearTimeout(bb_blackberryTimeout_id);
		bb_blackberryTimeout_id=-1;
        if (bb_successCallback && bb_errorCallback)
        {
                if(blackberry.location.latitude==0 && blackberry.location.longitude==0)
                {
                        //http://dev.w3.org/geo/api/spec-source.html#position_unavailable_error
                        //POSITION_UNAVAILABLE (numeric value 2)
                        bb_errorCallback({message:"Position unavailable", code:2});
                }
                else
                {  
                        var timestamp=null;
                        //only available with 4.6 and later
                        //http://na.blackberry.com/eng/deliverables/8861/blackberry_location_568404_11.jsp
                        if (blackberry.location.timestamp)
                        {
                                timestamp=new Date(blackberry.location.timestamp);
                        }
                        bb_successCallback({timestamp:timestamp, coords: {latitude:blackberry.location.latitude,longitude:blackberry.location.longitude}});
                }
                //since blackberry.location.removeLocationUpdate();
                //is not working as described http://na.blackberry.com/eng/deliverables/8861/blackberry_location_removeLocationUpdate_568409_11.jsp
                //the callback are set to null to indicate that the job is done

                bb_successCallback = null;
                bb_errorCallback = null;
        }
}

var geo_position_js=function() {

        var pub = {};
        var provider=null;

        pub.getCurrentPosition = function(successCallback,errorCallback,options)
        {
                provider.getCurrentPosition(successCallback, errorCallback,options);
        }

        pub.init = function()
        {			
                try
                {
                        if (typeof(geo_position_js_simulator)!="undefined")
                        {
                                provider=geo_position_js_simulator;
                        }
                        else if (typeof(bondi)!="undefined" && typeof(bondi.geolocation)!="undefined")
                        {
                                provider=bondi.geolocation;
                        }
                        else if (typeof(navigator.geolocation)!="undefined")
                        {
                                provider=navigator.geolocation;
                                pub.getCurrentPosition = function(successCallback, errorCallback, options)
                                {
                                        function _successCallback(p)
                                        {
                                                //for mozilla geode,it returns the coordinates slightly differently
                                                if(typeof(p.latitude)!="undefined")
                                                {
                                                        successCallback({timestamp:p.timestamp, coords: {latitude:p.latitude,longitude:p.longitude}});
                                                }
                                                else
                                                {
                                                        successCallback(p);
                                                }
                                        }
                                        provider.getCurrentPosition(_successCallback,errorCallback,options);
                                }
                        }
                         else if(typeof(window.google)!="undefined" && typeof(google.gears)!="undefined")
                        {
                                provider=google.gears.factory.create('beta.geolocation');
                        }
                        else if ( typeof(Mojo) !="undefined" && typeof(Mojo.Service.Request)!="Mojo.Service.Request")
                        {
                                provider=true;
                                pub.getCurrentPosition = function(successCallback, errorCallback, options)
                                {

                                parameters={};
                                if(options)
                                {
                                         //http://developer.palm.com/index.php?option=com_content&view=article&id=1673#GPS-getCurrentPosition
                                         if (options.enableHighAccuracy && options.enableHighAccuracy==true)
                                         {
                                                parameters.accuracy=1;
                                         }
                                         if (options.maximumAge)
                                         {
                                                parameters.maximumAge=options.maximumAge;
                                         }
                                         if (options.responseTime)
                                         {
                                                if(options.responseTime<5)
                                                {
                                                        parameters.responseTime=1;
                                                }
                                                else if (options.responseTime<20)
                                                {
                                                        parameters.responseTime=2;
                                                }
                                                else
                                                {
                                                        parameters.timeout=3;
                                                }
                                         }
                                }


                                 r=new Mojo.Service.Request('palm://com.palm.location', {
                                        method:"getCurrentPosition",
                                            parameters:parameters,
                                            onSuccess: function(p){successCallback({timestamp:p.timestamp, coords: {latitude:p.latitude, longitude:p.longitude,heading:p.heading}});},
                                            onFailure: function(e){
                                                                if (e.errorCode==1)
                                                                {
                                                                        errorCallback({code:3,message:"Timeout"});
                                                                }
                                                                else if (e.errorCode==2)
                                                                {
                                                                        errorCallback({code:2,message:"Position Unavailable"});
                                                                }
                                                                else
                                                                {
                                                                        errorCallback({code:0,message:"Unknown Error: webOS-code"+errorCode});
                                                                }
                                                        }
                                            });
                                }

                        }
                        else if (typeof(device)!="undefined" && typeof(device.getServiceObject)!="undefined")
                        {
                                provider=device.getServiceObject("Service.Location", "ILocation");

                                //override default method implementation
                                pub.getCurrentPosition = function(successCallback, errorCallback, options)
                                {
                                        function callback(transId, eventCode, result) {
                                            if (eventCode == 4)
                                                {
                                                errorCallback({message:"Position unavailable", code:2});
                                            }
                                                else
                                                {
                                                        //no timestamp of location given?
                                                        successCallback({timestamp:null, coords: {latitude:result.ReturnValue.Latitude, longitude:result.ReturnValue.Longitude, altitude:result.ReturnValue.Altitude,heading:result.ReturnValue.Heading}});
                                                }
                                        }
                                        //location criteria
                                    var criteria = new Object();
                                criteria.LocationInformationClass = "BasicLocationInformation";
                                        //make the call
                                        provider.ILocation.GetLocation(criteria,callback);
                                }
                        }
                        else if(typeof(window.blackberry)!="undefined" && blackberry.location.GPSSupported)
                        {

                                // set to autonomous mode
								if(typeof(blackberry.location.setAidMode)=="undefined")
								{
	                                return false;									
								}
								blackberry.location.setAidMode(2);
                                //override default method implementation
                                pub.getCurrentPosition = function(successCallback,errorCallback,options)
                                {
										//alert(parseFloat(navigator.appVersion));
                                        //passing over callbacks as parameter didn't work consistently
                                        //in the onLocationUpdate method, thats why they have to be set
                                        //outside
                                        bb_successCallback=successCallback;
                                        bb_errorCallback=errorCallback;
                                        //function needs to be a string according to
                                        //http://www.tonybunce.com/2008/05/08/Blackberry-Browser-Amp-GPS.aspx
										if(options['timeout'])  
										{
										 	bb_blackberryTimeout_id=setTimeout("handleBlackBerryLocationTimeout()",options['timeout']);
										}
										else
										//default timeout when none is given to prevent a hanging script
										{
											bb_blackberryTimeout_id=setTimeout("handleBlackBerryLocationTimeout()",60000);
										}										
										blackberry.location.onLocationUpdate("handleBlackBerryLocation()");
                                        blackberry.location.refreshLocation();
                                }
                                provider=blackberry.location;				
                        }
                }
                catch (e){ 
					alert("error="+e);
					if(typeof(console)!="undefined")
					{
						console.log(e);
					}
					return false;
				}
                return  provider!=null;
        }


        return pub;
}();
define("lib/geo", function(){});

/**
*
* Form
* Main entry point
*
* Listens to - {collection:addressselected}
* Emits - {locator:search}
*
*/

define(
  'src/form/form',[
    'src/map/models/locator-search',
    'src/core/baseview',
    'src/clientside/client',
    'lib/geo',
    'jquery'
  ],
  function(LocatorModel, BaseView, clientSide, geo, $) {
      var module = {}

      var FormView = BaseView.extend({
        events: { 'click .button-search'        : 'itemClick',
                  'click input[type="checkbox"]': 'itemClick',
                  'clickT': 'itemClick',
                  'click .button-location': 'setLocation'
        },
        initialize: function(options) {
          this.setElement($('.form-wrapper'))//this.setElement(options.element)
          /*
           * 1. Checks if searchFormID is defined (product || getlist || locator)
           * 2. Checks if search form is getlist
           * 3. By default search form is locator search
            ----
            ugly, needs refactor - cbaleanu 10/18/16
           */
          this.searchFormID = options.searchFormID ? options.searchFormID  : isGetListSearchForm.bind(this)(options.allOptions) ? 'getlist_search' : 'locator_search'
          this.template = this.loadTemplate('locator_addressline')
          options.searchFormID = options.searchFormID || this.searchFormID
          this.clientSide = clientSide.init(options)
          this.dynamicSearch = options.dynamicSearch
          this.collection_poi = options.collection_poi

          this.formdata = isGetListSearchForm.bind(this)(options.allOptions) ? checkGetlistFormData(options.allOptions.getlist) : options.formdata ;
          this.options  = isGetListSearchForm.bind(this)(options.allOptions) ? checkGetlistOptions(options.allOptions) : options;
          this.getListLocatorFlag = isGetListSearchForm.bind(this)(options.allOptions);
          this.noDynamicFilters = options.allOptions && options.allOptions.noDynamicFilters || false

          if(options.allOptions.locatorTypeId && options.allOptions.locatorTypeId == 'getlist'){
          	this.GetListFormData = checkGetlistFormData(options.allOptions.getlist);
          	this.GetListOptions = checkGetlistOptions(options.allOptions);
          }

          this.geoip = this.options.geoip;
          //Store Locator Search formdata & options
          this.LocatorSearchFormData = options.formdata;
          this.LocatorSearchOptions = options;

          //this.setModel()
          this.loadCountries()
          //this.registerEvents()

          function isGetListSearchForm(opts){

          	if (this.checkQuery() != null && ((opts.locatorTypeId && opts.locatorTypeId == 'getlist') || options.searchFormID == 'getlist') &&
          	    window.location.search.match(/getlist/) != null)
          		return true;
          	else
          		return false;
          }

          function checkGetlistFormData(getlist){
          	return getlist ? getlist.formdata : {
                    order: 'city',
                    objectname: "Locator::Store",
                    where: {
                        clientkey:       { eq: '' },
                        state:           { eq: '' },
                        city:            { eq: '' },
                        address1:        { eq: '' },
                    }
                };
          }

          function checkGetlistOptions(options){
          	return options.getlist ? options.getlist : {
                    method: "getlist",
                    formdata: {
                        order: 'city',
                        objectname: "Locator::Store",
                        where: {
                            clientkey:       { eq: '' },
                            state:           { eq: '' },
                            city:            { eq: '' },
                            address1:        { eq: '' },
                        }
                    }
          		};
          }

        },

        /*
        * subscribe to the EA events
        */
        registerEvents: function() {
          _.bindAll(this, 'addressSelected', 'poiLoadStart', 'searchLonLat', 'itemClick', 'searchExternal', '_searchRequest','_directionsSearch', '_getListSearchRequest')
          this.ea.bind('collection:addressselected',  this.addressSelected)
                  .bind('poi:loadstart', this.poiLoadStart)
                  .bind('locator:searchlonlat', this.searchLonLat)
          this.listenTo(this.model, 'error', this.showError)
          $(document).on('w2gi:proximitysearch', this.itemClick)
          $(document).on('w2gi:getlistsearchexternal', this.searchExternal)
          $(document).on('w2gi:proximitysearchrequest', this._searchRequest)
          $(document).on('w2gi:getlistsearchrequest', this._getListSearchRequest)
          $(document).on('directions:retrysearch', this._directionsSearch)
        },
        /*
        * If query params available, populate the form first
        */
        setModel: function() {
          var queryParams = this.checkQuery();
          var self = this

          if (queryParams){
            for (var i in queryParams){
              if(this.formdata.where && this.formdata.where[i]){
                  this.formdata.where[i][Object.keys(this.formdata.where[i])[0]] = queryParams[i];
              }
            }
          }

          this.model = new LocatorModel(this.formdata);

          //Store Locator Seach Model
          //Use case: client uses both getlist and locator search features
          this.LocatorSearchModel = new LocatorModel(this.LocatorSearchFormData);

          if(this.GetListFormData) {
            this.GetListModel = new LocatorModel(this.GetListFormData);
          }

          if (queryParams && queryParams.form) {
            // check for multiple addressline entries
            var result = this.getParamsMultiple()

            if (!_.isEmpty(result) && result.length  == 2) {
              var sa = result[0]
                  ea = result[1]
              this.directions = {ea: ea, sa: sa}
            }
          }
          // geoip enabled, will do autosearch
          if(!queryParams && this.geoip){
            var input = document.createElement('input')

            input.setAttribute('type', 'hidden')
            input.setAttribute('id', 'geoip_state')
            input.setAttribute('name', 'geoip')
            input.setAttribute('value', 'start')
            var search_div = $('#'+this.searchFormID)
            if(search_div)
              search_div.append(input)
          } else if (queryParams) {
            this.geoip = false
            delete this.options.geoip
            delete this.formdata.geoip
            this.model.unset('geoip', {silent:true})
          }
          if (queryParams || this.options.geoip) {
            this.populateForm(this.searchFormID)
            if (this.directions) {
              if(typeof this.clientSide.cdirectionLoaded !== 'undefined')
              	self.ea.trigger('directions:searchform', sa, ea)
              else
              	$(document).on('locatorloaded:directionssearch', function(){self.ea.trigger('directions:searchform', sa, ea)})
              //this.ea.trigger('directions:searchform', sa, ea)
            } else if (!this.collection_poi) {
              if(!queryParams) {
                if (this.formdata.gps && this.formdata.gps == 'first') {
                        this.setLocation(null)
                } else {
                        this.search(this.getFormValues(this.searchFormID))
                }
                this.getListLocatorFlag = false
              }
              else {
                if (this.formdata.gps && this.formdata.gps == 'first') {
                        if (queryParams.addressline) {
                                this.search(this.getFormValues(this.searchFormID), undefined, undefined, this.getListLocatorFlag)
                        } else {
                                this.setLocation(null)
                        }
                } else {
                        this.search(this.getFormValues(this.searchFormID), undefined, undefined, this.getListLocatorFlag)
                }
              }
            }
          } else  if (this.formdata.gps && this.formdata.gps == 'first') {
              this.setLocation(null)
          }
        },
        poiLoadStart: function(response, options) {
          $('#geoip_state').remove()
          this.renderAddress(options)
        },
        _directionsSearch: function(ev, sa, ea) {
          this.ea.trigger('directions:searchform', sa,ea)
        },
        searchLonLat: function(lonlat, options) {
          var rad, items
          rad = options.radius || null
          //if (this.locator.noZoomOnPan) {
          //  this.nozoom = true;
          //  rad = this._mapBoundsRadius();
          //}
          //else {
          //  this.nozoom = false;
          //  rad = this.searchRadius;
          //}
          //var params  = {longitude: lonlat.lon, latitude: lonlat.lat};
          if(this.searchFormID) {
            var newOpts = _.extend(this.getFormValues(this.searchFormID), options)
            items = _.extend(newOpts, lonlat);
          }
          //items.searchradius = rad;  // set searchradius after processing form to override value to visible map bounds
          //Object.extend(params, this.locator.url_params.prox);
          if (items.longitude == "" && items.latitude == "")
            // the lat and lon got blown away, so put them back in
            items = _.extend(items, {longitude: lonlat.longitude, latitude: lonlat.latitude});

          this.searchedLonLat = true
          items.addressline = ''
          this.search(items, {}, {}, true, true)
        },
        setLocation: function(event) {
          var lonLat = {},
              items = {},
              self = this
          if (event ) {
            event.preventDefault()
          }

          if(geo_position_js && geo_position_js.init()) {
            this.$('[name="addressline"]').val('')
            items   = this.getFormValues(this.searchFormID)
            delete items.addressline
            geo_position_js.getCurrentPosition(
              function(response) {
                lonLat = {longitude: response.coords.longitude,latitude: response.coords.latitude}
                self.searchLonLat(lonLat, items);
              },
              function(response) {
                self.search(items)
              },
              {maximumAge:0}
            );
          } else {
            _.extend(options, {gps:false});
            this.search(form, options);
          }
        },
        searchExternal: function(event, element) {
          items   = this.getFormValues('getlist_search');
          // this.search(items, event, undefined, true);
          this.model = this.GetListModel;
          this.items = this.GetListOptions;


          var model     = JSON.parse(JSON.stringify(this.model.toJSON())),
              request   = {}
              
          if (!_.isEmpty(items)) {
            request = this.model.setModelValues(items, model)
            this._search(request, true)
          }
        },
        itemClick: function(event, element) {
          var doc = $(document);
          var el = this.getTarget(event),
              items = {},
              form = this.$('[name="addressline"]').val(),
              country = this.$('[name="country"]');
              if(el.context === doc.context) {
                var button = $('button.button-search');
                parentNode = button[0].parentNode.id;
              } else {
                parentNode = el.context.parentNode.id;
              }
              

          country = (_.isEmpty(country) || !country || country.length == 0) ? 'US' : country.val();
          if (el.is(':submit')) { event.preventDefault() }

          if(parentNode != 'getlist_search'){
	          if (_.isEmpty(form) && this.options.alertError !== false) {
	              ace.util.alert(this.getLocaleString('validate_form', 'Please enter an address.'), {title_text: this.getLocaleString('no_results', 'No Results Found')});
	              return
	          }else if(_.isEmpty(form) && this.options.alertError === false){
	          	  var template = this.loadTemplate('panel_error_message', { noEscape: true });
                var text = this.getLocaleString('validate_form', 'Please enter an address.')
	            	$('.poi')[0].innerHTML = template({error: text});
	            	return
	          }

	          // address line empty or country == null
	          if (_.isEmpty(form) || form.length <= 3) {
	            if (country == null && this.options.alertError !== false) {//Note: Country may be undefined?
	              ace.util.alert(this.getLocaleString('validate_form', 'Please enter an address.'), {title_text: this.getLocaleString('no_results', 'No Results Found')});
	              return
	            }
	          }
	      }

          if (/[!\$%\\^*()]/.test(form) && this.options.alertError !== false) {
            ace.util.alert(this.getLocaleString('illegal_string', 'Your search must not include !$%^*()'), {title_text: this.getLocaleString('no_results', 'No Results Found')});
            return
          }

          // no dynamic search
          if (!this.dynamicSearch) {
            /*if (this.options.formdata && !_.isUndefined(this.options.formdata.google_autocomplete) && this.options.formdata.google_autocomplete == true) {
              return
            }*/
          }

          if (el.is(':checkbox') && this.noDynamicFilters) {
            return
          }
          this.ea.trigger('form:locatorsearch')
          if (this.getListLocatorFlag) {
            this.getListLocatorFlag = false
          }
          if(parentNode == 'getlist_search'){
          	items   = this.getFormValues('getlist_search');
          	this.search(items, undefined, undefined, true);

          }else if(parentNode == 'locator_search' || parentNode == 'product_search'){
            this.ea.trigger('form:locatorsearch')
          	this.searchFormID = el.context.parentNode.id;
          	items   = this.getFormValues(this.searchFormID);
          	this.search(items);
          }else {
            this.ea.trigger('form:locatorsearch')
          	this.searchFormID = 'locator_search';
          	items   = this.getFormValues(this.searchFormID);
          	this.search(items);
          }
        },
        getLocaleString: function(key, defaultValue) {

          if ( W2GI.custom_ob && W2GI.custom_ob.errorList && W2GI.custom_ob.errorList[key] &&  /*|| this.options.errLang*/ ace.locale.current) {
            return W2GI.custom_ob.errorList[key][ace.locale.current.substring(0,2)] || defaultValue
          } else {
            return defaultValue
          }
        },
        loadCountries: function() {
          var countrySelect = this.$('[name="country"]'),
              self = this,
              setupSearch = function(response) {
                self.setModel()
                self.registerEvents()
                window.ace.collection.countryDropDownLocales = response
                self.ea.trigger('countries:data', response)
              }
          // country dd is empty, populate first
          if ( !countrySelect.val() && this.$('[name="country"] option').length <=1) {
            ace.collection.appendOptions('#search_country', 'Account::Country', {}, 'account_country', 'name', 'description', setupSearch)
          } else {
            setupSearch()
          }
        },
        search: function(options, event, element, getListLocatorFlag, lonLatSearch) {
          try {
             if (lonLatSearch && lonLatSearch == true) {
             } else {
                this.searchedLonLat = false;
             }
          } catch (e) {}
          if(!getListLocatorFlag || lonLatSearch){
              this.model = this.LocatorSearchModel;
              this.options = this.LocatorSearchOptions;
           }else{
           		if(!this.options.method && this.options.method != 'getlist'){
           			this.model = this.GetListModel;
           			this.options = this.GetListOptions;
           		}
           }

          var model     = JSON.parse(JSON.stringify(this.model.toJSON())),
              request   = {}

          if (!_.isEmpty(options)) {
            request = this.model.setModelValues(options, model)
            this._search(request, getListLocatorFlag)
          }
        },
        renderAddress: function(result) {
          var parsedResult = {}
          if (!result) { return }
          if (typeof result.toJSON !== 'undefined') {
            var address = result.get('address1').trim()
            if (_.isEmpty(address)) {
              result.unset('address1')
            }
            parsedResult = {
              addressline: this.template( result.toJSON() ).trim()
            }
            parsedResult.latitude   = result.get('latitude')
            parsedResult.longitude  = result.get('longitude')
            parsedResult.country    = result.get('country')
          } else {
            parsedResult = {
              addressline: this.template( result ).trim(),
              country: result.country
            }
          }

          if (!parsedResult.latitude && !parsedResult.longitude) {
              if (result.centerpoint) {
                var arr = result.centerpoint.split(',')
                parsedResult.longitude = arr[0]
                parsedResult.latitude = arr[1]
              }
          }

          if (parsedResult.addressline && parsedResult.addressline.length) {
             parsedResult.addressline = parsedResult.addressline.replace(/\s+/g, ' ');
          }

          W2GI.addresses = []
          W2GI.form = this.searchFormID
          W2GI.addresses.push({latitude: parsedResult.latitude, longitude: parsedResult.longitude})
          this.populateForm(this.searchFormID, parsedResult )
        },
        addressSelected: function(result) {
          var address = {}
          this.renderAddress(result)
          address.latitude   = result.get('latitude')
          address.longitude  = result.get('longitude')
          this.searchLonLat(address, {radius: 10})
        },
        _searchRequest: function(event,request) {
           this.ea.trigger('locator:search', request, {formdataid: 'locator_search'})
        },
        _getListSearchRequest: function(event,request) {
           this.ea.trigger('locator:search', request, {formdataid: 'getlist_search'})
        },
        _search: function(request, getListLocatorFlag) {
          if (this.clientSide.useClientSideGeocoding && !getListLocatorFlag) {
            this.ea.trigger('locator:searchclientside', request, {formdataid: this.searchFormID, getListFlag: getListLocatorFlag});
          } else{
            if (this.searchedLonLat ) {
              if (!this.getListLocatorFlag) {
                 if (this.searchFormID && this.searchFormID == 'product_search') {
                    this.ea.trigger('locator:search', request, {formdataid: this.searchFormID, getListFlag: false})
                 } else {
                    this.ea.trigger('locator:search', request, {formdataid: 'locator_search', getListFlag: false})
                 }
              } else {
                return
              }
            } else {
              this.ea.trigger('locator:search', request, {formdataid: this.searchFormID, getListFlag: getListLocatorFlag})
            }

          }
        },
        showError: function(error, model) {
          console.log(error)
        }

      })
      module.init = function(options) {
        return new FormView(options)
      }
      return module
  }
)
;
/*
*
*   POI model
*
*/

define(
    'src/poi/models/poi',[
        'core',
        'src/core/basecollection'
    ],
    function(core, Collection){
        return Collection.extend({
            options: {
                    objectName: 'locator_search',
                    method:     'locatorsearch',
                    reset:      true,
                    noAccount:  true
            },
            initialize: function(options) {
                this.fields = []
                this._isMultipleAddress   = false
                this.options = _.extend({}, options, this.options)
                this.locatorsearchoptions = this.options;
                this.sortOrder = '_distance'
                var self = this
                /*ace.ajaxRequest(null, null, function(res) {
                    var fields = _(res).filter(function(e) {return e.view =='store_default'})
                                       .map(function(i) {return {'type': i.datatype, name: i.name}})
                    self.fields = fields
                },{
                    objectName: 'ComponentView::FieldEditor',
                    formdata: {
                        objectname: 'ComponentView::FieldEditor',
                        where: {
                            objectclass:  { eq: 'storelocator'}
                        }
                    }
                })*/
            },
            load: function() {
                this.fetch(this.options)
            },
            isMultipleAddress: function() {
                return this._isMultipleAddress
            },
            getPage : function(sliceSize, page) {
               var collection, parsedCollection = [],
                   self = this

               collection = _(this.rest(sliceSize*page))
               collection = _(collection.first(sliceSize))

               collection.forEach(function(item) {
                if (item instanceof Backbone.Model && item.set) {
                    parsedCollection.push(item)
                }
               })

               return parsedCollection.map( function(model) {
                    if (_.isObject(model) && model.set) {
                        model.set({'collectionIndex': self.indexOf(model) + 1}, {silent:true})
                        return model.toJSON()
                    }


                } )
            },
            getModelByUID: function(uid) {
                return this.find(function(model) {
                    return model.get('uid') == uid
                })
            },
            generateRequest: function(request,options) {
                var self = this,
                    opts = { formdata: request }

                options.formdataid = options.getListFlag ? 'getlist': options.formdataid;

                if(options.formdataid == 'locator_search')
                    this.options = this.locatorsearchoptions

                if (this.options.formdata) { delete this.options.formdata }

                switch(options.formdataid){
                	case 'locator':
                	case 'locator_search':
                		this.options =  _.extend({}, opts, this.options)
                		break;
                	case 'getlist':
                	case 'getlist_search':
                		this.options = _.extend({}, opts, {method: 'getlist', reset:true,noAccount:  true});
                		break;
                	case 'product':
                	case 'product_search':
                		this.options =  _.extend({}, opts, this.options);
                		this.options.method = 'productsearch';
                		this.options.objectName= 'product_search';
                		break;
                	default:
                		this.options =  _.extend({}, opts, this.options)
                		break;
                }

                this.load()
            },

            _getSocialCounts: function(data) {
                var likes = 0, checkins = 0
                _.each(data, function(source) {
                    likes += source.likes || 0
                    checkins += source.checkins || 0
                })

                return {
                    likes: likes,
                    checkins: checkins
                }
            },

            addPageDataTotals: function(collectionName, pageData) {
                var totals = null

                if (collectionName === 'social') {
                    totals = this.getCounts(['likes', 'checkins'],  pageData)
                }

                if (collectionName === 'reviewcount') {
                   totals = this.getCounts('badreviews', pageData)
                }

                if (collectionName === 'value') {
                    totals = this.getCounts('value', pageData)
                }
                if (collectionName === 'reviews') {
                    totals = this.getReviewCounts(pageData)
                }

                return totals
            },
            getReviewCounts: function(data){
            	var result = {
            		yelpplaces : _.where(data, {graphsource: "yelpplaces"}).length,
            		brandify : _.where(data, {graphsource: "brandify"}).length,
            		googleplaces : _.where(data, {graphsource: "googleplaces"}).length,
            		yahooplaces : _.where(data, {graphsource: "yahooplaces"}).length,
            		foursquareplaces : _.where(data, {graphsource: "foursquareplaces"}).length,
            		facebookplaces : _.where(data, {graphsource: "facebookplaces"}).length,
            		ypplaces : _.where(data, {graphsource: "ypplaces"}).length
            	}

            	for (var src in result){
            		if(result[src] != 0){
            			result[src + 'profile'] = _.where(data, {graphsource: src})[0].profilerating
            		}

            	}

            	return result;

            },
            getCounts: function(items, data) {
                var result = {}, self = this
                _.each(items, function(item) {
                    result[item] = self.getValueCount(data, item)
                })

                return result
            },

            getValueCount: function(data, key) {
                return _.reduce(data, function(memo, item){ return memo + item[key] }, 0)
            },
            getRecordByClientKey: function(collection, clientkey) {
                return _.where(collection, {clientkey: clientkey})
            },

            // convert true/false values and add collectioncount
            parseJsonResponse: function(collection, responseAttributes) {
                var result = []


                _.each(collection, function(poi) {
                    var item = _.mapValues(poi, function(el) {
                        if (_(el).isString()) {
                            if (el === 'true') { return true  }
                            if (el ==='false') { return false }
                            return el
                         }
                         return el
                    })
                    item.count = responseAttributes && responseAttributes.collectioncount
                    // needed for sort, distance is numeric
                    if (item._distance) {
                        item._distance = +item._distance
                    }

                    result.push(item)
                })
                return result
            },
            sortResults: function(order) {

                var collection = this._sortResults(this.toJSON(), order)
                this.sortOrder = order
                this.reset(collection, {silent: true})
                this.trigger('sort')

            },

            _sortResults: function(items, order, partnerType) {
                var result = [],
                    sortOrder = order || this.sortOrder,
                    field


                result = _.sortBy(items, order)

                return result

            },
            addMetaData: function(poiCollection, response) {
                var result,
                    collections = [],
                    self = this,
                    collectionNames = ['social', 'event', 'value', 'reviewcount', 'reviews']

                _.each(collectionNames, function(collectionName) {
                    var collection = ace.table.getValueCollection(response, collectionName)
                    collections[collectionName] = collection

                    _.each(poiCollection, function(poi) {
                        var pageData = self.addPoiPageData(collection, poi, collectionName)
                        poi._meta = poi._meta || {}
                        // now we have pageData for all of the above meta items
                        poi._meta[collectionName] = { pageData: pageData }

                        // we need to add specific items for some collectionNames
                        poi._meta[collectionName].totals = self.addPageDataTotals(collectionName, pageData)
                    })

                })

                return poiCollection
            },
            addPoiPageData: function(collection, poi, channelName) {
                return  this.getRecordByClientKey(collection, poi.clientkey) || {}
            },
            // succint way of adding our social data if it exists
            addSocialData: function(collection, poi) {
                var self = this, socialCollection, result
                var socialData = self.getRecordByClientKey(collection, poi.clientkey)
                if (socialData && !_.isEmpty(socialData)) {
                    result = {
                            pageData: socialData,
                            totals: self._getSocialCounts(socialData)
                    }
                }
                   // })
                return result
            },
            parse: function(data, options) {
                var result = [],
                    self = this,
                    poiCollection,
                    socialCollection,
                    responseAttributes = null
                /* we check for multiple address
                 * and set an flag, overriding reset or parse does not help,
                 * these methods are called in a cascaded way
                 */

                poiCollection = ace.table.getPoiCollection(data)
                
                if (poiCollection.collectionname && poiCollection.collectionname === 'multiple_address') {
                    this._isMultipleAddress = true
                    this.trigger('collection:multiple', poiCollection.collection ? poiCollection.collection : [])
                    return false
                } else {
                    // cache
                    ace.cache.add('proximityResponse', data)

                    if (poiCollection.responseAttributes) {
                        responseAttributes = _.extend(poiCollection.responseAttributes, poiCollection.attributes)
                    } else if (options.responseAttributes) {
                        responseAttributes = _.extend(options.responseAttributes, poiCollection.attributes)
                    } else if (poiCollection.attributes) {
                        responseAttributes = poiCollection.attributes
                    } else {
                        responseAttributes = null
                    }
                    this.responseAttributes = responseAttributes

                    if (poiCollection.collection) {
                        poiCollection = poiCollection.collection
                    }
                    // add metadata to the pois
                    poiCollection = this.addMetaData(poiCollection, data)

                    this._isMultipleAddress = false
                }

                result = this.parseJsonResponse(poiCollection, this.responseAttributes)

                if(options.formdata.randomize === true) {
                    result = _.shuffle(result)
                }

                if (W2GI.custom_ob && W2GI.custom_ob.updateRecords) {
                  return W2GI.custom_ob.updateRecords(result)
                }
                result = this._sortResults(result)
                return result
            }
        })
    }
)
;
/**
 * ============================================================================
 *  PoiSelectorView
 * ============================================================================
 *
 * Singleton responsible of the selection of a single POI that can come from any
 * type of source: the map (a marker), the poi panel (an item), etc.
 *
 * The following events are listened from and fired to the document element,
 * i.e. it doesn't use the `Backbone.Events` (this.ea).
 * - Listens to - {w2gi:selectpoi} {w2gi:unselectpoi} 
 * - Emits - {w2gi:poiselected} {poi:poiunselected}
 *
 * Backbone events:
 * - Listens to - {poi:loadstart}
 */

define('src/poi/poiselector', ['src/core/baseview', 'jquery'], function(BaseView, $) {

  var PoiSelectorView = BaseView.extend({

    /**
     * The property name that identifies the unique id of a record
     * @type {string}
     * @private
     */
    uidProperty: 'uid',

    /**
     * A reference to the current POI records. Automatically on every
     * 'poi:loadstart' event fired.
     * @type {Array.<Object>}
     * @private
     */
    records: null,

    /**
     * The currently selected record.
     * @type {?Object}
     * @private
     */
    selectedRecord: null,

    // === PUBLIC METHODS ===

    /**
     * Select a record from its uid.
     * @param {number} uid Unique id.
     * @api
     */
    select: function(uid) {
      var selectedRecord = this.selectedRecord;
      var record = this.findRecord(uid);
      if (record) {
        this.unselect();
        if (selectedRecord !== record) {
          this.selectedRecord = record;
          $(document).trigger('w2gi:poiselected', record);
        }
      }
    },

    /**
     * Unselect currently selected record.
     * @api
     */
    unselect: function() {
      var selectedRecord = this.selectedRecord;
      if (selectedRecord) {
        this.selectedRecord = null;
        $(document).trigger('w2gi:poiunselected', selectedRecord);
      }
    },

    // === PRIVATE METHODS ===

    /**
     * @private
     */
    initialize: function() {
      this.records = [];
      this.registerEvents()
    },

    /**
     * @private
     */
    registerEvents: function() {
      // this is the equivalent of doing this.handlePoiLoadStart.bind(this)
      _.bindAll(
        this,
        'handlePoiLoadStart',
        'handleW2GISelectPoi',
        'handleW2GIUnselectPoi'
      );

      // Backbone.Events
      this.ea.bind('poi:loadstart', this.handlePoiLoadStart);

      // document events
      $(document).on('w2gi:selectpoi', this.handleW2GISelectPoi);
      $(document).on('w2gi:unselectpoi', this.handleW2GIUnselectPoi);
    },

    /**
     * Called every time new poi records are loaded. Unselect currently
     * selected record, then keep a reference of the new records.
     * @param {Array.<Object>}
     * @private
     */
    handlePoiLoadStart: function(records) {
      this.unselect();
      this.records = records;
    },

    /**
     * @param {jQuery.Event} event Event
     * @param {number} uid Unique id.
     * @private
     */
    handleW2GISelectPoi: function(event, uid) {
      this.select(uid);
    },

    /**
     * @param {jQuery.Event} event Event
     * @private
     */
    handleW2GIUnselectPoi: function(event) {
      this.unselect();
    },

    /**
     * @param {number} uid Unique id of the record.
     * @return {?Object}
     * @private
     */
    findRecord: function(uid) {
      var record = null;
      var uidProp = this.uidProperty;
      for (var i = 0, len = this.records.length; i < len; i++) {
        if (this.records[i][uidProp] == uid) {
          record = this.records[i];
          break;
        }
      }
      return record;
    }

  });

  // Return instance
  return new PoiSelectorView();
});

/**
*
* POI Results panel
*
* Listens to - {locator:search} {marker:click}
* Emits - {collection:multiple} {poi:loadstart} {poi:click}
*
*/

define(
  'src/poi/poi',[
    'src/core/baseview',
    'src/poi/models/poi',
    'src/poi/poiselector',
    'jquery'
  ],
  function(BaseView, PoiCollection, poiSelector, $) {
      var module = {}

      var PoiView = BaseView.extend({
        events: {
          'click li.poi-item'   : 'handleClick',
          'focus li.poi-item' : 'handleFocus',
          'blur li.poi-item'  : 'handleBlur',
          'click #senddirectionsto'   : 'handleClick',
          'click .poi_paging_next': 'nextPage',
          'click .poi_paging_prev': 'prevPage'
        },
        initialize: function(options) {
          this.setElement(options.element)
          this.template     = this.loadTemplate('collection_poi')
          this.sliceSize    = $('script#' + 'collection_poi').data('slicesize') || null
          this.currentPage  = 0
          this.options      = options
          this.setCollection()
          this.poiSelector = poiSelector;

        },
        /*
        * subscribe to the EA events
        */
        registerEvents: function() {
          _.bindAll(this, 'search', 'markerClick', 'updatePanel','poiSelected', 'changeSortOrder', 'sortingChanged')
          this.ea.bind('locator:search',  this.search)
                 .bind('marker:click',    this.markerClick)
                 .bind('directions:updatePanel', this.updatePanel)
                 .bind('popup:close', this.clearSelected)

          this.listenTo(this.collection, 'reset', this.render)
          this.listenTo(this.collection, 'collection:multiple', this.multipleAddress)
          this.listenTo(this.collection, 'sort', this.sortingChanged)
          $(document).on('map:poiselected', this.poiSelected);
          this.$el.on('change','#sort-by-selector' , this.changeSortOrder)
        },
        changeSortOrder: function(event) {
          var sortOrder = $('#sort-by-selector').val()
          this.currentPage = 0
          this.collection.sortResults(sortOrder)
        },
        sortingChanged: function() {
          this.render(true)
        },
        getPagedCollection: function(sliceSize) {
          var _sliceSize = _.isNull(sliceSize) ? this.collection.length : sliceSize;
          return this.collection.getPage(_sliceSize, this.currentPage)
        },
        getModelForEvent: function(event) {
          var target = this.getTarget(event),
              uid = this.getUID(target),
              model = this.collection.getModelByUID(uid)

          return model
        },
        handleFocus: function(event) {
          var item = this.getModelForEvent(event)
          this.ea.trigger( 'poi:focus', item.toJSON())
        },
        handleBlur: function(event) {
          var item = this.getModelForEvent(event)
          this.ea.trigger( 'poi:blur', item.toJSON())
        },
        nextPage: function() {
          this.nextPageEl = $('.poi_paging_next', this.$el)
          this.prevPageEl = $('.poi_paging_prev', this.$el)

          if (this.currentPage === this.totalPages) {
            return
          }
          if (this.currentPage + 1 > this.totalPages) {
            return this.nextPageEl.addClass('poi_paging_disabled')
          } else {
            this.currentPage += 1
            collection = this.getPagedCollection(this.sliceSize, this.currentPage)

            this.$el.html( this.template( {
              count: this.getPageCount(),
              pois: collection,
              _attributes: this.collection.responseAttributes,
              radius: this.getResponseAttribute('radius'),
              radiusuom: this.getResponseAttribute('radiusuom'),
              sliceprevsize: this.sliceSize,
              slicenextsize: this.sliceSize,
              pageno: this.currentPage +1,
              pages: this.totalPages +1
            } ) )
            if (this.prevPageEl.hasClass('poi_paging_disabled')) {
              this.prevPageEl.removeClass('poi_paging_disabled')
            }
            if (this.currentPage === this.totalPages) {
              $('.poi_paging_next', this.$el).addClass('poi_paging_disabled')
            }
            this.pageUpdated()
          }

        },
        prevPage: function() {
          this.nextPageEl = $('.poi_paging_next', this.$el)
          this.prevPageEl = $('.poi_paging_prev', this.$el)

          if (this.currentPage === 0) {
            return
          }
          this.currentPage -= 1

          if (this.currentPage < this.totalPages) {
            this.nextPageEl.removeClass('poi_paging_disabled')
          }

          collection = this.getPagedCollection(this.sliceSize, this.currentPage)
          this.$el.html( this.template( {
              count: this.getPageCount(),
              pois: collection,
              _attributes: this.collection.responseAttributes,
              radius: this.getResponseAttribute('radius'),
              radiusuom: this.getResponseAttribute('radiusuom'),
              sliceprevsize: this.sliceSize,
              slicenextsize: this.sliceSize,
              pageno: this.currentPage +1,
              pages: this.totalPages +1
            } ) )

          if (this.currentPage === 0) {
            $('.poi_paging_prev', this.$el).addClass('poi_paging_disabled')
          }
          this.pageUpdated()
        },
        resetPaging: function(sliceSize, collectionSize) {
          this.currentPage = 0
          if (this.sliceSize) {
            this.totalPages = this.collection.length === this.sliceSize ? 0 : Math.ceil(this.collection.length / this.sliceSize) - 1
            this.nextPageEl = $('.poi_paging_next', this.$el)
            this.prevPageEl = $('.poi_paging_prev', this.$el)
            $('.poi_paging_wrapper').show()
            this.prevPageEl.addClass('poi_paging_disabled')
            if (this.totalPages === 0) { // 1 page or no results
              $('.poi_paging_next', this.$el).addClass('poi_paging_disabled')
            } else {
              this.nextPageEl.removeClass('poi_paging_disabled')
            }
            //$('.poi_paging_slice').html(sliceSize)
            $('.poi_paging_number').text('1')
            $('.poi_paging_totalpages').text(this.totalPages + 1)
          } else {
            this.totalPages = 0
            $('.poi_paging_wrapper').hide()
          }
          this.pageUpdated()
        },
        getPageCount: function() {
          var result

          if (this.collection.responseAttributes && this.collection.responseAttributes.collectioncount) {
            result = this.collection.responseAttributes.collectioncount
          } else {
            result = this.collection.length
          }
          return  result
        },
        getResponseAttribute: function(attr) {
        	return this.collection.responseAttributes && this.collection.responseAttributes[attr]
        },
        pageUpdated: function() {
          var numberofresults =  (this.sliceSize * (this.currentPage) + 1) + '-' + (this.sliceSize * (this.currentPage +1 )),
              pageposition = this.currentPage + 1 + ' of ',
              count = this.getPageCount()

          if (this.totalPages && this.totalPages > 0) {
            pageposition += this.totalPages
          } else {
            pageposition += 1
          }
          if (count < (this.sliceSize * (this.currentPage +1 ))) {
            if (this.currentPage > 0) {
              numberofresults = (this.sliceSize * (this.currentPage) + 1) + '-' + count
            } else {
              numberofresults = '1 - ' + count
              $('.poi_paging_next').addClass('poi_paging_disabled').attr('aria-disabled', true)
            }
          }

          $('.poi_paging_slice').text(numberofresults)
          $('#sort-by-selector').val(this.collection.sortOrder || '_distance')
          $(document).trigger("w2gi:sliceupdated")
          var collection = this.getPagedCollection(this.sliceSize, this.currentPage)
          this.ea.trigger( 'poi:loadstart', collection, this.collection.responseAttributes )
          //$(document).trigger("w2gi:sliceupdated")
        },
        render: function() {
          if (!this.collection.isMultipleAddress()) {
            var collection = [],
                count = this.getPageCount()

            collection = this.getPagedCollection(this.sliceSize ? this.sliceSize : this.collection.length)
            this.totalPages = this.collection.length === this.sliceSize ? 0 : Math.ceil(this.collection.length / this.sliceSize) - 1
            this.$el.html( this.template({
              count: count,
              pois: collection,
              _attributes: this.collection.responseAttributes,
              radius: this.getResponseAttribute('radius'),
              radiusuom: this.getResponseAttribute('radiusuom'),
              sliceprevsize: this.sliceSize,
              slicenextsize: this.sliceSize,
              pageno: this.currentPage +1,
              pages: this.totalPages +1
            } ))
            $('#sort-by-selector').val(this.collection.sortOrder || '_distance')
            this.resetPaging(collection.length, count)

            // new results were fetched from the server
            // so reset the paging as we're dealing with a new result set


            //this.ea.trigger( 'poi:loadstart', collection, this.collection.responseAttributes )
            this.ea.trigger('poi:proximityresponse', collection)
            $(document).trigger("w2gi:proximityresponse", { 'response' : this.collection.toJSON(), 'geoipData' : this.getGeoIpData() })
            this.moreInfoFlag = false;
          }
        },
        getGeoIpData: function() {

          var geoipData = {}, self = this

          _.each(['country','city', 'postalcode', 'province', 'state'], function(item) {
            geoipData[item.toUpperCase()] = self.getResponseAttribute(item)
          })

          return geoipData
        },
        updatePanel: function(directions, addresses, alongtheway) {
          var template = this.loadTemplate('collection_maneuvers', { noEscape: true })
          var fromAddress, toAddress, maneuvers, data, atwcount,atwuidlist

          fromAddress = addresses[0]
          toAddress = addresses[1]
          maneuverlist = directions.collection
          atwcount = 1
          atwuidlist = []

          for(i=0; i<maneuverlist.length;i++){
          	if(maneuverlist[i].pois && maneuverlist[i].pois.collectioncount > 0){
          		var maneuverIndex = i;
          		var tempLength = maneuverlist[maneuverIndex].pois.collection.length;

          		for(j=0; j<tempLength;j++){
          			var poiIndex = j;

          			if(!_.contains(atwuidlist, maneuverlist[maneuverIndex].pois.collection[poiIndex].uid)){
          				atwuidlist.push(maneuverlist[maneuverIndex].pois.collection[poiIndex].uid);
          			}else{
          				maneuverlist[maneuverIndex].pois.collection = _.without(maneuverlist[maneuverIndex].pois.collection, maneuverlist[maneuverIndex].pois.collection[poiIndex]);
          				maneuverlist[maneuverIndex].pois.collectioncount--;
          				j--;
          				tempLength--;
          			}
          		}
          	}
          }

          for(i=0; i<maneuverlist.length;i++){
          	if(maneuverlist[i].pois && maneuverlist[i].pois.collectioncount > 0){
          		for(j=0; j<maneuverlist[i].pois.collection.length;j++){
          			maneuverlist[i].pois.collection[j].recnum = atwcount;
          			atwcount += 1;
          			maneuverlist[i].alongtheway = alongtheway;
          		}
          	}
          }

          data = {
            fromAddress : fromAddress,
            toAddress : toAddress,
            maneuverlist : maneuverlist,
            total_time: directions.attributes.total_time,
            total_distance: directions.attributes.total_distance,
            emailmapurl: directions.attributes.emailmapurl,
            mobilemapurl: directions.attributes.mobilemapurl,
            distanceuom: directions.attributes.distanceuom,
            timeuom: directions.attributes.timeuom,
            attributes: directions.attributes
          }
          this.$el.addClass('maneuver').html( template(data))
          this.$el.scrollTop(0)//Scroll to top
        },
        setCollection: function() {
          var collection_poi = W2GI.collection && W2GI.collection.poi

          this.collection =  new PoiCollection()
          this.registerEvents()
          if (collection_poi) {
            this.collection.reset(collection_poi)
          }
        },
        handleClick: function(event) {
          event.preventDefault()
          var target    = this.getTarget(event),
              action    = target.data('action'),
              uid       = this.getUID(target),
              id       = this.getID(target)
          if ( !(target.is('checkbox' )) && !( target.is('a') ) ) {  event.stopPropagation() }

          switch (action) {
            case 'open_bubble':
              var feature = this.collection.getModelByUID(uid)
              var initialTab = target.data('initialtab')

              this.ea.trigger('set:initialtab', initialTab)

              if (!initialTab && feature && feature.popup) {
                var tabs = $(feature.popup.id).select('.tab_label');
                initialTab = (tabs.length > 0) ? tabs[0].innerHTML : null;
              }
              this.select(target)
              /*
              if (initialTab) {
                this.smap.popup.selectTabLabel(initialTab);
              }*/
              break;
            case 'sort_table':
              /*
              var sortField = event.element().readAttribute('sort_field');
              var fieldType = event.element().readAttribute('field_type');
              ace.table.sortRecords(sortField, fieldType, this.locator.panelID);
              ace.table.updateFromRecords(panel);
              this.smap.clear();
              this.update(this.smap.locator.proximitySearch.centerPoint);
              document.fire('w2gi:track', {
                action: 'sort_table',
                value: sortField
              });
              */
              break;
            case 'show_gs':
              var record = this.collection.getModelByUID(uid)
              this.openStreetView(uid, record);
              break;
            case 'more_info':
              this.oldPoi = $('.poi').html();
              this.oldRecords = this.collection.models;
              this.collection.reset(new Array(this.collection.getModelByUID(uid).toJSON()));
              this.openMoreInfo(target, uid, id)
              break;
              /*
              recnum = event.element().readAttribute('recnum');
              // Have to do this monkey business to make this work properly
              ace.table.oldrecords = ace.table.data[this.locator.panelID].records.clone();
              ace.table.selected = recnum;
              var pois = ace.table.data[this.locator.panelID].records.slice(recnum - 1, recnum);
              pois[0].RECNUM = 1;
              pois[0].POINUM = 1;
              this.smap.locator.clear();
              ace.table.updateFromRecords(panel, pois, {
                NAME: 'more_info'
              });
              this.addPOIMarker(pois[0]);
              this.smap.zoomToPOI(pois, 1);
              document.fire('w2gi:track', {
                action: 'more_info',
                value: pois[0].UID
              });
              break;
              */
            case 'show_all':
              /*
              this.smap.locator.clear();
              ace.table.data[this.locator.panelID].records = ace.table.oldrecords.clone();
              ace.table.data[this.locator.panelID].records[ace.table.selected - 1].RECNUM = ace.table.selected;
              ace.table.data[this.locator.panelID].records[ace.table.selected - 1].POINUM = ace.table.selected;
              ace.table.updateFromRecords(panel, ace.table.data[this.locator.panelID].records, {
                NAME: 'poi'
              });
              this.addPOIMarkers();
              this.smap.zoomToPOIs();
              break;
              */
             this.collection.reset(this.oldRecords)
             this.ea.trigger('markers:zoom', this.collection.toJSON());
             $('.poi').html(this.oldPoi);
             this.moreInfoFlag = false;
             break;
            case 'make_default_loc':
              //this.smap.locator.proximitySearch._makeDefaultLocation(event.element(), event.element().readAttribute('uid'));
              this.makeDefaultLocation(target, uid, this.collection.getModelByUID(uid).toJSON())
              break;
            case 'linktrack':
              this.linkTrack(target)
              break;
            default:
              if (target.is('a')) {
                var href = target.attr('href')

                if (target.hasClass('lightwindow')) {
                  ace.util.alertExternal(target);
                  break;
                }

                var oc = target.attr('onclick')
                if (oc == undefined || oc == null || oc == '') {
                  var linkTarget = target.attr('target');
                  linkTarget = (linkTarget && linkTarget != '') ? linkTarget : '_parent';

                  if (href.substr(0, 4) == 'http')
                    window.open(href);
                }
              }
              break;
          }
        },
        openStreetView: function(uid, record) {
          if (this.streetView) {
            this.streetView.show(record.toJSON())
          } else {
            this.streetView = new GoogleStreetView({
              //model: this.model
            })
            this.streetView.show(record.toJSON())
          }
          if ($('.overlay')) {
                $('.overlay').show()
          }
        },
        openMoreInfo: function(target, uid, id) {
          var record = this.collection.getModelByUID(uid),
              showOnMap = target ? target.data('showonmap') : null;
              //panel = '#' +  (target.data('panel') || 'more-info-panel'),
              template = this.loadTemplate('collection_more_info');

              record = record.toJSON();
              record.index = id;
              this.ea.trigger('marker:zoom', new Array(record));
              this.moreInfoFlag = true;
          //$(panel).html(template(record.toJSON()))
          $('.poi').html(template(record))
        },
        poiSelected: function(event, record) {
	          console.log('selected once');
	          //$('li.poi-item[data-uid=' + record.uid + ']')
	          //$('li.poi-item[data-uid=' + record.uid + '] [data-action=more_info]')
	          //var more_info = $('li.poi-item[data-uid=' + record.uid + '] [data-action=more_info]');
	          var _uid = record.uid;
	          var _id = $('li.poi-item[data-uid=' + _uid + ']');

              if(this.moreInfoFlag == false || this.moreInfoFlag == undefined){
		          this.oldPoi = $('.poi').html();
	              this.oldRecords = this.collection.models;
	              this.collection.reset(new Array(this.collection.getModelByUID(_uid).toJSON()));
	              this.openMoreInfo(null, _uid, this.getID(_id));
              }


	    },
        linkTrack: function(element) {
          var trackValue = element.data('linktrack');
          $(document).trigger('w2gi:track', {
            action: 'linktrack',
            value: trackValue
          });
        },
        makeDefaultLocation: function(el, uid, record) {
          this.ea.trigger('poi:makedefaultlocation', el, uid, record)
        },
        select: function(el) {
          var uid = null
          if (!el.is('li.poi-item')) {
            el = el.parents('li.poi-item')
          }
          uid = el.data('uid')

          // let the poiSelect decide what to do with the poi to select
          this.poiSelector.select(uid);

          $(document).trigger('w2gi:track', {
            action : 'clickondealer-panel',
            value : el.data('uid')
          })
        },
        getUID: function(el) {
          return el.is('li.poi-item') ?  el.data('uid') : el.parents('li.poi-item').data('uid')
        },
        getID: function(el) {
          return el.is('li.poi-item') ?  el.data('id') : el.parents('li.poi-item').data('id')
        },
        clearPanel: function() {
          //this.collection.reset({ silent: true })
          this.ea.trigger('map:clear')
          this.currentPage = 0
          this.$el.empty()
        },
        search: function(request,options) {

          this.clearPanel()
          var locator = $('#' + options.formdataid);

          if(locator){//Clear the LAT/LON for next search
          	if(locator[0].longitude) locator[0].longitude.value = '';
          	if(locator[0].latitude) locator[0].latitude.value = '';
          }

          if (!_.isEmpty(request)) {
            this.collection.sortOrder = $('#sort-by-selector').val() || '_distance'
            this.collection.generateRequest(request,options)
          }


        },
        clearSelected: function() {
          $('.poi-item', this.$el).removeClass('poi-hover')
        },
        markerClick: function(lonlat, model) {
          $('.poi-item', this.$el).removeClass('poi-hover')
                                  .filter(function() { return $(this).data('uid') == model.get('uid') })
                                  .addClass('poi-hover')
          this.scrollPanel(model.collection.indexOf(model))
          $(document).trigger('w2gi:track', {
              action : 'clickondealer-map',
              value : model.get('uid')
            })
        },
        scrollPanel: function(poinumn) {
            var from = this.$el.scrollTop(),
                startEl = $($('.poi-item', this.$el)[0]),
                targetEl = $($('.poi-item', this.$el)[poinumn]),
                to, start,
                difference,
                max_speed

            if (targetEl && !_.isEmpty(targetEl)) {
              to = targetEl.position().top
              start = startEl.position().top
            } else {
              return false
            }

            from = parseInt(from, 10)
            to = parseInt(to, 10)
            start = parseInt(start,10)
            if (start < 0) {
                to = to - start;
            }
            if(to > from) {
              difference = to - from
            } else if (from > to) {
              difference = from - to;
            }

            if(difference < 500) {
              max_speed = 350;
            } else {
              max_speed = difference  - 500;
            }

            this.divScroller(from, to, max_speed);
        },
        divScroller: function(from, to, step_size) {
            var panel = this.$el,
                self = this
            if(to > from) {
                if(to - from < Math.ceil(Math.pow(to - from, 1/2)) + 10 ) {
                    setTimeout(function() {
                        panel.scrollTop(to)
                    }, 1)
                }
                else {
                    setTimeout(function() {
                        var scroll = panel.scrollTop()
                        panel.scrollTop( scroll + step_size )
                        self.divScroller( from + step_size, to, Math.ceil(Math.pow(to - from, 1/2)) + 10 )
                    }, 1)
                }
            }

            if(from > to) {
                if(from - to < Math.ceil(Math.pow(from - to, 1/2)) + 10 ) {
                    setTimeout(function() {
                       panel.scrollTop(to)
                    }, 1)
                }
                setTimeout(function() {
                    var scroll = panel.scrollTop()
                    panel.scrollTop(scroll - step_size)
                    self.divScroller(from - step_size, to, Math.ceil(Math.pow(from - to, 1/2)) + 10 )
                }, 1)
            }
            return false
        },
        multipleAddress: function(collection) {
          this.ea.trigger('collection:multiple', collection)
        },
        showError: function(error, model) { console.log(error) }
      })

    var GoogleStreetView = BaseView.extend({
      el: $('.street-view-wrapper'),
      panorama: null,
      events: {
        'click .gs': 'click'
      },
      initialize: function(options) {
      },
      close: function() {
        this.$el.hide()
        this.panorama.setVisible(false);
        if ($('.overlay')) {
            $('.overlay').hide()
        }
      },
      show: function(model) {
        var record = model
        var self = this

        var lat = parseFloat(record.latitude)
        var lng = parseFloat(record.longitude)
        var userLocation = new google.maps.LatLng(lat, lng)
        var userPOV = {
          heading : 34,
          pitch : 10,
          zoom : 1
        };
        if (!(window.google && window.google.maps)) {
          return
        }
        var sv = new google.maps.StreetViewService();
        sv.getPanoramaByLocation(userLocation, 50, function(results, status) {
          $('.street-view-wrapper').show();
          if (status == google.maps.StreetViewStatus.OK) {
            self.panorama = new google.maps.StreetViewPanorama(document.getElementById("streetViewCtn"), {
              position : userLocation,
              pov : userPOV,
              visible : true
            });
          } else {
            $('#streetViewCtn').setStyle({
              backgroundColor : '#fff',
              fontsize : 'large'
            });
            self.panorama = new google.maps.StreetViewPanorama(document.getElementById("streetViewCtn"), {
              position : userLocation,
              pov : userPOV,
              visible : false
            });
            $('#streetViewCtn').innerHTML = "<h1>We are sorry, street view for this area is not available at this moment.</h1>";
          }
        })
      },
      click: function(event) {
        var el = this.getTarget(event),
            action = el.data('action')
        if (action === 'close') {
          this.close()
        }
      }
    })

      module.init = function(options) {
        return new PoiView(options)
      }
      return module
  }
)
;
/**
 * Directions layer
 */

 define(
  'src/layer/route-vector',[
    'src/core/baseview',
    'ol'
  ],
  function(BaseView, ol) {
    var module = {}
    var RouteVectorLayer = BaseView.extend({
            initialize: function(options) {
              this.source = new ol.source.Vector({});

              // Get route style
                var routeStyle = {
                    strokeColor:    'blue',
                    strokeOpacity:  1,
                    strokeWidth:    5
                }
                _.extend(routeStyle, options.routeStyle || {})
              // get RBGA color
              var rbgaString = ace.util.buildRGBAString(
                routeStyle.strokeColor, routeStyle.strokeOpacity);

              var style = new ol.style.Style({
                stroke: new ol.style.Stroke({
                  color: rbgaString,
                  width: routeStyle.strokeWidth
                })
              });
          
              this.layer = new ol.layer.Vector({
                name: options.name,
                source: this.source,
                style: style
              });

              this.map = options.map;

              this.options = options
              options.map.addLayer(this.layer)                       
            },
            clear: function() { this.source.clear() },
            addRoute: function(options) {

              var pointList   = this._getPointList(options.linestrings);

              var geometry = new ol.geom.LineString(pointList);
              if(this.map.getView().getProjection().getCode() != 'EPSG:4326')
                geometry.transform("EPSG:4326", this.map.getView().getProjection())

              var lineFeature = new ol.Feature(geometry);
              this.source.addFeature(lineFeature);
            },
            _getPointList: function(linestrings) {
                var lineStrings = linestrings, //ace.table.data[this.locator.panelID].records.pluck('SEGMENT_GEOMETRY')
                    pointList = []
                for(var i=0,leni=lineStrings.length; i<leni; i++) {
                    if (lineStrings[i]) {
                        if (lineStrings[i].length <= 0) continue
                        var points = lineStrings[i].substring(11, lineStrings[i].length - 1).split(',')
                        for(var j=0,lenj=points.length; j<lenj; j++) {
                            var point = points[j].split(' ')
                            
                            pointList.push([parseFloat(point[0]),
                                            parseFloat(point[1])])
                        }
                    }
                }
                return pointList
            }
        })
    module.init = function(options) {
        return new RouteVectorLayer(options)
    }
    return module
})
;
(function (root, factory) {
  if (typeof exports === 'object') {
    module.exports = factory(root.ol);
  } else if (typeof define === 'function' && define.amd) {
    define('ol3ext',['ol'], factory);
  } else {
    root.ow = factory(root.ol);
  }
}(this, function (ol) {
var ow={getFeatureBy:function(a,b,c){var d=null;i=0;for(len=a.length;i<len;i++)if(propertyValue=a[i].get(b),propertyValue==c){d=a[i];break}return d},upperCaseObject:function(a){var b={},c;for(c in a)b[c.toUpperCase()]=a[c];return b},addClassName:function(a,b){var c=a.className.split(" ");-1===c.indexOf(b)&&(c.push(b),a.className=c.join(" "))},removeClassName:function(a,b){var c=a.className.split(" "),d=c.indexOf(b);-1!==d&&(c.splice(d,1),a.className=c.join(" "))},extent:{}};
ow.extent.extendCoordinate=function(a,b){b[0]<a[0]&&(a[0]=b[0]);b[0]>a[2]&&(a[2]=b[0]);b[1]<a[1]&&(a[1]=b[1]);b[1]>a[3]&&(a[3]=b[1])};ow.interaction={};ow.interaction.DragFeatureCustomEventType={DRAG_END:"dragend",DRAG_START:"dragstart"};
ow.interaction.DragFeature=function(a){a=a||{};if(a.layers)if("function"==typeof a.layers)a=a.layers;else var b=a.layers,a=function(a){return-1!=b.indexOf(a)};else a=function(){return!0};ol.interaction.Pointer.call(this,{handleDownEvent:ow.interaction.DragFeature.prototype.handleDownEvent,handleDragEvent:ow.interaction.DragFeature.prototype.handleDragEvent,handleMoveEvent:ow.interaction.DragFeature.prototype.handleMoveEvent,handleUpEvent:ow.interaction.DragFeature.prototype.handleUpEvent});this.coordinate_=
null;this.cursor_="pointer";this.dragged_=!1;this.feature_=null;this.layerFilter_=a;this.previousCursor_=void 0;this.customEvents=document.createElement("div")};ol.inherits(ow.interaction.DragFeature,ol.interaction.Pointer);
ow.interaction.DragFeature.prototype.handleDownEvent=function(a){var b=a.map.forEachFeatureAtPixel(a.pixel,function(a,b){if(this.layerFilter_(b))return a},this);b&&(this.coordinate_=a.coordinate,this.feature_=b,a=document.createEvent("Event"),a.initEvent(ow.interaction.DragFeatureCustomEventType.DRAG_START,!0,!0),a.detail={coordinate:this.coordinate_,feature:this.feature_},this.customEvents.dispatchEvent(a));return!!b};
ow.interaction.DragFeature.prototype.handleDragEvent=function(a){a.map.forEachFeatureAtPixel(a.pixel,function(a){return a});var b=a.coordinate[0]-this.coordinate_[0],c=a.coordinate[1]-this.coordinate_[1];this.feature_.getGeometry().translate(b,c);this.coordinate_[0]=a.coordinate[0];this.coordinate_[1]=a.coordinate[1];this.dragged_=!0};
ow.interaction.DragFeature.prototype.handleMoveEvent=function(a){if(this.cursor_){var b=a.map.forEachFeatureAtPixel(a.pixel,function(a,b){if(this.layerFilter_(b))return a},this),a=a.map.getTargetElement();b?a.style.cursor!=this.cursor_&&(this.previousCursor_=a.style.cursor,a.style.cursor=this.cursor_):void 0!==this.previousCursor_&&(a.style.cursor=this.previousCursor_,this.previousCursor_=void 0)}};
ow.interaction.DragFeature.prototype.handleUpEvent=function(){var a=document.createEvent("Event");a.initEvent(ow.interaction.DragFeatureCustomEventType.DRAG_END,!0,!0);a.detail={coordinate:this.coordinate_,dragged:this.dragged_,feature:this.feature_};this.customEvents.dispatchEvent(a);this.feature_=this.coordinate_=null;return this.dragged_=!1};ow.control={};
ow.control.LayerSwitcher=function(a){a=a||{};this.className_="ow-layerswitcher";var b=this.createElement_();ol.control.Control.call(this,{element:b,target:a.target});this.cache_=[];this.layers_=[]};ol.inherits(ow.control.LayerSwitcher,ol.control.Control);ow.control.LayerSwitcher.prototype.baseLayersEl_=null;
ow.control.LayerSwitcher.prototype.createElement_=function(){var a=this.className_,b=document.createElement("div");b.className=a+" ol-unselectable";var c=document.createElement("div");c.className=a+"-layers";b.appendChild(c);var d=document.createElement("div");d.className=a+"-baselayers";c.appendChild(d);this.baseLayersEl_=d;return b};
ow.control.LayerSwitcher.prototype.setMap=function(a){var b=this.getMap();b&&(b=b.getLayers(),b.forEach(this.removeLayer_,this),b.un("add",this.handleLayersAdd_,this),b.un("remove",this.handleLayersRemove_,this));ol.control.Control.prototype.setMap.call(this,a);a&&(b=a.getLayers(),b.forEach(this.addLayer_,this),b.on("add",this.handleLayersAdd_,this),b.on("remove",this.handleLayersRemove_,this))};ow.control.LayerSwitcher.prototype.handleLayersAdd_=function(a){this.addLayer_(a.element)};
ow.control.LayerSwitcher.prototype.handleLayersRemove_=function(a){this.removeLayer_(a.element)};ow.control.LayerSwitcher.prototype.addLayer_=function(a){if(this.isValidLayer_(a)){this.layers_.push(a);var b=this.createLayerEl_(a);this.baseLayersEl_.appendChild(b);a.on("change:visible",this.handleLayerVisibleChange_,this);var a={layerEl:b,layer:a},c=this.handleLayerClick_.bind(this,a);a.clickCallback=c;b.addEventListener("click",c);this.cache_.push(a)}};
ow.control.LayerSwitcher.prototype.removeLayer_=function(a){if(this.isValidLayer_(a)){var b=this.layers_.indexOf(a),c=this.cache_[b];c.layerEl.remove();a.un("change:visible",this.handleLayerVisibleChange_,this);c.layerEl.removeEventListener("click",c.clickCallback);this.layers_.splice(b,1);this.cache_.splice(b,1)}};ow.control.LayerSwitcher.prototype.isValidLayer_=function(a){return!0===a.get("displayInLayerSwitcher")};
ow.control.LayerSwitcher.prototype.createLayerEl_=function(a){var b=this.className_,c=document.createElement("div");c.className=[b+"-layeritem",[b,"-layeritem-",a.getVisible()?"active":"inactive"].join("")].join(" ");var d=document.createElement("span");d.className=b+"layeritem-text";d.innerHTML=this.getLayerName_(a);c.appendChild(d);return c};
ow.control.LayerSwitcher.prototype.getLayerName_=function(a){if(window.olgm&&a instanceof olgm.layer.Google)switch(a.getMapTypeId()){case google.maps.MapTypeId.HYBRID:a="Hybrid";break;case google.maps.MapTypeId.SATELLITE:a="Satellite";break;case google.maps.MapTypeId.TERRAIN:a="Terrain";break;default:a="Map"}else a=a.get("name");return a};
ow.control.LayerSwitcher.prototype.handleLayerVisibleChange_=function(a){var a=a.target,b=this.layers_.indexOf(a),b=this.cache_[b].layerEl,c=this.className_,d=c+"-layeritem-active",c=c+"-layeritem-inactive";a.getVisible()?(ow.removeClassName(b,c),ow.addClassName(b,d)):(ow.removeClassName(b,d),ow.addClassName(b,c))};ow.control.LayerSwitcher.prototype.handleLayerClick_=function(a){a=a.layer;a.getVisible()||a.setVisible(!0)};
ow.control.POILayerSwitcher=function(a){a=a||{};this.className_="ow-poilayerswitcher";var b=this.createElement_();ol.control.Control.call(this,{element:b,target:a.target});this.layers_=[];this.labelEls_=[];this.layerIconEls_=[];this.layerDefinitions_=a.layerDefinitions?a.layerDefinitions:a.userLayers?this.getUserLayerDefinitions_(a.userLayers):ow.control.POILayerSwitcherLayerDefinitions;this.perPage_=a.numLayersToDraw?a.numLayersToDraw:4;this.cache_={};this.createLayers_();this.popup_=new ow.popup.Image;
this.nextClickCallback_=this.handleNextClick_.bind(this);this.prevClickCallback_=this.handlePrevClick_.bind(this);this.layerIconClickCallback_=this.handleLayerIconClick_.bind(this);this.layerIconMouseOverCallback_=this.handleLayerIconMouseOver_.bind(this);this.layerIconMouseOutCallback_=this.handleLayerIconMouseOut_.bind(this);this.poiLayerFilter_=this.isPOILayer_.bind(this)};ol.inherits(ow.control.POILayerSwitcher,ol.control.Control);ow.control.POILayerSwitcher.prototype.currentPage_=1;
ow.control.POILayerSwitcher.prototype.labelsEl_=null;ow.control.POILayerSwitcher.prototype.layersEl_=null;ow.control.POILayerSwitcher.prototype.prevEl_=null;ow.control.POILayerSwitcher.prototype.nextEl_=null;
ow.control.POILayerSwitcher.prototype.setMap=function(a){var b,c=this.getMap();if(c)for(b in c.un("click",this.handleMapClick_,this),c.getView().un("change:resolution",this.handleViewResolutionChange_,this),this.nextEl_.removeEventListener("click",this.nextClickCallback_),this.prevEl_.removeEventListener("click",this.prevClickCallback_),this.layerIconEls_.forEach(this.removeLayerIconEventListener_,this),this.cache_)this.deactivateCacheItem_(this.cache_[b]);ol.control.Control.prototype.setMap.call(this,
a);if(a)for(b in a.on("click",this.handleMapClick_,this),a.getView().on("change:resolution",this.handleViewResolutionChange_,this),this.nextEl_.addEventListener("click",this.nextClickCallback_),this.prevEl_.addEventListener("click",this.prevClickCallback_),this.layerIconEls_.forEach(this.addLayerIconEventListener_,this),this.cache_)this.activateCacheItem_(this.cache_[b])};
ow.control.POILayerSwitcher.prototype.createElement_=function(){var a=this.className_,b=document.createElement("div");b.className=a+" olControlPOILayerSwitcher ol-unselectable";var c=document.createElement("div");c.className=a+"-container layersDiv";b.appendChild(c);var d=document.createElement("div");d.className=a+"-panel-labels";c.appendChild(d);this.labelsEl_=d;d=document.createElement("div");d.className=a+"-panel-layers dataLayersDiv";c.appendChild(d);c=document.createElement("a");c.className=
a+"-nav-prev previousLayersImg";d.appendChild(c);this.prevEl_=c;c=document.createElement("div");c.className=a+"-layers";d.appendChild(c);this.layersEl_=c;c=document.createElement("a");c.className=a+"-nav-next nextLayersImg";d.appendChild(c);this.nextEl_=c;return b};ow.control.POILayerSwitcher.prototype.createLayers_=function(){this.layerDefinitions_.forEach(this.createLayer_,this)};
ow.control.POILayerSwitcher.prototype.createLayer_=function(a){var b=Object.keys(this.cache_).length,c=a.name,d=Math.floor(b/this.perPage_)+1,e=d===this.currentPage_,f=b%this.perPage_+1,b=document.createElement("a");b.style["background-image"]=["url(",a.iconURL,")"].join("");b.className=[this.className_,"-layer iconImg"].join("");b.style.height=a.height+"px";b.style.width=a.width+"px";b.style.display=e?"block":"none";b.setAttribute("data-name",c);this.layersEl_.appendChild(b);this.layerIconEls_.push(b);
e=document.createElement("div");e.className=[this.className_,"-label ",this.className_,"-label-",f].join("");e.style.display="none";e.setAttribute("data-name",c);f=document.createElement("span");f.innerHTML=c;e.appendChild(f);f=document.createElement("span");f.className=[this.className_,"-label-num"].join("");e.appendChild(f);this.labelsEl_.appendChild(e);this.labelEls_.push(e);var g=new ol.source.Vector({loader:this.featureLoader_.bind(this),wrapX:!1}),h=new ol.source.Cluster({distance:40,source:g}),
j=[new ol.style.Style({image:new ol.style.Icon({src:a.iconURL})})],k=[new ol.style.Style({image:new ol.style.Icon({src:a.clusterIconURL})})],h=new ol.layer.Vector({name:c,source:h,style:function(a){return 1<a.get("features").length?k:j},visible:!1});this.layers_.push(h);this.cache_[c]={callbackVectorSourceChange:this.handleVectorSourceChange_.bind(this,c),element:b,labelEl:e,labelNumEl:f,layer:h,page:d,poiType:a.poi_type,strategy:null,vectorSource:g}};
ow.control.POILayerSwitcher.prototype.featureLoader_=function(){};ow.control.POILayerSwitcher.prototype.addLayerIconEventListener_=function(a){a.addEventListener("click",this.layerIconClickCallback_);a.addEventListener("mouseover",this.layerIconMouseOverCallback_);a.addEventListener("mouseout",this.layerIconMouseOutCallback_)};
ow.control.POILayerSwitcher.prototype.removeLayerIconEventListener_=function(a){a.removeEventListener("click",this.layerIconClickCallback_);a.removeEventListener("mouseover",this.layerIconMouseOverCallback_);a.removeEventListener("mouseout",this.layerIconMouseOutCallback_)};
ow.control.POILayerSwitcher.prototype.handleLayerIconClick_=function(a){var a=a.target,b=a.getAttribute("data-name"),b=this.cache_[b].layer,c=[this.className_,"-layer-visible"].join("");b.getVisible()?a.removeClassName(c):a.addClassName(c);b.setVisible(!b.getVisible())};ow.control.POILayerSwitcher.prototype.handleLayerIconMouseOver_=function(a){var a=a.target.getAttribute("data-name"),a=this.cache_[a],b=a.labelEl;this.updateLabelNum_(a);b.style.display="block"};
ow.control.POILayerSwitcher.prototype.handleLayerIconMouseOut_=function(a){a=a.target.getAttribute("data-name");this.cache_[a].labelEl.style.display="none"};ow.control.POILayerSwitcher.prototype.getUserLayerDefinitions_=function(a){var b=[];ow.control.POILayerSwitcherLayerDefinitions.forEach(function(c){-1!==a.indexOf(c.name)&&b.push(c)},this);return b};
ow.control.POILayerSwitcher.prototype.setPage_=function(a){var b=this.currentPage_,c;for(c in this.cache_)this.updateCacheItem_(this.cache_[c],a,b);this.currentPage_=a};ow.control.POILayerSwitcher.prototype.updateCacheItem_=function(a,b,c){a.page===b?a.element.style.display="block":a.page===c&&(a.element.style.display="none")};
ow.control.POILayerSwitcher.prototype.handleNextClick_=function(){var a=Math.floor(Object.keys(this.cache_).length/this.perPage_)+1;this.currentPage_+1>a||this.setPage_(this.currentPage_+1)};ow.control.POILayerSwitcher.prototype.handlePrevClick_=function(){1>this.currentPage_-1||this.setPage_(this.currentPage_-1)};
ow.control.POILayerSwitcher.prototype.activateCacheItem_=function(a){var b=a.layer,c=a.vectorSource,d=this.getMap(),a=a.callbackVectorSourceChange;d.addLayer(b);b.on("change:visible",this.handleLayerVisibleChange_,this);c.on("change",a,this)};ow.control.POILayerSwitcher.prototype.deactivateCacheItem_=function(a){var b=a.layer,c=a.vectorSource,d=this.getMap(),a=a.callbackVectorSourceChange;d.removeLayer(b);b.un("change:visible",this.handleLayerVisibleChange_,this);c.un("change",a,this)};
ow.control.POILayerSwitcher.prototype.handleLayerVisibleChange_=function(a){var a=a.target,b=a.get("name"),b=this.cache_[b],c=!1;null===b.strategy&&(b.strategy=new ow.strategy.Proximity({map:this.getMap(),panelId:"poipanel",poiType:b.poiType,params:{alertError:!1,checkResponse:!1,formdataID:"poisearch",like:1},source:b.vectorSource}),c=!0);var d=b.strategy;a.getVisible()?d.activate():d.deactivate();c||this.updateLabelNum_(b);this.popup_.close()};
ow.control.POILayerSwitcher.prototype.handleVectorSourceChange_=function(a){this.updateLabelNum_(this.cache_[a])};
ow.control.POILayerSwitcher.prototype.updateLabelNum_=function(a){var b=a.layer,c=a.labelNumEl,d=this.getMap(),e=d.getView();if(e.getCenter())if(d=e.calculateExtent(d.getSize()),null===a.strategy||!b.getVisible())c.innerHTML="";else{for(var a=a.layer.getSource().getFeatures(),f=b=0,g=a.length;f<g;f++)e=a[f].getGeometry().getCoordinates(),ol.extent.containsCoordinate(d,e)&&(b+=a[f].get("features").length);c.innerHTML=["(",b,")"].join("")}};
ow.control.POILayerSwitcher.prototype.handleMapClick_=function(a){this.popup_.close();if(a=this.getPOIFeatureAtPixel_(a.pixel)){var b=this.getMap(),c=a.getGeometry().getCoordinates(),d=this.createPopupContent_(a),e;50<b.getView().getResolution()&&(e=this.getClusterExtent_(a));this.popup_.show(b,c,d,e)}};ow.control.POILayerSwitcher.prototype.getPOIFeatureAtPixel_=function(a){return this.getMap().forEachFeatureAtPixel(a,function(a){return a},void 0,this.poiLayerFilter_)};
ow.control.POILayerSwitcher.prototype.isPOILayer_=function(a){return-1!==this.layers_.indexOf(a)};
ow.control.POILayerSwitcher.prototype.createPopupContent_=function(a){var b=a.get("features");if(1<b.length){var c,a=document.createElement("div");a.className="ow-popup-image-list";for(var d=0,e=b.length;d<e;d++)c=ace.template.getTemplate("poibubblesub",b[d].getProperties()),c.removeClassName("mainbubblecontent"),c.id="",a.appendChild(c)}else a=ace.template.getTemplate("poibubbleselect",b[0].getProperties()).getElementsByClassName("mainbubblecontent")[0],a.removeClassName("mainbubblecontent");return a};
ow.control.POILayerSwitcher.prototype.getClusterExtent_=function(a){var b,a=a.get("features");if(1<a.length){b=ol.extent.createEmpty();for(var c=0,d=a.length;c<d;c++)ol.extent.extend(b,a[c].getGeometry().getExtent())}return b};ow.control.POILayerSwitcher.prototype.handleViewResolutionChange_=function(){this.popup_.close()};
ow.control.POILayerSwitcherLayerDefinitions=[{name:"Airport",poi_type:"airport",width:21,height:25,iconURL:"/w2gi/images/maps/marker-gold.png",clusterIconURL:"/w2gi/images/maps/marker-gold-cluster.png"},{name:"Amusement Park",poi_type:"amusementpark",width:21,height:25,iconURL:"/w2gi/images/maps/marker-green.png",clusterIconURL:"/w2gi/images/maps/marker-green-cluster.png"},{name:"ATM",poi_type:"atm",width:21,height:25,iconURL:"/w2gi/images/maps/marker.png",clusterIconURL:"/w2gi/images/maps/marker-cluster.png"},
{name:"Auto Dealerships",poi_type:"autodealerships",width:21,height:25,iconURL:"/w2gi/images/maps/marker-blue.png",clusterIconURL:"/w2gi/images/maps/marker-blue-cluster.png"},{name:"Used Cars",poi_type:"autodealership-usedcars",width:21,height:25,iconURL:"/w2gi/images/maps/marker.png",clusterIconURL:"/w2gi/images/maps/marker-cluster.png"},{name:"Automobile Club",poi_type:"automobileclub",width:21,height:25,iconURL:"/w2gi/images/maps/marker-blue.png",clusterIconURL:"/w2gi/images/maps/marker-blue-cluster.png"},
{name:"Auto Service",poi_type:"autoservice",width:21,height:25,iconURL:"/w2gi/images/maps/marker-green.png",clusterIconURL:"/w2gi/images/maps/marker-green-cluster.png"},{name:"Bank",poi_type:"bank",width:21,height:25,iconURL:"/w2gi/images/maps/marker-gold.png",clusterIconURL:"/w2gi/images/maps/marker-gold-cluster.png"},{name:"Bookstore",poi_type:"bookstore",width:21,height:25,iconURL:"/w2gi/images/maps/marker-gold.png",clusterIconURL:"/w2gi/images/maps/marker-gold-cluster.png"},{name:"Border Crossing",
poi_type:"bordercrossing",width:21,height:25,iconURL:"/w2gi/images/maps/marker.png",clusterIconURL:"/w2gi/images/maps/marker-cluster.png"},{name:"Bowling Centre",poi_type:"bowlingcentre",width:21,height:25,iconURL:"/w2gi/images/maps/marker-blue.png",clusterIconURL:"/w2gi/images/maps/marker-blue-cluster.png"},{name:"Business Facility",poi_type:"businessfacility",width:21,height:25,iconURL:"/w2gi/images/maps/marker-green.png",clusterIconURL:"/w2gi/images/maps/marker-green-cluster.png"},{name:"Bus Station",
poi_type:"busstation",width:21,height:25,iconURL:"/w2gi/images/maps/marker-green.png",clusterIconURL:"/w2gi/images/maps/marker-green-cluster.png"},{name:"Camping Ground",poi_type:"campground",width:21,height:25,iconURL:"/w2gi/images/maps/marker-gold.png",clusterIconURL:"/w2gi/images/maps/marker-gold-cluster.png"},{name:"Cargo Centre",poi_type:"cargocentre",width:21,height:25,iconURL:"/w2gi/images/maps/marker-blue.png",clusterIconURL:"/w2gi/images/maps/marker-blue-cluster.png"},{name:"Casino",poi_type:"casino",
width:21,height:25,iconURL:"/w2gi/images/maps/marker.png",clusterIconURL:"/w2gi/images/maps/marker-cluster.png"},{name:"Cinema",poi_type:"cinema",width:21,height:25,iconURL:"/w2gi/images/maps/marker-blue.png",clusterIconURL:"/w2gi/images/maps/marker-blue-cluster.png"},{name:"Clothing Store",poi_type:"clothingstore",width:21,height:25,iconURL:"/w2gi/images/maps/marker-green.png",clusterIconURL:"/w2gi/images/maps/marker-green-cluster.png"},{name:"Coffee Shop",poi_type:"coffeeshop",width:21,height:25,
iconURL:"/w2gi/images/maps/marker.png",clusterIconURL:"/w2gi/images/maps/marker-cluster.png"},{name:"Rail Station",poi_type:"commuterrailstation",width:21,height:25,iconURL:"/w2gi/images/maps/marker-blue.png",clusterIconURL:"/w2gi/images/maps/marker-blue-cluster.png"},{name:"Electronics Store",poi_type:"consumerelectronicsstore",width:21,height:25,iconURL:"/w2gi/images/maps/marker.png",clusterIconURL:"/w2gi/images/maps/marker-cluster.png"},{name:"Convenience Store",poi_type:"conveniencestore",width:21,
height:25,iconURL:"/w2gi/images/maps/marker-green.png",clusterIconURL:"/w2gi/images/maps/marker-green-cluster.png"},{name:"Convention Center",poi_type:"conventioncenter",width:21,height:25,iconURL:"/w2gi/images/maps/marker.png",clusterIconURL:"/w2gi/images/maps/marker-cluster.png"},{name:"departmentstore",poi_type:"departmentstore",width:21,height:25,iconURL:"/w2gi/images/maps/marker.png",clusterIconURL:"/w2gi/images/maps/marker-cluster.png"},{name:"Ferry",poi_type:"ferryterminal",width:21,height:25,
iconURL:"/w2gi/images/maps/marker.png",clusterIconURL:"/w2gi/images/maps/marker-cluster.png"},{name:"Gas Station",poi_type:"gasstation",width:21,height:25,iconURL:"/w2gi/images/maps/marker.png",clusterIconURL:"/w2gi/images/maps/marker-cluster.png"},{name:"Golf Course",poi_type:"golfcourse",width:21,height:25,iconURL:"/w2gi/images/maps/marker.png",clusterIconURL:"/w2gi/images/maps/marker-cluster.png"},{name:"Grocery Store",poi_type:"grocerystore",width:21,height:25,iconURL:"/w2gi/images/maps/marker-gold.png",
clusterIconURL:"/w2gi/images/maps/marker-gold-cluster.png"},{name:"Higher Education",poi_type:"highereducation",width:21,height:25,iconURL:"/w2gi/images/maps/marker-green.png",clusterIconURL:"/w2gi/images/maps/marker-green-cluster.png"},{name:"Historical Monument",poi_type:"historicalmonument",width:21,height:25,iconURL:"/w2gi/images/maps/marker.png",clusterIconURL:"/w2gi/images/maps/marker-cluster.png"},{name:"Home Improvement Store",poi_type:"homeimprovementstore",width:21,height:25,iconURL:"/w2gi/images/maps/marker-gold.png",
clusterIconURL:"/w2gi/images/maps/marker-gold-cluster.png"},{name:"Home Specialty Store",poi_type:"homespecialtystore",width:21,height:25,iconURL:"/w2gi/images/maps/marker.png",clusterIconURL:"/w2gi/images/maps/marker-cluster.png"},{name:"Hospital",poi_type:"hospital",width:21,height:25,iconURL:"/w2gi/images/maps/marker.png",clusterIconURL:"/w2gi/images/maps/marker-cluster.png"},{name:"Hotel",poi_type:"hotel",width:21,height:25,iconURL:"/w2gi/images/maps/marker-blue.png",clusterIconURL:"/w2gi/images/maps/marker-blue-cluster.png"},
{name:"Ice Skating Rink",poi_type:"iceskatingrink",width:21,height:25,iconURL:"/w2gi/images/maps/marker.png",clusterIconURL:"/w2gi/images/maps/marker-cluster.png"},{name:"Industrial Zone",poi_type:"industrialzone",width:21,height:25,iconURL:"/w2gi/images/maps/marker-green.png",clusterIconURL:"/w2gi/images/maps/marker-green-cluster.png"},{name:"Library",poi_type:"library",width:21,height:25,iconURL:"/w2gi/images/maps/marker-blue.png",clusterIconURL:"/w2gi/images/maps/marker-blue-cluster.png"},{name:"Marina",
poi_type:"marina",width:21,height:25,iconURL:"/w2gi/images/maps/marker-gold.png",clusterIconURL:"/w2gi/images/maps/marker-gold-cluster.png"},{name:"Medical Service",poi_type:"medicalservice",width:21,height:25,iconURL:"/w2gi/images/maps/marker-gold.png",clusterIconURL:"/w2gi/images/maps/marker-gold-cluster.png"},{name:"Motorcycle Dealership",poi_type:"motorcycledealership",width:21,height:25,iconURL:"/w2gi/images/maps/marker-green.png",clusterIconURL:"/w2gi/images/maps/marker-green-cluster.png"},
{name:"Museum",poi_type:"museum",width:21,height:25,iconURL:"/w2gi/images/maps/marker.png",clusterIconURL:"/w2gi/images/maps/marker-cluster.png"},{name:"Named Place",poi_type:"namedplace",width:21,height:25,iconURL:"/w2gi/images/maps/marker.png",clusterIconURL:"/w2gi/images/maps/marker-cluster.png"},{name:"Nightlife",poi_type:"nightlife",width:21,height:25,iconURL:"/w2gi/images/maps/marker-blue.png",clusterIconURL:"/w2gi/images/maps/marker-blue-cluster.png"},{name:"Office Supply Store",poi_type:"officesupplystore",
width:21,height:25,iconURL:"/w2gi/images/maps/marker.png",clusterIconURL:"/w2gi/images/maps/marker-cluster.png"},{name:"Other Accommodation",poi_type:"otheraccommodation",width:21,height:25,iconURL:"/w2gi/images/maps/marker-gold.png",clusterIconURL:"/w2gi/images/maps/marker-gold-cluster.png"},{name:"Park and Recreation Area",poi_type:"parkandrecreationarea",width:21,height:25,iconURL:"/w2gi/images/maps/marker-green.png",clusterIconURL:"/w2gi/images/maps/marker-green-cluster.png"},{name:"Park and Ride",
poi_type:"parkandride",width:21,height:25,iconURL:"/w2gi/images/maps/marker.png",clusterIconURL:"/w2gi/images/maps/marker-cluster.png"},{name:"Parking Garage",poi_type:"parkinggarage",width:21,height:25,iconURL:"/w2gi/images/maps/marker.png",clusterIconURL:"/w2gi/images/maps/marker-cluster.png"},{name:"Parking Lot",poi_type:"parkinglot",width:21,height:25,iconURL:"/w2gi/images/maps/marker.png",clusterIconURL:"/w2gi/images/maps/marker-cluster.png"},{name:"Performing Arts",poi_type:"performingarts",
width:21,height:25,iconURL:"/w2gi/images/maps/marker.png",clusterIconURL:"/w2gi/images/maps/marker-cluster.png"},{name:"Pharmacy",poi_type:"pharmacy",width:21,height:25,iconURL:"/w2gi/images/maps/marker.png",clusterIconURL:"/w2gi/images/maps/marker-cluster.png"},{name:"Public Sports Airport",poi_type:"publicsportsairport",width:21,height:25,iconURL:"/w2gi/images/maps/marker.png",clusterIconURL:"/w2gi/images/maps/marker-cluster.png"},{name:"Rental Car Agency",poi_type:"rentalcaragency",width:21,height:25,
iconURL:"/w2gi/images/maps/marker-blue.png",clusterIconURL:"/w2gi/images/maps/marker-blue-cluster.png"},{name:"Rest Area",poi_type:"restarea",width:21,height:25,iconURL:"/w2gi/images/maps/marker.png",clusterIconURL:"/w2gi/images/maps/marker-cluster.png"},{name:"Restaurant",poi_type:"restaurant",width:21,height:25,iconURL:"/w2gi/images/maps/marker-green.png",clusterIconURL:"/w2gi/images/maps/marker-green-cluster.png"},{name:"School",poi_type:"school",width:21,height:25,iconURL:"/w2gi/images/maps/marker.png",
clusterIconURL:"/w2gi/images/maps/marker-cluster.png"},{name:"Shopping",poi_type:"shopping",width:21,height:25,iconURL:"/w2gi/images/maps/marker.png",clusterIconURL:"/w2gi/images/maps/marker-cluster.png"},{name:"Ski Resort",poi_type:"skiresort",width:21,height:25,iconURL:"/w2gi/images/maps/marker.png",clusterIconURL:"/w2gi/images/maps/marker-cluster.png"},{name:"Specialty Store",poi_type:"specialtystore",width:21,height:25,iconURL:"/w2gi/images/maps/marker-gold.png",clusterIconURL:"/w2gi/images/maps/marker-gold-cluster.png"},
{name:"Sporting Goods Store",poi_type:"sportinggoodsstore",width:21,height:25,iconURL:"/w2gi/images/maps/marker.png",clusterIconURL:"/w2gi/images/maps/marker-cluster.png"},{name:"Sports Complex",poi_type:"sportscomplex",width:21,height:25,iconURL:"/w2gi/images/maps/marker-blue.png",clusterIconURL:"/w2gi/images/maps/marker-blue-cluster.png"},{name:"Tourist Attraction",poi_type:"touristattraction",width:21,height:25,iconURL:"/w2gi/images/maps/marker-green.png",clusterIconURL:"/w2gi/images/maps/marker-green-cluster.png"},
{name:"Tourist Information",poi_type:"touristinformation",width:21,height:25,iconURL:"/w2gi/images/maps/marker.png",clusterIconURL:"/w2gi/images/maps/marker-cluster.png"},{name:"Train Station",poi_type:"trainstation",width:21,height:25,iconURL:"/w2gi/images/maps/marker-blue.png",clusterIconURL:"/w2gi/images/maps/marker-blue-cluster.png"},{name:"Transportation Service",poi_type:"transportationservice",width:21,height:25,iconURL:"/w2gi/images/maps/marker.png",clusterIconURL:"/w2gi/images/maps/marker-cluster.png"},
{name:"Winery",poi_type:"winery",width:21,height:25,iconURL:"/w2gi/images/maps/marker.png",clusterIconURL:"/w2gi/images/maps/marker-cluster.png"}];ow.strategy={};ow.strategy.BrowserResize=function(a){this.map_=a.map;this.browserResizeCallback_=this.handleBrowserResize_.bind(this)};ow.strategy.BrowserResize.prototype.active_=!1;ow.strategy.BrowserResize.prototype.activate=function(){this.active_||(window.addEventListener("resize",this.browserResizeCallback_),this.active_=!0)};
ow.strategy.BrowserResize.prototype.deactivate=function(){this.active_&&(window.removeEventListener("resize",this.browserResizeCallback_),this.active_=!1)};ow.strategy.BrowserResize.prototype.handleBrowserResize_=function(){this.map_.updateSize()};
ow.strategy.LayerExclusivity=function(a){this.map_=a.map;this.property_=a.property||"group";this.value_=a.value||"base";this.layers_=[];a=this.map_.getLayers();a.forEach(this.manageLayer_,this);a.on("add",this.handleLayersAdd_,this);a.on("remove",this.handleLayersRemove_,this)};ow.strategy.LayerExclusivity.prototype.destroy=function(){var a=this.map_.getLayers();a.forEach(this.unmanageLayer_,this);a.un("add",this.handleLayersAdd_,this);a.un("remove",this.handleLayersRemove_,this);this.map_=null};
ow.strategy.LayerExclusivity.prototype.handleLayersAdd_=function(a){this.manageLayer_(a.element)};ow.strategy.LayerExclusivity.prototype.handleLayersRemove_=function(a){this.unmanageLayer_(a.element)};ow.strategy.LayerExclusivity.prototype.manageLayer_=function(a){this.isValidLayer_(a)&&(this.layers_.push(a),a.on("change:visible",this.handleLayerVisibleChange_,this),a.getVisible()&&this.manageLayerExclusivity_(a))};
ow.strategy.LayerExclusivity.prototype.unmanageLayer_=function(a){if(this.isValidLayer_(a)){var b=this.layers_.indexOf(a);this.layers_.splice(b,1);a.un("change:visible",this.handleLayerVisibleChange_,this)}};ow.strategy.LayerExclusivity.prototype.isValidLayer_=function(a){return a.get(this.property_)===this.value_};ow.strategy.LayerExclusivity.prototype.handleLayerVisibleChange_=function(a){this.manageLayerExclusivity_(a.target)};
ow.strategy.LayerExclusivity.prototype.manageLayerExclusivity_=function(a){if(a.getVisible())for(var b=this.layers_,c=0,d=b.length;c<d;c++)b[c]!==a&&b[c].setVisible(!1)};ow.strategy.Proximity=function(a){this.map_=a.map;this.view_=a.map.getView();this.source_=a.source;this.ratio_=void 0!==a.ratio?a.ratio:2;this.panelId_=a.panelId;this.poiType=a.poiType;this.options_=a;this.map_.on("change:view",this.handleMapViewChange_,this)};ow.strategy.Proximity.prototype.active_=!1;
ow.strategy.Proximity.prototype.extent_=null;ow.strategy.Proximity.prototype.activate=function(a){this.active_||(this.view_.on("change:center",this.handleViewCenterChange_,this),this.view_.on("change:resolution",this.handleViewResolutionChange_,this),this.update(a),this.active_=!0)};
ow.strategy.Proximity.prototype.deactivate=function(){this.active_&&(this.view_.un("change:center",this.handleViewCenterChange_,this),this.view_.un("change:resolution",this.handleViewResolutionChange_,this),this.active_=!1)};ow.strategy.Proximity.prototype.update=function(a){if(void 0!==a&&a||this.invalidExtent_())this.calculateExtent_(),this.triggerRead_()};
ow.strategy.Proximity.prototype.setView=function(a){var b=this.active_;b&&this.deactivate();this.view_=a;if(b)if(a.getCenter())this.activate(!0);else a.once("change:center",function(){this.activate(!0)},this)};ow.strategy.Proximity.prototype.handleViewCenterChange_=function(){this.update()};ow.strategy.Proximity.prototype.handleViewResolutionChange_=function(){this.update()};
ow.strategy.Proximity.prototype.destroy=function(){this.map_.un("change:view",this.handleMapViewChange_,this);this.map_=this.view_=this.source_=null};ow.strategy.Proximity.prototype.invalidExtent_=function(){var a=this.getMapExtent_();return!this.extent_||!ol.extent.containsExtent(this.extent_,a)};ow.strategy.Proximity.prototype.getMapExtent_=function(){return this.view_.calculateExtent(this.map_.getSize())};
ow.strategy.Proximity.prototype.calculateExtent_=function(){var a=this.getMapExtent_(),b=this.view_.getCenter(),c=ol.extent.getWidth(a)*this.ratio_,a=ol.extent.getHeight(a)*this.ratio_;this.extent_=[b[0]-c/2,b[1]-a/2,b[0]+c/2,b[1]+a/2]};
ow.strategy.Proximity.prototype.getMapExtentRadius_=function(){var a=this.getMapExtent_(),b=this.view_.getProjection();if("EPSG:4326"!==b.getCode()){var c=ol.proj.get("EPSG:4326");extent=ol.proj.transformExtent(a,b,c)}else extent=a;return""+69.04*Math.max(Math.abs(extent[3]-extent[1]),Math.abs(extent[0]-extent[2]))/2};
ow.strategy.Proximity.prototype.triggerRead_=function(){var a=this.view_.getCenter();"EPSG:4326"!==this.view_.getProjection().getCode()&&(a=ol.proj.toLonLat(a));var b=this.getMapExtentRadius_(),c=this.options_,d=this.handleRead_.bind(this,c.callback,c.scope);ace.request({latitude:a[1],longitude:a[0],panelId:this.panelId,poi_type:this.poiType,searchradius:b},d,c.params)};
ow.strategy.Proximity.prototype.handleRead_=function(a,b,c){if(c){var c=ace.xml.getCollection(c),d=ace.xml.findDeepestElement(c),d=d?d.parentNode.tagName:null;if(!d)return a&&b&&a.call(b,{}),!1;a=c.getElementsByTagName(d);ace.xml.parseAttributes(c);a=ace.xml.parseNodes(a);a=this.parseFeatures_(a);this.addFeatures_(a)}};
ow.strategy.Proximity.prototype.parseFeatures_=function(a){for(var b=[],c,d=this.view_.getProjection(),e=a.length-1;0<=e;e--)c=a[e],c.geometry=new ol.geom.Point(ol.proj.fromLonLat([+a[e].LONGITUDE,+a[e].LATITUDE],d)),b.push(new ol.Feature(c));return b};ow.strategy.Proximity.prototype.addFeatures_=function(a){this.source_.clear();this.source_.addFeatures(a)};ow.strategy.Proximity.prototype.handleMapViewChange_=function(){this.setView(this.map_.getView())};ow.popup={};ow.popup.ImageEventType={POPUP_CLOSED:"popupclosed"};
ow.popup.Image=function(a){var a=a||{},b=a.className||"ow-popup-image";this.className_=b;a.autoPan=void 0!==a.autoPan?a.autoPan:!0;a.autoPanAnimation=void 0!==a.autoPanAnimation?a.autoPanAnimation:{duration:500,easing:ol.easing.easeOut};a.positioning=a.positioning||"bottom-center";var c=document.createElement("div");c.className=[b,"ol-unselectable"].join(" ");a.element=c;this.contentEl_=document.createElement("div");this.contentEl_.className=[b,"-content"].join("");c.appendChild(this.contentEl_);
this.zoomEl_=document.createElement("a");this.zoomEl_.className=[b,"-zoom ol-unselectable"].join("");this.zoomEl_.innerHTML="+";this.zoomEl_.title="Zoom to these features";this.closeEl_=document.createElement("a");this.closeEl_.className=[b,"-close ol-unselectable"].join("")+" olPopupCloseBox";c.appendChild(this.closeEl_);ol.Overlay.call(this,a);this.closeClickCallback_=this.close.bind(this);this.zoomClickCallback_=this.zoomToExtent_.bind(this)};ol.inherits(ow.popup.Image,ol.Overlay);
ow.popup.Image.prototype.extent_=null;ow.popup.Image.prototype.extentClassSuffix_="extent";ow.popup.Image.prototype.show=function(a,b,c,d){this.close();a.addOverlay(this);this.setPosition(b);c instanceof Element?this.contentEl_.appendChild(c):this.contentEl_.innerHTML=c;d&&this.enableExtent_(d)};ow.popup.Image.prototype.close=function(){var a=this.getMap();if(a){a.removeOverlay(this);for(a=this.contentEl_.childNodes;a.length;)a[0].remove();this.disableExtent_();this.dispatchEvent(ow.popup.ImageEventType.POPUP_CLOSED)}};
ow.popup.Image.prototype.removeElement_=function(a){a.remove()};ow.popup.Image.prototype.setMap=function(a){this.getMap()&&(this.closeEl_.removeEventListener("click",this.closeClickCallback_),this.zoomEl_.removeEventListener("click",this.zoomClickCallback_));ol.Overlay.prototype.setMap.call(this,a);a&&(this.closeEl_.addEventListener("click",this.closeClickCallback_),this.zoomEl_.addEventListener("click",this.zoomClickCallback_))};
ow.popup.Image.prototype.enableExtent_=function(a){this.disableExtent_();this.extent_=a;ow.addClassName(this.getElement(),this.getExtentClassName_());this.getElement().appendChild(this.zoomEl_)};ow.popup.Image.prototype.disableExtent_=function(){this.extent_&&(this.extent_=null,ow.removeClassName(this.getElement(),this.getExtentClassName_()),this.getElement().removeChild(this.zoomEl_))};ow.popup.Image.prototype.getExtentClassName_=function(){return[this.className_,this.extentClassSuffix_].join("-")};
ow.popup.Image.prototype.zoomToExtent_=function(){var a=this.getMap();a&&(a.getView().fit(this.extent_,a.getSize()),this.close())};
  return ow;
}));

/**
 * Route Marker Layer
 */

define(
  'src/layer/marker',[
    'src/core/baseview',
    'ol',
    'ol3ext',
    'jquery'
  ],
  function(BaseView, ol, ow, $) {
    var module = {}
    var RouteMarkerLayer = BaseView.extend({
        initialize: function(options) {
          this.source = new ol.source.Vector({});

          this.layer = new ol.layer.Vector({
            name: 'Route markers',
            source: this.source
          });

          this.options = options
          this.map = options.map
          this.map.addLayer(this.layer);
        },
        clear: function() {
            this.source.clear()
        },

        getIconTemplate: function(icon) {
          var template = (this.loadTemplate(icon))(),
              res = {}, image = {}, $template
          if (_.isEmpty(template)) {
            return {
              src:  '/w2gi/javascript/backbone/bb/img/mappin.png', // '/demos/bb/images/mappin.png',
              width: 31,
              height: 53,
              offsetX: 0,
              offsetY: 0,
              labelOffsetX: 0,
              labelOffsetY: 0,
              fontColor: '#000',
              fontSize: '10'
            }
          }
          image       = $(template).find('img').first()
          res.src     = image.attr('src')
          $template = $(template)
          res.width   = $template.data('width')
          res.height  = $template.data('height')
          res.offsetX = $template.data('offsetx')
          res.offsetY = $template.data('offsety')
          res.labelOffsetX = $template.data('labeloffsetx') || 0
          res.labelOffsetY = $template.data('labeloffsety') || 0
          res.fontColor = $template.data('fontcolor') || '#000'
          res.fontSize = $template.data('fontsize') || '10px'
          res.fontFamily = $template.data('fontfamily') || 'serif'
          res.fontWeight = $template.data('fontweight') || ''
          res.fontStyle = $template.data('fontstyle') || ''
          res.fontVariant = $template.data('fontvariant') || ''
          res.display = $template.data('display')
          return res
        },
        createIconStyleFromTemplate: function(icon, opt_label) {
          var template = this.getIconTemplate(icon),
              text;

          var anchor = [
            -template.offsetX,
            -template.offsetY
          ]
          var iconOptions = {
            src: template.src,
            anchorXUnits: 'pixels',
            anchorYUnits: 'pixels',
            anchor: anchor,
            opacity: 1
          };

          var icon = new ol.style.Icon(iconOptions);
          var styleOptions = {
            image: icon,
            scale: 1
          };

          if (opt_label !== undefined) {
            var font = [
              template.fontStyle + '',
              template.fontVariant + '',
              template.fontWeight + '',
              template.fontSize + '',
              template.fontFamily
            ].join(' ');
            var textOptions = {
              offsetX: +template.labelOffsetX,
              offsetY: -template.labelOffsetY,
              font: font,
              fill: new ol.style.Fill({color: template.fontColor}),
              text: opt_label
            };

            text = new ol.style.Text(textOptions);
            styleOptions.text = text;
          }

          var i = new Image();
          i.src = template.src;
          if (i.width) {
            var scale = Math.min(template.height / i.height, template.width / i.width);
            icon.setScale(scale);
            if (text) {
              text.setOffsetX(text.getOffsetX() * scale);
              text.setOffsetY(text.getOffsetY() * scale);
            }
          } else {
            i.addEventListener('load', function(e) {
              var img = e.target;
              var scale = Math.min(template.height / img.height, template.width / img.width);
              icon.setScale(scale);
              if (text) {
                text.setOffsetX(text.getOffsetX() * scale);
                text.setOffsetY(text.getOffsetY() * scale);
              }
            });
          }

          return new ol.style.Style(styleOptions);
        },
        createMarker: function(name, record) {
          var point     = new ol.geom.Point([+record.longitude, +record.latitude]);

          point.transform('EPSG:4326', this.map.getView().getProjection())
          var feature = new ol.Feature(point);

          var style = (name == 'default') ? this.createIconStyleFromTemplate(name, record.label) : this.createIconStyleFromTemplate(name);
          style.setZIndex(this.source.getFeatures().length + 1);
          feature.setStyle(style);

          feature.setProperties({
            projection: this.map.getView().getProjection().getCode(),
            address: record,
            name: name
          });

          return feature;
        },

        addEndMarkers: function(addresses) {
            var self = this
            _(addresses).each(function(address, index) {
                var marker = null;
                if (index <= 0) {
                    // assume index <= 0 implies that this addr is the start
                    marker = self.createMarker('ddstarticon', address);
                } else {
                    marker = self.createMarker('ddendicon', address);
                }
                if (marker == null){
                    // create and use a default template (default.png)
                    marker = self.createMarker('default', address);
                }
                //var icon    = new OpenLayers.Icon.IconFromTemplate(template);
                //var lonlat  = new OpenLayers.LonLat(address.longitude, address.latitude);
                //var marker  = new OpenLayers.Marker.DragabbleMarker(lonlat, icon, this.options.disableDynamicRoutes);

                //if (self.map.baseLayer.projection.toString() == 'EPSG:900913') {
                    //marker.setSphericalMercator(true);
                //}
                var endAddress  = (index <= 0) ? _(addresses).last() : _(addresses).first();
                marker.set('endaddress', endAddress);
                if (!self.options.disableDynamicRoutes) {
                  self.addDragControl(marker, index, endAddress)
                }

                self.source.addFeature(marker)

            });
        },
        addAtw:function(atws) {
            var self = this
            _(atws).each(function(poi, index) {
                var marker = null;
                poi.label = (index+1).toString();
                marker = self.createMarker('default', poi);
                
                
                var Address  = atws[index];
                marker.set('atwaddress', Address);
                if (!self.options.disableDynamicRoutes) {
                  self.addDragControl(marker, index, Address)
                }

                self.source.addFeature(marker)

            });
        },

        /**
         * @method
         * @param {OpenLayers.Marker.DragabbleMarker} marker
         * @param {Number} index - marker index, first is 0
         * @param {Object} endAddress
         */
         _mouseUp: function(evt) {
           var coordinate = evt.detail.coordinate;
           var dragged = evt.detail.dragged;
           var feature = evt.detail.feature;

           var options = {routeDrag : true};

           var lonlat = new ol.geom.Point(coordinate).transform(
             feature.get('projection'), 'EPSG:4326').getCoordinates();
           var index = (feature.get('name') == 'ddstarticon') ? 0 : 1;

           this.ea.trigger('directions:searchmarker', lonlat, index, feature.get('endaddress'))

           $(document).trigger('w2gi:track', {action: 'routemarkerdrag', value: lonlat.join(', ')});
        },

        addDragControl: function(marker, index, endAddress) {
          var drag = new ow.interaction.DragFeature({
            layers: [this.layer]
          });
          drag.customEvents.addEventListener(
            ow.interaction.DragFeatureCustomEventType.DRAG_END,
            (this._mouseUp).bind(this));
          this.map.addInteraction(drag);
        }
    })
    module.init = function(options) {
        return new RouteMarkerLayer(options)
    }
    return module
})
;
/**
* Event tracker
* Emits:
* Listens to:
**/

define(
  'src/tracker/tracker',[
    'src/core/baseview',
    'src/core/basemodel',
    'jquery'
  ],
  function(BaseView, BaseModel, $) {
    var TrackerModel = BaseModel.extend({
        getOptions: function() {
            return {
                noCache: true,
                method:     'clicktrack',
                formdata: {
                    clicktrack: null
                }
            }
        },
        initialize: function(options) { this.options = this.getOptions() },
        load: function(data) {
            this.options.formdata = data
            this.fetch(this.options) 
        }
    })
    var Tracker = BaseView.extend({
        initialize: function(options) {
            this.options = options
            this.model = new TrackerModel()
            this.registerListeners(options)
        },
        registerListeners: function() {
            _.bindAll(this, 'track')
            $(document).on('w2gi:track', this.track)
            this.bindPageAnchors(this.options.anchors || ['linktrack'])

        },
        bindPageAnchors: function(anchors) {
            var self = this
            _(anchors).each(function(trackAttribute){
                $(document).on("click", function(event) {
                    var target = self.getTarget(event)
                    if(event && target) {
                        var action  = target.attr(trackAttribute) || target.data(trackAttribute)
                        if (!action) {
                          var _target = $(target).parents('[data-' + trackAttribute + ']')
                          action = $(_target).attr(trackAttribute) || $(_target).data(trackAttribute)
                        }
                        
                        var obj = {
                            'action' : trackAttribute,
                            'value' : action
                        }
                        
                        if(action && action != '' && action != null && action != undefined) {
                            self.track(event, obj)
                        }
                    }
                })
            })
        },
        track: function(event, data) {
            this.model.load(data)
        }
    })

    return Tracker
})

;
/**
* Event tracker
* Emits:
* Listens to:
**/

define(
  'src/dialog/dialog',[
    'src/core/baseview',
    'src/core/basemodel',
    'jquery'
  ],
  function(BaseView, BaseModel, $) {

    var Dialog = BaseView.extend({
        initialize: function(options) {
            //$('.modal').modal()
            this.options = options
            this.registerListeners()
        },
        registerListeners: function() {
            _.bindAll(this, 'showDialog', 'showError')
            $(document).on('w2gi:fetchError', this.showError)
                       .on('w2gi:showDialog', this.showDialog)
        },
        showError: function(event, data) {
            if (this.options.alertError !== false) {
                this.showDialog(null, data.error);
            }else{
                var source = $('#panel_error_message').html()
                source = source.replace('{{error}}', $.parseHTML(data.error)[0].data)
                var template =  Handlebars.compile(source, { noEscape: true })  //, { noEscape: true })
                var content = $('<div/>').html(data.error).text();
                //var text = $.parseHTML(data.error)
            	$('.poi').html(content)
            }
        },
        showDialog: function(event, data) {
            var content = $('<div/>').html(data).text();
            $('.modal p').empty().html(content)//Encode HTML
            $('.modal').modal()
        }
    })

    return Dialog
})

;
/**
*
* Popup
* Listens to - {marker:select} {marker:unselect}
* Emits - {popup:open} {popup:close}
*/

define(
  'src/popup/popup',[
    'src/core/baseview',
    'src/core/basemodel',
    'jquery',
    'ol'
  ],
  function(BaseView, BaseModel, $, ol) {
    var PopupView = BaseView.extend({
        events: {
          'click .tabs li': 'tabClick',
          'click .tab-content .gs': 'gsClick',
          'click .tab-content .more_info': 'miClick',
          'click .lightwindow': 'openAlert',
          'click .bubble_close': 'close'
        },
        initialize: function(options) {
          this.options = options
          if (options && !options.el) {

          }
          this.map = options.map;
          this.template = this.loadTemplate('bubble')

          /**
           * @type {Object.<string, Function>}
           * @private
           */
          this.templates = this.loadTemplates('bubble');

          this.popup = null

          this.model = new BaseModel()
          this.registerEvents()
        },
        registerEvents: function() {
          _.bindAll(this, 'select', 'unselect', 'render', 'click', 'close','initialtab')
          this.ea.bind('marker:click', this.click)
                  //.bind('marker:select',       this.select)
                 .bind('marker:unselect',     this.unselect)
                 .bind('set:initialtab',      this.initialtab)
        },
        _setBubbleCountry : function(popupName, country) {
            var opts = ace.cache.get(popupName)
            if (popupName) {
              _.each(opts, function(opt, i) {
                if (opt.value === country) {
                  opt.selected = 'selected'
                } else {
                  delete opt.selected
                }
              })
              ace.cache.add(popupName, opts)
            }
            return opts
        },
        initialtab: function(tabname){
        	this.initTab = tabname;
        },
        loadPopup: function(feature) {
          var template;
          var templateFn;

          // Load template element and function from feature property,
          // or use default if none is found
          var bubbleId = feature.get('bubbleid');
          if (bubbleId && this.templates[bubbleId]) {
            template = $('script#' + bubbleId);
            templateFn = this.templates[bubbleId];
          } else {
            template = $('script#' + 'bubble');
            templateFn = this.template;
          }

          var offset,
              width = template.data('width'),
              height= template.data('height'),
              offsetX = -(width/2 +  (template.data('offsetx') || 10)),
              offsetY =  (template.data('offsety') || 30),
              marginLeft= template.data('marginleft') || -15,
              marginBottom = template.data('marginbottom') || 0,
              marginRight = template.data('marginright') || 5,
              marginTop = template.data('margintop') || 5,
              point     = ace.util.getCenter(feature),
              country = this.model.get('country')


          var opts = this._setBubbleCountry('#bubble_country', this.model.get('country'))

          this.model.set({options: opts})

          var element = document.createElement('div');
          element.innerHTML = '<div class="w2gi-popup">'+ templateFn( this.model.toJSON() ) +'</div>';
          element.style.width = width + 'px';
          element.style.height = height + 'px';
          element.className = 'olPopupContent';
          //console.log(this.initTab);
          
          if(this.initTab !== undefined){
          	var tabArr = element.querySelectorAll('.w2gi-popup .tabs li');
          	var tabContentArr = element.querySelectorAll('.w2gi-popup .tab-content');
          	
          	for (i=0;i<tabArr.length;i++){
          		if(tabArr[i].innerText == this.initTab){
          			tabArr[i].className += ' active';
          			checkTabContent.bind(this)(tabContentArr, tabArr[i].attributes['data-tab'].nodeValue);
          		}else{
          			tabArr[i].className = tabArr[i].className.replace(/active/g,'');
          		}
          	}
          	this.initTab = undefined;          	
          }
          
          function checkTabContent(tabContentArr, tabName){
          	for (i=0;i<tabContentArr.length;i++){
          		if(tabContentArr[i].attributes['data-tab'].nodeValue == tabName){
          			tabContentArr[i].className += ' active';
          		}else{
          			tabContentArr[i].className = tabContentArr[i].className.replace(/active/g,'');
          		}
          	}
          }

          var offset = [
            parseInt(offsetX, 10),
            parseInt(offsetY, 10)
          ];

          // While Google Maps is active, do no animate while auto-panning to popup
          var animDuration = (
            this.map && this.map.olgm &&
              this.map.olgm.getGoogleMapsActive()
          ) ? 0 : 500;

          return {
            coordinates: point,
            content: element,
            options: {
              autoPan: false,
              autoPanAnimation: {
                source: point,
                duration: animDuration,
                easing: ol.easing.easeOut
              },
              className: 'w2gi-popup',
              positioning: 'bottom-left',
              offset: offset,
              position: point
            }};
        },
        openAlert: function(event) {
            var target = this.getTarget(event)
            event.preventDefault()
            ace.util.alertExternal(target);
        },
        select: function(feature, model) {
            var address = $('.search-box').val()
            this.model.set(model)
            if (address && address.length > 0){
              this.model.set('addressline', address)
            }
            this.popup = this.loadPopup(feature)
            if (this.model.has('addressline')) {
              this.model.unset('addressline')
            }
            this.ea.trigger('popup:loaded', this.popup, this.model)
            //this.ea.trigger('popup:loaded', this.popup, feature)
        },
        tabClick:function(event) {
          var el = this.getTarget(event),
              tabID = el.data('tab'),
              panel
          this.$el.find('.tabs li').removeClass('active')
          this.$el.find('.tab-content').removeClass('active')
                                       .filter( function() { return $(this).data('tab') === tabID } )
                                       .addClass('active')

          el.addClass('active')
        },
        gsClick: function(event) {
          var el = this.getTarget(event),
              action = el.data('action')
          if (action === 'show_gs') {
            this.openStreetView()
          }
        },
        miClick: function(event) {
          var el = this.getTarget(event),
              action = el.data('action'),
              uid    = this.model.toJSON().uid;
          if (action === 'more_info') {
             var mielement = $('div.poi li.poi-item[data-uid="' + uid + '"] a.more_info');
             if ($(mielement).is('a')) {
                $(mielement)[0].click();
             }
          }
        },


        openStreetView: function() {
          if (this.streetView) {
            this.streetView.show(this.model.toJSON())
          } else {
            this.streetView = new GoogleStreetView({
              //model: this.model
            })
            this.streetView.show(this.model.toJSON())
          }
          if ($('.overlay')) {
                $('.overlay').show()
          }
        },
        click: function(location, model, feature) {

          this.select(feature, model.toJSON())
        },
        unselect: function(feature) {
            this.close(feature)
        },
        render: function() {
          //this.$el.html( this.template( this.model.toJSON() ) )
        },
        close: function() {
          if (this.popup) {
            // FIXME
            //this.popup.destroy()
            this.popup = null
          }
          if (this.hide) this.hide()
          this.ea.trigger('popup:close')
        }
    })

    var GoogleStreetView = BaseView.extend({
      el: $('.street-view-wrapper'),
      panorama: null,
      events: {
        'click .gs': 'click'
      },

      initialize: function(options) {
      },
      close: function() {
        this.$el.hide()
        this.panorama.setVisible(false);
        if ($('.overlay')) {
            $('.overlay').hide()
        }
      },
      show: function(model) {
        var record = model
        var self = this

        var lat = parseFloat(record.latitude)
        var lng = parseFloat(record.longitude)
        var userLocation = new google.maps.LatLng(lat, lng)
        var userPOV = {
          heading : 34,
          pitch : 10,
          zoom : 1
        };
        if (!(window.google && window.google.maps)) {
          return
        }
        var sv = new google.maps.StreetViewService();
        sv.getPanoramaByLocation(userLocation, 50, function(results, status) {
          $('.street-view-wrapper').show();
          if (status == google.maps.StreetViewStatus.OK) {
            self.panorama = new google.maps.StreetViewPanorama(document.getElementById("streetViewCtn"), {
              position : userLocation,
              pov : userPOV,
              visible : true
            });
          } else {
            $('#streetViewCtn').setStyle({
              backgroundColor : '#fff',
              fontsize : 'large'
            });
            self.panorama = new google.maps.StreetViewPanorama(document.getElementById("streetViewCtn"), {
              position : userLocation,
              pov : userPOV,
              visible : false
            });
            $('#streetViewCtn').innerHTML = "<h1>We are sorry, street view for this area is not available at this moment.</h1>";
          }
        })
      },
      click: function(event) {
        var el = this.getTarget(event),
            action = el.data('action')
        if (action === 'close') {
          this.close()
        }
      }
    })
   return PopupView
  }
)
;
/**
*
* Marker view
*
*/

define(
  'src/map/marker',[
    'src/core/baseview',
    'ol',
    'src/core/basecollection',
    'jquery'
  ],
  function(BaseView, ol, BaseCollection, $) {
     var module = {}
      /*
      * Vector layer view
      * Listens to - {poi:loadstart} {marker:select} {marker:unselect}
      * Emits - {marker:add} {marker:click}
      */
      var MarkerVectorView = BaseView.extend({
        initialize: function(options) {
          this.options      =  options
          this.collection   = new BaseCollection()
          this.source = new ol.source.Vector({
            projection: 'EPSG:3857'
          });
          this.zIndexCounter = 9999

          this.hasFocusTemplate = $('#icon_focus') && !_.isEmpty($('#icon_focus').html()) || false
          this.layer = new ol.layer.Vector({
            source: this.source
          });
          this.registerEvents()
        },
        registerEvents: function() {
          _.bindAll(this, 'update', 'selectMarker', 'select', 'unselect', 'hidemarkers', 'showmarkers', 'handleFocus', 'handleBlur')
          this.ea.bind('poi:loadstart', this.update)
                 .bind('poi:click', this.select)
                 .bind('marker:select', this.select)
                 .bind('marker:unselect', this.unselect)
                 .bind('locator:hidemarkers', this.hidemarkers)
                 .bind('locator:showmarkers', this.showmarkers)
                 .bind('poi:focus', this.handleFocus)
                 .bind('poi:blur', this.handleBlur)
          this.listenTo(this.collection, 'reset', this.createMarkers)
        },
        getModel: function(uid) {
          return this.collection.find(function(el) { return el.get('uid') == uid})
        },
        getMarker: function(uid) {
          return _.find(this.source.getFeatures(), function(el) { return el.uid == uid })
        },
        hidemarkers: function() {
          this.layer.setVisible(false)
        },
        showmarkers: function() {
          this.layer.setVisible(true)
        },
        getFeatureForModel: function(feature) {
          var uid     = feature.uid ? feature.uid : feature,
              marker  = this.getMarker(uid)

          return marker
        },
        handleBlur: function(model) {
          if (!this.hasFocusTemplate) { return }
          var marker = this.getFeatureForModel(model)
          var style = marker.get('defaultStyle') || this.createIconStyleFromTemplate('default');
          marker.setStyle(style);
        },
        handleFocus: function(model) {
          if (!this.hasFocusTemplate) { return }
          var marker = this.getFeatureForModel(model)
          var style = this.createIconStyleFromTemplate('icon_focus');
          var defaultStyle = marker.get('defaultStyle')

          if (!defaultStyle) {
            marker.set('defaultStyle', marker.getStyle())
          }
          marker.setStyle(style)

        },
        selectMarker: function( feature ) {

          var uid     = feature.uid ? feature.uid : feature,
              marker  = this.getMarker(uid),
              model   = this.getModel(uid),
              timer, prevUid;
          if (!marker || !model) {
            return
          }

          if (prevUid && uid == prevUid) {
            return
          }

          timer = setTimeout(function() {
            prevUid = null
          }, 100)

          prevUid = uid

          try {
                this.zIndexCounter++;
                var style = marker.getStyle();
                style.setZIndex(this.zIndexCounter);
                marker.setStyle(style);
          } catch (err) {
                console.log(err);
          }

          this.ea.trigger('marker:click', marker.getGeometry().getCoordinates(), model, feature.uid ? feature : marker)
        },
        getPOIBounds: function(pois) {
          var lonMin  = 180;
          var lonMax  = -180;
          var latMin  = 90;
          var latMax  = -90;

          for(var i=0, len=pois.length; i<len; i++) {
            var lon = parseFloat(pois[i].longitude);
            var lat = parseFloat(pois[i].latitude);
            if (isNaN(lon) || isNaN(lon)) continue;
            lonMin = Math.min(lonMin, lon);
            lonMax = Math.max(lonMax, lon);
            latMin = Math.min(latMin, lat);
            latMax = Math.max(latMax, lat);
          }

          var bounds = [lonMin, latMin, lonMax, latMax];
          return ol.proj.transformExtent(bounds, 'EPSG:4326', 'EPSG:3857');
        },
        getcenterPoint: function(){
            return ol.extent.getCenter(this.source.getExtent());
        },
        createMarkers: function(collection, options) {
          var self    = this,
              bounds  = {},
              centerMarker = null

          _.each(this.collection.toJSON().reverse(), function(record, i) {
              var marker = self.createMarker(record, i)
              marker.uid = record.uid
              self.source.addFeature(marker)
          })

          this.layer.poiBounds = this.source.getExtent();
          var centerLonLat = ol.extent.getCenter(this.layer.poiBounds);

          if(options.centerpoint){
	          //Latitude Longitude Coordinates
	          var xLon = +options.centerpoint.split(',')[0];
	          var yLat = +options.centerpoint.split(',')[1];

            centerLonLat = ol.proj.transform([xLon, yLat], 'EPSG:4326', 'EPSG:3857');
            centerMarker = this.addCenterMarker(centerLonLat);

           }

          if (centerMarker) {
            if (this.centerMarker) {
              this.centerMarker.getGeometry().setCoordinates(centerLonLat);

            } else {
              this.centerMarkerSource = new ol.source.Vector({});
              this.centerMarkerLayer = new ol.layer.Vector({
                source: this.centerMarkerSource
              });
              this.centerMarkerSource.addFeature(centerMarker)
              this.centerMarker  = centerMarker
            }
            this.layer.poiBounds = ol.extent.extend(this.layer.poiBounds,
						    ol.extent.boundingExtent([centerLonLat]));

          }

          this.done()
        },
        addCenterMarker : function(markerLonLat) {
          var icon = this.getIconTemplate('center_marker'),
              marker,
              point

          if (!icon || ! markerLonLat) {
            return null
          }

          point = new ol.geom.Point(markerLonLat);

          marker = new ol.Feature({
            geometry: point
          });

          var style = this.createIconStyleFromTemplate('center_marker');
          marker.setStyle(style);


          //if (this.smap.map.baseLayer.projection.toString() == 'EPSG:900913') {
          //  marker.setSphericalMercator(true);
         // }
          /*
          marker.events.register('mouseup', this.smap.locator.proximitySearch, function(evt) {
            OpenLayers.Event.stop(evt);
            var lonlat = evt.object.lonlat;
            this.smap.map.setCenter(lonlat);
            if (this.smap.map.baseLayer.projection.toString() == 'EPSG:900913') {
              lonlat.transform(this.smap.map.baseLayer.projection, new OpenLayers.Projection('EPSG:4326'));
            }
            this.searchLonLat(lonlat, {
              onError : this.locator.clearLocator.bind(this.locator)
            });
            document.fire('w2gi:track', {
              action : 'centermarkerdrag',
              value : lonlat.toShortString()
            });
          });
          marker.events.register('touchend', this.smap.locator.proximitySearch, function(evt) {
            OpenLayers.Event.stop(evt);
            var lonlat = evt.object.lonlat;
            this.smap.map.setCenter(lonlat);
            if (this.smap.map.baseLayer.projection.toString() == 'EPSG:900913') {
              lonlat.transform(this.smap.map.baseLayer.projection, new OpenLayers.Projection('EPSG:4326'));
            }
            this.searchLonLat(lonlat, {
              onError : this.locator.clearLocator.bind(this.locator)
            });
            document.fire('w2gi:track', {
              action : 'centermarkerdrag',
              value : lonlat.toShortString()
            });
          });
          */
          //this.layer.addMarker(marker);
          return marker;
        },
        _getIconSize: function(el) {
          return [el.data('width'), template.data('height')];
        },
        getIconTemplate: function(icon) {
          var template = (this.loadTemplate(icon))(),
              res = {}, image = {}, $template;

          template = _.isEmpty(template) ? (this.loadTemplate('default'))() : template;

          if (_.isEmpty(template)) {
            return null
            /*
            return {
              src:  '/demos/bb/images/mappin.png',
              width: 31,
              height: 53
            }*/
          }
          image       = $(template).find('img').first()
          res.src     = image.attr('src')
          $template = $(template)
          res.width   = $template.data('width')
          res.height  = $template.data('height')
          res.offsetX = $template.data('offsetx')
          res.offsetY = $template.data('offsety')
          res.labelOffsetX = $template.data('labeloffsetx') || 0
          res.labelOffsetY = $template.data('labeloffsety') || 0
          res.fontColor = $template.data('fontcolor') || '#000'
          res.fontSize = $template.data('fontsize') || '10px'
          res.fontFamily = $template.data('fontfamily') || 'serif'
          res.fontWeight = $template.data('fontweight') || ''
          res.fontStyle = $template.data('fontstyle') || ''
          res.fontVariant = $template.data('fontvariant') || ''
          res.display = $template.data('display')
          res.bubbleid = $template.data('bubbleid') || ''
          return res

        },
        createIconStyleFromTemplate: function(icon, opt_label) {
          var template = this.getIconTemplate(icon),
              text;

          var anchor = [
            -template.offsetX,
            -template.offsetY
          ]
          var iconOptions = {
            src: template.src,
            anchorXUnits: 'pixels',
            anchorYUnits: 'pixels',
            anchor: anchor,
            opacity: 1
          };

          var icon = new ol.style.Icon(iconOptions);
          var styleOptions = {
            image: icon,
            scale: 1
          };

          if (opt_label !== undefined && !!template.display) {
            var font = [
              template.fontStyle + '',
              template.fontVariant + '',
              template.fontWeight + '',
              template.fontSize + '',
              template.fontFamily
            ].join(' ');
            var textOptions = {
              offsetX: +template.labelOffsetX,
              offsetY: -template.labelOffsetY,
              font: font,
              fill: new ol.style.Fill({color: template.fontColor}),
              text: opt_label
            };

            text = new ol.style.Text(textOptions);
            styleOptions.text = text;
          }

          var i = new Image();
          i.src = template.src;
          if (i.width) {
            var scale = Math.min(template.height / i.height, template.width / i.width);
            icon.setScale(scale);
            if (text) {
              text.setOffsetX(text.getOffsetX() * scale);
              text.setOffsetY(text.getOffsetY() * scale);
            }
          } else {
            i.addEventListener('load', function(e) {
              var img = e.target;
              var scale = Math.min(template.height / img.height, template.width / img.width);
              icon.setScale(scale);
              if (text) {
                text.setOffsetX(text.getOffsetX() * scale);
                text.setOffsetY(text.getOffsetY() * scale);
              }
            });
          }

          return new ol.style.Style(styleOptions);
        },
        createMarker: function(record, i) {
          var lonlat = ol.proj.transform([+record.longitude, +record.latitude], 'EPSG:4326', 'EPSG:3857');
          var point = new ol.geom.Point(lonlat);
          var icon = this.getIconTemplate(record.icon);

          var feature = new ol.Feature({
            bubbleid: icon.bubbleid,
            geometry: point,
            record: record
          });
          style = this.createIconStyleFromTemplate(record.icon, record.collectionIndex.toString());
          style.setZIndex(this.source.getFeatures().length + 1);
          feature.setStyle(style);

          return feature;
        },
        clearFeatures: function() {
          this.source.clear();
        },
        select: function(feature) {

          this.selectMarker(feature)
        },
        unselect: function(feature){
         // debugger
        },


        update: function(collection, options) {
          this.clearFeatures()
          this.collection.reset(collection,options)
        },
        done: function(features){
          if (this.layer.getVisible() === false) {
            this.showmarkers()
          }
          this.ea.trigger('marker:add', this.layer, this.centerMarkerLayer)
        }
      })
      return MarkerVectorView
  }
)

// Original slippymap implementation

/*
      * Marker layer view
      * Listens to - {poi:loadstart} {poi:click}
      * Emits - {marker:add} {marker:click}
      */
      /*
      var MarkerView = BaseView.extend({
        initialize: function(options) {
          this.options      =  options
          this.collection   = new BaseCollection()
          this.layer        = new OpenLayers.Layer.Markers('Markers', {projection: 'EPSG:900913', eventListeners: {
                      'loadend': function(e) {
                        console.log('\nloaded 3')
                      }
                    }})
          this.registerEvents()
        },
        registerEvents: function() {
          _.bindAll(this, 'update', 'selectMarker')
          this.ea.bind('poi:loadstart', this.update)
                 .bind('poi:click', this.selectMarker)
          this.listenTo(this.collection, 'reset', this.createMarkers)
        },
        getModel: function(uid) {
          return this.collection.find(function(el) { return el.get('uid') === uid})
        },
        getMarker: function(uid) {
          return _.find(this.layer.markers, function(el) { return el.uid === uid })
        },
        selectMarker: function(uid) {
          var marker = this.getMarker(uid),
              model  = this.getModel(uid)

          this.ea.trigger('marker:click', marker.lonlat, model)
        },
        getPOIBounds: function(pois) {
          var lonMin  = 180;
          var lonMax  = -180;
          var latMin  = 90;
          var latMax  = -90;

          for(var i=0, len=pois.length; i<len; i++) {
            var lon = parseFloat(pois[i].longitude);
            var lat = parseFloat(pois[i].latitude);
            if (isNaN(lon) || isNaN(lon)) continue;
            lonMin = Math.min(lonMin, lon);
            lonMax = Math.max(lonMax, lon);
            latMin = Math.min(latMin, lat);
            latMax = Math.max(latMax, lat);
          }
          var bounds = new OpenLayers.Bounds(lonMin, latMin, lonMax, latMax);
          if (this.layer.projection.toString() == "EPSG:900913") {
            bounds.transform(new OpenLayers.Projection('EPSG:4326'),this.layer.projection);
          }
          return bounds;
        },
        createMarkers: function() {
          var self    = this,
              bounds  = {},
              size    = new OpenLayers.Size(21,25),
              offset  = new OpenLayers.Pixel(-(size.w/2), -size.h),
              icon    = new OpenLayers.Icon('/demos/bb/images/mappin.png', size, offset)

          _.each(this.collection.toJSON(), function(record) {
              var marker = self.createMarker(record, icon.clone())
              marker.uid = record.uid
              marker.events.register('mousedown', marker, function(evt) {
                var model = self.getModel(this.uid)
                self.ea.trigger('marker:click', this.lonlat, model)
                OpenLayers.Event.stop(evt)
              })
              self.layer.addMarker(marker)
          })
          this.layer.poiBounds = this.getPOIBounds(this.collection.toJSON())
          this.done()
        },
        createMarker: function(record, icon) {

          var lonlat    = new OpenLayers.LonLat(record.longitude, record.latitude).transform('EPSG:4326', 'EPSG:900913'),
              _icon     = icon
          return new OpenLayers.Marker(lonlat, _icon)
        },
        clearFeatures: function() {
          this.layer.clearMarkers()
        },
        update: function(collection) {
          this.clearFeatures()
          this.collection.reset(collection)
        },
        done: function(features){
          this.ea.trigger('marker:add', this.layer)
        }
      })
        */
;
/*
*
*   Locator model
*
*/

define(
    'src/directions/models/directions',['src/core/basemodel'],
    function(Model){
        return Model.extend({
            getOptions: function() {
                return {
                    objectName: 'driving_directions',
                    method:     'drivingdirections',
                    reset:      true,
                    noAccount:  true
                }
            },
            initialize: function(options) { this.options = this.getOptions() },
            load:       function() {
                this.options.formdata = this.toJSON()
                this.fetch(this.options)
            },
            search: function(addresses) {
                var geoloc = []
                _(addresses).each(function(e, index) {
                    var geolocArr = e.geolocs.geoloc
                    geoloc.push(e.geolocs.geoloc[0])
                })
                this.attributes.geolocs.geoloc = geoloc
                this.load()
            },
            parse: function(data, options) {
                var result = data
                //debugger
                var multiple = _.filter(data, function(item) {return item.collectionname && item.collectionname== 'multiple_address'})

                this.isMultipleAddress = multiple && !_.isEmpty(multiple)

                if (this.isMultipleAddress) {
                    var self = this
                    this.reqAddresses = this.attributes.geolocs.geoloc
                    _.each(data, function(item, index) {
                        if (item.collectionname && item.collectionname== 'multiple_address') {
                            self.addressIndex = index
                        }
                    })
                }

                if (this.isMultipleAddress) {
                    result = multiple[0]
                }
                return result
            }
        })
    }
)
;
/**
*
* Directions
* Listens to - {} {}
* Emits - {} {}
*/
define(
  'src/directions/directions',[
    'src/core/baseview',
    'src/core/basemodel',
    'src/directions/models/directions',
    'jquery'
  ],
  function(BaseView, BaseModel, DirectionsModel, $) {
    var DirectionsFormView = BaseView.extend({
      element: $('.dd-form-wrapper'),
      events: {
            'click .button-search': 'click',
            'click .reverse': 'reverseSearchInputs',
            'focus [name="addressline"]': 'clearLatLon'
        },
      initialize: function(options) {
        this.options  = options
        this.searchFormID = 'driving_directions'
        //this.stringFrm = JSON.stringify(options.formdata)

        this.template = this.loadTemplate('dd-template')
        this.addresslineTemplate = this.loadTemplate('directions_addressline')
        if(this.template() != '') $(this.element).html( this.template() )

        this.searchForm = $('#driving_directions')
        this.setElement(this.searchForm)
        this.checkQueryParams()
        this.ea.trigger('add:autocomplete');
      },
      click: function(event){
        event.preventDefault()
        var sa = {
        			addressline: this.searchForm.find('[data-action="start"]').val(),
        			country: this.searchForm.find('#country').val(),
        			latitude: this.searchForm.find('#latitude').val(),
        			longitude: this.searchForm.find('#longitude').val(),
        		 },
            ea = {
            		addressline: this.searchForm.find('[data-action="end"]').val(),
            		country: this.searchForm.find('#dest_country').val(),
        			latitude: this.searchForm.find('#dest_latitude').val(),
        			longitude: this.searchForm.find('#dest_longitude').val(),
            	 }
        this.ea.trigger('directions:searchform', sa, ea)
      },
      populateAddresses: function(addresses) {
        this.renderAddress(addresses)
      },
      checkQueryParams: function() {

      },
      renderAddress: function(addresses) {
        var result = this.getParsedAddresses(addresses)
        this.searchForm.find('[data-action="start"]').val(result.origin.addressline)
        this.searchForm.find('[data-action="end"]').val(result.destination.addressline)
        $('#latitude', this.searchForm).val(result.origin.address.latitude)
        $('#longitude', this.searchForm).val(result.origin.address.longitude)
        $('#dest_latitude', this.searchForm).val(result.destination.address.latitude)
        $('#dest_longitude', this.searchForm).val(result.destination.address.longitude)
        $('#country', this.searchForm).val(result.origin.address.country)
        $('#dest_country', this.searchForm).val(result.destination.address.country)
        W2GI.addresses = []
        W2GI.form = this.searchFormID
        W2GI.addresses.push({latitude: result.origin.address.latitude, longitude: result.origin.address.longitude})
        W2GI.addresses.push({latitude: result.destination.address.latitude, longitude: result.destination.address.longitude})

      },
      clearLatLon: function(event){
      	event.preventDefault();
      	var el = this.getTarget(event);
      	if(el.attr('data-action') ==  'start'){
      		this.searchForm.find('[name=latitude]').val("")
      		this.searchForm.find('[name=longitude]').val("")
      	}else{
      		this.searchForm.find('[name=dest_latitude]').val("")
      		this.searchForm.find('[name=dest_longitude]').val("")
      	}

      },
      getParsedAddresses: function(addresses) {
        var parsedResult  = {},
            origin,
            destination

		    var _addresses = addresses.hasOwnProperty('collection') ? addresses.collection : addresses;

        _(_addresses).each(function(e) {
          if (e.address1 && _.isEmpty(e.address1)) { delete e.address1 }
        })

        parsedResult = {
          origin: {
            address: _addresses[0] || _addresses.collection[0],
            addressline: this.addresslineTemplate(_addresses[0]).trim().replace(', ' + _addresses[0].country ? _addresses[0].country : 'XYZ', '').replace(/\s*,\s*$/,'')
          },
          destination: {
            address: _addresses[1] || _addresses.collection[1],
            addressline: this.addresslineTemplate(_addresses[1]).trim().replace(', ' + _addresses[1].country ? _addresses[0].country : 'XYZ', '').replace(/\s*,\s*$/,'')

          }
        }
        return parsedResult
      },
      reverseSearchInputs: function() {
        var addressline = this.searchForm.find('[name="addressline"]'),
            values = _(addressline).pluck('value').reverse()
        addressline.each(function(index) { this.value = values[index] })
        /*
        var addressline = this.searchForm.getInputs('text', 'addressline')
        var values      = addressline.pluck('value').reverse()
        addressline.each(function(e, index) { e.value = values[index] })
        */
      }
    })
    var DirectionsView = BaseView.extend({
        events: {
            'click input[type="submit"]': 'click',
            'click .origin-select a' : 'toggleAction'
        },
        popupActionText: {
          to: 'To: ',
          from: 'From: '
        },
        initialize: function(options) {
          this.options  =  options
          this.stringFrm = JSON.stringify(options.formdata)
          this.model    = new DirectionsModel(this.options.formdata)
          this.registerEvents()
        },
        registerEvents: function() {
           this.listenTo(this.model, 'change', this.processResponse)
          _.bindAll(this, 'popupLoaded', 'searchForm', 'enableClientSide', 'cdirectionsResponse','processResponse', 'searchMarker','initDirectionsFormView')
          this.ea.bind('popup:loaded',  this.popupLoaded)
                 .bind('directions:searchform', this.searchForm)
                 .bind('locator:clientdirectionson', this.enableClientSide)
                 .bind('cdirections:result', this.cdirectionsResponse)
                 .bind('directions:searchmarker', this.searchMarker)
                 .bind('directions:initform', this.initDirectionsFormView)
        },
        popupLoaded: function(popup, model) {
          this.feature = model.toJSON()
        },
        toggleAction: function(event) {
          var el = this.getTarget(event),
              action
          this.$el.find('.origin-select a').removeClass('active_action')
          el.addClass('active_action')
          action = this.getAction()
          if(action == 'to') {
            $('span', '#dd').text(this.popupActionText.from)
          } else {
            $('span', '#dd').text(this.popupActionText.to)
          }

          this.$el.find('#dd').show()
        },
        getAction: function() {
          //ddaction = (form.getElementsByTagName('a') && form.getElementsByTagName('a')[0].innerHTML == 'To')  ? 'To' : 'From';
          return this.$el.find('.active_action').data('action')
        },
        cdirectionsResponse: function(response) {
          this.model.set(response)
        },
        enableClientSide: function() {
          this.clientSide = true
        },
        getAddresses: function(form, ddaction, feature) {
          this.clearFormdata()
          var formdata      = this.getFormValues(this.$el.find('form').attr('id')),
              frm           = JSON.parse(this.stringFrm),
              poiAddress    = new BaseModel(JSON.parse(JSON.stringify(frm))), //to
              address       = new BaseModel(JSON.parse(JSON.stringify(frm))), //from
              addresses;

            if (!formdata.addressline && !formdata.city && !formdata.postalcode && !formdata.state && !formdata.province) {
                 ace.util.alert(this.getLocaleString('validate_form_dd', 'Please enter an address.'), {title_text: this.getLocaleString('no_results_dd', 'No Results Found')});
                 return;
            }

            this.startAddress = $('.search-box').val()
            poiAddress    = poiAddress.setModelValues(feature, poiAddress.toJSON()) //end
            address       = address.setModelValues(formdata, address.toJSON()) // start
            addresses     = (ddaction === 'from') ? [poiAddress, address] : [ address, poiAddress ]
            return addresses
        },
        getLocaleString: function(key, defaultValue) {

          if ( W2GI.custom_ob && W2GI.custom_ob.errorList && W2GI.custom_ob.errorList[key] &&  /*|| this.options.errLang*/ ace.locale.current) {
            return W2GI.custom_ob.errorList[key][ace.locale.current.substring(0,2)] || defaultValue
          } else {
            return defaultValue
          }
        },
        clearFormdata: function() {
          var els,
              self = this
          if (this.options.formdata.geolocs.geoloc.length == 1) {
            this.options.formdata.geolocs.geoloc.splice(1,1)
          }
          els = _(this.options.formdata.geolocs.geoloc[0]).keys()
          _.each(els, function(e)  { self.options.formdata.geolocs.geoloc[0][e] = '' })
        },
        searchMarker: function(lonlat, index, ea) {
          var sa = {
                longitude: lonlat[0],
                latitude: lonlat[1]
          },
          self = this

          if (this.clientSide && ace.cgeo && ace.cgeo.reverseGeocode) {
            ace.cgeo.reverseGeocode({latitude: lonlat[1], longitude: lonlat[0]}, {routeDrag: true}).then(function(response) {
              sa = response
              self.clearFormdata()
              var frm  = JSON.parse(self.stringFrm),
                poiAddress  = new BaseModel(JSON.parse(JSON.stringify(frm))),      //end
                address     = new BaseModel(JSON.parse(JSON.stringify(frm))), //start
                addresses = (index <= 0) ? [address, ea] : [ea, address]
              self.startAddress = $('.search-box').val()
              poiAddress    = poiAddress.setModelValues(ea, poiAddress.toJSON()) //end
              address       = address.setModelValues(sa, address.toJSON()) // start
              addresses = (index <= 0) ? [address, poiAddress] : [poiAddress, address]//[poiAddress, address]
              //addresses     = (ddaction === 'From') ? [poiAddress, address] : [ address, poiAddress ]
              self.search(addresses)
              //this._searchForm(addresses[0], addresses[1])
            })

          } else {
            this.clearFormdata()
            var frm  = JSON.parse(this.stringFrm),
              poiAddress  = new BaseModel(JSON.parse(JSON.stringify(frm))),      //end
              address     = new BaseModel(JSON.parse(JSON.stringify(frm))), //start
              addresses = (index <= 0) ? [address, ea] : [ea, address]
            this.startAddress = $('.search-box').val()
            poiAddress    = poiAddress.setModelValues(ea, poiAddress.toJSON()) //end
            address       = address.setModelValues(sa, address.toJSON()) // start
            addresses = (index <= 0) ? [address, poiAddress] : [poiAddress, address]
            //addresses     = (ddaction === 'From') ? [poiAddress, address] : [ address, poiAddress ]
            this.search(addresses)
            //this._searchForm(addresses[0], addresses[1])
          }
        },
        _searchForm: function(sa, ea) {
          this.clearFormdata()
          var frm         = JSON.parse(this.stringFrm),
              toAddress  = new BaseModel(JSON.parse(JSON.stringify(frm))),
              fromAddress     = new BaseModel(JSON.parse(JSON.stringify(frm))),
              addresses
          this.startAddress = $('.search-box').val()
          toAddress    = toAddress.setModelValues(ea, toAddress.toJSON()) //end
          fromAddress       = fromAddress.setModelValues(sa, fromAddress.toJSON()) // start
          addresses = [ fromAddress, toAddress]
          //addresses     = (ddaction === 'From') ? [poiAddress, address] : [ address, poiAddress ]
          this.search(addresses)
        },
        click: function(event) {
           var ddaction   = this.getAction(event),
               addresses  = this.getAddresses(this.options.formdata, ddaction, this.feature)
            if (event) { event.preventDefault() }
            if (!addresses) {
               return;
            }

            this.search(addresses)
        },
        search: function(addresses) {
           var addr = _.pluck(addresses, 'geolocs')
                addr = _.pluck(addr, 'geoloc')
                addr = _.flatten(addr)
          this.addresses = addr
          if (this.options.externalBingDirections && this.options.externalBingDirections == true) {
              var reqStr = 'http://bing.com/maps/default.aspx?rtp=';

              reqStr += this.getBingAddress(addresses[0])
              reqStr += '~' + this.getBingAddress(addresses[1])
              return window.open(reqStr, '_blank')
          }
          else if (this.options.clientSideDirections || this.clientSide) {
              addr = _.pluck(addresses, 'geolocs')
              addr = _.pluck(addr, 'geoloc')
              addr = _.flatten(addr)

              var opts = {
                feature: this.feature,
                distanceuom: 'mile'
              }
              var params = this.options.params ? this.options.params : {}
              if (this.options.route && this.options.route.distanceuom) {
                params.distanceuom = this.options.route.distanceuom
              }
              params.travelmode = $('#travelmode')[0] ? $('#travelmode')[0].value : params.travelmode;
              this.ea.trigger('directions:searchclient', addr, opts, params);
          } else {
            this.model.search(addresses)
          }
        },
        getBingAddress: function(address) {
                var res = ''
                if (!address.geolocs.geoloc[0]) {
                        return res;
                }
                var addr = address.geolocs.geoloc[0];
                if (addr.addressline) {
                        res += 'adr.' + addr.addressline;
                        if (addr.country) {
                                res += ',' + addr.country;
                        }
                } else if (addr.address1) {
                        res += 'adr.' + addr.address1;
                        if (addr.city) {
                                res += ',' + addr.city;
                        }
                        if (addr.state) {
                                res += ',' + addr.state;
                        }
                        if (addr.province) {
                                res += ',' + addr.province;
                        }
                        if (addr.country) {
                                res += ',' + addr.country;
                        }
                } else {
                        res += 'pos.' + addr.latitude + '_' + addr.longitude
                }
                return res
        },
        searchForm: function(sa, ea){
          this._searchForm(sa, ea)
        },
        processResponse: function() {
          var response = this.model.toJSON()
          if (this.model.isMultipleAddress) {
            W2GI._multiple = {
              addresses: this.addresses,
              suggestions: response.collection,
              reqAddress: this.model.reqAddress,
              addressIndex: this.model.addressIndex
            }
            var self = this
            var _self = this
            var template   = this.loadTemplate('collection_multiple_address')
            var el = $('.wrapper .poi')
            el.html(template(response.collection))
            var handlePoiClick = function(ev) {
              var target = $(this).data('id')
              var add = W2GI._multiple.suggestions[target]
              var addresses = (W2GI._multiple.addressIndex == 0) ? [add, W2GI._multiple.addresses[1]] : [W2GI._multiple.addresses[0], add]
              $(document).trigger('directions:retrysearch', addresses)
            }
            //_.bind('handlePoiClick', self)
            $('.wrapper .poi .address-suggestions li').on('click', handlePoiClick)
            return
          }
          this.ea.trigger('map:clear')
          var markerLayer = this.routeMarkerLayer;
          var routeLayer  = this.routeLayer;
          if (! routeLayer) {
            routeLayer = this.routeImageLayer;
          }
          if (response.maneuvers) {
            this.bounds     = this._getRouteBounds(response.maneuvers.attributes);
            //var addresses   = response.addresses && response.addresses.collection ? response.addresses.collection : response.addresses
            addresses = this.addresses
            this.mapurl = response.mapurl || response.attributes && response.attributes.mapurl || response.maneuvers.attributes && response.maneuvers.attributes.mapurl || null
            _(['A', 'B']).each(function(letter, index) {
              addresses[index].poinum = letter
              addresses[index].recnum = letter
            });

            if(this.mapurl && response.maneuvers.attributes){
            	var tempEmail = response.maneuvers.attributes.emailmapurl;
            	var tempMobile = response.maneuvers.attributes.mobilemapurl;
            	response.maneuvers.attributes.emailmapurl = tempEmail ? tempEmail : '/lite?' + this.mapurl.split('/lite?')[1].replace('getdirectionsmap', 'emaildirectionstart');
            	response.maneuvers.attributes.mobilemapurl = tempMobile ? tempMobile : '/lite?' + this.mapurl.split('/lite?')[1].replace('getdirectionsmap', 'smsdirectionstart');
            }

            /**
             * If it is any country but the US or CA,
             * or the source of directions is Google,
             * then we'll flip things to Google layer
             */
            if (_(response.addresses.collection).any(function (o) { return (o.country != 'US' && o.country != 'CA'); } ) || response.source == 'Google') {
              this.layer = this.googleLayer;
              this.view = this.mercatorView;
            }
            /* need to handle situation where OSM is the base layer and we need to switch to either Navteq if US/CA or Google for everyone else
             * we know it is either OSM or Google if we get here
             */
            else {
              navteqLayer = this.navteqLayer;
              if (_(response.addresses.collection).any(function (o) { return (o.country == 'US' || o.country == 'CA'); } ) && navteqLayer) {
                this.layer = navteqLayer;
                this.view = this.latLonView;
              }
              else {
                this.layer = this.mainLayer;
                this.view = this.smap.getView();
              }
            }

            if(this.layer && this.view) {
              if(this.layer != this.mainLayer) {
                this.mainLayer.setVisible(false);
              }
              if(this.navteqLayer && this.layer != this.navteqLayer) {
                this.navteqLayer.setVisible(false);
              }
              if(this.googleLayer && this.layer != this.googleLayer) {
                this.googleLayer.setVisible(false);
              }
              this.smap.setView(this.view);
              this.layer.setVisible(true);
            }

            this.smap.directionsDisplayed = true

            this.bounds = ace.util.transformExtent(this.bounds, this.view, 'EPSG:4326');
            this.ea.trigger('map:zoomToExtent', this.bounds)
            var responseAddresses   = response.addresses && response.addresses.collection ? response.addresses.collection : response.addresses || addresses

            var includeATW = (this.options.formdata && this.options.formdata.alongTheWay) ? this.options.formdata.alongTheWay : false;
            includeATW = (this.directionsForm && this.directionsForm.el && this.directionsForm.el["includeATW"]) ? this.directionsForm.el["includeATW"].checked : includeATW;

            includeATW && response.pois && response.pois.collection && this.ea.trigger('directions:addAtw', response.pois.collection)//So that end markers will be placed on top

            this.ea.trigger('directions:addEndMarkers', responseAddresses)
            this.ea.trigger('directions:addRoute', response.maneuvers)


            //var poi_xml = ace.xml.getCollection(responseXML, 'pois');
            this.ea.trigger('directions:updatePanel', response.maneuvers, responseAddresses, includeATW);
            this.maneuvers = response.maneuvers;

            /*if(response.pois) { //(poi_xml && poi_xml.childNodes && poi_xml.childNodes.length != 0) {
              var pois  = response.pois.collection; //ace.xml.parse(poi_xml);
              // add the records in the table, needed by popup
              _(pois).each(function(poi, index) {
                poi.POINUM = index + 1;
                poi.RECNUM = this.maneuvers.collection.length+1;//ace.table.data[this.locator.panelID].records.length+1;
                this.maneuvers.collection.push(poi);//ace.table.data[this.locator.panelID].records.push(poi)
              }.bind(this));
              //var table = this.ddpanel.down();
              //this._addAlongTheWayInfo(table, pois);
            }*/

            this.searchForm = $('')
            if (!this.options.disableDynamicRoutes && !this.mapurl) {
              this.showDDForm(response.addresses.collection)
            }else if (response.addresses) {
            	var addresses = this.addresses = response.addresses
            	this.showDDForm(addresses);
            }

            //this._updatePanelAddressline(addresses)
            if (this.mapurl) {
             this._addMapUrlImage(this.mapurl)
            }
          } else {
            var addresses = this.addresses = response.addresses
          }
          $(document).trigger("w2gi:directionsupdated", response);
        },
        _addMapUrlImage: function(mapurl) {
          var img = $('#map_url_image')[0];

          if (mapurl && img ) {
            var size = mapurl.match(/size=(\d+),(\d+)/)
            if (size) {
              img.width = size[1]
              img.height = size[2]
            }
            img.src = mapurl
          }
        },
        showDDForm: function(addresses) {
          $('.form-wrapper').hide()
          var prevATW = (this.directionsForm && this.directionsForm.el && this.directionsForm.el["includeATW"]) ? this.directionsForm.el["includeATW"].checked : false
          this.directionsForm = new DirectionsFormView()

          if (this.directionsForm && this.directionsForm.el && this.directionsForm.el["includeATW"])
          	this.directionsForm.el["includeATW"].checked = prevATW;

          this.directionsForm.populateAddresses(addresses)
          //this.listenTo(this.directionsForm, 'search', this.searchForm)
          $('.dd-form-wrapper').show()
        },
        initDirectionsFormView: function(){
        	new DirectionsFormView();
        },
        _addReverseSearchInputsObservers: function() {
          if (this.searchForm) {
            var flipDir = this.searchForm.getElementsByTagName('img')[0];
            if (flipDir) Event.observe(flipDir, 'click', this._reverseSearchInputs.bind(this));
          }
        },
        _addReverseSearchObservers: function() {
          /*
          ace.util.select(this.ddpanel,'reverse_directions').each(function(e) {
            Event.observe(e, 'click', this._reverseSearch.bind(this));
          }.bind(this));
          ace.util.select(this.ddpanel,'reverse_directions_p').each(function(e) {
            Event.observe(e, 'click', this._reverseSearchP.bind(this));
          }.bind(this));
          */
        },
        _reverseSearch: function() {
          this._reverseSearchInputs();
          console.log('Deprecated call to SlippyMap.Util');
          //ace.directions.search(this.ddpanel, this.formData, this.includeATW, this.addresses.reverse(), false, this.processResponse.bind(this), {onHistory: SlippyMap.Util.addHistory},this.searchForm);
            document.fire('w2gi:track', {action: 'clickonreversedd', value: '1'});
        },
        _reverseSearchP: function() {
          console.log('Deprecated call to SlippyMap.Util');
          //ace.directions.search(this.ddpanel, this.formData, this.includeATW, this.addresses.reverse(), false, this.processResponse.bind(this), {onHistory: SlippyMap.Util.addHistory},this.searchForm);
            document.fire('w2gi:track', {action: 'clickonreversedd', value: '1'});
        },
        _updateAddressline: function(address, index) {
          var addressline = this.searchForm.getInputs('text', 'addressline')[index];
          if(!addressline)
            addressline = this.searchForm.getInputs('hidden', 'addressline')[0];
            //index 0 because there is only one hidden address line though it is the second index

          if(addressline)
            console.log('Deprecated call to SlippyMap.Util');
            //addressline.value = SlippyMap.Util.getAddressline(address);
        },
        _getRouteBounds: function(attributes) {
          var bounds = attributes.bounds.split(',');
          return [+bounds[0], +bounds[1], +bounds[2], +bounds[3]];
        },
        render: function() {
          //debugger
        }
    })
    return DirectionsView
  }
)
;
// Ol3-PanZoom. See https://github.com/mapgears/ol3-panzoom/
// License: https://github.com/mapgears/ol3-panzoom/blob/master/LICENSE
// Version: v0.2

(function (root, factory) {
  if (typeof exports === "object") {
    module.exports = factory(root.ol);
  } else if (typeof define === "function" && define.amd) {
    define('ol3pz',['ol'], factory);
  } else {
    root.olpz = factory(root.ol);
  }
}(this, function (ol) {
  var OL3PANZOOM = {};
  var k=this;function n(a,c){var b=a.split("."),d=OL3PANZOOM||k;b[0]in d||!d.execScript||d.execScript("var "+b[0]);for(var e;b.length&&(e=b.shift());)b.length||void 0===c?d[e]?d=d[e]:d=d[e]={}:d[e]=c}
function p(a){var c=typeof a;if("object"==c)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return c;var b=Object.prototype.toString.call(a);if("[object Window]"==b)return"object";if("[object Array]"==b||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==b||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==c&&"undefined"==typeof a.call)return"object";return c}function r(a,c){function b(){}b.prototype=c.prototype;a.w=c.prototype;a.prototype=new b;a.F=function(a,b,g){return c.prototype[b].apply(a,Array.prototype.slice.call(arguments,2))}};function s(a,c){return a<c?-1:a>c?1:0};var t=Array.prototype,aa=t.indexOf?function(a,c,b){return t.indexOf.call(a,c,b)}:function(a,c,b){b=null==b?0:0>b?Math.max(0,a.length+b):b;if("string"==typeof a)return"string"==typeof c&&1==c.length?a.indexOf(c,b):-1;for(;b<a.length;b++)if(b in a&&a[b]===c)return b;return-1};var u;a:{var v=k.navigator;if(v){var x=v.userAgent;if(x){u=x;break a}}u=""};var y=-1!=u.indexOf("Opera")||-1!=u.indexOf("OPR"),z=-1!=u.indexOf("Trident")||-1!=u.indexOf("MSIE"),A=-1!=u.indexOf("Gecko")&&-1==u.toLowerCase().indexOf("webkit")&&!(-1!=u.indexOf("Trident")||-1!=u.indexOf("MSIE")),B=-1!=u.toLowerCase().indexOf("webkit");function C(){var a=k.document;return a?a.documentMode:void 0}
var D=function(){var a="",c;if(y&&k.opera)return a=k.opera.version,"function"==p(a)?a():a;A?c=/rv\:([^\);]+)(\)|;)/:z?c=/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/:B&&(c=/WebKit\/(\S+)/);c&&(a=(a=c.exec(u))?a[1]:"");return z&&(c=C(),c>parseFloat(a))?String(c):a}(),E={};
function F(a){var c;if(!(c=E[a])){c=0;for(var b=String(D).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),d=String(a).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),e=Math.max(b.length,d.length),g=0;0==c&&g<e;g++){var f=b[g]||"",h=d[g]||"",q=RegExp("(\\d*)(\\D*)","g"),l=RegExp("(\\d*)(\\D*)","g");do{var m=q.exec(f)||["","",""],w=l.exec(h)||["","",""];if(0==m[0].length&&0==w[0].length)break;c=s(0==m[1].length?0:parseInt(m[1],10),0==w[1].length?0:parseInt(w[1],10))||s(0==m[2].length,0==w[2].length)||
s(m[2],w[2])}while(0==c)}c=E[a]=0<=c}return c}var G=k.document,ba=G&&z?C()||("CSS1Compat"==G.compatMode?parseInt(D,10):5):void 0;var H;(H=!z)||(H=z&&9<=ba);var I=H,ca=z&&!F("9");!B||F("528");A&&F("1.9b")||z&&F("8")||y&&F("9.5")||B&&F("528");A&&!F("8")||z&&F("9");function J(a,c){this.type=a;this.a=this.target=c}J.prototype.b=function(){};function K(a){K[" "](a);return a}K[" "]=function(){};function L(a,c){J.call(this,a?a.type:"");this.c=this.a=this.target=null;if(a){this.type=a.type;this.target=a.target||a.srcElement;this.a=c;var b=a.relatedTarget;if(b&&A)try{K(b.nodeName)}catch(d){}this.c=a;a.defaultPrevented&&this.b()}}r(L,J);L.prototype.b=function(){L.w.b.call(this);var a=this.c;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,ca)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(c){}};var M="closure_listenable_"+(1E6*Math.random()|0),da=0;function ea(a,c,b,d,e){this.d=a;this.a=null;this.src=c;this.type=b;this.i=!!d;this.b=e;++da;this.e=this.h=!1}function N(a){a.e=!0;a.d=null;a.a=null;a.src=null;a.b=null};function O(a){this.src=a;this.a={};this.b=0};var P="closure_lm_"+(1E6*Math.random()|0),Q={},R=0;
function S(a,c,b,d,e){if("array"==p(c)){for(var g=0;g<c.length;g++)S(a,c[g],b,d,e);return null}b=fa(b);if(a&&a[M])a=a.a(c,b,d,e);else{g=b;if(!c)throw Error("Invalid event type");b=!!d;var f=T(a);f||(a[P]=f=new O(a));var h=f,q=c.toString(),f=h.a[q];f||(f=h.a[q]=[],h.b++);var l;b:{for(l=0;l<f.length;++l){var m=f[l];if(!m.e&&m.d==g&&m.i==!!d&&m.b==e)break b}l=-1}-1<l?(d=f[l],d.h=!1):(d=new ea(g,h.src,q,!!d,e),d.h=!1,f.push(d));d.a||(e=ga(),d.a=e,e.src=a,e.d=d,a.addEventListener?a.addEventListener(c.toString(),
e,b):a.attachEvent(U(c.toString()),e),R++);a=d}return a}function ga(){var a=ha,c=I?function(b){return a.call(c.src,c.d,b)}:function(b){b=a.call(c.src,c.d,b);if(!b)return b};return c}function U(a){return a in Q?Q[a]:Q[a]="on"+a}function V(a,c,b,d){var e=1;if(a=T(a))if(c=a.a[c.toString()])for(c=c.concat(),a=0;a<c.length;a++){var g=c[a];g&&g.i==b&&!g.e&&(e&=!1!==W(g,d))}return Boolean(e)}
function W(a,c){var b=a.d,d=a.b||a.src;if(a.h&&"number"!=typeof a&&a&&!a.e){var e=a.src;if(e&&e[M])e.G(a);else{var g=a.type,f=a.a;e.removeEventListener?e.removeEventListener(g,f,a.i):e.detachEvent&&e.detachEvent(U(g),f);R--;if(g=T(e)){var f=a.type,h;if(h=f in g.a){h=g.a[f];var q=aa(h,a),l;(l=0<=q)&&t.splice.call(h,q,1);h=l}h&&(N(a),0==g.a[f].length&&(delete g.a[f],g.b--));0==g.b&&(g.src=null,e[P]=null)}else N(a)}}return b.call(d,c)}
function ha(a,c){if(a.e)return!0;if(!I){var b;if(!(b=c))a:{b=["window","event"];for(var d=k,e;e=b.shift();)if(null!=d[e])d=d[e];else{b=null;break a}b=d}e=b;b=new L(e,this);d=!0;if(!(0>e.keyCode||void 0!=e.returnValue)){a:{var g=!1;if(0==e.keyCode)try{e.keyCode=-1;break a}catch(f){g=!0}if(g||void 0==e.returnValue)e.returnValue=!0}e=[];for(g=b.a;g;g=g.parentNode)e.push(g);for(var g=a.type,h=e.length-1;0<=h;h--)b.a=e[h],d&=V(e[h],g,!0,b);for(h=0;h<e.length;h++)b.a=e[h],d&=V(e[h],g,!1,b)}return d}return W(a,
new L(c,this))}function T(a){a=a[P];return a instanceof O?a:null}var X="__closure_events_fn_"+(1E9*Math.random()>>>0);function fa(a){return"function"==p(a)?a:a[X]||(a[X]=function(c){return a.handleEvent(c)})};function Y(a){this.element=null;ol.control.ZoomSlider.call(this,a)}r(Y,ol.control.ZoomSlider);Y.prototype.a=function(){return this.element};function Z(a){a=a||{};this.A=a.className?a.className:"ol-panzoom";var c=this.j=a.imgPath?a.imgPath:null,b=[this.A,"ol-unselectable"];c||b.push("ol-control");var d=document.createElement("div");d.className=b.join(" ");c&&(d.style.left="4px",d.style.position="absolute",d.style.top="4px");ol.control.Control.call(this,{element:d,target:a.target});this.C=[];this.a=void 0!==a.duration?a.duration:100;this.b=a.maxExtent?a.maxExtent:null;this.n=a.maxZoom?a.maxZoom:19;this.o=a.minZoom?a.minZoom:0;this.D=void 0!==
a.pixelDelta?a.pixelDelta:128;this.c=void 0!==a.slider?a.slider:!1;this.t=void 0!==a.zoomDelta?a.zoomDelta:1;this.p=$(this,"pan-east");this.q=$(this,"pan-north");this.r=$(this,"pan-south");this.s=$(this,"pan-west");this.u=$(this,"zoom-in");this.v=$(this,"zoom-out");this.k=!this.c&&this.b?$(this,"zoom-max"):null;this.g=this.c?new Y:null;d.appendChild(this.q);d.appendChild(this.s);d.appendChild(this.p);d.appendChild(this.r);d.appendChild(this.u);d.appendChild(this.v);this.k&&d.appendChild(this.k);this.B=
d}r(Z,ol.control.Control);
Z.prototype.setMap=function(a){var c=this.C,b=this.g,d=this.getMap();d&&d instanceof ol.Map&&(c.forEach(ol.Observable.unByKey),c.length=0,this.g&&(this.g.setTarget(null),window.setTimeout(function(){d.removeControl(b)},0)));Z.w.setMap.call(this,a);a&&(c.push(S(this.p,"click",this.f.bind(this,"east"),!1,this)),c.push(S(this.q,"click",this.f.bind(this,"north"),!1,this)),c.push(S(this.r,"click",this.f.bind(this,"south"),!1,this)),c.push(S(this.s,"click",this.f.bind(this,"west"),!1,this)),c.push(S(this.u,
"click",this.l.bind(this,"in"),!1,this)),c.push(S(this.v,"click",this.l.bind(this,"out"),!1,this)),this.b&&!this.c&&c.push(S(this.k,"click",this.l.bind(this,"max"),!1,this)),this.c&&(b.setTarget(this.B),window.setTimeout(function(){a.addControl(b)},0),ia(this)))};
function $(a,c){var b=document.createElement("div"),d=a.j,e=a.b,g=a.c;if(d){b.style.width="18px";b.style.height="18px";b.style.position="absolute";b.style.cursor="pointer";var f=document.createElement("img");f.style.width="18px";f.style.height="18px";f.style["vertical-align"]="top";switch(c){case "pan-east":f.id="OpenLayers_Control_PanZoom_panright_innerImage";f.src=[d,"east-mini.png"].join("/");f.alt="Pan East";b.id="OpenLayers_Control_PanZoom_panright";b.style.top="22px";b.style.left="22px";break;
case "pan-north":f.id="OpenLayers_Control_PanZoom_panup_innerImage";f.src=[d,"north-mini.png"].join("/");f.alt="Pan North";b.id="OpenLayers_Control_PanZoom_panup";b.style.top="4px";b.style.left="13px";break;case "pan-south":f.id="OpenLayers_Control_PanZoom_pandown_innerImage";f.src=[d,"south-mini.png"].join("/");f.alt="Pan South";b.id="OpenLayers_Control_PanZoom_pandown";b.style.top="40px";b.style.left="13px";break;case "pan-west":f.id="OpenLayers_Control_PanZoom_panleft_innerImage";f.src=[d,"west-mini.png"].join("/");
f.alt="Pan West";b.id="OpenLayers_Control_PanZoom_panleft";b.style.top="22px";b.style.left="4px";break;case "zoom-in":f.id="OpenLayers_Control_PanZoom_zoomin_innerImage";f.src=[d,"zoom-plus-mini.png"].join("/");f.alt="Zoom In";b.id="OpenLayers_Control_PanZoom_zoomin";b.style.top="63px";b.style.left="13px";break;case "zoom-out":f.id="OpenLayers_Control_PanZoom_zoomout_innerImage";f.src=[d,"zoom-minus-mini.png"].join("/");f.alt="Zoom Out";b.id="OpenLayers_Control_PanZoom_zoomout";b.style.top=g?[11*
(a.n-a.o+1)+81,"px"].join(""):e?"99px":"81px";b.style.left="13px";break;case "zoom-max":f.id="OpenLayers_Control_PanZoom_zoomworld_innerImage",f.src=[d,"zoom-world-mini.png"].join("/"),f.alt="Zoom Max",b.id="OpenLayers_Control_PanZoom_zoomworld",b.style.top="81px",b.style.left="13px"}b.appendChild(f)}return b}
Z.prototype.f=function(a,c){var b=this.getMap(),d=b.getView(),e=d.getResolution()*this.D,g=0,f=0;"south"==a?f=-e:"west"==a?g=-e:"east"==a?g=e:f=e;e=[g,f];ol.coordinate.rotate(e,d.getRotation());if(g=d.getCenter())this.a&&0<this.a&&b.beforeRender(ol.animation.pan({source:g,duration:this.a,easing:ol.easing.linear})),b=d.constrainCenter([g[0]+e[0],g[1]+e[1]]),d.setCenter(b);c.b();return!1};
Z.prototype.l=function(a){if("in"===a)ja(this,this.t);else if("out"===a)ja(this,-this.t);else if("max"===a){var c=this.getMap();a=c.getView();var b=this.b?this.b:a.getProjection().getExtent(),c=c.getSize();a.fit(b,c)}};function ja(a,c){var b=a.getMap(),d=b.getView();if(d){var e=d.getResolution();e&&(0<a.a&&b.beforeRender(ol.animation.zoom({undefined:null,resolution:e,duration:a.a,easing:ol.easing.easeOut})),b=d.constrainResolution(e,c),d.setResolution(b))}}
function ia(a){var c=a.g,b=a.j;c&&b&&(a=[11*(a.n-a.o+1),"px"].join(""),c=c.element,c.style.background=["url(",b,"/zoombar.png)"].join(""),c.style.border="0",c.style["border-radius"]="0",c.style.height=a,c.style.left="13px",c.style.padding="0",c.style.top="81px",c.style.width="18px",c=c.children[0],c.style.background=["url(",b,"/slider.png)"].join(""),c.style.border=0,c.style.height="9px",c.style.margin="0 -1px",c.style.width="20px")};n("olpz.control.PanZoom",Z);Z.prototype.setMap=Z.prototype.setMap;n("olpz.control.ZoomSlider",Y);Y.prototype.getElement=Y.prototype.a;
  return OL3PANZOOM.olpz;
}));


/**
*
* map
*
*/

define("src/map/map", [
    'src/core/baseview',
    'src/core/basecollection',
    'src/poi/poiselector',
    'src/popup/popup',
    'src/map/marker',
    'src/directions/directions',
    'ol',
    'jquery',
    'ol3ext',
    'ol3pz'
  ],
  function(BaseView, BaseCollection, poiSelector, PopupView, MarkerView, BubbleDirectionsView, ol, $, ow, olpz) {
  var module = {}

      /*
      * Main map view
      * Listens to - {marker:add} {marker:click} {poi:click}
      * Emits - {map:move} {marker:select} {marker:unselect}
      */
      var MapView = BaseView.extend({
        initialize: function(options) {
          this.setElement(options.element)
          this.options  =  options
          this.markerView = new MarkerView()
          this.curZoomLevel = null;
          this.initMap(options)
          this.popup = new PopupView({map: this.map})
          this.addDirectionsView()
          this.registerEvents()
          this.mercatorView = null;
          this.lonLatView = null;
          this.navteqLayer = null;
          this.googleLayer = null;
          this.routeVectorLayer = null;
          this.routeMarkerLayer = null;
          this.ol = ol;
          this.ow = ow;
          this.poiSelector = poiSelector;
          this.imagePopupListenerKeys = [];

          $('#navteqfooter').hide();
        },
        /*
        * subscribe to the EA events
        */
        registerEvents: function() {
          _.bindAll(this, 'addMarkerLayer', 'move', 'showPopup', 'closePopups', 'closePopup',
                          'zoomToExtent','zoomToPOI','zoomToPOIs', 'setGMapsStyle', 'setMapCenter',
                          '_handleCursorCheck', 'handleW2GIPoiSelected', 'handleW2GIPoiUnselected',
                          '_locatorSearch');

          this.ea.bind('marker:add',    this.addMarkerLayer)
                 .bind('marker:click',  this.move)
                 .bind('marker:zoom',  this.zoomToPOI)
                 .bind('markers:zoom',  this.zoomToPOIs)
                 .bind('marker:close', this.closePopups)
                 .bind('popup:loaded',  this.showPopup)
                 .bind('map:zoomToExtent', this.zoomToExtent)
                 .bind('form:locatorsearch', this._locatorSearch)

          this.map.getView().on('change:resolution', this._handleResolutionChange, this);

          if (this.options.dynamicSearch ) {
            this.map.on('pointerdown', this._onMapMouseDown, this);
            this.map.on('pointerup', this._onMapMouseUp, this);
          }
          this.map.on('moveend', this._onZoomChange, this);
          $(document).on('w2gi:setgmapstyle', this.setGMapsStyle)
          $(document).on('w2gi:setcenter', this.setMapCenter)
          $(document).on('w2gi:poiselected', this.handleW2GIPoiSelected);
          $(document).on('w2gi:poiunselected', this.handleW2GIPoiUnselected);

          this.curZoomLevel = this.map.getView().getZoom();
        },
        initMap: function(opts) {
          var sources = this._getSources(),
              layers  = this._getLayers(sources),
              options = opts || {},
              controls = [],
              mapCenter = opts.mapCenter || [-98.5553, 39.8097]

          if (layers[0].options) {
            options = _.extend(options, layers[0].options)
          }
          options['scales'] = [50000000, 20000000, 10000000, 4000000, 1000000, 500000, 150000, 100000, 50000, 25000, 15000, 6000]

          if (options.theme != null) {
            delete options.theme
          }

          var imgPath = options.imgPath || ' /w2gi/images/zoombar_black/'
          if (options.controls) {
            controls = this.loadMapControls(options.controls, imgPath)
            options.controls = controls
          } else {
          	options.controls = []
          }

          options.controls.push(new ol.control.Attribution({
            collapsible: false
          }));

          var interactions = this.loadMapInteractions(options.interactions || []);

          /*
           */
          var viewOpts =  {
            center: ol.proj.transform(mapCenter, 'EPSG:4326', 'EPSG:3857'),
            projection: ol.proj.get('EPSG:3857'),
            zoom: options.zoom || 4
          };
          if (typeof (options.maxZoom) != 'undefined') {
                viewOpts.maxZoom = options.maxZoom;
          }
          if (typeof (options.minZoom) != 'undefined') {
                viewOpts.minZoom = options.minZoom;
          }
          this.mercatorView = new ol.View(viewOpts);

          this.view = this.mercatorView;

          // Attribution logo
          var logoElement = $('<span />', {
            'class': 'w2gi-logo'
          })[0];

          this.el.className += ' olMap';
          this.map = new ol.Map({
            controls: ol.control.defaults({
              attribution: false,
              zoom: !this.panZoom,
              zoomOptions: {
                duration: 1
              }
            }).extend(options.controls),
            interactions: interactions,
            logo: logoElement,
            target: this.el,
            layers: layers,
            view: this.view
          });


          this.map.paddingForPopups = this.getPopupBounds()

          //39.8097, -98.5553 Lebanon, KS
          this.lonLatView = new ol.View({
              center: [-98.5553, 39.8097],
              projection: ol.proj.get('EPSG:4326'),
              resolutions: [
                  0.15873908440210452,
                  0.06349563376084183,
                  0.031747816880420915,
                  0.012699126752168366,
                  0.0031747816880420914,
                  0.0015873908440210457,
                  0.0004762172532063137,
                  0.00031747816880420905,
                  0.00015873908440210453,
                  0.00007936954220105226,
                  0.000047621725320631366,
                  0.000019048690128252544
              ],
              zoom: options.zoom || 4
          });

          if (ow.strategy && ow.strategy.LayerExclusivity) {
            new ow.strategy.LayerExclusivity({
              map: this.map,
              value: 'layer',
              property: 'group'
            });
          }

          if (this.requireGoogleMaps) {
            require(['ol3gm'], function(olgm) {
              setTimeout((function() {
                this.olgm = new olgm.OLGoogleMaps({
                  map: this.map,
                  watchVector: false
                });
                this.olgm.activate();
                setTimeout((function() {
                  if (!this.olgm.getGoogleMapsActive()) {
                    this.olgm.activate()
                    this.map.render()
                  }
                }).bind(this), 1000);
              }).bind(this), 0);
            }.bind(this));
          }

          document.body.className += 'w2gi-backbone';
        },
        _locatorSearch: function() {
          if (this.options.getlistLocator) { delete this.options.getlistLocator }
        },

        getPopupBounds: function() {
          var template = $('script#' + 'bubble')
          marginLeft= template.data('marginleft') || 50,
          marginBottom = template.data('marginbottom') || 50,
          marginRight = template.data('marginright') || 50,
          marginTop = template.data('margintop') || 50
          return [marginLeft, marginTop, marginRight, marginBottom];
        },
        loadMapControls: function(controls, imgPath) {
          var olControls = []
          var self = this
          var duration = 1;
          this.panZoom = false;
          _.each(controls, function(control) {
            switch (control.name) {
              case 'panZoomBar':
                this.panZoom = true;
                olControls.push(new olpz.control.PanZoom({
                  duration: duration,
                  imgPath: imgPath,
                  minZoom: 0,
                  maxZoom: 13,
                  slider: true
                }));
                break;
              case 'panZoom':
                this.panZoom = true;
                olControls.push(new olpz.control.PanZoom({
                  duration: duration,
                  imgPath: imgPath
                }));
                break;
              case 'layerSwitcher':
                //self.initLayerSwitcher(control.options)
                this.panZoom = true;
                olControls.push(new olpz.control.PanZoom({
                  duration: duration,
                  imgPath: imgPath,
                  minZoom: 0,
                  maxZoom: 13,
                  slider: true
                }));
                // FIXME
                olControls.push(new ow.control.LayerSwitcher());
                // olControls.push(new OpenLayers.Control.LayerSwitcher(control.options))
                break;
              default:
                break;
            }
          }, this)
          return olControls
        },
        loadMapInteractions: function(interactions) {
          var olInteractions = [];
          var extraInteractions = [new ol.interaction.Pointer({
            'handleMoveEvent': this._handleCursorCheck
          })];
          var self = this;
          var defaultsOptions = {
            altShiftDragRotate: false,
            dragPan: true,
            shiftDragZoom: true,
            zoomDuration: 1,
            pinchRotate: false
          };
          _.each(interactions, function(interaction) {
            switch(interaction.name) {
              case 'defaults':
                defaultsOptions = _.extend(defaultsOptions, interaction.options);
                break;
            }
          });
          if (defaultsOptions.shiftDragZoom) {
            defaultsOptions.shiftDragZoom = false;
            extraInteractions.unshift(new ol.interaction.DragZoom({
              duration: 1
            }));
          }
          olInteractions = ol.interaction.defaults(defaultsOptions);
          olInteractions.extend(extraInteractions);

          return olInteractions;
        },
        initLayerSwitcher: function(options) {
          var self = this

          require(['googlemaps'], function(){
            // FIXME
            //self.map.addControl(new OpenLayers.Control.LayerSwitcher(control.options))
          })
        },
        _getSources: function() {
          return this.options.sources
        },
        _getLayers: function(sources) {
          // (A) reorder the sources to respect the following order of priority:
          //    1 ) OSM
          //    2 ) Google
          //    3 ) Navteq
          //    4 ) Everything else
          var osmSources = [];
          var googleSources = [];
          var navteqSources = [];
          var otherSources = [];
          var bingSources = [];
          sources.forEach(function(source) {
            switch(source.name) {
              case 'SlippyMap Navteq':
                navteqSources.push(source);
                break;
              case 'Google Satellite':
              case 'Google Normal':
              case 'Google Hybrid':
              case 'Google Streets':
                googleSources.push(source);
                break;
              case 'SlippyMap W2GI':
              case 'OpenStreetMap TMS':
                osmSources.push(source);
                break;
              case 'Bing':
                bingSources.push(source)
                break;
              default:
                otherSources.push(source);
                break;
            }
          }, this);


          /*var sortedSources = [].concat(
              osmSources,
              googleSources,
              navteqSources,
              otherSources
              );*/
          var sortedSources;
          if (bingSources.length >= 0) {
            sortedSources = [].concat(
              bingSources,
              osmSources,
              googleSources,
              navteqSources,
              otherSources
            );
          } else {
            sortedSources = [].concat(
              osmSources,
              googleSources,
              navteqSources,
              otherSources
            );
          }

          this.requireGoogleMaps = false;
          var layers = _(sortedSources).map(function(source) {
            var url         = null,
                options     = {},
                sourceOptions = source.options,
                layerOptions  = _.extend(options, sourceOptions)

            switch(source.name) {
              case 'SlippyMap Navteq':
                options = { g: '__base__',
                    i: 'PNG8',
                    appkey       : W2GI.config.appkey,
                    units        : 'degrees',
                    sphericalMercator: false,
                    maxResolution : 1.40625
                  };
                layerOptions = _.extend(layerOptions, options);
                var urls = source.imageurl.replace(/ /g, '').split(',') //$w(source.IMAGEURL.gsub(',', ' '));

                var tileGrid = new ol.tilegrid.TileGrid({
                  extent: [-165, 15, -50, 75],
                  origin: [0, 0],
                  resolutions: [
                          0.15873908440210452,
                          0.06349563376084183,
                          0.031747816880420915,
                          0.012699126752168366,
                          0.0031747816880420914,
                          0.0015873908440210457,
                          0.0004762172532063137,
                          0.00031747816880420905,
                          0.00015873908440210453,
                          0.00007936954220105226,
                          0.000047621725320631366,
                          0.000019048690128252544
                         ]
                });

                var tileUrlFunction = (function(urls, tileGrid, tileCoord) {

                  var view = this.map.getView();
                  var units = view.getProjection().getUnits();
                  var resolution = view.getResolution();

                  // (1) Pick a base url
                  //     FIXME - support multiple urls properly
                  var baseUrl = urls[Math.floor(Math.random() * urls.length)];

                  // (2) Base parameters (that are common to all queries)
                  // The 'map' property comes from layer options
                  var params = _.extend(layerOptions, {
                    appkey: W2GI.config.appkey,
                    g: '__base__',
                    i: 'PNG8',
                    projection: 'EPSG:4326'
                  });

                  // (3) left, top, scale
                  var tileExtent = tileGrid.getTileCoordExtent(tileCoord);
                  var left = Math.round(tileExtent[0] / resolution / 256) * 256;
                  var top = Math.round(-(tileExtent[3] / resolution / 256)) * 256;
                  var scale = Math.round(ace.util.getScaleFromResolution(
                      resolution, units) * 10000) / 10000;
                  params['l'] = left;
                  params['t'] = top;
                  params['s'] = scale

                  // for DEV purpose
                  /*
                  console.log([
                    'left: ',
                    tileExtent[0] / resolution / 256
                  ].join(' '));
                  console.log(tileCoord);
                  console.log(tileExtent);
                  console.log(resolution);
                  console.log(scale);
                  */

                  // (4) build url string
                  var paramStrings = [];
                  for (var key in params) {
                    paramStrings.push([
                      key,
                      params[key]
                    ].join('='));
                  }
                  var url = [
                    baseUrl,
                    paramStrings.join('&')
                  ].join('?');

                  // for DEV purpose
                  //console.log(url);

                  return url;
                }).bind(this, urls, tileGrid);

                var navteqAttributions = [
                  new ol.Attribution({
                    html: [
                      '&copy; ',
                      '',
                      (new Date()).getFullYear(),
                      ' NAVTEQ Corp.'
                    ].join('')
                  })
                ];

                layer = new ol.layer.Tile({
                  source: new ol.source.XYZ({
                    attributions: navteqAttributions,
                    projection: 'EPSG:4326',
                    tileUrlFunction: tileUrlFunction,
                    tileGrid: tileGrid
                  }),
                  visible: false
                });

                this.navteqLayer = layer;
                this.navteqLayer.on('change:visible',
                                    function(visible) {
                                      if (visible) {
                                        $('#navteqfooter').show();
                                      } else {
                                        $('#navteqfooter').hide();
                                      }
                                    });

                return layer;

              case 'OpenLayers WMS':
                url = source.imageurl.replace(/ /g, '').split(',') // $w(source.IMAGEURL.gsub(',', ' '));
                var layersParam = layerOptions.layers;
                var serverType = layerOptions.serverType || 'mapserver';

                if (!url || !layersParam) {
                  var wmsMsg = [
                    'The WMS layer configuration is invalid.',
                    'Please, edit the template file.'
                  ].join(' ');
                  ace.util.alert(wmsMsg);
                  return;
                }

                layer = new ol.layer.Image({
                  source: new ol.source.ImageWMS({
                    url: url,
                    params: {'LAYERS': layersParam},
                    serverType: serverType
                  })
                });

                return layer;

              case 'Google Satellite':
              case 'Google Normal':
              case 'Google Hybrid':
              case 'Google Streets': //normal road map w/ Google maps v3
                this.requireGoogleMaps = true;

                require(['ol3gm', 'googlemaps'], function(olgm, gmaps) {
                  var mapTypeId = {
                    'Google Satellite': gmaps.MapTypeId.SATELLITE,
                    'Google Normal': gmaps.MapTypeId.ROADMAP,
                    'Google Hybrid': gmaps.MapTypeId.HYBRID,
                    'Google Streets': gmaps.MapTypeId.ROADMAP
                  };

                  var mapName = {
                    'Google Satellite': 'Satellite',
                    'Google Normal': 'Map',
                    'Google Hybrid': 'Hybrid',
                    'Google Streets': 'Map'
                  };

                  var googleOptions = {
                    name: mapName[source.name],
                    group: 'layer',
                    mapTypeId: mapTypeId[source.name],
                    visible: false,
                    displayInLayerSwitcher: true
                  };

                  if (layerOptions.styles) {
                    googleOptions['styles'] = layerOptions.styles;
                  }

                  layer = new olgm.layer.Google(googleOptions);

                  this.mainLayer = this.googleLayer = layer;
                  if(this.directions) {
                  	this.directions.mainLayer = this.directions.googleLayer = this.googleLayer;
                  }

                  var mapLayers = this.map.getLayers();
                  for (var i = 0, ii = mapLayers.getLength(); i < ii; ++i) {
                    var mapLayer = mapLayers.item(i);
                    if (mapLayer.get('name') === source.name) {
                      mapLayers.removeAt(i);
                      mapLayers.insertAt(i, layer);
                      layer.setVisible(mapLayer.getVisible());
                      break;
                    }
                  }
                }.bind(this));

                return new ol.layer.Group({name: source.name});
              case 'Yahoo Regular':
              case 'Yahoo Satellite':
              case 'Yahoo Hybrid':
                var yahooMsg = [
                  'Yahoo maps are no longer supported.',
                  'Please, choose a different map provider.'
                ].join(' ');
                ace.util.alert(yahooMsg);
                // return a dummmy layer to avoid JavaScript error
                layer = new ol.layer.Group({
                  name: source.NAME
                });
                return layer;

              case 'Virtual Earth Aerial':
              case 'Virtual Earth Road':
              case 'Virtual Earth Hybrid':
                // Return a dummy layer
                layer = new ol.layer.Group({
                  name: source.NAME
                });
                return layer;

              case 'SlippyMap W2GI':
              case 'OpenStreetMap TMS':
                var layerName;
                if(layerOptions.map) {
                  layerName = layerOptions.map;
                  delete layerOptions['map'];
                }

                // build urls
                var urls = source.imageurl.replace(/ /g, '').split(',') //$w(source.IMAGEURL.gsub(',', ' '));
                var serviceVersion = '1.0.0';
                var imageType = 'png';
                for (var i = 0, len = urls.length; i < len; i++) {
                  if (urls[i].indexOf('/', urls[i].length - 1) === -1) {
                    urls[i] += '/';
                  }
                  urls[i] = [
                    urls[i],
                    serviceVersion,
                    '/',
                    layerName,
                    '/{z}/{x}/{y}.',
                    imageType
                  ].join('');
                }

                var tileUrlFunction = (function(urls, tileCoord) {
                  // FIXME - support multiple urls
                  var url = urls[Math.floor(Math.random() * urls.length)];
                  return url
                    .replace('{z}', (tileCoord[0]+1).toString())
                    .replace('{x}', tileCoord[1].toString())
                    .replace('{y}', (tileCoord[2]).toString());
                }).bind(this, urls);

                var attributions = [
                  new ol.Attribution({
                    html: [
                      '&copy; ',
                      '<a target="_blank" '+
                      'href="http://www.openstreetmap.org/copyright">',
                      'OpenStreetMap</a> contributors.'
                    ].join('')
                  })
                ];

                layer = new ol.layer.Tile({
                  displayInLayerSwitcher: true,
                  name: source.name.split(' ')[0],
                  group: 'layer',
                  source: new ol.source.XYZ({
                    attributions: attributions,
                    tileUrlFunction: tileUrlFunction,
                    urls: urls,
                    projection: 'EPSG:900913',
                    tileGrid: new ol.tilegrid.TileGrid({
                      extent: [
                        -20000000.000000,
                        -20000000.000000,
                        20000000.000000,
                        20000000.000000
                      ],
                      origin: [-20000000.000000, -20000000.000000],
                      resolutions: [
                        39135.75848201022745342925,
                        19567.87924100512100267224,
                        9783.93962050256050133612,
                        4891.96981025128025066806,
                        2445.98490512564012533403,
                        1222.99245256282006266702,
                        611.49622628141003133351,
                        305.74811314070478829308,
                        152.87405657035250783338,
                        76.43702828517623970583,
                        38.21851414258812695834,
                        19.10925707129405992646,
                        9.55462853564703173959,
                        4.77731426782351586979,
                        2.38865713391175793490
                      ]
                    })
                  })
                });

                return layer;

              case 'OpenStreetMap XYZ':
                url = source.imageurl.replace(/ /g, '').split(',') //$w(source.IMAGEURL.gsub(',', ' '));
                for(var i=0; i<url.length; i++) {
                  url[i] += layerOptions.layername+'/${z}/${x}/${y}.png';
                }
                layerOptions.map = null;
                return new ol.layer.Tile({
                  source: new ol.source.OSM()
                });

              case 'Bing':
                layer = new ol.layer.Tile({
                          visible: false,
                          preload: Infinity,
                          name: source.name,
                          source: new ol.source.BingMaps(layerOptions)
                      });
                return  layer

              default:
                throw new Error(source.name + ' - missing handler in Smap.js: _getLayers()');
            }
          }, this);

          if(layers instanceof Array && layers.length > 0) {
            this.mainLayer = layers[0];
            layers[0].setVisible(true);
            for(var i=1; i<layers.length; i++) {
              layers[i].setVisible(false);
            }
          }

          return layers;
        },
        _onZoomChange: function(evt) {
            try {
                var newZoomLevel = this.map.getView().getZoom();
                if (this.curZoomLevel == null) {
                     this.curZoomLevel = newZoomLevel;
                     return;
                }
                var zoomDiff = Math.abs(parseInt(this.curZoomLevel - newZoomLevel));
                if (zoomDiff >= 3) {
                     this.curZoomLevel = newZoomLevel;
                     return;
                }
                if (newZoomLevel > this.curZoomLevel) {
                   $(document).trigger("w2gi:mapzoomin", { 'zoomlevel' : newZoomLevel });
                } else if (newZoomLevel < this.curZoomLevel) {
                   $(document).trigger("w2gi:mapzoomout", { 'zoomlevel' : newZoomLevel });
                }
                this.curZoomLevel = newZoomLevel;
            } catch (e) {}
        },
        _onMapMouseDown: function(evt) {
          if (!this.searchRadius) {
            this.searchRadius = this._getSearchRadius(this.options.form)
          }
          if (!this.dragStartCenter) {
            var mapCenter = this.map.center ? this.map.center : this.map.getView ().getCenter();
            var lonlat = ol.proj.transform(mapCenter, this.map.getView().getProjection(), 'EPSG:4326')
            this.isDragged = false
            this.dragStartCenter = lonlat
           }
           return true;
        },
        _onMapMouseUp: function(evt) {
          if ((this.routeLayer && this.routeLayer.layer.getSource().getFeatures().length > 0) ||
              this.directionsDisplayed) {
            return;
          }

          if (this.options.dynamicSearch && this.options.getlistLocator) {
            return
          }

          if (!this.dragStartCenter) { return }

          var mapCenter = this.map.center ? this.map.center : this.map.getView ().getCenter();
          var lonlat = ol.proj.transform(mapCenter, this.map.getView().getProjection(), 'EPSG:4326')
          var degrees = Math.max(Math.abs(lonlat[0] - this.dragStartCenter[0]), Math.abs(lonlat[1] - this.dragStartCenter[1]));
          var dragLen = (degrees*69.04);
          var searchCheck = this._mapBoundsRadius() / 10;
          if (dragLen > searchCheck) {
            var _lonlat = {latitude: lonlat[1], longitude: lonlat[0]}
            this.isDragged = true
            this.ea.trigger('locator:searchlonlat', _lonlat, { searchradius: this.searchRadius, alertError: false })
            //this.searchLonLat(lonlat, {onError: this.locator.clearLocator.bind(this.locator), alertError : false });
            this.dragStartCenter = null;
          }
        },
        _handleCursorCheck: function(evt) {
          var map = evt.map;
          var feature = map.forEachFeatureAtPixel(evt.pixel,
            function(feature, layer) {
              return feature;
            }, this);
          var element = map.getTargetElement();
          if (feature) {
            if (element.style.cursor != 'pointer') {
              this.previousCursor_ = element.style.cursor;
              element.style.cursor = 'pointer';
            }
          } else if (this.previousCursor_ !== undefined) {
            element.style.cursor = this.previousCursor_;
            this.previousCursor_ = undefined;
          }

        },
        _handleResolutionChange: function() {
          this.map.once('moveend', this._onMapZoomEnd, this);
        },
        _onMapZoomEnd: function(opts) {
          setTimeout((function() {this._popupPanIntoView();}).bind(this), 0);
        },
        _popupPanIntoView : function() {
          if (this.imagePopup && this.imagePopup.getMap()) {
            var mapRect = this.map.getViewport().getBoundingClientRect();
            var popupRect = this.imagePopup.getElement().getBoundingClientRect();
            var padding = this.map.paddingForPopups;

            var rightDx = Math.min(mapRect.right - padding[2] - popupRect.right, 0);
            var newLeft = Math.max(popupRect.left + rightDx, mapRect.left + padding[0])
            var dx = newLeft - popupRect.left;

            var botDy = Math.min(mapRect.bottom - padding[3] - popupRect.bottom, 0);
            var newTop = Math.max(popupRect.top + botDy, mapRect.top + padding[1]);
            var dy = newTop - popupRect.top;

            var centerPx = this.map.getPixelFromCoordinate(this.view.getCenter());
            centerPx = [centerPx[0] - dx, centerPx[1] - dy];
            var pan = ol.animation.pan({
              duration: 100,
              source: /** @type {ol.Coordinate} */ (this.view.getCenter())
            });
            this.map.beforeRender(pan);
            this.view.setCenter(this.map.getCoordinateFromPixel(centerPx));

          }
        },
        setGMapsStyle: function(event, options) {
          var olGmap = this.map.layers[0]
          if (olGmap && olGmap.mapObject && olGmap.mapObject.setOptions) {
            olGmap.mapObject.setOptions(options)
          }
        },
        _mapBoundsRadius: function() {
          var extent = this.map.getView().calculateExtent(this.map.getSize())
          var rad;
          if (extent) {
            extent = ol.proj.transformExtent(extent, this.map.getView().getProjection(), 'EPSG:4326');
            var degrees = Math.max(Math.abs(extent[1] - extent[3]), Math.abs(extent[0] - extent[2]));
            rad = '' + ((degrees*69.04)/2);
          } else {
            rad = this.searchRadius.replace(/\|.*/, '');  // fallback to first item in serachRadius option
          }
          return '' + rad;
        },

        /**
         * @method
         * @param {DOMElement} form
         * @return {String} search radius
         */
        _getSearchRadius: function(form) {
          if (form.searchradius && this.searchRadius) return form.searchradius.value

          var value = this.options.formdata.searchradius
          if (value) return value;

          var bounds = this.map.getView().calculateExtent(this.map.getSize());
          if (!bounds) return null;
          ol.proj.transformExtent(this.map.getView().getProjection(), 'EPSG:4326');

          var degrees = Math.min(Math.abs(bounds[3] - bounds[1]), Math.abs(bounds[2] - bounds[0]));
          return '' + ((degrees*69.04)/2);
        },
        addDirectionsView: function() {
          if (!this.directions) {
            this.options.directionsFormdata.clientSideDirections = this.clientSideDirections
            this.directions = new BubbleDirectionsView(this.options.directionsFormdata)
            this.directions.smap = this.map;
            this.directions.latLonView = this.lonLatView;
            this.directions.mercatorView = this.mercatorView;
            this.directions.mainLayer = this.mainLayer;
            this.directions.googleLayer = this.googleLayer;
            this.directions.navteqLayer = this.navteqLayer;
            this.directions.routeLayer = this.routeLayer;
            this.directions.routeMarkerLayer = this.routeMarkerLayer;
            this.directions.setElement($('.dd-wrapper'))
          }
        },
        setMapCenter: function(event,obj) {
        	if(obj && obj['latitude'] != '' && obj['longitude'] != '' && obj['zoom'] != null){
	            var lonlat = ol.proj.transform([ obj['longitude'], obj['latitude']], 'EPSG:4326', 'EPSG:3857');
				var view = this.map.getView();
				view.setCenter(lonlat);
				view.setZoom(obj['zoom']);
			}
        },
        showPopup: function(popup, feature) {
          this.closePopups()
          this.imagePopup = new ow.popup.Image(popup.options)
          // When popup is closed, unselect what's selected in the poiSelector
          this.imagePopupListenerKeys.push(
            this.imagePopup.on(
              ow.popup.ImageEventType.POPUP_CLOSED,
              function() {
                this.imagePopup = null;
                this.poiSelector.unselect();
              },
              this
            )
          );
          this.imagePopup.show(this.map, popup.coordinates, popup.content)
          //this.map.paddingForPopups = popup.data.bubbleMargin
          if (!this.directions) {
             this.options.directionsFormdata.clientSideDirections = this.clientSideDirections
             this.directions = new BubbleDirectionsView(this.options.directionsFormdata)
             // first time only
             this.directions.popupLoaded(popup, feature)
             this.directions.smap = this.map
          }
          //this.directions.featureuid = popup.featureuid
          this.popup.setElement('.w2gi-popup')
          this.directions.setElement($('.dd-wrapper'))
          this._popupPanIntoView()
          //this.map.adjustForBubble(popup.data.marker, popup.data.popupSize, popup.data.bubbleMargin, popup.data.bubbleOffset, popup);
          this.dragStartCenter = null;
          this.ea.trigger('add:autocomplete');
          ace.util.changeCountryDropDownLocale();

        },
        clearMarkers: function() {
          if (this.markerLayer) {
            this.poiSelector.unselect();
            this.markerLayer.getSource().clear();
          }
        },
        closePopups: function() {
          this.imagePopupListenerKeys.forEach(ol.Observable.unByKey);
          this.imagePopupListenerKeys.length = 0;
          var self = this
          this.map.getOverlays().forEach (function(e) {
            self.closePopup(e)
          })
        },
        closePopup: function(popup) {
          if (!_.isEmpty(this.map.getOverlays())) {
            this.map.removeOverlay(popup)
            $(document).trigger('w2gi:popupclose', {data: popup})
          }
        },
        move: function(lonlat, model) {
          //this.map.panTo(lonlat)
          this.ea.trigger('map:move', this.map.getView().calculateExtent(this.map.getSize()))
          $(document).trigger('w2gi:track', {
            action : 'mappan',
            value : lonlat.join(', ')
          })
        },
        handleW2GIPoiSelected: function(event, record) {
          var feature = this.findFeature(record.uid);
          if (feature) {
            event.preventDefault()
            event.stopPropagation()
            this.ea.trigger('marker:select', feature);
          }
        },
        handleW2GIPoiUnselected: function(event, record) {
          var feature = this.findFeature(record.uid);
          if (feature) {
            this.ea.trigger('marker:unselect', feature);
            this.closePopups();
          }
        },
        findFeature: function(uid) {
          var feature = null;
          var features = this.markerLayer.getSource().getFeatures();
          for (var i = 0, len = features.length; i < len; i++) {
            if (features[i].uid === uid) {
              feature = features[i];
              break;
            }
          }
          return feature;
        },
        addMarkerLayer: function(layer, centerMarkerLayer) {
          var self = this, selectLayers = [layer];
          if (!this.markerLayer) {
            this.markerLayer = layer
            this.map.addLayer(this.markerLayer)

            this.map.on('singleclick', function(event) {
              var feature = this.map.forEachFeatureAtPixel(
                event.pixel,
                function(feature, layer) {
                  return feature;
                },
                this,
                function(layer) {
                  return layer === this.markerLayer;
                },
                this
              );

              // Let the poiSelector decide what to do with the selection of
              // the feature (if any). Any of the following 2 methods are valid,
              // the first being a direct call to the poiSelector, the second
              // using the event. The later can even be used from custom code.
              if (feature) {
                // both do the same thing
                this.poiSelector.select(feature.uid);
                //$(document).trigger('w2gi:selectpoi', feature.uid);
              } else {
                // both do the same thing
                this.poiSelector.unselect();
                //$(document).trigger('w2gi:unselectpoi');
              }

            }, this);
          this.map.on('dblclick', function(event) {
            var feature = this.map.forEachFeatureAtPixel(
                event.pixel,
                function(feature, layer) {
                  return feature;
                },
                this,
                function(layer) {
                  return layer === this.markerLayer;
                },
                this
              );

            if (feature) {
              event.preventDefault()
              this.poiSelector.select(feature.uid);
            }
          }, this)
          }

          if (centerMarkerLayer) {
            var endDrag = function(evt) {
              var lonlat = evt.detail.coordinate, _lonlat
              self.map.getView().setCenter(lonlat);
              _lonlat = ol.proj.transform(lonlat, 'EPSG:3857', 'EPSG:4326')
              //_lonlat = {latitude: lonlat.lat, longitude: lonlat.lon}
              self.ea.trigger('locator:searchlonlat', {latitude: _lonlat[1], longitude: _lonlat[0]}, { searchradius: self.searchRadius || null, alertError: false })
              self.move(lonlat)
            }


            if (!this.centerMarkerLayer) {
              this.centerMarkerLayer = centerMarkerLayer;
              var drag = new ow.interaction.DragFeature({
                layers: [this.centerMarkerLayer]
              });
              drag.customEvents.addEventListener(
                  ow.interaction.DragFeatureCustomEventType.DRAG_END,
                  endDrag);
              this.map.addInteraction(drag);

              this.map.addLayer(this.centerMarkerLayer);
            }
            //selectLayers.unshift(centerMarkerLayer);
          }
          //if (!this.options.noZoomOnPan || typeof this.isDragged != 'undefined' && this.isDragged == true) {
          if (!this.options.noZoomOnPan || !this.isDragged) {
            this.zoomToExtent(this.markerLayer.poiBounds);
          }
          this.isDragged = false

          /*
          if (!this.options.noZoomOnPan && !this.isDragged) {
            this.map.zoomToExtent(this.markerLayer.poiBounds)
          } else if (!this.isDragged) {
            this.map.setCenter(this.markerLayer.poiBounds.getCenterLonLat())
          }*/

        },
        addRouteLayer: function() {

        },
        zoomToExtent: function(bounds) {
          this.map.getView().fit(this.padBounds(bounds), this.map.getSize())
        },
        transformLonLatCoordinate: function(coordinate) {
		    var outProjection = this.map.getView().getProjection().getCode();
		    if (outProjection != 'EPSG:4326') {
		      coordinate = this.ol.proj.transform(coordinate, outProjection, 'EPSG:4326');
		    }
		    return coordinate;
		},
        zoomToPOI: function(poi) {
        	console.log("zoomToPOI");
		    var bounds = this.markerView.getPOIBounds(poi);
		    //var lonlat = this.markerView.getcenterPoint();
		    this.zoomToExtent(bounds);
		    return bounds;

		},
		zoomToPOIs: function(pois,excludeCenterMarker) {
			console.log("zoomToPOIS")

		    if (!pois.length) {
		      return;
		    }

			var bounds = this.markerView.getPOIBounds(pois)
			var centerpoint;

			//var locatorType = this.locator.proximitySearch || this.locator.productSearch || null;

			if (true/*locatorType && locatorType.centerPoint*/) {
				centerpoint =  this.markerView.getcenterPoint();
	      		var mapProj = this.map.getView().getProjection().getCode();

				if (mapProj == "EPSG:900913" || mapProj == "EPSG:3857") {
					var projCode, x, y, zoom;

					x = centerpoint[0];
					y = centerpoint[1];

					projCode = ((x >= -180 && x <= 180) && (y >= -90 && y <= 90) ) ? "EPSG:4326" : "EPSG:900913";

					if (projCode == 'EPSG:4326') {
	          			centerpoint = this.ol.proj.transform(centerpoint, 'EPSG:4326', 'EPSG:3857');
					}
				}
			} else {
				centerpoint = this.ol.extent.getCenter(bounds);
			}

		    if (!excludeCenterMarker) {
		      this.ow.extent.extendCoordinate(bounds, centerpoint);
		    }
			bounds = this.padBounds(bounds);

			this.zoomToExtent(bounds);
			return bounds;

		},
        padBounds: function(bounds) {
          var padding = this.locator && this.locator.padBounds,
              margin
          if ((typeof padding != 'undefined') || padding != null) {
            margin = padding
          }
          else {
            margin = 0.0125;
          }

          if (this.map.getView().getProjection().getCode() == "EPSG:3857") {
              margin = 1291.49
          }

          return ol.extent.buffer(bounds, margin);
        }
      })
      module.init = function(options) {
        return new MapView(options)
      }

      /*
        IE 8 polyfill for Function.bind() from MDN
      */
      if (!Function.prototype.bind) {
        Function.prototype.bind = function (oThis) {
          if (typeof this !== "function") {
            // closest thing possible to the ECMAScript 5 internal IsCallable function
            throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable")
          }

          var aArgs = Array.prototype.slice.call(arguments, 1),
              fToBind = this,
              fNOP = function () {},
              fBound = function () {
                return fToBind.apply(this instanceof fNOP && oThis? this : oThis,
                                     aArgs.concat(Array.prototype.slice.call(arguments)))
              };

          fNOP.prototype = this.prototype
          fBound.prototype = new fNOP()

          return fBound
        }
      }

      return module
  }
)
;
/**
*
* Locator
*
* Listens to - {collection:multiple}
*/

define("src/locator/module",[
    'src/util/table',
    'src/util/locale',
    'src/multipleaddress/multiple',
    'src/form/form',
    'src/core/baseview',
    'src/poi/poi',
    'src/layer/route-vector',
    'src/layer/marker',
    'src/tracker/tracker',
    'src/dialog/dialog',
    'src/map/map',
    'jquery'
  ],
  function(table, locale, MultipleAddressView, FormView, BaseView,  PoiView, RouteVectorLayer, RouteMarkerLayer, Tracker, Dialog, MapView, $) {
      var module = {}

      Handlebars.registerHelper('incIndex', function(index) {
        return index + 1
      });

      Handlebars.registerHelper('url_fmt', function(val) {
        if(typeof val === 'string' && !val.match(/^\s*$/)) {
          if(!val.match(/^([a-zA-Z]{3,7}:)/i)) {
            return "http://" + val;
          }
        }
        return val;
      });
      Handlebars.registerHelper('surl_fmt', function(val) {
        if(typeof val === 'string' && !val.match(/^\s*$/)) {
          if(!val.match(/^([a-zA-Z]{3,7}:)/i)) {
            return "https://" + val;
          }
        }
        return val;
      });
      Handlebars.registerHelper('ftp_fmt', function(val) {
        if(typeof val === 'string' && !val.match(/^\s*$/)) {
          if(!val.match(/^([a-zA-Z]{3,7}:)/i)) {
            return "fttp://" + val;
          }
        }
        return val;
      });
      Handlebars.registerHelper('sftp_fmt', function(val) {
        if(typeof val === 'string' && !val.match(/^\s*$/)) {
          if(!val.match(/^([a-zA-Z]{3,7}:)/i)) {
            return "sfttp://" + val;
          }
        }
        return val;
      });
      /*
       * {{#if (eif 1 'eq' 1)}}{{/if}}
       * {{#if (eif 1 'ne' 2)}}{{/if}}
       * {{#if (eif 1 'lt' 3)}}{{/if}}
       * {{#if (eif 4 'gt' 1)}}{{/if}}
       * {{#if (eif 1 'le' 2)}}{{/if}}
       * {{#if (eif 5 'ge' 1)}}{{/if}}
       * {{#if (eif (eif 5 'ge' 1) 'and' (eif 1 'le' 2))}}{{/if}}
       * {{#if (eif (eif 1 'le' 2) 'or' (eif 1 'eq' 1))}}{{/if}}
       */
      (function() {
			function getArgs(args) {
				var opts = args.splice(args.length-1,1)[0];
				var ids = (opts.ids || []);
				args.forEach(function(v,i) {
					if(typeof v === 'undefined' && ids[i] == null) {
						args[i] = ids[i];
					}
				});
				return args;
			}
			Handlebars.registerHelper("eif", function() {
				var args = Array.from ? getArgs(Array.from(arguments)) : getArgs(Array.prototype.slice.call(arguments));
				if(args.length === 1) {
					return !!args[0];
				}
				if(args.length === 3) {
					switch(args[1]) {
						case "eq":
						return args[0] == args[2];
						case "ne":
						return args[0] != args[2];
						case "lt":
						return args[0] < args[2];
						case "gt":
						return args[0] > args[2];
						case "le":
						return args[0] <= args[2];
						case "ge":
						return args[0] >= args[2];
						case "and":
						return args[0] && args[2];
						case "or":
						return args[0] || args[2];
					}
				}
				throw "invalid input to eif";
			});
	   })();

	  (function(){
	  	$('div.templates script').each(function(index,element){
	  		Handlebars.registerPartial(element.id, $('script#' + element.id).html())
	  	})
	  })();

      var LocatorView = BaseView.extend({
         loadGoogleLibrary: function(options) {
            var self = this

              var self = this, url = ''
              if(/^https/.test(window.location.protocol)) {
                  url = 'https://maps-api-ssl.google.com'
              } else {
                  url = 'http://maps.googleapis.com'
              }
              //url += '/maps/api/js?v=3&sensor=false&callback=ace.geo._googleloaded&client=gme-where2getit';
              //url += '/maps/api/js?v=3.20&sensor=false&client=gme-where2getit';
			  //url += '&libraries=places';

              require(['googlemaps'], function(){
               console.log('loaded google maps')
               self.loadLocator(options)
              })


         },
         loadLocator: function(options) {
            var collection_poi = W2GI.collection && W2GI.collection.poi
            $(document).trigger("w2gi:locatorload", { 'options' : this.options });
            this.setElement(options.element)
            this.searchFormID = options.searchFormID || 'locator_search'
            this.template = this.loadTemplate('locator_addressline')
            ace.util._addAjaxActivityIndicator(this.$el.find('.map'))
            this.dynamicSearch = true
            this.options  =  options
            if (this.options.clientCookie) {
              this.clientCookie = this.options.clientCookie
            }
            this.loadLocationCookie()
            ace.locale.loadLocale(this.options.locatorlocale)
            this.tracker = new Tracker({ anchors: options.pageObserve })

            this.mapView  = MapView.init({  element: this.$el.find('.map'),
                                            sources: options.sources,
                                            directionsFormdata: options.drivingdirections,
                                            routeStyle: options.routeStyle,
                                            noZoomOnPan: options.noZoomOnPan,
                                            dynamicSearch: options.dynamicSearch,
                                            /*getlistLocator: options.locatorTypeId,*/
                                            eventListeners: options.eventListeners,
                                            form: options.element,
                                            formdata: options.formdata,
                                            controls: options.controls,
                                            interactions: options.interactions,
                                            imgPath:  options.imgPath,
                                            zoom: options.zoom,
                                            minZoom: options.minZoom,
                                            maxZoom: options.maxZoom,
                                            theme: options.theme,
                                            mapCenter: options.center  });
            this.initRouteLayer();

            this.routeMarkerLayer = RouteMarkerLayer.init({map: this.mapView.map, name: 'Route markers', disableDynamicRoutes: options.disableDynamicRoutes });
            this.mapView.routeMarkerLayer = this.routeMarkerLayer;
            this.mapView.directions.routeMarkerLayer = this.routeMarkerLayer;
            this.registerEvents();
            this.poiView  = PoiView.init({  element: this.$el.find('.poi')  })
            this.formView = FormView.init({ element: options.element,
                                          directionsFormdata: options.drivingdirections,
                                          formdata: options.formdata,
                                          searchFormID: options.searchFormID,
                                          cgeo: options.cgeo,
                                          cdirections: options.cdirections,
                                          geoip: this.options.formdata.geoip,
                                          collection_poi: collection_poi,
                                          alertError: this.options.alertError,
                                          errLang: this.options.errLang,
                                          allOptions: options,
                                        })

            this.dialog = new Dialog({alertError: this.options.alertError})

            if(this.searchFormID == 'driving_directions') this.ea.trigger('directions:initform');
            $(document).trigger("w2gi:locatorloaded", { 'options' : this.options })
            $(document).trigger('w2gi:track', {action: 'mapstartview', value: new Date().toString()})

            $(function() {
              if (typeof W2GI.loaded === 'function') { W2GI.loaded($) }
            })
         },
         initialize: function(options) {
          if (_.where(options.sources, function(item) {return item.name.toLowerCase().indexOf('google') != -1}).length){
            this.loadGoogleLibrary(options)
          } else {
            this.loadLocator(options)
          }
        },

        /*
        * subscribe to the EA events
        */
        registerEvents: function() {
          _.bindAll(this,  'showCollection', 'clear','addEndMarkers','addAtw','searchDirections', 'addRoute', 'enableClientSide', '_makeDefaultLocation', 'printPrepare')
          this.ea.bind('collection:multiple', this.showCollection)
                 .bind('map:clear', this.clear)
                 .bind('locator:clientdirectionson', this.enableClientSide)
                 .bind('directions:addEndMarkers', this.addEndMarkers)
                 .bind('directions:addAtw', this.addAtw)
                 .bind('directions:addRoute', this.addRoute)
                 .bind('poi:makedefaultlocation', this._makeDefaultLocation)
                 .bind('poi:loadstart', this.printPrepare)
                 .bind('locator:searchform', this.searchDirections)
          $(window).on('beforeunload', function() {
            //$(document).trigger('w2gi:track', {action: 'mapendview', value: new Date().toString()})
          })
        },
        clear: function() {
          this.routeLayer.clear()
          this.routeMarkerLayer.clear()
          this.ea.trigger('locator:hidemarkers')
          // need to add a different method
          this.mapView.closePopups()
          this.mapView.clearMarkers()
        },
        loadLocationCookie: function() {
          var cookiename = (this.clientCookie && this.clientCookie.name) ?  this.clientCookie.name : 'mylocation';
          var cookieuid = ace.util.getCookie(cookiename);
          var cookiearr = (cookieuid && cookieuid.length ? cookieuid.split("|") : new Array());
          if((cookiearr.length && this.defaultLocation) ){
            this.options.clientkey = cookiearr[0]
            this.options.formdata.geoip = false
            this.options.formdataid = 'getlist'
          }
        },
        searchDirections: function(sa, ea) {
          //debugger
        },
        addMapUrlImage: function(mapurl) {
          var img = $('#map_url_image')[0];
          if (mapurl && img ) {
            var size = mapurl.match(/size=(\d+),(\d+)/);
            if (size) {
              img.width = size[1];
              img.height = size[2];
            }
            img.src = mapurl;
          }
        },
        printPrepare: function(pois, attributes) {
          if (attributes && attributes.mapurl && !_.isEmpty(attributes.mapurl)) {
            $('.map').hide()
            this.addMapUrlImage(attributes.mapurl)
          }
        },
        enableClientSide: function() {
          this.mapView.clientSideDirections = true
        },
        showCollection: function(collection) {
           if (this.multipleAddressView) { this.multipleAddressView.show({ collection: collection }) }
           else {
               this.multipleAddressView = new MultipleAddressView({
                                                collection: collection,
                                                element:    this.$el.find('.poi')
                                            })
            }
        },
        initRouteLayer: function() {
          this.routeLayer = null;
          if (!this.mapView.options.routeStyle) {
            return;
          }
          this.routeLayer = RouteVectorLayer.init({
            map: this.mapView.map,
            name: 'Route vector',
            routeStyle: this.mapView.options.routeStyle
          })
          this.mapView.routeLayer = this.routeLayer
          this.mapView.directions.routeLayer = this.routeLayer
        },
        addRoute: function(points) {
          var linestrings = _.pluck(points.collection, 'segment_geometry')
          this.routeLayer.addRoute( { linestrings: linestrings })
        },
        addEndMarkers: function(addresses) {
          this.routeMarkerLayer.addEndMarkers(addresses)
        },
        addAtw: function(atws) {
          this.routeMarkerLayer.addAtw(atws)
        },
        checkLanguage: function() {
          //check for default language option in options
          if (options.defaultLanguage && options.defaultLanguage != null && options.defaultLanguage != '' && options.defaultLanguage == true) {
            var language = window.navigator.language || window.navigator.userLanguage;
            language = language.replace("-", "_");
            if (options.language && options.language != null && options.language != '') {
              var languageDefined = false;
              $H(options.language).each(function(country) {
                if (language.indexOf(country.value.lang) != -1) {
                  languageDefined = true;
                  if (country.value.template && country.value.template != null && country.value.template != '') {
                    var currentPage = location.href;
                    currentPage = currentPage.substring(currentPage.lastIndexOf('/') + 1, currentPage.length);
                    if (currentPage != country.value.template) {
                      location.href = country.value.template;
                    }
                  }
                }
              });
              if (languageDefined) { // language is defined but template is not defined for this lang
                ace.locale.loadLocale(language);
              }
            }
          } else if (options.language && options.language != null && options.language != '') {
            // do geoip call, fetch the country and do the same logic again
            var params = {
              formdataID: 'getcountry'
            };
            var temp_options = {};
            if (typeof Console != 'undefined' && $('accounts')) {
              temp_options.schemaname = $('accounts').getValue();
            } else {
              temp_options.appkey = ace.xml.getXMLData('appkey');
            }
            ace.request(temp_options, checkCountry, params);
          }

          function checkCountry(response) {
            response = ace.xml.parse(response);
            var location = response[0].COUNTRY.toUpperCase();
            if (options.language && options.language != null && options.language != '') {
              var countryDefined = false;
              $H(options.language).each(function(country) {
                if (country.key.indexOf(',') != -1) {
                  var countryList = country.key.split(',');
                  for (var i = 0; i < countryList.length; i++) {
                    if (location.indexOf(countryList[i].toUpperCase) != -1) {
                      countryDefined = true;
                      if (country.value.template && country.value.template != null && country.value.template != '') {
                        var currentPage = location.href;
                        currentPage = currentPage.substring(currentPage.lastIndexOf('/') + 1, currentPage.length);
                        if (currentPage != country.value.template) {
                          location.href = country.value.template;
                        }
                      }
                    }
                  }
                } else {
                  if (location.indexOf(country.key.toUpperCase()) != -1) {
                    countryDefined = true;
                    if (country.value.template && country.value.template != null && country.value.template != '') {
                      var currentPage = location.href;
                      currentPage = currentPage.substring(currentPage.lastIndexOf('/') + 1, currentPage.length);
                      if (currentPage != country.value.template) {
                        location.href = country.value.template;
                      }
                    }
                  }
                }
              });
              if (countryDefined) { // language is defined but template is not defined for this lang
                ace.locale.loadLocale(language);
              }
            }
          }
        },
        _makeDefaultLocation : function(e, uid, record) {
          var name  = (this.clientCookie && this.clientCookie.name) ?  this.clientCookie.name : 'mylocation';
          var value = (this.clientCookie && this.clientCookie.value) ?  this.clientCookie.value : 'uid';
          var expires   = 1000;
          var domain  = (this.clientCookie && this.clientCookie.domain) ? this.clientCookie.domain : document.domain;
          var secure  = 0;
          var value_cc  = '';
          var limit = (this.clientCookie && typeof this.clientCookie.cookieLimit != 'undefined' && this.clientCookie.cookieLimit > 0) ? this.clientCookie.cookieLimit : 1;
          var cookie  = ace.util.getCookie(name);
          var locations = []
          var locationuids = []
          var values = (cookie ? cookie.split('|') :[]);

          //set the checked value in case the element is an image
          e.checked = (typeof e.type != 'undefined' && e.type == 'checkbox' ? e.checked : true);

          if(this.clientCookie && this.clientCookie.value ){
            var temp = record
              if(temp){
                value_cc = temp[this.clientCookie.value]
              }
          }
          if (limit == 1) {
            locations = [];
          }
          else {
            for (var i = 0; i < values.length; i++) {
              if (values[i] == value_cc && e.checked)
                return; //already checked nothing to do
              if (values[i].strip().length > 0) {
                locations.push(values[i]);
              }
            }
          }

          if (e.checked) {
            if (limit > 1 && locations.length >= limit) {
              var txtmsg;
              var options = { width: 425, height: 120 };
              var cookielimitmsg = $('#cookielimitmsg');
              if (cookielimitmsg.length && cookielimitmsg.innerHTML) {
                txtmsg = cookielimitmsg.innerHTML;
                var params = cookielimitmsg.attr('params');
                options = { 'params' : params };
              }
              else {
                txtmsg = 'You already have the maximum number of favorite locations.  Please remove some and try again';
              }
              ace.util.alert(txtmsg, params );
              e.checked = false;
            } else {
              locations.push(value_cc);
              var cookieValue = locations.join('|');
              ace.util.setCookie(name, cookieValue, expires, null, domain, secure);

              if ($('#cookieaddmsg').length && $('#cookieaddmsg').text().strip().length > 0) {
                  var options = { width: 425, height: 120 };
                  var msg = $('#cookieaddmsg').innerHTML;
                  var params = $('#cookieaddmsg').attr('params');

                  if (params && params.strip().length > 0)
                    options = { 'params' : params };
                  ace.util.alert(msg, options );
                }
            }
          } else {
            for (var i = 0; i < locations.length; i++) {
              if (locations[i] == value_cc) {
                locations.splice(i, 1);
              }
            }
            var cookieValue = (locations.length ? locations.join('|') : '');
            ace.util.setCookie(name, cookieValue, expires, null, domain, secure);
          }

          if (limit == 1) {
          $('.make_default_loc').each(function(e){
              var euid = e.getAttribute('uid');
                //if(euid == '#{UID}') return;

                if(euid != uid) e.checked = false;

              }.bind(this));
          }

        }
      })
      module.init = function(options) {
        return new LocatorView(options)
      }
      return module
  }
)
;
/**
* Client Side geocoding
* Emits:
* Listens to:
**/

define(
  'src/clientside/cgeo',[
    'src/core/baseview',
    'src/core/basemodel',
    'jquery'
  ],
  function(BaseView, BaseModel, $) {
    console.log('cgeo loaded')
    ace = ace || {}

    ace.cgeo = {
        getGeoResult : function(type,accuracy) {
            var result;
            switch(accuracy) {
                case 'APPROXIMATE':
                    switch(type) {
                        case 'sublocality_level_4':
                        case 'sublocality_level_3':
                        case 'sublocality_level_2':
                            result = '09 W2GISEGMENT';
                            break;
                        case 'locality':
                        case 'sublocality_level_1':
                        case 'sublocality':
                            result = '04 W2GICITY';
                            break;
                        case 'postal_code':
                            result = '05 W2GIPOSTAL';
                            break;
                        case 'administrative_level_1':
                            result = '02 W2GISTATE';
                            break;
                        case 'country':
                            result = '01 W2GICOUNTRY';
                            break;
                    }
                    break;
                case 'GEOMETRIC_CENTER':
                    switch(type) {
                        case 'locality':
                        case 'sublocality_level_1':
                            result = '04 W2GICITY';
                            break;
                        case 'postal_code':
                            result = '05 W2GIPOSTAL';
                            break;
                        case 'administrative_level_1':
                            result = '02 W2GISTATE';
                            break;
                        case 'country':
                            result = '01 W2GICOUNTRY';
                            break;
                    }
                    break;
                case 'RANGE_INTERPOLATED':
                    result = '09 W2GISEGMENT';
                    break;
                case 'ROOFTOP':
                    result = '10 W2GIADDRESS';
                    break;
                default:
                    result = '00 FAILED';
                    break;
            }

            return result
        },
        parseAddress : function(p) {
            var address = {}
            address.addressline = p.formatted_address

            address.georesult = this.getGeoResult(p.address_components[0].types[0],p.geometry.location_type);
            var country = _(p.address_components).find( function(s) { return _(s.types).first() == 'country' });
            if (country == undefined) { return address } // jshint ignore:line
            address.country = country.short_name;
            address.address = '';

            for (var i = 0; i < p.address_components.length; i++) {
                var type = p.address_components[i].types[0];
                var value = p.address_components[i].short_name;
                if (address.country == 'JP') {
                    address.address1 = _.chain(p.address_components).filter(function (s) {
                                            return _(s.types).detect( function (t) {
                                                return t == 'sublocality_level_4' ||
                                                    t=='sublocality_level_3' ||
                                                    t=='sublocality_level_2' ||
                                                    t=='sublocality_level_1'; }
                                            ) }
                                        ).pluck('short_name').join(' ');
                } else if (address.country == 'HK' && type == "administrative_area_level_2") {
                    address.city = !address.city ? "" : address.city;
                    address.city += value;
                } else {
                    address.address1 = _.chain(p.address_components).filter(function (s) {
                                            return _(s.types).detect( function (t) {
                                                return t=='street_number' ||
                                                    t=='route'; }
                                            ) }
                                        ).pluck('short_name').value().join(' ');
                }
                switch(type) {
                    case 'locality':
                        if (address.country == 'JP') { address.province = value }
                        else { address.city = value }
                        break;
                    case 'postal_code':
                        address.postalcode = value;
                        break;
                    case 'administrative_area_level_1':
                        if (address.country && address.country == 'US') { address.state = value }
                        else if (address.country == 'JP') { address.city = value }
                        else if (address.country && (address.country == 'UK' || address.country == 'GB')) {
                            address.county = value;
                        }
                        else { address.province = value }
                        break;
                    case 'administrative_area_level_2':
                        if (address.country && (address.country == 'UK' || address.country == 'GB')) {
                            address.province = value;
                        }
                        break;
                    case 'country':
                        address.country = value;
                        break;
                }
            }
            //now clean up the address object
            address.country = (typeof address.country == 'undefined' ? '' : address.country);
            //GB -> UK
            address.country = (address.country == 'GB') ? 'UK' : address.country;
            address.city = (typeof address.city == 'undefined' ? '' : address.city.replace(/[()]/g,''));
            address.province = (typeof address.province == 'undefined' ? '' : address.province);
            address.state = (typeof address.state == 'undefined' ? '' : address.state);
            address.postalcode = (typeof address.postalcode == 'undefined' ? '' : address.postalcode);
            address.address = (typeof address.address == 'undefined' ? '' : address.address.replace(/[()]/g,''));
            address.addressline = (typeof address.addressline == 'undefined' ? '' : address.addressline.replace(/[()]/g,''));
            try {
                address.address1 = (typeof address.address1 == 'undefined' ? address.address : address.address1.replace(/[()]/g,''));
            } catch (e) {
                address.address1 = (typeof address.address1 == 'undefined' ? address.address : address.address1.value().replace(/[()]/g,''));
            }

            return address;
        }
    }

    var ClientGeocoder = BaseView.extend({
        initialize: function(options) {
            this.sbClassNames = options.formdata.sbClassNames || {};
            this.sbOnSelectEvent = options.formdata.sbOnSelectEvent || 'w2gi:sbselect';
            this.allowcountries = options.allOptions.allowcountries || false;
            this.include_country = options.allOptions.include_country || false;
            this.additionalClasses = options.formdata.autocompleteExtraClasses || null
            this.googleAutoComplete = false;
            options.formdata.google_autocomplete && this.addAutocomplete();
            ace.cgeo = ace.cgeo || {}
            this.registerEvents();
        },

        registerEvents: function() {
        	_.bindAll(this, 'addAutocomplete')
           this.ea.bind('add:autocomplete', this.addAutocomplete)
		$(document).on('add:autocomplete', this.googleAutoComplete && this.addAutocomplete);
        	$(document).on('w2gi:suggestion', this.suggestionSelected);
        },
        init: function() {
            if (!this.googleGeocoder ) {
                if (typeof google.maps.Geocoder == 'function') {
                    this.googleGeocoder = new google.maps.Geocoder();
                }
            }
        },
        geocode: function(request, callback, options){
            //debugger
            options = options || {};
            var form = request.geolocs.geoloc[0];
            this.init();

            if (!this.googleGeocoder) {
                //only if we cant access google for some reason
                //return  ace.request(form, callback, options);
                return this.ea.trigger('locator:search', request, options)
            }

            if (form['latitude'] && form['longitude']) {
                this.reverseGeocode(request, callback, options);
            }
            else {
                var addstring;
                if (form['addressline']) {
                    addstring = form['addressline'] + (form['country'] ? ', ' + form['country'] : '');
                    addstring = this.addressCorrection(addstring);
                }
                else {
                    addstring = (form['address1'] ? form['address1'] + ' ' : '') +
                                (form['address2'] ? form['address2'] + ', ' : '') +
                                (form['city'] ? form['city'] + ', ' : '') +
                                (form['state'] ? form['state'] + ' ' : '') +
                                (form['province'] ? form['province'] + ' ' : '') +
                                (form['postalcode'] ? form['postalcode'] + ' ' : '') +
                                (form['country'] ? form['country'] : '');
                }
                var address = { 'address' : addstring };
                if (form['country']) {
                    //set the country bias, should work but it is not behaving correctly
                    address.region = form['country'];
                }

                if(address.region === 'HK' && /^\s*hong\s*kong\s*, hk$/i.test(address.address)) {
                    address.address = 'HK';
                }
                address.newForwardGeocoder = true
                this.googleGeocoder.geocode(address, function(response, status){
                    if (!status || status != google.maps.GeocoderStatus.OK || response.length === 0) {
                        //options = Object.extend(options || {}, {formdataID: 'geocoder'});
                        // this will return xml response to callback
                        //ace.request(form, callback, options);
                        this.ea.trigger('locator:search', request, options);
                    }
                    else {

                        var total = 0;
                        // rtemp = new Array();
                        //now find the total number of valid results
                        //sometimes google will return an obvious result and then
                        //garbage with no country information
                        var country = 'US';
                        if (form['country']) {
                            country = (form['country'] + '').toUpperCase(); // use "+''" to ensure string conversion
                        }
                        else if ($('search_country')) {
                            country = $('search_country');
                        }
                        var rhash = {}; //new Hash();
                        _(response).forEach(function(x) {
                            var tmp = _(x.address_components).find(function(s) {return _(s.types).include('country')} );
                            if(!tmp && country !== 'CY')
                                return;
                            var cntry = (tmp) ? tmp.short_name : '';
                            if (_(x.types).include('point_of_interest') ||
                                    _(x.types).include('establishment') ||
                                    _(x.types).include('natural_feature')) {
                                return;
                            }
                            if (_(x.address_components).find(function(s) {return _(s.types).include('colloquial_area') ||
                                    (cntry == 'HK' && _(s.types).include('route'));})) {
                                return;
                            }
                            if (cntry == 'GB') {
                                _(x.address_components).find(function(s) { return _(s.types).include('country') } ).short_name = 'UK';
                            }
                            if ((country === 'CY') || (_(x.address_components).find(function(s) { return _(s.types).include('country') } ).short_name == country)) {
                                // rtemp.push(x);
                                var address = ace.cgeo.parseAddress(x);
                                if(/[!$%^*\\]/.test(address.addressline || address.address || address.address1)) {
                                    return;
                                }
                                //rhash.set(Object.toJSON(address), x);
                                rhash[JSON.stringify(address)] = x;
                            }
                        });
                        response = _(rhash).values();
                        /* if(response.length > 1) {
                            response = [response[0]];
                        } */
                        // response = rtemp;
                        if (response.length > 1 && (!options || !options.clientSide || options.clientSide === false)) {
//                            var xml = '<?xml version="1.0" encoding="UTF-8"?>';
//                            xml += '<response code="1"><collection name="multiple_address" count="' + response.length + '">\n';
                            var col = [];
                            _(response).each(function(x) {
                                var place = ace.cgeo.parseAddress(x);
                                place.country = place.country || country;
                                col.push({
                                    address1: place.address || '',
                                    city: place.city || '',
                                    postalcode: place.postalcode || '',
                                    country: place.country || '',
                                    longitude: x.geometry.location.lng(),
                                    latitude: x.geometry.location.lat(),
                                    state: place.state || '',
                                    province: place.province || ''
                                });
//                                xml += '<address>\n';
//                                xml += '<address1>' + (place.address || '') + '</address1>\n';
//                                xml += '<city>' + (place.city || '') + '</city>\n';
//                                xml += '<postalcode>' + (place.postalcode || '') + '</postalcode>\n';
//                                xml += '<country>' + (place.country || '') + '</country>\n';
//                                xml += '<longitude>' + x.geometry.location.lng() + '</longitude>\n';
//                                xml += '<latitude>' + x.geometry.location.lat() + '</latitude>\n';
//                                xml += '<state>' + (place.state || '') + '</state>\n';
//                                xml += '<province>' + (place.province || '') + '</province>\n';
//                                xml += '</address>\n';
                            });

//                            xml += '</collection></response>';

//                            var responseDoc;

                            //IE will not properly allow a document element to be created
//                            if (Prototype.Browser.IE) {
//                                try {
//                                    responseDoc = new ActiveXObject('Microsoft.XMLDOM');
//                                    responseDoc.loadXML(xml);
//                                }
//                                catch (e) {
//                                    form['longitude'] = response[0].geometry.location.lng();
//                                    form['latitude'] = response[0].geometry.location.lat();
//                                    //this returns xml to the callback ?
//                                    ace.request(form, callback, options);
//                                    return;
//                                }
//
//                            }
//                            else {
//                                responseDoc = new Element('document');
//                                responseDoc.innerHTML = xml;
//                            }

                            // this returns xml to the callback
//                            return callback(responseDoc);
                            return this.ea.trigger("collection:multiple", col);
                        }
                        else if (response.length == 1) {
                            var addr = ace.cgeo.parseAddress(response[0]);

                            form['longitude'] = response[0].geometry.location.lng();
                            form['latitude'] = response[0].geometry.location.lat();

                            /* if(options.formdataID == 'locatorsearch'){
                                $('locator_search').insert(new Element('input',{'type':'hidden','name':'longitude','value':form.longitude}));
                                $('locator_search').insert(new Element('input',{'type':'hidden','name':'latitude','value':form.latitude}));
                            } */


                            form['country'] = addr.country || country;
                            form['state'] = addr.state || '';
                            form['province'] = addr.province || '';
                            form['city'] = addr.city || '';
                            form['address1'] = addr.address1 || '';
                            form['postalcode'] = addr.postalcode || '';
                        }

                        // this if block is solely for LocationManager geocode function in OLE
                        if (options && options.clientSide && options.clientSide === true) {
                            var addr = new Array(); // jshint ignore:line
                            for (var i = 0; i < response.length; i++) {
                                addr[i] = ace.cgeo.parseAddress(response[i]);
                                addr[i].longitude = response[i].geometry.location.lng();
                                addr[i].latitude = response[i].geometry.location.lat();
                                addr[i].recnum = i+1;
                            }
                            // this returns an array of address objects to the callback
                            callback(addr);
                        }
                        // other wise this is normal locator proximity search
                        else {
                            //ace.request(form, callback, options);
                            this.ea.trigger('locator:search', request, options)
                        }
                    }
                }.bind(this));
            }
        },
        reverseGeocode : function(form, callback, options) {
            var deferred = $.Deferred(),
                self = this
            this.init();

            if (!this.googleGeocoder) {
                //only if we cant access google for some reason
                return this.ea.trigger('locator:search', form);
                //return  ace.request(form, callback, options);
            }

            var latlng = new google.maps.LatLng(form['latitude'], form['longitude']);

            this.googleGeocoder.geocode({'latLng': latlng }, function(response,status) {
                if (!status || status != google.maps.GeocoderStatus.OK) {
                    //ace.request(form, callback, options);
                    this.ea.trigger('locator:search', form, options);
                }
                else {
                    if (options && options.routeDrag) {

                        var address = response[0];
                        if (address.address_components) {
                            var place = ace.cgeo.parseAddress(address)

                            form['address1'] = place.address1;
                            form['country'] = place.country;
                            form['state'] = place.state;
                            form['province'] = place.province;
                            form['city'] = place.city;
                            form['address1'] = place.address1;
                            form['postalcode'] = place.postalcode;
                            form['latitude'] = place.latitude;
                            form['longitude'] = place.longitude
                        }



                        // var responseDoc;

                        // //IE will not properly allow a document element to be created
                        // if (Prototype.Browser.IE) {
                        //     try{
                        //         responseDoc = new ActiveXObject('Microsoft.XMLDOM');
                        //         responseDoc.loadXML(xml);
                        //     }catch (e) {
                        //         form['longitude'] = response[0].geometry.location.lng();
                        //         form['latitude'] = response[0].geometry.location.lat();
                        //         ace.request(form, callback, options);
                        //         return;
                        //     }

                        // }
                        // else {
                        //     responseDoc = new Element('document');
                        //     responseDoc.innerHTML = xml;
                        // }
                        deferred.resolve(form);
                    }
                    else {
                        var newaddress = ace.cgeo.parseAddress(response[0]);
                        //google automatically appends the country to the address line
                        //so this script removes it
                        var clean_address = response[0].formatted_address.replace(/\(.*?\)/g,"");
                        var addr = clean_address.split(',');
                        var cc = addr.pop();
                        var cataddr = addr.join(',');
                        var cataddr = (newaddress.address1) ? newaddress.address1 + ", " : "";
                        cataddr += (newaddress.city) ? newaddress.city + ", " : ", ";
                        cataddr += (newaddress.state) ? newaddress.state + " " : (newaddress.province) ? newaddress.province + " " : "";
                        cataddr += (newaddress.postalcode) ? newaddress.postalcode : "";
                        if ($('#inputaddress')) {
                            $('#inputaddress').val(cataddr);
                        }
                        else {

                            if ($('#postalcode') && newaddress.postalcode)
                                $('#postalcode').val(newaddress.postalcode);
                            if ($('#city') && newaddress.city)
                                $('#city').val(newaddress.city);
                            if ($('#address1') && newaddress.address1)
                                $('#address1').val(newaddress.address1);
                        }
                        form['addressline'] = cataddr;
                        form['country'] = newaddress.country;
                        form['state'] = newaddress.state;
                        form['province'] = newaddress.province;
                        form['city'] = newaddress.city;
                        form['address1'] = newaddress.address1;
                        form['postalcode'] = newaddress.postalcode;

                        //if ((options.clientSide && options.clientSide == true) || (ace.useClientSideGeo && ace.useClientSideGeo == true)){
                        if (options.clientSide && options.clientSide === true) {
                            // var xml = '<?xml version="1.0" encoding="UTF-8"?>'; // jshint ignore:line
                            // xml += '<response code="1"><collection name="address">\n';
                            // xml += '<address>\n';
                            // xml += '<address1>' + newaddress.address1 + '</address1>\n';
                            // xml += '<city>' + newaddress.city + '</city>\n';
                            // xml += '<postalcode>' + newaddress.postalcode + '</postalcode>\n';
                            // xml += '<country>' + newaddress.country + '</country>\n';
                            // xml += '<longitude>' + form['longitude'] + '</longitude>\n';
                            // xml += '<latitude>' + form['latitude'] + '</latitude>\n';
                            // xml += '<state>' + newaddress.state + '</state>\n';
                            // xml += '<province>' + newaddress.province + '</province>\n';
                            // xml += '</address>\n';

                            // xml += '</collection></response>';

                            // var responseDoc; // jshint ignore:line

                            // //IE will not properly allow a document element to be created
                            // if (Prototype.Browser.IE) {
                            //     try{
                            //         responseDoc = new ActiveXObject('Microsoft.XMLDOM');
                            //         responseDoc.loadXML(xml);
                            //     }catch (e) {
                            //         ace.request(form, callback, options);
                            //         return;
                            //     }
                            // }
                            // else {
                            //     responseDoc = new Element('document');
                            //     responseDoc.innerHTML = xml;
                            // }
                            deferred.resolve(form);
                        }
                        else {
                            //ace.request(form, callback, options);
                            this.ea.trigger('locator:search', request, options);
                        }
                    }
                }
            }.bind(this));
            return deferred.promise()
        },

	addressMap : [
// Some US states that have issue with "did you mean" suggestion
	{'input':/^california[\s]*[,]*[\s]*[us]*[\s]*$/i, 'output':"CA"},
	{'input':/^new[\s]*york[\s]*[,]*[\s]*[us]*[\s]*$/i, 'output':"NY"},
	{'input':/^oklahoma[\s]*[,]*[\s]*[us]*[\s]*$/i, 'output':"OK"},
	{'input':/^louisiana[\s]*[,]*[\s]*[us]*[\s]*$/i, 'output':"Louisiana, LA"},
	{'input':/^la[\s]*[,]*[\s]*[us]*[\s]*$/i, 'output':"Louisiana, LA"},
	{'input':/^oregon[\s]*[,]*[\s]*[us]*[\s]*$/i, 'output':"Oregon, OR"},
	{'input':/^portland[\s]*[,]*[\s]or[\s]*[,]*[\s]*[us]*[\s]*$/i, 'output':"Portland, Oregon"},
	{'input':/^or[\s]*[,]*[\s]*[us]*[\s]*$/i, 'output':"Oregon, OR"},
	{'input':/^delaware[\s]*[,]*[\s]*[us]*[\s]*$/i, 'output':"DE"},
	{'input':/^indiana[\s]*[,]*[\s]*[us]*[\s]*$/i, 'output':"IN"},
	{'input':/^maine[\s]*[,]*[\s]*[us]*[\s]*$/i, 'output':"ME"},
	{'input':/^ohio[\s]*[,]*[\s]*[us]*[\s]*$/i, 'output':"OH"},
	{'input':/^virginia[\s]*[,]*[\s]*[us]*[\s]*$/i, 'output':"VA"},
	{'input':/^wyoming[\s]*[,]*[\s]*[us]*[\s]*$/i, 'output':"WY"},
	{'input':/^washington[\s]*[,]*[\s]*[us]*[\s]*$/i, 'output':"WA"},
//End of US states with issue
// Some Korean cities
	{'input':/^changwon[\s]*[,]*[\s]*kr[\s]*$/i, 'output':"641-490, South Korea"},
	{'input':/^창원[\s]*[,]*[\s]*kr[\s]*$/i, 'output':"641-490, South Korea"},
// END of Korean cities
// Some Japanese cities
	{'input':/^中目黒*/i, 'output':"Nakameguro"},
	{'input':/^しんじゅく*/i, 'output':"Shinjuku"},
	{'input':/^しぶや*/i, 'output':"Shibuya"},
	{'input':/^吉祥寺*/i, 'output':"Kichijoji"},
	{'input':/^きちじょうじ*/i, 'output':"Kichijoji"},
	{'input':/^おおさか*/i, 'output':"Osaka Prefecture"},
	{'input':/^Osaka*/i, 'output':"Osaka Prefecture"},
//End of Japanese cities
	{'input':"Brunnen, CH", 'output':"Ingenbohl, CH"},
	{'input':"Marin, CH", 'output':"Marin-Epagnier, CH"},
	{'input':"St. Agnes, UK", 'output':"St. Agnes, Cornwall, UK"},
	{'input':"St Agnes, UK", 'output':"St. Agnes, Cornwall, UK"},
	{'input':"Saint Agnes, UK", 'output':"St. Agnes, Cornwall, UK"},
	{'input':"Ibach, CH", 'output':"Ibach, Schwyz, CH"},
	{'input':"Langen, DE", 'output':"Langen Hessen, DE"},
	{'input':"31952, SA", 'output':"Al Khobar, SA"},
	{'input':"Highland, IN", 'output':"41.5536468, -87.451984"},
	{'input':"Highland IN", 'output':"41.5536468, -87.451984"},
	{'input':"Quebec, CA", 'output':"Quebec, QC, CA"},
	{'input':"Cardigan, UK", 'output':"Cardigan, Ceredigion, UK"},
	{'input':"Roma, IT", 'output':"Roma, Roma, IT"},
	{'input':"Milano, IT", 'output':"Milano, Milano, IT"},
	{'input':"Seminole, FL, US", 'output':"33772"},
	{'input':"Seminole, FL", 'output':"33772"},
	{'input':/^Beaverton[\s]*[,]*[\s]*OR[,]*[\s]*[us]*[\s]*$/i, 'output':"Beaverton, OR, USA, US"},
	{'input':/^glendale[\s]*,*[\s]*ca[\s]*.*$/i, 'output':"91205,US"},
	{'input':/^\s*Pembroke\s+Pines,?\s+FL/i, 'output':"33028"},
	{'input':/^ventura[\s]*[,]*[\s]*ca[,]*[\s]*93001[\s]*[,]*[\s]*US[\s]*$/i, 'output':"93001"},
	// {'input':/^san[\s]*juan[\s]*[,]*[\s]*pr[\s]*[,]*[\s]*US[\s]*$/i, 'output':"San Juan, Puerto Rico, US"},
	{'input':/^san[\s]*juan[\s]*[,]*[\s]*puerto[\s]*rico[\s]*[,]*.*$/i, 'output':"San Juan, Puerto Rico"},
	{'input':/^san[\s]*juan[\s]*[,]*[\s]*pr[\s]*[,]*.*$/i, 'output':"San Juan, Puerto Rico"},
	{'input':/^jersey[\s]*[,]*[\s]*uk[\s]*[,]*.*$/i, 'output':"Jersey, JE"},
	{'input':/^guernsey[\s]*[,]*[\s]*uk[\s]*[,]*.*$/i, 'output':"Guernsey, GG"},
	{'input':/^richmond[\s]*[,]*[\s]*on[\s]*[,]*.*$/i, 'output':"Richmond, ON, K0A 2Z0"},
	{'input':/^Puerto[\s]*rico.*$/i, 'output':"Puerto Rico"},
	{'input':/münchen/i, 'output':"Munich, DE"},
	{'input':/^\s*28700, ES$/, 'output': "Madrid, ES"},
	{'input':/^\s*28529, ES$/, 'output': "Madrid, ES"},
	{'input':/^\s*97224, MQ$/, 'output': "Ducos, MQ"},
	{'input':/^\s*90802,\s*US$/, 'output': "90802, CA, US"}
	],

        addressCorrection: function(address) {
            /*var ret = sortedArraySearch(addressMap,address,addressMapCompare);
            if(ret) {
                return ret.output;
            }

            return address;*/
            var ret = _(this.addressMap || []).find(function(element){
                if(typeof element.input === 'string') {
                    return (element.input.toLowerCase() == address.toLowerCase());
                } else { // if it is not a string we will assume it is a regex
                    return element.input.test(address);
                }
            }.bind(this));

            if(ret)
                return ret.output;
            else
                return address;
        },
        addAutocomplete : function(){
            //console.log("Google Autocomplete Added");
            this.googleAutoComplete = true;

            this.sbClassNames['default'] = this.sbClassNames['default'] || 'default';
            this.sbClassNames.active = this.sbClassNames.active || 'active';
            this.sbClassNames.sb = this.sbClassNames.sb || 'sb';
            this.sbClassNames.sbhidden = this.sbClassNames.sbhidden || 'sbhidden';
            this.sbClassNames.sbshown = this.sbClassNames.sbshown   || 'sbshown';
            this.createDefaultCss();

            this.init();

            var doTextInputAC = function(textinput){

                var doStartAC = function(textinput){
                    if(google.maps.places){
                        this.startAutocompleteService(textinput);
                    }

                };

                textinput.addEventListener('focus', function(ev){
                    var ele = ev.currentTarget;
                    (doStartAC.bind(this))(ele);
                }.bind(this));

                textinput.addEventListener('keyup', function(ev){
                    var ele = ev.currentTarget;
                    if(ele.autocompleteServiceStarted){
                        return;
                    }
                    (doStartAC.bind(this))(ele);
                }.bind(this));

                textinput.setAttribute('autocomplete', 'off');
            };
            var domElements = 'form[id=locator_search] input[type=text][name=addressline],form[id=driving_directions] input[type=text][name=addressline],form[id=dd] input[type=text][name=addressline]';
            if (this.additionalClasses) {
                this.additionalClasses.forEach(function(tag) {
                    domElements+= ', .' + tag
                })
            }
            //var textInputsTemp = document.querySelectorAll(, .search_bar');
            var textInputs = $(domElements);

            _.each(textInputs, function(textinput){
                (doTextInputAC.bind(this))(textinput);
            }.bind(this));

            document.addEventListener('click', function(e){
                SuggestionBox.currentSuggestionBox && SuggestionBox.currentSuggestionBox.hideSuggestionBox();
            });


            document.addEventListener('mouseup', function(e){
                SuggestionBox.currentSuggestionBox && SuggestionBox.currentSuggestionBox.hideSuggestionBox();
            });

        },
        createDefaultCss: function(){
            var style = document.createElement('style');
            style.type = 'text/css';
            style.innerHTML = '.sbhidden { display: none }';
            document.getElementsByTagName('head')[0].appendChild(style);

            style = document.createElement('style');
            style.type = 'text/css';
            style.innerHTML = '.sb .active { background-color: lightgray }';
            document.getElementsByTagName('head')[0].appendChild(style);


        },
        getFormCountry : function(textInput){
            //if(textInput.form.select('[name=country]') && textInput.form.select('[name=country]').length > 0){
            if($( textInput.form).find('[name=country]') && $( textInput.form).find('[name=country]').length > 0){
                //switch(textInput.form.getAttribute('id')){
                switch($(textInput.form).attr('id')){
                    case 'driving_directions' :
                        if($(textInput).attr('id') == 'startaddress'){
                            return textInput.form.select('#orig_country')[0].value || '';
                        }
                        else if($(textInput).attr('id') == 'endaddress'){
                            return textInput.form.select('#dest_country')[0].value || '';
                        }
                        //break;
                        /* falls through */
                    case 'locator_search' :
                        /* falls through */
                    default :
                        //return textInput.form.select('[name=country]')[0].value || '';
                        return $( textInput.form).find('[name=country]')[0].value || '';
                        //break;
                }
            }

            return 'US';
        },
        startAutocompleteService : function(textInput){

            if(textInput.autocompleteServiceStarted){
                return;
            }

            textInput.suggestionBox = new SuggestionBox({
                textInput:textInput,
                classnames:this.sbClassNames,
                onselectevent:this.sbOnSelectEvent
            });


            //google.maps.LatLng = this.googleLatLngSaved;
            //Testing 2.5.16
            //if(!this.testauto )
            	//this.testauto = new google.maps.places.Autocomplete(textInput);

            if(!this.autocompleteService){
                this.autocompleteService = new google.maps.places.AutocompleteService();
            }
            textInput.addEventListener('focus', function(ev){
            	ev.path.forEach(function(x){
					if(x.nodeName == 'FORM'){
						var lat = $('#'+ x.id + ' [name="latitude"]');
						var lon = $('#'+ x.id + ' [name="longitude"]');
						if(lat.length != 0)
							resetValue(lat);
						if(lon.length != 0)
							resetValue(lon);

					}

					function resetValue(elems){
						for(var i=0;i<elems.length;i++){
							elems[i].value = '';
						}
		            }
				})
            }.bind(this))

            textInput.addEventListener('keyup', function(ev){
                var textInput = ev.target;
                var keyCode = ev.keyCode;

                if(textInput.value == '' || keyCode == 38 || keyCode == 40){
                    return;
                }

                this.currentFormCountry = this.getFormCountry(textInput);
                var autocompletionRequest = {
                    input: textInput.value,
                    types: ['geocode']
                };

                if(this.currentFormCountry != '' && !this.allowcountries){
                    autocompletionRequest.componentRestrictions = {
                        country: this.currentFormCountry
                    };
                }

                this.autocompleteService.getPlacePredictions(autocompletionRequest, function(predictions, status){
                    //console.log(keyCode);
                    if(!predictions){
                        return;
                    }

                    this.currentPredictions = [];
                    for (var i = 0, numPredictions = predictions.length ; i < numPredictions ; i++){
                        var prediction = predictions[i];
                        if(this.currentFormCountry && !this.include_country){
                            //var pred_parts = prediction.description.split(',');
                            var pred_parts = prediction.terms;
                            if(pred_parts.length > 1){
                                pred_parts.splice(pred_parts.length-1);
                                pred_parts = pred_parts.map(function(pred_part){
                                    return pred_part.value;
                                });
                                prediction.description = pred_parts.join(' ');
                            }
                        }
                     this.currentPredictions.push({
                            description: prediction.description,
                            id:prediction.place_id
                      });

                    }

                    textInput.suggestionBox.clearSuggestions();
                    textInput.suggestionBox.addSuggestions(this.currentPredictions);

                }.bind(this));
            }.bind(this));

            textInput.autocompleteServiceStarted = true;


        },
	suggestionSelected: function(evt,params){
    	this.locatorForm = params.textInput.form;
    	this.callbackevent = params.callbackevent ? params.callbackevent : null;
    	this.addressLineTarget = params.target ? params.target : null;
    	var _placeId = params.selectedSuggested ? params.selectedSuggested.id : null;

    	if(!this.placeService)
    		this.placeService = new google.maps.places.PlacesService(document.createElement("DIV"));

    	if(this.placeService && _placeId)
    		this.placeService.getDetails({'placeId':_placeId}, processPlace.bind(this));

        function processPlace(){
        	var place = arguments[0];

        	var addr_comp = place.address_components;
        	var lat = place.geometry.location.lat();
        	var lng = place.geometry.location.lng();
        	var country;

        	for(i = 0 ; i < addr_comp.length; i++){
        		if(addr_comp[i].types.indexOf('country') != -1)
        			country = addr_comp[i].short_name;
        	}

        	if(this.addressLineTarget && this.addressLineTarget.getAttribute('data-action') == 'end'){

	        	if(this.locatorForm.dest_country) this.locatorForm.dest_country.value = country
	        	if(this.locatorForm.dest_longitude) this.locatorForm.dest_longitude.value = lng
	        	if(this.locatorForm.dest_latitude) this.locatorForm.dest_latitude.value = lat

        	}else{
        		if(this.locatorForm.country) this.locatorForm.country.value = country
	        	if(this.locatorForm.longitude) this.locatorForm.longitude.value = lng
	        	if(this.locatorForm.latitude) this.locatorForm.latitude.value = lat
        	}

        	if(this.callbackevent) $(document).trigger(this.callbackevent);
        }
    }
    })

    SuggestionBox = Backbone.View.extend({

        suggestionBoxContainer : null,
        selectedIndex : -1,
        suggestions : [],
        textEntered : '',
        initialize : function(options){

            if(!options.textInput){
                return;
            }

            if(!options.textInput.getAttribute('id')){
                options.textInput.setAttribute('id', 'anonymousSBTextInput' + (this.constructor.numSuggestionBoxes));
            }

            //Object.extend(this, options);
            $.extend(this,options);

            this.suggestions = this.suggestions || [];

            //this.suggestionBoxContainer = new Element('div');
            this.suggestionBoxContainer = document.createElement('div');

            this.suggestionBoxContainer.setAttribute('id', 'suggestionBoxContainer_' + options.textInput.getAttribute('id'));

            // this.textInput.insert({after:this.suggestionBoxContainer});

            document.body.appendChild(this.suggestionBoxContainer);

            //var textInputLoc = this.textInput.cumulativeOffset();

            /*
            this.suggestionBoxContainer.setStyle(
                {
                    //top : textInputLoc.top + parseInt(this.textInput.getStyle('height')) + 5 + 'px',
                    //left : textInputLoc.left + 'px',
                    position : 'absolute',
                    //display : 'none',
                    //backgroundColor : this.textInput.getStyle('backgroundColor') || '#fff',
                    //border : this.textInput.getStyle('border') || '1px solid',
                    //borderRadius : this.textInput.getStyle('borderRadius') || '0px',
                    //padding : this.textInput.getStyle('padding') || '0px',
                    //whiteSpace : 'nowrap',
                    zIndex : 99999
                }
            );
            */

            $(this.suggestionBoxContainer).css({
                    position : 'absolute',
                    zIndex : 99999
            })

            $(this.suggestionBoxContainer).addClass(this.classnames.sb || 'sb').addClass(this.classnames.sbhidden);


            this.addSuggestions();

            this._addObserver();

            this.constructor.numSuggestionBoxes++;

            this.constructor.currentSuggestionBox = this;
        },

        hideSuggestionBox : function(){
            //this.suggestionBoxContainer.hide();
            $(this.suggestionBoxContainer).addClass(this.classnames.sbhidden).removeClass(this.classnames.sbshown);
        },

        showSuggestionBox : function(suggestions){
            if(suggestions){
                this.clearSuggestions();
                this.addSuggestions(suggestions);
            }
            var textInputLoc = $(this.textInput).offset();
            /*this.suggestionBoxContainer.setStyle(
                {
                    top : textInputLoc.top + parseInt(this.textInput.getStyle('height')) + 'px',
                    left : textInputLoc.left + 'px'
                }
            );*/

            $(this.suggestionBoxContainer).css({
                    top : textInputLoc.top + parseInt($(this.textInput).height() + 5) + 'px',
                    left : textInputLoc.left + 'px',
                    background: '#ffffff',
                    padding: '5px',
                    border: '1px solid #cdcdcd',
            })

            $(this.suggestionBoxContainer).addClass(this.classnames.sb || 'sb').addClass(this.classnames.sbhidden);
            $(this.suggestionBoxContainer).addClass(this.classnames.sbshown).removeClass(this.classnames.sbhidden);
        },

        _scrollDown : function(){

            var selectedIndex = +this.selectedIndex;

            if(selectedIndex == this.suggestions.length - 1){
                this._setDeselected();
                this.selectedIndex = -1;
                this.textInput.value = this.textEntered;
                return;
            }

            if(this.selectedIndex >= 0){
                this._setDeselected();
            }

            this.selectedIndex = (selectedIndex + 1)%(this.suggestions.length);

            this._setSelected();

            this.textInput.value = this.suggestions[this.selectedIndex].description;
        },

        _scrollUp : function(){

            var selectedIndex = +this.selectedIndex;

            if(selectedIndex == 0){
                this._setDeselected();
                this.selectedIndex = -1;
                this.textInput.value = this.textEntered;
                return;
            }


            if(selectedIndex > 0){
                this._setDeselected();
                this.selectedIndex = (selectedIndex - 1)%(this.suggestions.length);
            }
            else if(selectedIndex == -1){
                this.selectedIndex = this.suggestions.length - 1;
            }

            this._setSelected();

            this.textInput.value = this.suggestions[this.selectedIndex].description;

        },

        _setSelected : function(index){
            var index = (typeof index != 'undefined'?''+index:undefined) || this.selectedIndex;
            //this.suggestionBoxContainer.select('div[data-suggestionIndex=' + index + ']')[0].setStyle({'backgroundColor':'#ff0'});
            $($(this.suggestionBoxContainer).find('div[data-suggestionIndex=' + index + ']')[0]).addClass(this.classnames.active);
            $($(this.suggestionBoxContainer).find('div[data-suggestionIndex=' + index + ']')[0]).removeClass(this.classnames['default']);
            this.selectedIndex = index;
        },

        _setDeselectedAll : function(){
            this.suggestions.forEach(function(suggestion, i){
                this._setDeselected(i);
            }.bind(this));
            this.selectedIndex = -1;
        },

        _setDeselected : function(index){
            var index = (typeof index != 'undefined'?''+index:undefined) || this.selectedIndex;
            //this.suggestionBoxContainer.select('div[data-suggestionIndex=' + index + ']')[0].setStyle({'backgroundColor':this.suggestionBoxContainer.style.backgroundColor});
            $($(this.suggestionBoxContainer).find('div[data-suggestionIndex=' + index + ']')[0]).addClass(this.classnames['default']);
            $($(this.suggestionBoxContainer).find('div[data-suggestionIndex=' + index + ']')[0]).removeClass(this.classnames.active);
        },

        clearSuggestions : function(){
            this.suggestionBoxContainer.innerHTML = '';
            this.suggestions = [];
            this.selectedIndex = -1;
        },

        addSuggestions : function(suggestions){
            var suggestions = suggestions || this.suggestions;
            this.suggestions = suggestions;
            suggestions.forEach(function(suggestion, i){
                this._addSuggestion(suggestion, i);
            }.bind(this));
        },

        _addSuggestion : function(suggestion, index){
            $(this.suggestionBoxContainer).append('<div data-suggestionIndex=' + index + ' data-suggestionId=' + suggestion.id + ' style="cursor:pointer">' + suggestion.description + '</div>');

            var suggestionContainer = $(this.suggestionBoxContainer).find('div[data-suggestionIndex=' + index + ']')[0];

            $(suggestionContainer).addClass(this.classnames['default']);

            this._observeSuggestionContainer(suggestionContainer);

        },

        _observeSuggestionContainer : function(suggestionContainer){
            suggestionContainer.addEventListener('mouseover', function(ev){
                var element = ev.target;
                var index = element.getAttribute('data-suggestionIndex');
                this._setDeselectedAll();
                this._setSelected(index);
            }.bind(this));

        },

        _addObserver : function(){
            this.textInput.addEventListener('keyup', function(ev){
                var textInput = ev.target;
                var keyCode = ev.keyCode;

                switch(keyCode){
                    case 38 : //up
                        if(this.suggestions.length == 0){
                            break;
                            // return false;
                        }
                        this.showSuggestionBox();
                        this._scrollUp();
                        //ace.cgeo.suggestionSelected({textInput:this.textInput, selectedSuggested:this.suggestions[this.selectedIndex]});
                        $(document).trigger('w2gi:suggestion', {textInput:this.textInput, selectedSuggested:this.suggestions[this.selectedIndex], callbackevent:this.onselectevent, target: ev.target});
                        break;
                        // return false;
                    case 40 : //down
                        if(this.suggestions.length == 0){
                            break;
                        }
                        this.showSuggestionBox();
                        this._scrollDown();
                        //ace.cgeo.suggestionSelected({textInput:this.textInput, selectedSuggested:this.suggestions[this.selectedIndex]});
                        $(document).trigger('w2gi:suggestion', {textInput:this.textInput, selectedSuggested:this.suggestions[this.selectedIndex], callbackevent:this.onselectevent, target: ev.target});
                        break;
                    case 27 :
                        this.textInput.value = this.textEntered;
                        /* falls through */
                    case 13 :
                        this.hideSuggestionBox();
                        $(document).trigger(this.onselectevent);
                        break;
                    default :
                        this.textEntered = this.textInput.value;
                        if(textInput.value == ''){
                            this.hideSuggestionBox();
                            break;
                        }
                        this.showSuggestionBox();
                        break;
                }

            }.bind(this));

            this.textInput.addEventListener('blur', function(ev){
                //console.log(this.selectedIndex);
                if(this.selectedIndex != -1){
                    this.textEntered = this.textInput.value = this.suggestions[this.selectedIndex].description;
                    //ace.cgeo.suggestionSelected({textInput:this.textInput, selectedSuggested:this.suggestions[this.selectedIndex], callbackevent:this.onselectevent});
                    $(document).trigger('w2gi:suggestion', {textInput:this.textInput, selectedSuggested:this.suggestions[this.selectedIndex], callbackevent:this.onselectevent, target: ev.target});
                }
                this.hideSuggestionBox();
            }.bind(this));

            this.suggestionBoxContainer.addEventListener('mouseout', function(ev){
                var element = ev.target;
                var index = element.getAttribute('data-suggestionIndex');
                this._setDeselectedAll();
            }.bind(this));

        }
    });

    SuggestionBox.numSuggestionBoxes = 0;



    return ClientGeocoder
})
;
/**
* Client Side directions
* Emits:
* Listens to:
**/

define(
  'src/clientside/cdirections',[
    'src/core/baseview',
    'src/core/basemodel',
    'jquery'
  ],
  function(BaseView, BaseModel, $) {
    console.log('cdirections loaded')
    var ClientDirections = BaseView.extend({
        initialize: function() {
            this.registerEvents()
            
        },
        initGoogleDirections: function() {
            if(!this.googleDirectionsService){
                if((typeof google != 'undefined') && google.maps && google.maps.DirectionsService){
                    this.googleDirectionsService = new google.maps.DirectionsService();                
                } else {
                    return false
                }
            }
            return true
        },
        registerEvents: function() {
           //this.listenTo(this.model, 'change', this.processResponse)
            _.bindAll(this, 'initSearch')
            this.ea.bind('directions:searchclient',  this.initSearch)
                 //.bind('directions:searchclient', this.searchForm)
        },
        initSearch: function(addresses, options, params) {
            this.initGoogleDirections()
            this.search(addresses, options, params)
        },
        search: function(addresses, searchInfo, params) {
            //options = options ? options : {};
            var gDirectionsReq = {},
                options = options || {}
            

            var origin = addresses[0]
            var destination = addresses[1]
            
            var orecnum = origin.poinum || null
            var drecnum = destination.poinum || null
            
            var action = searchInfo.action || null
            var locationuid = searchInfo.feature ? searchInfo.feature.uid : null
            
            this._prevSearchInfo = this._prevSearchInfo || {};
            
            //if either of orecnum or drecnum is undefined, then it is probably the first time that a directions search is being made from the search bubble
            if((orecnum === null && drecnum !== null) || (drecnum === null && orecnum !== null)){
                //save the first info
                this._firstSearchInfo = {
                    uid : searchInfo.uid,
                    action : searchInfo.action  //searchInfo.action is the true action here
                };
                //save the previous searchInfo
                this._prevSearchInfo = {
                    uid : searchInfo.uid,
                    action : searchInfo.action  //searchInfo.action is the true action here
                };
            }
            //else if both are defined, depending upon the first searchInfo, change the properties here
            else if(orecnum !== null && drecnum !== null){
                if(isNaN(orecnum) && !isNaN(drecnum)){  //the origin recnum is not a number, but destination recnum is -> the destination marker was probably moved
                    //if the first action was a 'To', then the destination was the store location; we have lost the locationuid now
                    if(this._firstSearchInfo.action == 'To'){
                        this._prevSearchInfo.uid = locationuid = undefined;
                    }
                    else{   //the first action was a 'From', therefore the destination was a user-input address; the locationuid is still alive, if it wasn't lost in the previous info
                        this._prevSearchInfo.uid = locationuid = (this._prevSearchInfo.uid == undefined ? undefined : searchInfo.uid); // jshint ignore:line
                    }
                    
                    //in any case, the action becomes a 'From'
                    this._prevSearchInfo.action = action = 'From';
                }
                else if(isNaN(drecnum) && !isNaN(orecnum)){ //the destination recnum is not a number, but origin recnum is -> the origin marker was probably moved
                    
                    //if the first action was a 'To', the origin was a user-input address, therefore the locationuid is still alive if it wasn't lost in the previous info
                    if(this._firstSearchInfo.action == 'To'){
                        //the action becomes a 'From' if the locationuid was lost in the previous info
                        if(this._prevSearchInfo.uid == undefined){ // jshint ignore:line
                            this._prevSearchInfo.action = action = 'From';
                        }
                        else{   //its a 'To'
                            this._prevSearchInfo.action = action = 'To';
                        }
                        this._prevSearchInfo.uid = locationuid = (this._prevSearchInfo.uid == undefined ? undefined : searchInfo.uid); // jshint ignore:line
                    }
                    else{   //the first action was a 'From', the origin was a store location; we have lost the locationuid now
                        this._prevSearchInfo.uid = locationuid = undefined;
                        //the action becomes a 'From' because we don't have the locationuid now
                        this._prevSearchInfo.action = action = 'From';
                    }
                }
                else{   //things are normal
                    this._prevSearchInfo.uid = searchInfo.uid;
                    this._prevSearchInfo.action = searchInfo.action;
                }
            }
            else if(orecnum === null && drecnum === null){  //this is probably a search not originating from the map bubble
                this._prevSearchInfo.uid = locationuid = undefined;
                this._prevSearchInfo.action = action = 'From';
            }
                      
            options.info = {
                locationuid : locationuid,
                action : action
            };

            if(params && params.country) {
                if(typeof params.country == 'object'){
                    gDirectionsReq.region = params.country[0];
                    gDirectionsReq.origin = this._googleSearchable(origin, params.country[0]);
                    gDirectionsReq.destination = this._googleSearchable(destination, params.country[0]);
                } else {
                    gDirectionsReq.region = params.country;
                    gDirectionsReq.origin = this._googleSearchable(origin, params.country);
                    gDirectionsReq.destination = this._googleSearchable(destination, params.country);
                }
            } else {
                gDirectionsReq.origin = this._googleSearchable(origin);
                gDirectionsReq.destination = this._googleSearchable(destination);
            }
            options.originCountry = origin.COUNTRY || origin.country/*  || params.country[0] */;
            options.destinationCountry = destination.COUNTRY || destination.country/*  || params.country[1] */;
            if(options && options.country){
                gDirectionsReq.region = options.country;
            } else if(this.options && this.options.country) {
                gDirectionsReq.region = this.options.country;
            } else if(origin.country){
                gDirectionsReq.region = origin.country;
            }
            
            if(params.roadpreference && params.roadpreference.toLowerCase() == 'local'){
                gDirectionsReq.avoidHighways = true;
                gDirectionsReq.avoidTolls = true;
            }
            
            var uom = options.distanceuom ? options.distanceuom : ace._distanceuom
            uom = params.distanceuom ? params.distanceuom : uom;
            if(uom){
                switch (uom.toLowerCase()){
                    case 'km':
                    case 'meter':
                        gDirectionsReq.unitSystem = google.maps.UnitSystem.METRIC;
                        break;
                    case 'mile':
                        gDirectionsReq.unitSystem = google.maps.UnitSystem.IMPERIAL;
                        break;
                }
            }
            
            gDirectionsReq.travelMode = google.maps.TravelMode.DRIVING;
            if(params.travelmode){
                switch(params.travelmode.toLowerCase()) {
                    case 'walk':
                    case 'walking':
                        gDirectionsReq.travelMode = google.maps.TravelMode.WALKING;
                    break;
                    case 'bike':
                    case 'bicycle':
                    case 'bicycling':
                        gDirectionsReq.travelMode = google.maps.TravelMode.BICYCLING;
                    break;
                    case 'transit':
                    case 'publictransit':
                        gDirectionsReq.travelMode = google.maps.TravelMode.TRANSIT;
                    break;
                    default:
                        gDirectionsReq.travelMode = google.maps.TravelMode.DRIVING;
                }
            }
            
            options.distanceuom = options.distanceuom ? options.distanceuom : params.distanceuom;
            
            this.googleDirectionsService.route(gDirectionsReq, this._processResponse.bind(this, gDirectionsReq, options));
            
            /* document.fire('w2gi:track', {
                action : 'directionsearch',
                value : JSON.stringify(gDirectionsReq)
            }); */
            
            return true;
        },
        dispatchResult: function(response) {
            this.ea.trigger('cdirections:result', response)
        },
        _processResponse: function(gDirectionsReq, options, result, status) {
            //debugger
            var records = [];
            var attributes = {};
            var addresses = [];
            var mapurl = "http://maps.googleapis.com/maps/api/staticmap?";
            var emailmapurl = "/lite?action=emaildirectionstart&appkey=" + W2GI.config.appkey + "&";
            
            mapurl += "size=";
            emailmapurl += "size=";
            if(options.mapsize) {
                mapurl += options.mapsize + "&";
                emailmapurl += options.mapsize.replace("x",",") + "&";
            } else {
                mapurl += "500x500&";
                emailmapurl += "500,500&";
            }
            attributes.name = 'maneuvers';
            
            if(status != google.maps.DirectionsStatus.OK){
                $(document).trigger('w2gi:fetchError', 'Driving directions could not be generated')
                this.dispatchResult({'records': records, 'attributes': attributes, 'status':status, 'addresses': addresses})
                return
            }
            
            var route = result.routes[0];
            mapurl += "path=enc:" + google.maps.geometry.encoding.encodePath(route.overview_path) + "&";
            var leg = route.legs[0];
            
            //build attributes
            //attributes.TOTAL_TIME = ace.util.convertSeconds(leg.duration.value);
            attributes.total_time = leg.duration.text;
            //attributes.TIME_UNIT = ace._timeuom ? ace._timeuom : 'minute';
            //attributes.TOTAL_DISTANCE = ace.util.convertMeters(leg.distance.value);
            attributes.total_distance = leg.distance.text;
            //attributes.DISTANCE_UNIT = ace._distanceuom ? ace._distanceuom : 'mile';
            
            //bounds
            var sw = route.bounds.getSouthWest();
            var ne = route.bounds.getNorthEast();
            attributes.bounds = sw.lng() + "," + sw.lat() + "," + ne.lng() + "," + ne.lat();
            
            //build address objects
            //ADDRESS based on user input
            addresses.push({'address1': gDirectionsReq.origin/*leg.start_address*/, 'latitude': leg.start_location.lat(), 'longitude': leg.start_location.lng(),'country':options.originCountry});
            mapurl += "markers=color:green|label:A|" + leg.start_location.lat() + "," + leg.start_location.lng() + "&";
            emailmapurl += "longitude="+leg.start_location.lng()+"&latitude="+leg.start_location.lat()+"&oaddress="+gDirectionsReq.origin+"&";
            addresses.push({'address1': gDirectionsReq.destination/*leg.end_address*/, 'latitude': leg.end_location.lat(), 'longitude': leg.end_location.lng(),'country':options.destinationCountry});
            mapurl += "markers=color:red|label:B|" + leg.end_location.lat() + "," + leg.end_location.lng() + "&";
            emailmapurl += "dest_longitude="+leg.end_location.lng()+"&dest_latitude="+leg.end_location.lat()+"&daddress="+gDirectionsReq.destination+"&";
            emailmapurl += 'distanceuom=' + (options.distanceuom ? options.distanceuom : 'mile') + '&';
            emailmapurl += 'timeuom=' + (ace._timeuom ? ace._timeuom : 'minute') + '&';
            
            //build maneuvers
            var steps = leg.steps
            _(steps).each(function( step, index ) {
                var record = {};
                record.id = index + 1;
                record.latitude = step.start_location.lat();
                record.longitude = step.start_location.lng();
                //record.text = step.instructions.replace(/(<([^>]+)>)/ig,"")
                record.text = step.instructions;
                var path = _(step.path).collect(function(latlng){
                    return latlng.lng() + " " + latlng.lat();
                }.bind(this));
                record.segment_geometry = "linestring(" + path.join(",") + ")";
                //record.TIME = ace.util.convertSeconds(step.duration.value, 2);
                record.time = step.duration.text;
                //record.TIMEUOM = ace._timeuom ? ace._timeuom : 'minute';
                //record.DISTANCE = ace.util.convertMeters(step.distance.value, 2, options.distanceuom);
                record.distance = step.distance.text;
                //record.DISTANCEUOM = ace._distanceuom ? ace._distanceuom : 'mile';
                records.push(record);
            },this);
            mapurl += "sensor=false" + "&";
            attributes.mapurl = mapurl.replace(/&$/,"");
            attributes.emailmapurl = emailmapurl.replace(/&$/,"");
            attributes.mobilemapurl = attributes.emailmapurl.replace("emaildirectionstart","smsdirectionstart");
            
            //console.log(google.maps.Geocoder);
            var googleGeocoder = new google.maps.Geocoder();
            googleGeocoder.geocode({address:addresses[0].address1}, function(resp){
                // resp.each(function(r){
                    // console.log(ace.cgeo.parseAddress(r));
                    // console.log('****');
                // });
                
                var add1 = ace.cgeo.parseAddress(resp[0]);
                
                googleGeocoder.geocode({address:addresses[1].address1}, function(resp){       

                    var add2 = ace.cgeo.parseAddress(resp[0]);             
                    var w2gilocator = ace.w2gilocator[0];
                    var obj = {
                        'account' : w2gilocator.schemaname,
                        'locatoruid' : w2gilocator.uit,
                        'accountuid' : w2gilocator.accountuid,
                        //'sessionid' : '',
                        //'seq' : '',
                        //'newloc' : '',
                        //'elapsedtime' : '',
                        'f_address1' : add1.address1,
                        'f_city' : add1.city,
                        'f_state' : add1.state || add1.province || '', //add1.state != '' ? add1.state : add1.province,
                        'f_country' : add1.country,
                        'f_postalcode' : add1.postalcode,
                        'f_latitude' : addresses[0].latitude,
                        'f_longitude' : addresses[0].longitude,
                        't_address1' : add2.address1,
                        't_city' : add2.city,
                        't_state' : add2.state || add2.province || '', //add2.state != '' ? add2.state : add2.province,
                        't_country' : add2.country,
                        't_postalcode' : add2.postalcode,
                        't_latitude' : addresses[1].latitude,
                        't_longitude' : addresses[1].longitude,
                        //'logtime' : '',
                        //'f_llpoint' : '',
                        //'t_llpoint' : '',
                        //'appkey' : '',
                        'locationuid' : options.info.locationuid,
                        'action' : options.info.action,
                        'distance' : ace.util.convertMeters(leg.distance.value),
                        'time_sec' : leg.duration.value,
                        //'logtimeepoch' : '',
                        //'remoteip' : '',
                        //'virtualhost' : ''
                    };
                    
                    $(document).trigger('w2gi:track', {
                        'action' : 'directionsearch',
                        'value' : JSON.stringify(obj)
                    });
                });
            });
            
            
                this.dispatchResult({'records': records, 'maneuvers': { attributes:attributes, collection: records }  , 'attributes': attributes, 'status':status, 'addresses': addresses, 'source':'Google', 'gResult': result});
 
    
        },
        _googleSearchable: function(obj,country) {
            if(typeof obj == 'string'){
                if (country){
                    if($$('option[value=' + country + ']'))
                        return obj + ", " + $$('option[value=' + country + ']')[0].innerHTML;
                    else
                        return obj + ", " + country;
                }else
                    return obj;
            } else {
                obj = this.lowerCaseObject(obj);
                 /*if(obj.latitude && obj.longitude){
                    // Google's documentation on using lat lng is wrong.
                    // If you use the LatLng object the toString method
                    // will wrap the comma separated lat lng with parens,
                    // this will cause an error.
                    //return new google.maps.LatLng(obj.latitude, obj.longitude);
                    return obj.latitude + "," + obj.longitude;
                    //commented out the above code because the code was comparing addressline with latLng, resulting
                    //in a minor change in destination address
                    * */
                if(obj.address1){
                    var addr1 = obj.address1;
                    addr1 += (obj.city && obj.city != "")? (', ' + obj.city ) : '';
                    addr1 += (obj.state && obj.state != "")? (', ' + obj.state) : '';
                    addr1 += (obj.postalcode && obj.postalcode == "") ? (', ' + obj.postalcode): '';
                    addr1 += (obj.country && obj.country != "" && obj.address1.indexOf(obj.country) == -1) ? (', ' + obj.country) : '';
                    var addr_country = obj.address1.replace(/\(.*?\)/g,"").split(',').pop().trim()
                    return addr1
                    
                } else if(obj.addressline){
                    if(obj.country || country)
                        return obj.addressline + ", " + (obj.country ? obj.country : country);
                    return obj.addressline;
                } else {
                    var addr = (obj.address && obj.address != "") ? obj.address: '';
                    addr1 += (obj.city && obj.city != "")? (', ' + obj.city ) : '';
                    addr1 += (obj.state && obj.state != "")? (', ' + obj.state) : '';
                    addr1 += (obj.postalcode && obj.postalcode == "") ? (', ' + obj.postalcode): '';
                    addr1 += (obj.country && obj.country != "" && obj.address1.indexOf(obj.country) == -1) ? (', ' + obj.country) : '';
                    if (!addr && obj.latitude && obj.longitude) {
                        return new google.maps.LatLng(obj.latitude, obj.longitude)
                    }
                    return addr;
                }
            }
        },
        lowerCaseObject: function(object) {
            var obj = {}
            for (var key in object) {
                obj[key.toLowerCase()] = object[key]
            }
            return obj
        }
    })

    return new ClientDirections()
})
;
/**
 * Loads Google Maps as a RequireJs module
 */
var googleLanguageCodes = [
        {"name":"ARABIC","code":"ar"},  {"name":"BASQUE","code":"eu"},  {"name":"BULGARIAN","code":"bg"},   {"name":"BENGALI","code":"bn"},
        {"name":"CATALAN","code":"ca"}, {"name":"CZECH","code":"cs"},   {"name":"DANISH","code":"da"},      {"name":"GERMAN","code":"de"},
        {"name":"GREEK","code":"el"},   {"name":"ENGLISH","code":"en"}, {"name":"ENGLISH (AUSTRALIAN)","code":"en-AU"},
        {"name":"ENGLISH (GREAT BRITAIN)","code":"en-GB"}, {"name":"SPANISH","code":"es"}, {"name":"BASQUE","code":"eu"},
        {"name":"FARSI","code":"fa"},    {"name":"FINNISH","code":"fi"},    {"name":"FILIPINO","code":"fil"}, {"name":"FRENCH","code":"fr"},
        {"name":"GALICIAN","code":"gl"}, {"name":"GUJARATI","code":"gu"},   {"name":"HINDI","code":"hi"},   {"name":"CROATIAN","code":"hr"},
        {"name":"HUNGARIAN","code":"hu"}, {"name":"INDONESIAN","code":"id"}, {"name":"ITALIAN","code":"it"},{"name":"HEBREW","code":"iw"},
        {"name":"JAPANESE","code":"ja"}, {"name":"KANNADA","code":"kn"},    {"name":"KOREAN","code":"ko"},  {"name":"LITHUANIAN","code":"lt"},
        {"name":"LATVIAN","code":"lv"},  {"name":"MALAYALAM","code":"ml"},  {"name":"MARATHI","code":"mr"}, {"name":"DUTCH","code":"nl"},
        {"name":"NORWEGIAN","code":"no"}, {"name":"POLISH","code":"pl"},    {"name":"PORTUGUESE","code":"pt"},
        {"name":"PORTUGUESE (BRAZIL)","code":"pt-BR"}, {"name":"PORTUGUESE (PORTUGAL)","code":"pt-PT"},     {"name":"ROMANIAN","code":"ro"},
        {"name":"RUSSIAN","code":"ru"}, {"name":"SLOVAK","code":"sk"},  {"name":"SLOVENIAN","code":"sl"},   {"name":"SERBIAN","code":"sr"},
        {"name":"SWEDISH","code":"sv"}, {"name":"TAGALOG","code":"tl"}, {"name":"TAMIL","code":"ta"},       {"name":"TELUGU","code":"te"},
        {"name":"THAI","code":"th"},    {"name":"TURKISH","code":"tr"}, {"name":"UKRAINIAN","code":"uk"},   {"name":"VIETNAMESE","code":"vi"},
        {"name":"CHINESE","code":"zh-CN"}, {"name":"CHINESE (SIMPLIFIED)","code":"zh-CN"}, {"name":"CHINESE (TRADITIONAL)","code":"zh-TW"},
        {"name":"MALAY","code":"ms"}
    ]

var url = '';
//try to get language
var language = '', lang = '', url='', arr, region = ''

/*
W2GI.config.language = opts.drivingdirections.language
                            W2GI.config.region = opts.drivingdirections.region
*/
if (W2GI.config && W2GI.config.language ) {
    lang =  W2GI.config.language
} else if (W2GI.config  && W2GI.config.locator && W2GI.config.locator.drivingdirections && W2GI.config.locator.drivingdirections.language ) {
    lang =  W2GI.config.locator.drivingdirections.language
} else {
    lang = 'english'
}

if (W2GI.config && W2GI.config.region) {
  region =  W2GI.config.region
} else if (W2GI.config  && W2GI.config.locator && W2GI.config.locator.drivingdirections && W2GI.config.locator.drivingdirections.region) {
  region = W2GI.config.locator.drivingdirections.region
} else {
  region = null
}
//lang = ( || ) ? W2GI.config.language : 'english';
//region = (W2GI.config && W2GI.config.region) ? W2GI.config.region : null;
if(lang){
    lang = _.where(googleLanguageCodes,{name: lang.toUpperCase()})
    if (lang.length != 0){
        language = lang[0].code
    } else {
        language = _.where(googleLanguageCodes,{code: lang.toUpperCase()})
        if (lang.length == 0){
            language = null
        } else {
            language = lang[0].code
        }
    }
}

if(/^https/.test(window.location.protocol)) {
    url = 'https://maps-api-ssl.google.com'
} else {
    url = 'http://maps.googleapis.com'
}
//url += '/maps/api/js?v=3&sensor=false&client=gme-where2getit';
//url += '/maps/api/js?v=3.20&sensor=false&client=gme-where2getit';
//url += '/maps/api/js?v=3.27&client=gme-where2getit';
//url += '/maps/api/js?v=3.29&client=gme-where2getit';
url += '/maps/api/js?v=3.31&client=gme-where2getit';
url += '&libraries=places';

if(!_.isEmpty(language)) {
    url += '&language=' + language
}

if (region && !_.isEmpty(region)) {
    url += '&region=' + region
}
define('googlemaps',['async!' + url],
function(){
    // return the gmaps namespace for brevity
    return window.google.maps;
});

// Ol3-Google-Maps. See https://github.com/mapgears/ol3-google-maps/
// License: https://github.com/mapgears/ol3-google-maps/blob/master/LICENSE
// Version: v0.3-16-gf2a6da4

(function (root, factory) {
  if (typeof exports === "object") {
    module.exports = factory(root.ol);
  } else if (typeof define === "function" && define.amd) {
    define('ol3gm',['ol'], factory);
  } else {
    root.olgm = factory(root.ol);
  }
}(this, function (ol) {
  var OL3GOOGLEMAPS = {};
  var g,l=this;
function n(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";else if("function"==
b&&"undefined"==typeof a.call)return"object";return b}function aa(a,b,c){return a.call.apply(a.bind,arguments)}function ba(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}
function p(a,b,c){p=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?aa:ba;return p.apply(null,arguments)}function q(a,b){var c=a.split("."),d=OL3GOOGLEMAPS||l;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)c.length||void 0===b?d[e]?d=d[e]:d=d[e]={}:d[e]=b}
function s(a,b){function c(){}c.prototype=b.prototype;a.j=b.prototype;a.prototype=new c;a.da=function(a,c,f){return b.prototype[c].apply(a,Array.prototype.slice.call(arguments,2))}};function t(a,b){this.e=a;this.a=b};function u(a,b){return a<b?-1:a>b?1:0};var v=Array.prototype,ca=v.indexOf?function(a,b,c){return v.indexOf.call(a,b,c)}:function(a,b,c){c=null==c?0:0>c?Math.max(0,a.length+c):c;if("string"==typeof a)return"string"==typeof b&&1==b.length?a.indexOf(b,c):-1;for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1};var x;a:{var z=l.navigator;if(z){var A=z.userAgent;if(A){x=A;break a}}x=""};var B=-1!=x.indexOf("Opera")||-1!=x.indexOf("OPR"),C=-1!=x.indexOf("Trident")||-1!=x.indexOf("MSIE"),D=-1!=x.indexOf("Gecko")&&-1==x.toLowerCase().indexOf("webkit")&&!(-1!=x.indexOf("Trident")||-1!=x.indexOf("MSIE")),E=-1!=x.toLowerCase().indexOf("webkit");function F(){var a=l.document;return a?a.documentMode:void 0}
var G=function(){var a="",b;if(B&&l.opera)return a=l.opera.version,"function"==n(a)?a():a;D?b=/rv\:([^\);]+)(\)|;)/:C?b=/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/:E&&(b=/WebKit\/(\S+)/);b&&(a=(a=b.exec(x))?a[1]:"");return C&&(b=F(),b>parseFloat(a))?String(b):a}(),da={};
function H(a){var b;if(!(b=da[a])){b=0;for(var c=String(G).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),d=String(a).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var h=c[f]||"",k=d[f]||"",w=RegExp("(\\d*)(\\D*)","g"),m=RegExp("(\\d*)(\\D*)","g");do{var r=w.exec(h)||["","",""],y=m.exec(k)||["","",""];if(0==r[0].length&&0==y[0].length)break;b=u(0==r[1].length?0:parseInt(r[1],10),0==y[1].length?0:parseInt(y[1],10))||u(0==r[2].length,0==y[2].length)||
u(r[2],y[2])}while(0==b)}b=da[a]=0<=b}return b}var ea=l.document,fa=ea&&C?F()||("CSS1Compat"==ea.compatMode?parseInt(G,10):5):void 0;var I;(I=!C)||(I=C&&9<=fa);var ga=I,ha=C&&!H("9");!E||H("528");D&&H("1.9b")||C&&H("8")||B&&H("9.5")||E&&H("528");D&&!H("8")||C&&H("9");function J(a,b){this.type=a;this.a=this.b=b}J.prototype.c=function(){};function K(a){K[" "](a);return a}K[" "]=function(){};function L(a,b){J.call(this,a?a.type:"");this.d=this.a=this.b=null;if(a){this.type=a.type;this.b=a.target||a.srcElement;this.a=b;var c=a.relatedTarget;if(c&&D)try{K(c.nodeName)}catch(d){}this.d=a;a.defaultPrevented&&this.c()}}s(L,J);L.prototype.c=function(){L.j.c.call(this);var a=this.d;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,ha)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};var ia="closure_listenable_"+(1E6*Math.random()|0),ja=0;function ka(a,b,c,d,e){this.p=a;this.a=null;this.src=b;this.type=c;this.B=!!d;this.b=e;++ja;this.s=this.A=!1}function la(a){a.s=!0;a.p=null;a.a=null;a.src=null;a.b=null};function ma(a){this.src=a;this.a={};this.b=0};var M="closure_lm_"+(1E6*Math.random()|0),N={},na=0;
function oa(a,b,c,d,e){if("array"==n(b)){for(var f=0;f<b.length;f++)oa(a,b[f],c,d,e);return null}c=pa(c);if(a&&a[ia])a=a.a(b,c,d,e);else{f=c;if(!b)throw Error("Invalid event type");c=!!d;var h=O(a);h||(a[M]=h=new ma(a));var k=h,w=b.toString(),h=k.a[w];h||(h=k.a[w]=[],k.b++);var m;b:{for(m=0;m<h.length;++m){var r=h[m];if(!r.s&&r.p==f&&r.B==!!d&&r.b==e)break b}m=-1}-1<m?(d=h[m],d.A=!1):(d=new ka(f,k.src,w,!!d,e),d.A=!1,h.push(d));d.a||(e=qa(),d.a=e,e.src=a,e.p=d,a.addEventListener?a.addEventListener(b.toString(),
e,c):a.attachEvent(ra(b.toString()),e),na++);a=d}return a}function qa(){var a=sa,b=ga?function(c){return a.call(b.src,b.p,c)}:function(c){c=a.call(b.src,b.p,c);if(!c)return c};return b}function ra(a){return a in N?N[a]:N[a]="on"+a}function ta(a,b,c,d){var e=1;if(a=O(a))if(b=a.a[b.toString()])for(b=b.concat(),a=0;a<b.length;a++){var f=b[a];f&&f.B==c&&!f.s&&(e&=!1!==ua(f,d))}return Boolean(e)}
function ua(a,b){var c=a.p,d=a.b||a.src;if(a.A&&"number"!=typeof a&&a&&!a.s){var e=a.src;if(e&&e[ia])e.ea(a);else{var f=a.type,h=a.a;e.removeEventListener?e.removeEventListener(f,h,a.B):e.detachEvent&&e.detachEvent(ra(f),h);na--;if(f=O(e)){h=a.type;if(h in f.a){var k=f.a[h],w=ca(k,a),m;(m=0<=w)&&v.splice.call(k,w,1);m&&(la(a),0==f.a[h].length&&(delete f.a[h],f.b--))}0==f.b&&(f.src=null,e[M]=null)}else la(a)}}return c.call(d,b)}
function sa(a,b){if(a.s)return!0;if(!ga){var c;if(!(c=b))a:{c=["window","event"];for(var d=l,e;e=c.shift();)if(null!=d[e])d=d[e];else{c=null;break a}c=d}e=c;c=new L(e,this);d=!0;if(!(0>e.keyCode||void 0!=e.returnValue)){a:{var f=!1;if(0==e.keyCode)try{e.keyCode=-1;break a}catch(h){f=!0}if(f||void 0==e.returnValue)e.returnValue=!0}e=[];for(f=c.a;f;f=f.parentNode)e.push(f);for(var f=a.type,k=e.length-1;0<=k;k--)c.a=e[k],d&=ta(e[k],f,!0,c);for(k=0;k<e.length;k++)c.a=e[k],d&=ta(e[k],f,!1,c)}return d}return ua(a,
new L(b,this))}function O(a){a=a[M];return a instanceof ma?a:null}var va="__closure_events_fn_"+(1E9*Math.random()>>>0);function pa(a){return"function"==n(a)?a:a[va]||(a[va]=function(b){return a.handleEvent(b)})};var wa=[156543.03390625,78271.516953125,39135.7584765625,19567.87923828125,9783.939619140625,4891.9698095703125,2445.9849047851562,1222.9924523925781,611.4962261962891,305.74811309814453,152.87405654907226,76.43702827453613,38.218514137268066,19.109257068634033,9.554628534317017,4.777314267158508,2.388657133579254,1.194328566789627,.5971642833948135,.298582141697,.14929107084,.07464553542,.03732276771];
function xa(a){var b=null;return b=a instanceof ol.geom.Point?a.getCoordinates():a instanceof ol.geom.Polygon?a.getInteriorPoint().getCoordinates():ol.extent.getCenter(a.getExtent())}function P(a){var b="",c=null;"string"===typeof a?0===a.indexOf("rgba")?c=ya(a):b=a:c=a;null!==c&&(b=["rgb(",c[0],",",c[1],",",c[2],")"].join(""));return b}function Q(a){var b=null,c=null;"string"===typeof a?0===a.indexOf("rgba")&&(c=ya(a)):c=a;c&&void 0!==c[3]&&(b=+c[3]);return b}
function za(a){var b=null;a instanceof ol.style.Style?b=a:a instanceof ol.layer.Vector||a instanceof ol.Feature?(b=a.getStyle())&&b instanceof Function&&(b=b()[0]):a instanceof Function&&(b=a()[0]);return b}function ya(a){var b=null;(a=a.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)$/))&&a.length&&(b=[+a[1],+a[2],+a[3],+a[4]]);return b}function R(a){a.forEach(ol.Observable.unByKey);a.length=0};function S(a){this.set("font","normal 10px sans-serif");this.set("textAlign","center");this.set("textBaseline","middle");this.set("zIndex",1E3);this.setValues(a)}window.google&&window.google.maps&&s(S,google.maps.OverlayView);g=S.prototype;g.J=!1;g.L=0;g.T=0;g.changed=function(a){switch(a){case "fontColor":case "fontFamily":case "fontSize":case "fontWeight":case "strokeColor":case "strokeWeight":case "text":case "textAlign":case "textBaseline":Aa(this);break;case "maxZoom":case "minZoom":case "offsetX":case "offsetY":case "position":this.draw()}};
function Aa(a){var b=a.a;if(b){var c=b.style,d=a.get("fontColor");if(d&&(c.zIndex=a.get("zIndex"),c=b.getContext("2d"),c.clearRect(0,0,b.width,b.height),c.textBaseline=a.get("textBaseline"),c.strokeStyle=a.get("strokeColor"),c.fillStyle=d,c.font=a.get("font"),c.textAlign=a.get("textAlign"),d=a.get("text"))){var e=b.width/2,b=b.height/2;if(a=Number(a.get("strokeWeight")))c.lineWidth=a,c.strokeText(d,e,b);c.fillText(d,e,b)}}}
g.onAdd=function(){var a=this.a=document.createElement("canvas");a.style.position="absolute";a.getContext("2d").lineJoin="round";Aa(this);var b=this.getPanes();b&&b.markerLayer.appendChild(a)};g.draw=function(){if(this.J)Ba(this);else{var a=this.a;if(a){var a=a.getContext("2d"),b=a.canvas.height;this.T=a.canvas.width;this.L=b;Ba(this)&&(this.J=!0)}}};
function Ba(a){var b=a.get("position");if(!b)return!1;var c=a.getProjection();if(!c)return!1;var c=c.fromLatLngToDivPixel(b),d=a.L,e=a.T,f=a.get("offsetX")||0,h=a.get("offsetY")||0,b=a.a.style;b.top=c.y-d/2+h+"px";b.left=c.x-e/2+f+"px";c=a.get("minZoom");d=a.get("maxZoom");void 0===c&&void 0===d?a="":(a=a.getMap())?(a=a.getZoom(),a=a<c||a>d?"hidden":""):a="";b.visibility=a;return!0}g.onRemove=function(){var a=this.a;a&&a.parentNode&&a.parentNode.removeChild(a)};function Ca(a,b){var c=null;if(a instanceof ol.geom.Point)c=T(a,b);else if(a instanceof ol.geom.LineString||a instanceof ol.geom.Polygon){var d=void 0!==b?b.getView().getProjection():"EPSG:3857",c=[],e,f;f=a instanceof ol.geom.LineString?a.getCoordinates():a.getCoordinates()[0];for(var h=0,k=f.length;h<k;h++)e=ol.proj.transform(f[h],d,"EPSG:4326"),c.push(new google.maps.LatLng(e[1],e[0]));d=null;a instanceof ol.geom.LineString?d=new google.maps.Data.LineString(c):d=new google.maps.Data.Polygon([c]);
c=d}return c}function T(a,b){var c=void 0!==b?b.getView().getProjection():"EPSG:3857",d;d=a instanceof ol.geom.Point?a.getCoordinates():a;c=ol.proj.transform(d,c,"EPSG:4326");return new google.maps.LatLng(c[1],c[0])}
function Da(a,b){var c=null,d=za(a);if(d){var c={},e=d.getStroke();if(e){var f=e.getColor();f&&(c.strokeColor=P(f),f=Q(f),null!==f&&(c.strokeOpacity=f));(e=e.getWidth())&&(c.strokeWeight=e)}if(e=d.getFill())if(e=e.getColor())c.fillColor=P(e),e=Q(e),null!==e&&(c.fillOpacity=e);if(f=d.getImage()){d={};e={};if(f instanceof ol.style.Circle){e.path=google.maps.SymbolPath.CIRCLE;var h=f.getStroke();if(h){var k=h.getColor();k&&(e.strokeColor=P(k));e.strokeWeight=h.getWidth()}if(h=f.getFill())if(h=h.getColor())e.fillColor=
P(h),h=Q(h),e.fillOpacity=null!==h?h:1;(f=f.getRadius())&&(e.scale=f)}else f instanceof ol.style.Icon&&((h=f.getSrc())&&(e.url=h),h=f.getScale(),(k=f.getAnchor())&&(e.anchor=void 0!==h?new google.maps.Point(k[0]*h,k[1]*h):new google.maps.Point(k[0],k[1])),(k=f.getOrigin())&&(e.origin=new google.maps.Point(k[0],k[1])),f=f.getSize())&&(e.size=new google.maps.Size(f[0],f[1]),void 0!==h&&(e.scaledSize=new google.maps.Size(f[0]*h,f[1]*h)));Object.keys(d).length?c.icon=d:Object.keys(e).length&&(c.icon=
e)}0===Object.keys(c).length?c.visible=!1:void 0!==b&&(c.zIndex=2*b)}return c};function U(a,b){this.h=[];t.call(this,a,b)}s(U,t);U.prototype.g=function(){};U.prototype.f=function(){R(this.h)};function V(a,b,c,d,e){this.b=c;this.d=d;this.i=e;U.call(this,a,b)}s(V,U);g=V.prototype;g.n=null;g.k=null;
g.g=function(){V.j.g.call(this);var a=this.b.getGeometry(),b=this.b.getGeometry(),b=Ca(b,void 0);this.n=new google.maps.Data.Feature({geometry:b});this.d.add(this.n);(b=Da(this.b,this.i))&&this.d.overrideStyle(this.n,b);if(b=za(this.b)){var c=b.getText();if(c){var b={align:"center",position:T(xa(a)),zIndex:2*this.i+1},d=c.getText();d&&(b.text=d);(d=c.getFont())&&(b.font=d);(d=c.getFill())&&(d=d.getColor())&&(b.fontColor=d);if(d=c.getStroke()){var e=d.getColor();e&&(b.strokeColor=e);(d=d.getWidth())&&
(b.strokeWeight=d)}(d=c.getOffsetX())&&(b.offsetX=d);(d=c.getOffsetY())&&(b.offsetY=d);(d=c.getTextAlign())&&(b.textAlign=d);(c=c.getTextBaseline())&&(b.textBaseline=c);this.k=new S(b);this.k.setMap(this.a)}}b=this.h;this.c=a.on("change",this.F,this);b.push(this.c);b.push(this.b.on("change:"+this.b.getGeometryName(),this.V,this))};g.f=function(){this.d.remove(this.n);this.n=null;this.k&&(this.k.setMap(null),this.k=null);V.j.f.call(this)};
g.F=function(){var a=this.b.getGeometry();this.n.setGeometry(Ca(a));this.k&&(a=T(xa(a)),this.k.set("position",a))};g.V=function(){var a=this.h;ol.Observable.unByKey(this.c);a.splice(a.indexOf(this.c),1);this.c=this.b.getGeometry().on("change",this.F,this);a.push(this.c);this.F()};function W(a,b,c,d){this.b=[];this.d=[];this.i=d;this.c=c;U.call(this,a,b)}s(W,U);g=W.prototype;g.g=function(){W.j.g.call(this);this.c.getFeatures().forEach(this.R,this);var a=this.h;a.push(this.c.on("addfeature",this.U,this));a.push(this.c.on("removefeature",this.Y,this))};g.f=function(){this.c.getFeatures().forEach(this.P,this);W.j.f.call(this)};g.U=function(a){this.R(a.feature)};g.Y=function(a){this.P(a.feature)};
g.R=function(a){var b=this.e,c=this.a,d=this.i;this.b.push(a);b=new V(b,c,a,d,this.b.indexOf(a));b.g();this.d.push({feature:a,r:b})};g.P=function(a){a=this.b.indexOf(a);-1!==a&&(this.b.splice(a,1),this.d[a].r.f(),this.d.splice(a,1))};function X(a,b){U.call(this,a,b)}s(X,U);g=X.prototype;g.v=null;g.g=function(){X.j.g.call(this);var a=this.e.getView(),b=this.h;b.push(a.on("change:center",this.u,this));b.push(a.on("change:resolution",this.H,this));b.push(oa(window,"resize",this.$,!1,this));this.u();this.H()};g.f=function(){X.j.f.call(this)};g.u=function(){var a=this.e.getView(),b=a.getProjection(),a=a.getCenter();"array"==n(a)&&(a=ol.proj.transform(a,b,"EPSG:4326"),this.a.setCenter(new google.maps.LatLng(a[1],a[0])))};
g.H=function(){var a=this.e.getView().getResolution();if("number"==typeof a){var b;b=null;for(var a=Math.round(1E3*a)/1E3,c=0,d=wa.length;c<d;c++)if(a==Math.round(1E3*wa[c])/1E3){b=c;break}null!==b&&this.a.setZoom(b)}};g.$=function(){null===this.v||l.clearTimeout(this.v);this.v=window.setTimeout(p(this.ca,this),100)};g.ca=function(){this.u();this.v=null};function Y(a){a=void 0!==a?a:{};ol.layer.Group.call(this,a);this.a=void 0!==a.mapTypeId?a.mapTypeId:google.maps.MapTypeId.ROADMAP;this.c=a.styles?a.styles:null}s(Y,ol.layer.Group);Y.prototype.b=function(){return this.a};function Z(a,b,c){this.t=[];this.C=[];this.b=[];this.D=[];this.i=new X(a,b);this.M=c;this.K=b.getDiv();this.c=a.getViewport();this.d=a.getTargetElement();U.call(this,a,b);if(this.e.getView().getCenter())this.e.once("postrender",function(){this.G=!0;this.q()},this);else this.e.getView().once("change:center",function(){this.e.once("postrender",function(){this.G=!0;this.q()},this);this.q()},this)}s(Z,U);g=Z.prototype;g.o=!1;g.G=!1;
g.g=function(){Z.j.g.call(this);var a=this.e.getLayers();a.forEach(this.S,this);var b=this.h;b.push(a.on("add",this.W,this));b.push(a.on("remove",this.X,this))};g.f=function(){this.e.getLayers().forEach(this.Q,this);Z.j.f.call(this)};g.W=function(a){this.S(a.element)};g.X=function(a){this.Q(a.element)};
g.S=function(a){if(a instanceof Y)this.t.push(a),this.C.push({layer:a,h:[a.on("change:visible",this.q,this)]}),this.q();else if(a instanceof ol.layer.Vector&&this.M){var b=this.e,c=this.a,d=a.getSource();if(d){this.D.push(a);var e=new google.maps.Data({map:c}),f=Da(a);f&&e.setStyle(f);b=new W(b,c,d,e);c=a.getOpacity();e={data:e,r:b,layer:a,h:[],opacity:c};e.h.push(a.on("change:visible",this.Z.bind(this,e),this));this.w(e);this.b.push(e)}}};
g.Q=function(a){if(a instanceof Y)a=this.t.indexOf(a),-1!==a&&(this.t.splice(a,1),R(this.C[a].h),this.C.splice(a,1),this.q());else if(a instanceof ol.layer.Vector&&this.M){var b=this.D.indexOf(a);if(-1!==b){this.D.splice(b,1);var c=this.b[b];R(c.h);c.data.setMap(null);c.r.f();a.setOpacity(c.opacity);this.b.splice(b,1)}}};
function Ea(a){var b=a.e.getView().getCenter();!a.o&&a.G&&b&&(a.d.removeChild(a.c),a.d.appendChild(a.K),a.a.controls[google.maps.ControlPosition.TOP_LEFT].push(a.c),a.i.g(),google.maps.event.trigger(a.a,"resize"),a.i.u(),a.i.H(),a.o=!0,a.b.forEach(a.w,a))}
g.q=function(){var a=null;this.e.getLayers().getArray().slice(0).reverse().every(function(b){return b instanceof Y&&b.getVisible()&&-1!==this.t.indexOf(b)?(a=b,!1):!0},this);if(a){this.a.setMapTypeId(a.a);var b=a.c;b?this.a.setOptions({styles:b}):this.a.setOptions({styles:null});Ea(this)}else this.o&&(this.a.controls[google.maps.ControlPosition.TOP_LEFT].removeAt(0),this.d.removeChild(this.K),this.d.appendChild(this.c),this.i.f(),this.c.style.position="relative",this.b.forEach(this.I,this),this.o=
!1)};g.w=function(a){a.layer.getVisible()&&this.o&&(a.r.g(),a.layer.setOpacity(0))};g.I=function(a){a.r.f();a.layer.setOpacity(a.opacity)};g.Z=function(a){a.layer.getVisible()?this.w(a):this.I(a)};function $(a){this.b=[];var b=document.createElement("div");b.style.height="inherit";b.style.width="inherit";b=new google.maps.Map(b,{disableDefaultUI:!0,disableDoubleClickZoom:!0,draggable:!1,keyboardShortcuts:!1,mapTypeId:google.maps.MapTypeId.ROADMAP,scrollwheel:!1,streetViewControl:!1});t.call(this,a.map,b);this.c=new Z(this.e,this.a,void 0!==a.watchVector?a.watchVector:!0);this.b.push(this.c)}s($,t);g=$.prototype;g.l=!1;
g.N=function(){if(!this.l){for(var a=0,b=this.b.length;a<b;a++)this.b[a].g();this.l=!0}};g.O=function(){if(this.l){for(var a=0,b=this.b.length;a<b;a++)this.b[a].f();this.l=!1}};g.aa=function(){return this.l&&this.c.o};g.ba=function(){this.l?this.O():this.N()};q("olgm.OLGoogleMaps",$);$.prototype.activate=$.prototype.N;$.prototype.deactivate=$.prototype.O;$.prototype.getGoogleMapsActive=$.prototype.aa;$.prototype.toggle=$.prototype.ba;q("olgm.layer.Google",Y);Y.prototype.getMapTypeId=Y.prototype.b;q("olgm.interaction.defaults",function(a){a=void 0!==a?a:{};a.altShiftDragRotate=!1;a.dragPan=!1;a.pinchRotate=!1;return ol.interaction.defaults(a).extend([new ol.interaction.DragPan])});q("olgm.gm.MapLabel",S);S.prototype.changed=S.prototype.changed;
S.prototype.onAdd=S.prototype.onAdd;S.prototype.draw=S.prototype.draw;S.prototype.onRemove=S.prototype.onRemove;
  return OL3GOOGLEMAPS.olgm;
}));


})(); requirejs.config({ map: { '*' : { 'jquery' : 'jquery-private' }, 'jquery-private' : { 'jquery' : 'jquery' } } }); requirejs(['main']);